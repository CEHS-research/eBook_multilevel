<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models</title>
  <meta name="description" content="RM Regression: ICCs, MLM/HLM, and GEEs." />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="EQM_v1_cover.png" />
  <meta property="og:description" content="RM Regression: ICCs, MLM/HLM, and GEEs." />
  <meta name="github-repo" content="cehs-research/eBook_wrangle" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models" />
  
  <meta name="twitter:description" content="RM Regression: ICCs, MLM/HLM, and GEEs." />
  <meta name="twitter:image" content="EQM_v1_cover.png" />

<meta name="author" content="Sarah Schwartz &amp; Tyson Barrett" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="heading.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models</h1>
<p class="author"><em>Sarah Schwartz &amp; Tyson Barrett</em></p>
<p class="date"><em>Last updated: 2020-10-29</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#welcome">Welcome</a>
<ul>
<li><a href="#blocked-notes">Blocked Notes</a></li>
<li><a href="#code-and-output">Code and Output</a></li>
<li><a href="#the-authors">The Authors</a>
<ul>
<li><a href="#why-choose-r">Why choose R ?</a></li>
<li><a href="#fyi">FYI</a></li>
</ul></li>
</ul></li>
<li><a href="#learning-resources"><span class="toc-section-number">1</span> Learning Resources</a>
<ul>
<li><a href="#introduction"><span class="toc-section-number">1.1</span> Introduction</a></li>
</ul></li>
<li><a href="#formula-warehouse"><span class="toc-section-number">2</span> Formula Warehouse</a>
<ul>
<li><a href="#data-notation"><span class="toc-section-number">2.1</span> Data Notation</a></li>
<li><a href="#single-level-regression-analysis"><span class="toc-section-number">2.2</span> Single-level Regression Analysis</a>
<ul>
<li><a href="#the-only-equation"><span class="toc-section-number">2.2.1</span> The Only Equation</a></li>
<li><a href="#parameters"><span class="toc-section-number">2.2.2</span> Parameters</a></li>
<li><a href="#assumptions-to-check"><span class="toc-section-number">2.2.3</span> Assumptions to Check</a></li>
</ul></li>
<li><a href="#multi-level-regression-analysis"><span class="toc-section-number">2.3</span> Multi-level Regression Analysis</a>
<ul>
<li><a href="#level-1-regression-equation"><span class="toc-section-number">2.3.1</span> Level 1 Regression Equation*</a></li>
<li><a href="#level-2-regression-equations"><span class="toc-section-number">2.3.2</span> Level 2 Regression Equations</a></li>
<li><a href="#combinded-multilevel-regression-equation"><span class="toc-section-number">2.3.3</span> Combinded, Multilevel Regression Equation</a></li>
<li><a href="#parameters-1"><span class="toc-section-number">2.3.4</span> Parameters</a></li>
</ul></li>
<li><a href="#intraclass-correlation-icc"><span class="toc-section-number">2.4</span> Intraclass Correlation (ICC)</a>
<ul>
<li><a href="#two-level-models"><span class="toc-section-number">2.4.1</span> Two Level Models</a></li>
<li><a href="#three-level-models"><span class="toc-section-number">2.4.2</span> Three Level Models</a></li>
</ul></li>
<li><a href="#proporion-of-variance-explianed"><span class="toc-section-number">2.5</span> Proporion of Variance Explianed</a>
<ul>
<li><a href="#level-1-variance-explained"><span class="toc-section-number">2.5.1</span> Level 1 Variance Explained</a></li>
<li><a href="#level-2-variance-explined"><span class="toc-section-number">2.5.2</span> Level 2 Variance Explined</a></li>
</ul></li>
<li><a href="#using-latex-for-equation-typesetting"><span class="toc-section-number">2.6</span> Using <span class="math inline">\(\LaTeX\)</span> for Equation Typesetting</a></li>
</ul></li>
<li><a href="#example-articles"><span class="toc-section-number">3</span> Example Articles</a>
<ul>
<li><a href="#cross-sectional-clustered-or-hierarchical"><span class="toc-section-number">3.1</span> Cross-sectional: clustered or hierarchical</a>
<ul>
<li><a href="#non-randomized-intervention"><span class="toc-section-number">3.1.1</span> Non-randomized Intervention</a></li>
<li><a href="#dyadic-design"><span class="toc-section-number">3.1.2</span> Dyadic Design</a></li>
<li><a href="#binary-outcome"><span class="toc-section-number">3.1.3</span> Binary Outcome</a></li>
</ul></li>
<li><a href="#repeated-measures-longitudinal-change-over-time-or-conditional-no-time-component"><span class="toc-section-number">3.2</span> Repeated Measures: longitudinal (change over time) or conditional (no time component)</a>
<ul>
<li><a href="#repeated-measures---linear-growth"><span class="toc-section-number">3.2.1</span> Repeated Measures - linear growth</a></li>
<li><a href="#cohort-sequential-or-accelerated-longitudinal-design"><span class="toc-section-number">3.2.2</span> Cohort sequential or accelerated longitudinal design</a></li>
<li><a href="#sem-framework"><span class="toc-section-number">3.2.3</span> SEM Framework</a></li>
</ul></li>
<li><a href="#both-hierarchical-longitudinal"><span class="toc-section-number">3.3</span> Both: Hierarchical longitudinal</a></li>
</ul></li>
<li><a href="#mlm-2-levels-pupil-popularity"><span class="toc-section-number">4</span> MLM, 2-levels: Pupil Popularity</a>
<ul>
<li><a href="#background"><span class="toc-section-number">4.1</span> Background</a>
<ul>
<li><a href="#unique-identifiers"><span class="toc-section-number">4.1.1</span> Unique Identifiers</a></li>
<li><a href="#structure-and-variables"><span class="toc-section-number">4.1.2</span> Structure and variables</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis"><span class="toc-section-number">4.2</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summarize-descriptive-statistics"><span class="toc-section-number">4.2.1</span> Summarize Descriptive Statistics</a></li>
<li><a href="#visualizations-of-raw-data"><span class="toc-section-number">4.2.2</span> Visualizations of Raw Data</a></li>
<li><a href="#consider-clustering"><span class="toc-section-number">4.2.3</span> Consider Clustering</a></li>
</ul></li>
<li><a href="#single-level-regression-analysis-1"><span class="toc-section-number">4.3</span> Single-level Regression Analysis</a>
<ul>
<li><a href="#null-model"><span class="toc-section-number">4.3.1</span> Null Model</a></li>
<li><a href="#add-predictors-to-the-model"><span class="toc-section-number">4.3.2</span> Add Predictors to the Model</a></li>
<li><a href="#compare-fixed-effects"><span class="toc-section-number">4.3.3</span> Compare Fixed Effects</a></li>
</ul></li>
<li><a href="#multi-level-regression-analysis-1"><span class="toc-section-number">4.4</span> Multi-level Regression Analysis</a>
<ul>
<li><a href="#intercept-only-or-null-model"><span class="toc-section-number">4.4.1</span> Intercept-only or Null Model</a></li>
<li><a href="#intraclass-correlation-icc-1"><span class="toc-section-number">4.4.2</span> Intraclass Correlation (ICC)</a></li>
<li><a href="#add-predictors-to-the-model-1"><span class="toc-section-number">4.4.3</span> Add Predictors to the Model</a></li>
<li><a href="#testing-random-components"><span class="toc-section-number">4.4.4</span> Testing Random Components</a></li>
<li><a href="#testing-cross-level-interactions"><span class="toc-section-number">4.4.5</span> Testing Cross-Level Interactions</a></li>
<li><a href="#final-model"><span class="toc-section-number">4.4.6</span> Final Model</a></li>
<li><a href="#residual-plots"><span class="toc-section-number">4.4.7</span> Residual Plots</a></li>
</ul></li>
</ul></li>
<li><a href="#mlm-3-levels-nurses-stress-intervention"><span class="toc-section-number">5</span> MLM, 3 levels: Nurse’s Stress Intervention</a>
<ul>
<li><a href="#background-1"><span class="toc-section-number">5.1</span> Background</a>
<ul>
<li><a href="#unique-identifiers-1"><span class="toc-section-number">5.1.1</span> Unique Identifiers</a></li>
<li><a href="#centering-variables"><span class="toc-section-number">5.1.2</span> Centering Variables</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-1"><span class="toc-section-number">5.2</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summarize-descriptive-statistics-1"><span class="toc-section-number">5.2.1</span> Summarize Descriptive Statistics</a></li>
</ul></li>
<li><a href="#mlm-null-model"><span class="toc-section-number">5.3</span> MLM: Null Model</a></li>
<li><a href="#estimate-the-icc"><span class="toc-section-number">5.4</span> Estimate the ICC</a></li>
<li><a href="#mlm-add-fixed-effects"><span class="toc-section-number">5.5</span> MLM: Add Fixed Effects</a>
<ul>
<li><a href="#fit-the-model-5"><span class="toc-section-number">5.5.1</span> Fit the Model</a></li>
<li><a href="#assess-significance"><span class="toc-section-number">5.5.2</span> Assess Significance</a></li>
<li><a href="#centering-variables-1"><span class="toc-section-number">5.5.3</span> Centering Variables</a></li>
</ul></li>
<li><a href="#mlm-add-random-slope"><span class="toc-section-number">5.6</span> MLM: Add Random Slope</a>
<ul>
<li><a href="#fit-the-model-6"><span class="toc-section-number">5.6.1</span> Fit the Model</a></li>
<li><a href="#assess-significance-1"><span class="toc-section-number">5.6.2</span> Assess Significance</a></li>
</ul></li>
<li><a href="#mlm-add-cross-level-interaction"><span class="toc-section-number">5.7</span> MLM: Add Cross-Level Interaction</a>
<ul>
<li><a href="#fit-the-model-7"><span class="toc-section-number">5.7.1</span> Fit the Model</a></li>
<li><a href="#assess-significance-2"><span class="toc-section-number">5.7.2</span> Assess Significance</a></li>
</ul></li>
<li><a href="#final-model-1"><span class="toc-section-number">5.8</span> Final Model</a>
<ul>
<li><a href="#fit-the-model-8"><span class="toc-section-number">5.8.1</span> Fit the model</a></li>
<li><a href="#table-of-estimated-parameters"><span class="toc-section-number">5.8.2</span> Table of Estimated Parameters</a></li>
<li><a href="#visualization-estimated-marginal-means-plot"><span class="toc-section-number">5.8.3</span> Visualization: Estimated Marginal Means Plot</a></li>
</ul></li>
<li><a href="#interpretation-6"><span class="toc-section-number">5.9</span> Interpretation</a>
<ul>
<li><a href="#strength"><span class="toc-section-number">5.9.1</span> Strength</a></li>
<li><a href="#weakness"><span class="toc-section-number">5.9.2</span> Weakness</a></li>
</ul></li>
<li><a href="#reproduction-of-table-2.5"><span class="toc-section-number">5.10</span> Reproduction of Table 2.5</a></li>
</ul></li>
<li><a href="#mlm-centeringscaling-reading-achievement-2-levels-only"><span class="toc-section-number">6</span> MLM, Centering/Scaling: Reading Achievement (2-levels only)</a>
<ul>
<li><a href="#background-2"><span class="toc-section-number">6.1</span> Background</a>
<ul>
<li><a href="#sample-structure"><span class="toc-section-number">6.1.1</span> Sample Structure</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-2"><span class="toc-section-number">6.2</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summarize-descriptive-statistics-2"><span class="toc-section-number">6.2.1</span> Summarize Descriptive Statistics</a></li>
<li><a href="#visualization-of-raw-data"><span class="toc-section-number">6.2.2</span> Visualization of Raw Data</a></li>
</ul></li>
<li><a href="#single-level-regression"><span class="toc-section-number">6.3</span> Single-Level Regression</a>
<ul>
<li><a href="#fit-nested-models-2"><span class="toc-section-number">6.3.1</span> Fit Nested Models</a></li>
<li><a href="#visualize-the-interaction"><span class="toc-section-number">6.3.2</span> Visualize the Interaction</a></li>
</ul></li>
<li><a href="#mlm---step-1-null-model-only-fixed-and-random-intercepts"><span class="toc-section-number">6.4</span> MLM - Step 1: Null Model, only fixed and random intercepts</a>
<ul>
<li><a href="#fit-the-model-9"><span class="toc-section-number">6.4.1</span> Fit the Model</a></li>
<li><a href="#estimate-the-icc-1"><span class="toc-section-number">6.4.2</span> Estimate the ICC</a></li>
</ul></li>
<li><a href="#mlm---step-2-add-lower-level-explanatory-variables-fixed-ml"><span class="toc-section-number">6.5</span> MLM - Step 2: Add Lower-level explanatory variables, fixed, ML</a>
<ul>
<li><a href="#add-pupils-vocab-score-as-a-fixed-effects-predictor"><span class="toc-section-number">6.5.1</span> Add pupil’s vocab score as a fixed effects predictor</a></li>
<li><a href="#investigate-more-level-1-predictors"><span class="toc-section-number">6.5.2</span> Investigate More Level 1 Predictors</a></li>
</ul></li>
<li><a href="#mlm---step-3-higher-level-explanatory-variables-fixed-ml"><span class="toc-section-number">6.6</span> MLM - Step 3: Higher-level explanatory variables, fixed, ML</a>
<ul>
<li><a href="#assess-significance-of-effects-2"><span class="toc-section-number">6.6.1</span> Assess Significance of Effects</a></li>
</ul></li>
<li><a href="#mlm---step-4-explanatory-variables-predict-slopes-random-reml"><span class="toc-section-number">6.7</span> MLM - Step 4: Explanatory variables predict Slopes, random, REML</a></li>
<li><a href="#mlm---step-5-cross-level-interactions-between-explanatory-variables---fixed-ml"><span class="toc-section-number">6.8</span> MLM - Step 5: Cross-Level interactions between explanatory variables - fixed, ML</a></li>
<li><a href="#centering-predictors-change-center"><span class="toc-section-number">6.9</span> Centering Predictors: Change Center</a>
<ul>
<li><a href="#use-centered-variables"><span class="toc-section-number">6.9.1</span> Use Centered Variables</a></li>
</ul></li>
<li><a href="#rescaling-predictors-change-units-or-standardize"><span class="toc-section-number">6.10</span> Rescaling Predictors: Change Units or Standardize</a>
<ul>
<li><a href="#scale-varaibles"><span class="toc-section-number">6.10.1</span> Scale Varaibles</a></li>
<li><a href="#use-scaled-variables"><span class="toc-section-number">6.10.2</span> Use Scaled Variables</a></li>
</ul></li>
<li><a href="#final-model-2"><span class="toc-section-number">6.11</span> Final Model</a>
<ul>
<li><a href="#table"><span class="toc-section-number">6.11.1</span> Table</a></li>
<li><a href="#interpretation-of-model"><span class="toc-section-number">6.11.2</span> Interpretation of model</a></li>
</ul></li>
</ul></li>
<li><a href="#mlm-centeringscaling-student-popularity"><span class="toc-section-number">7</span> MLM, Centering/Scaling: Student Popularity</a>
<ul>
<li><a href="#background-3"><span class="toc-section-number">7.1</span> Background</a></li>
<li><a href="#grand-mean-centering-and-standardizing-variables"><span class="toc-section-number">7.2</span> Grand-Mean-Centering and Standardizing Variables</a>
<ul>
<li><a href="#grand-mean-centering"><span class="toc-section-number">7.2.1</span> Grand-Mean-Centering</a></li>
<li><a href="#standardizing"><span class="toc-section-number">7.2.2</span> Standardizing</a></li>
</ul></li>
<li><a href="#ri-only-random-intercepts"><span class="toc-section-number">7.3</span> RI = ONLY Random Intercepts</a>
<ul>
<li><a href="#fit-mlm-with-all-3-versions-of-the-predictor"><span class="toc-section-number">7.3.1</span> Fit MLM with all 3 versions of the predictor</a></li>
<li><a href="#investigating-a-mlm-ri-model"><span class="toc-section-number">7.3.2</span> Investigating a MLM-RI Model</a></li>
<li><a href="#comapre-the-centered-version"><span class="toc-section-number">7.3.3</span> Comapre the Centered Version</a></li>
<li><a href="#comapre-the-standardized-version"><span class="toc-section-number">7.3.4</span> Comapre the Standardized Version</a></li>
</ul></li>
<li><a href="#rias-random-intercepts-and-slopes"><span class="toc-section-number">7.4</span> RIAS = Random Intercepts AND Slopes</a>
<ul>
<li><a href="#fit-mlm-with-all-3-versions-of-the-predictor-1"><span class="toc-section-number">7.4.1</span> Fit MLM with all 3 versions of the predictor</a></li>
<li><a href="#investigating-a-mlm-ri-model-1"><span class="toc-section-number">7.4.2</span> Investigating a MLM-RI Model</a></li>
<li><a href="#comapre-the-centered-version-1"><span class="toc-section-number">7.4.3</span> Comapre the Centered Version</a></li>
<li><a href="#comapre-the-standardized-version-1"><span class="toc-section-number">7.4.4</span> Comapre the Standardized Version</a></li>
</ul></li>
</ul></li>
<li><a href="#effect-size-variance-explained"><span class="toc-section-number">8</span> Effect Size: Variance Explained</a>
<ul>
<li><a href="#mlm-or-lmm"><span class="toc-section-number">8.1</span> MLM or LMM</a></li>
<li><a href="#glmm"><span class="toc-section-number">8.2</span> GLMM</a></li>
</ul></li>
<li><a href="#sjplot-package"><span class="toc-section-number">9</span> sjPlot Package</a>
<ul>
<li><a href="#plotting-coefficients"><span class="toc-section-number">9.1</span> Plotting Coefficients</a>
<ul>
<li><a href="#fixed-effects"><span class="toc-section-number">9.1.1</span> Fixed Effects</a></li>
<li><a href="#random-effects"><span class="toc-section-number">9.1.2</span> Random Effects</a></li>
</ul></li>
<li><a href="#plotting-marginal-effects"><span class="toc-section-number">9.2</span> Plotting Marginal Effects</a>
<ul>
<li><a href="#predicted-values"><span class="toc-section-number">9.2.1</span> Predicted Values</a></li>
<li><a href="#effect-plots"><span class="toc-section-number">9.2.2</span> Effect Plots</a></li>
<li><a href="#interaction-plots"><span class="toc-section-number">9.2.3</span> Interaction Plots</a></li>
</ul></li>
<li><a href="#model-diagnostics"><span class="toc-section-number">9.3</span> Model Diagnostics</a>
<ul>
<li><a href="#slope-of-coefficentes"><span class="toc-section-number">9.3.1</span> Slope of Coefficentes</a></li>
<li><a href="#residuals"><span class="toc-section-number">9.3.2</span> Residuals</a></li>
<li><a href="#diagnostics"><span class="toc-section-number">9.3.3</span> Diagnostics</a></li>
</ul></li>
</ul></li>
<li><a href="#mlm-longitudinal-autism"><span class="toc-section-number">10</span> MLM, Longitudinal: Autism</a>
<ul>
<li><a href="#background-4"><span class="toc-section-number">10.1</span> Background</a>
<ul>
<li><a href="#long-format"><span class="toc-section-number">10.1.1</span> Long Format</a></li>
<li><a href="#wide-format"><span class="toc-section-number">10.1.2</span> Wide Format</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-3"><span class="toc-section-number">10.2</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#demographic-summary"><span class="toc-section-number">10.2.1</span> Demographic Summary</a></li>
<li><a href="#baseline-summary"><span class="toc-section-number">10.2.2</span> Baseline Summary</a></li>
<li><a href="#missing-data-attrition"><span class="toc-section-number">10.2.3</span> Missing Data &amp; Attrition</a></li>
<li><a href="#means-across-time"><span class="toc-section-number">10.2.4</span> Means Across Time</a></li>
<li><a href="#person-profile-plots"><span class="toc-section-number">10.2.5</span> Person Profile Plots</a></li>
<li><a href="#side-by-side-boxplots"><span class="toc-section-number">10.2.6</span> Side-by-side Boxplots</a></li>
<li><a href="#means-plots"><span class="toc-section-number">10.2.7</span> Means Plots</a></li>
</ul></li>
<li><a href="#model-1-full-model-with-loaded-mean-structure"><span class="toc-section-number">10.3</span> Model 1: Full model with ‘loaded’ mean structure</a>
<ul>
<li><a href="#fit-the-model-10"><span class="toc-section-number">10.3.1</span> Fit the Model</a></li>
<li><a href="#table-of-prameter-estimates"><span class="toc-section-number">10.3.2</span> Table of Prameter Estimates</a></li>
<li><a href="#plot-of-the-estimated-marginal-means"><span class="toc-section-number">10.3.3</span> Plot of the Estimated Marginal Means</a></li>
</ul></li>
<li><a href="#model-2a-drop-random-intercepts"><span class="toc-section-number">10.4</span> Model 2A: Drop Random Intercepts</a>
<ul>
<li><a href="#fit-the-model-11"><span class="toc-section-number">10.4.1</span> Fit the Model</a></li>
<li><a href="#assess-the-signifcance"><span class="toc-section-number">10.4.2</span> Assess the Signifcance</a></li>
</ul></li>
<li><a href="#model-2b-drop-random-quadratic-slope"><span class="toc-section-number">10.5</span> Model 2B: Drop Random Quadratic Slope</a>
<ul>
<li><a href="#fit-the-model-12"><span class="toc-section-number">10.5.1</span> Fit the Model</a></li>
<li><a href="#assess-the-signifcance-1"><span class="toc-section-number">10.5.2</span> Assess the Signifcance</a></li>
</ul></li>
<li><a href="#model-3-drop-quadratic-time-fixed-effect"><span class="toc-section-number">10.6</span> Model 3: Drop Quadratic Time Fixed Effect</a>
<ul>
<li><a href="#fit-the-models"><span class="toc-section-number">10.6.1</span> Fit the Models</a></li>
<li><a href="#assess-the-signifcance-2"><span class="toc-section-number">10.6.2</span> Assess the Signifcance</a></li>
</ul></li>
<li><a href="#final-model-3"><span class="toc-section-number">10.7</span> Final Model</a>
<ul>
<li><a href="#table-of-parameter-esitmates"><span class="toc-section-number">10.7.1</span> Table of Parameter Esitmates</a></li>
<li><a href="#interpretation-of-fixed-effects"><span class="toc-section-number">10.7.2</span> Interpretation of Fixed Effects</a></li>
<li><a href="#interpretation-of-random-effects"><span class="toc-section-number">10.7.3</span> Interpretation of Random Effects</a></li>
<li><a href="#assumption-checking"><span class="toc-section-number">10.7.4</span> Assumption Checking</a></li>
<li><a href="#plot-of-the-estimated-marginal-means-1"><span class="toc-section-number">10.7.5</span> Plot of the Estimated Marginal Means</a></li>
<li><a href="#blups-vs.-fixed-effects"><span class="toc-section-number">10.7.6</span> Blups vs. Fixed Effects</a></li>
</ul></li>
</ul></li>
<li><a href="#mlm-longitudinal-hedeker-gibbons---depression"><span class="toc-section-number">11</span> MLM, Longitudinal: Hedeker &amp; Gibbons - Depression</a>
<ul>
<li><a href="#background-5"><span class="toc-section-number">11.1</span> Background</a>
<ul>
<li><a href="#long-format-1"><span class="toc-section-number">11.1.1</span> Long Format</a></li>
<li><a href="#wide-format-1"><span class="toc-section-number">11.1.2</span> Wide Format</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-4"><span class="toc-section-number">11.2</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#diagnosis-group"><span class="toc-section-number">11.2.1</span> Diagnosis Group</a></li>
<li><a href="#missing-data-attrition-1"><span class="toc-section-number">11.2.2</span> Missing Data &amp; Attrition</a></li>
<li><a href="#depression-over-time-by-group"><span class="toc-section-number">11.2.3</span> Depression Over Time, by Group</a></li>
</ul></li>
<li><a href="#patterns-in-the-outcome-over-time"><span class="toc-section-number">11.3</span> Patterns in the Outcome Over Time</a>
<ul>
<li><a href="#variance-covariance"><span class="toc-section-number">11.3.1</span> Variance-Covariance</a></li>
<li><a href="#correlation"><span class="toc-section-number">11.3.2</span> Correlation</a></li>
<li><a href="#for-each-group"><span class="toc-section-number">11.3.3</span> For Each Group</a></li>
</ul></li>
<li><a href="#mlm---null-or-emptly-models"><span class="toc-section-number">11.4</span> MLM - Null or Emptly Models</a>
<ul>
<li><a href="#fit-the-model-13"><span class="toc-section-number">11.4.1</span> Fit the model</a></li>
<li><a href="#table-of-parameter-estimates"><span class="toc-section-number">11.4.2</span> Table of Parameter Estimates</a></li>
<li><a href="#estimated-marginal-means-plot"><span class="toc-section-number">11.4.3</span> Estimated Marginal Means Plot</a></li>
<li><a href="#estimated-marginal-means-and-emperical-bayes-plots"><span class="toc-section-number">11.4.4</span> Estimated Marginal Means and Emperical Bayes Plots</a></li>
<li><a href="#intra-individual-correlation-icc"><span class="toc-section-number">11.4.5</span> Intra-individual Correlation (ICC)</a></li>
<li><a href="#compare-to-the-single-level-null-no-random-effects"><span class="toc-section-number">11.4.6</span> Compare to the Single-Level Null: No Random Effects</a></li>
</ul></li>
<li><a href="#mlm-add-random-slope-for-time-i.e.-trend"><span class="toc-section-number">11.5</span> MLM: Add Random Slope for Time (i.e. Trend)</a>
<ul>
<li><a href="#fit-the-model-14"><span class="toc-section-number">11.5.1</span> Fit the Model</a></li>
<li><a href="#table-of-prameter-estimates-1"><span class="toc-section-number">11.5.2</span> Table of Prameter Estimates</a></li>
<li><a href="#likelihood-ratio-test"><span class="toc-section-number">11.5.3</span> Likelihood Ratio Test</a></li>
<li><a href="#estimated-marginal-means-plot-1"><span class="toc-section-number">11.5.4</span> Estimated Marginal Means Plot</a></li>
<li><a href="#estimated-marginal-means-and-emperical-bayes-plots-1"><span class="toc-section-number">11.5.5</span> Estimated Marginal Means and Emperical Bayes Plots</a></li>
</ul></li>
<li><a href="#mlm-coding-of-time"><span class="toc-section-number">11.6</span> MLM: Coding of Time</a>
<ul>
<li><a href="#fit-the-model-15"><span class="toc-section-number">11.6.1</span> Fit the Model</a></li>
<li><a href="#table-of-parameter-estimates-2"><span class="toc-section-number">11.6.2</span> Table of Parameter Estimates</a></li>
<li><a href="#estimated-marginal-means-and-emperical-bayes-plots-2"><span class="toc-section-number">11.6.3</span> Estimated Marginal Means and Emperical Bayes Plots</a></li>
</ul></li>
<li><a href="#mlm-effect-of-diagnosis-on-time-trends-fixed-interaction"><span class="toc-section-number">11.7</span> MLM: Effect of DIagnosis on Time Trends (Fixed Interaction)</a>
<ul>
<li><a href="#fit-the-models-1"><span class="toc-section-number">11.7.1</span> Fit the Models</a></li>
<li><a href="#estimated-marginal-meanse-plot"><span class="toc-section-number">11.7.2</span> Estimated Marginal Meanse Plot</a></li>
<li><a href="#likelihood-ratio-test-1"><span class="toc-section-number">11.7.3</span> Likelihood Ratio Test</a></li>
</ul></li>
<li><a href="#mlm-quadratic-trend"><span class="toc-section-number">11.8</span> MLM: Quadratic Trend</a>
<ul>
<li><a href="#fit-the-model-16"><span class="toc-section-number">11.8.1</span> Fit the Model</a></li>
<li><a href="#table-of-parameter-estimates-3"><span class="toc-section-number">11.8.2</span> Table of Parameter Estimates</a></li>
<li><a href="#likelihood-ratio-test-2"><span class="toc-section-number">11.8.3</span> Likelihood Ratio Test</a></li>
<li><a href="#estimated-marginal-means-plot-2"><span class="toc-section-number">11.8.4</span> Estimated Marginal Means Plot</a></li>
<li><a href="#blups-or-emperical-bayes-estimates"><span class="toc-section-number">11.8.5</span> BLUPs or Emperical Bayes Estimates</a></li>
<li><a href="#estimated-marginal-means-and-emperical-bayes-plots-3"><span class="toc-section-number">11.8.6</span> Estimated Marginal Means and Emperical Bayes Plots</a></li>
</ul></li>
</ul></li>
<li><a href="#mlm-longitudinal-hox-ch-5---student-gpa"><span class="toc-section-number">12</span> MLM, Longitudinal: Hox ch 5 - student GPA</a>
<ul>
<li><a href="#background-6"><span class="toc-section-number">12.1</span> Background</a></li>
<li><a href="#mlm"><span class="toc-section-number">12.2</span> MLM</a>
<ul>
<li><a href="#null-models-and-icc"><span class="toc-section-number">12.2.1</span> Null Models and ICC</a></li>
<li><a href="#fixed-effects-2"><span class="toc-section-number">12.2.2</span> Fixed Effects</a></li>
<li><a href="#variance-explained-by-linear-time-at-level-one"><span class="toc-section-number">12.2.3</span> Variance Explained by linear TIME at Level ONE</a></li>
<li><a href="#variance-explained-by-linear-time-at-level-two"><span class="toc-section-number">12.2.4</span> Variance Explained by linear TIME at Level TWO</a></li>
<li><a href="#random-effects-2"><span class="toc-section-number">12.2.5</span> Random Effects</a></li>
<li><a href="#cross-level-interaction"><span class="toc-section-number">12.2.6</span> Cross-Level Interaction</a></li>
<li><a href="#visualize-the-model-3"><span class="toc-section-number">12.2.7</span> Visualize the Model</a></li>
<li><a href="#effect-sizes"><span class="toc-section-number">12.2.8</span> Effect Sizes</a></li>
<li><a href="#significance"><span class="toc-section-number">12.2.9</span> Significance</a></li>
</ul></li>
</ul></li>
<li><a href="#mlm-longitudinal-rct---exercise-and-diet"><span class="toc-section-number">13</span> MLM, Longitudinal: RCT - Exercise and Diet</a>
<ul>
<li><a href="#the-dataset"><span class="toc-section-number">13.1</span> The dataset</a></li>
<li><a href="#exploratory-data-analysis-5"><span class="toc-section-number">13.2</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#participant-summary"><span class="toc-section-number">13.2.1</span> Participant Summary</a></li>
<li><a href="#baseline-summary-1"><span class="toc-section-number">13.2.2</span> Baseline Summary</a></li>
<li><a href="#raw-trajectories---person-profile-plot"><span class="toc-section-number">13.2.3</span> Raw Trajectories - Person Profile Plot</a></li>
</ul></li>
<li><a href="#multilevel-modeling"><span class="toc-section-number">13.3</span> Multilevel Modeling</a>
<ul>
<li><a href="#null-model-1"><span class="toc-section-number">13.3.1</span> Null Model</a></li>
<li><a href="#icc-r-squared"><span class="toc-section-number">13.3.2</span> ICC &amp; R-squared</a></li>
<li><a href="#add-fixed-effects-level-specific"><span class="toc-section-number">13.3.3</span> Add fixed effects: level specific</a></li>
<li><a href="#final-model-4"><span class="toc-section-number">13.3.4</span> Final Model</a></li>
</ul></li>
</ul></li>
<li><a href="#gee-continuous-outcome-beat-the-blues"><span class="toc-section-number">14</span> GEE, Continuous Outcome: Beat the Blues</a>
<ul>
<li><a href="#prepare-and-get-to-know-the-dataset"><span class="toc-section-number">14.1</span> Prepare and get to know the dataset</a>
<ul>
<li><a href="#read-in-the-data"><span class="toc-section-number">14.1.1</span> Read in the data</a></li>
<li><a href="#tidy-up-the-dataset"><span class="toc-section-number">14.1.2</span> Tidy up the dataset</a></li>
<li><a href="#restructure-to-long-format"><span class="toc-section-number">14.1.3</span> Restructure to long format</a></li>
<li><a href="#visualize-person-profile-plots"><span class="toc-section-number">14.1.4</span> Visualize: Person-profile Plots</a></li>
<li><a href="#calculate-the-observed-correlation-structure"><span class="toc-section-number">14.1.5</span> Calculate the Observed Correlation Structure</a></li>
<li><a href="#plot-the-correlation-matrix-to-get-a-better-feel-for-the-pattern"><span class="toc-section-number">14.1.6</span> Plot the correlation matrix to get a better feel for the pattern</a></li>
</ul></li>
<li><a href="#multiple-regression-ols"><span class="toc-section-number">14.2</span> Multiple Regression (OLS)</a>
<ul>
<li><a href="#fit-the-models-2"><span class="toc-section-number">14.2.1</span> Fit the models</a></li>
<li><a href="#parameter-estimates-table"><span class="toc-section-number">14.2.2</span> Parameter Estimates Table</a></li>
<li><a href="#plot-the-model-predictions"><span class="toc-section-number">14.2.3</span> Plot the model predictions</a></li>
</ul></li>
<li><a href="#multilevel-models-mlm"><span class="toc-section-number">14.3</span> Multilevel Models (MLM)</a>
<ul>
<li><a href="#fit-the-models-3"><span class="toc-section-number">14.3.1</span> Fit the models</a></li>
<li><a href="#parameter-estimates-table-1"><span class="toc-section-number">14.3.2</span> Parameter Estimates Table</a></li>
<li><a href="#likelihood-ratio-test-3"><span class="toc-section-number">14.3.3</span> Likelihood Ratio Test</a></li>
<li><a href="#plot-the-model-predictions-1"><span class="toc-section-number">14.3.4</span> Plot the model predictions</a></li>
</ul></li>
<li><a href="#general-estimating-equations-gee"><span class="toc-section-number">14.4</span> General Estimating Equations, GEE</a>
<ul>
<li><a href="#fit-the-models---main-effects-to-determine-correlation-structure"><span class="toc-section-number">14.4.1</span> Fit the models - Main effects to determine correlation structure</a></li>
<li><a href="#parameter-estimates-table-2"><span class="toc-section-number">14.4.2</span> Parameter Estimates Table</a></li>
<li><a href="#re-fit-models"><span class="toc-section-number">14.4.3</span> Re-Fit Models</a></li>
<li><a href="#cant-use-the-likelihood-ratio-test"><span class="toc-section-number">14.4.4</span> Can’t Use the Likelihood Ratio Test</a></li>
<li><a href="#can-use-the-performance-rmse"><span class="toc-section-number">14.4.5</span> Can use the Performance (RMSE)</a></li>
<li><a href="#variaous-qic-measures-of-fit"><span class="toc-section-number">14.4.6</span> Variaous QIC Measures of Fit</a></li>
<li><a href="#plot-the-model-predictions-2"><span class="toc-section-number">14.4.7</span> Plot the model predictions</a></li>
<li><a href="#investigate-interactions-not-with-time-month"><span class="toc-section-number">14.4.8</span> Investigate interactions NOT with time (<code>month</code>)</a></li>
<li><a href="#investigate-interactions-with-time-month"><span class="toc-section-number">14.4.9</span> Investigate interactions with time (<code>month</code>)</a></li>
</ul></li>
</ul></li>
<li><a href="#gee-binary-outcome-respiratory-illness"><span class="toc-section-number">15</span> GEE, Binary Outcome: Respiratory Illness</a>
<ul>
<li><a href="#packages"><span class="toc-section-number">15.1</span> Packages</a>
<ul>
<li><a href="#cran"><span class="toc-section-number">15.1.1</span> CRAN</a></li>
<li><a href="#github"><span class="toc-section-number">15.1.2</span> GitHub</a></li>
</ul></li>
<li><a href="#prepare-and-get-to-know-the-dataset-1"><span class="toc-section-number">15.2</span> Prepare and get to know the dataset</a>
<ul>
<li><a href="#read-in-the-data-1"><span class="toc-section-number">15.2.1</span> Read in the data</a></li>
<li><a href="#wide-format-2"><span class="toc-section-number">15.2.2</span> Wide Format</a></li>
<li><a href="#long-format-2"><span class="toc-section-number">15.2.3</span> Long Format</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-6"><span class="toc-section-number">15.3</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summary-statistics"><span class="toc-section-number">15.3.1</span> Summary Statistics</a></li>
<li><a href="#visualization-1"><span class="toc-section-number">15.3.2</span> Visualization</a></li>
</ul></li>
<li><a href="#logisitc-regression-glm"><span class="toc-section-number">15.4</span> Logisitc Regression (GLM)</a></li>
<li><a href="#generalized-estimating-equations-gee"><span class="toc-section-number">15.5</span> Generalized Estimating Equations (GEE)</a>
<ul>
<li><a href="#indepdendence"><span class="toc-section-number">15.5.1</span> Indepdendence</a></li>
<li><a href="#exchangeable"><span class="toc-section-number">15.5.2</span> Exchangeable</a></li>
<li><a href="#paramgeter-estimates-table"><span class="toc-section-number">15.5.3</span> Paramgeter Estimates Table</a></li>
<li><a href="#refit-with-the-geepack-package"><span class="toc-section-number">15.5.4</span> Refit with the <code>geepack</code> package</a></li>
<li><a href="#visualize-the-model-4"><span class="toc-section-number">15.5.5</span> Visualize the Model</a></li>
</ul></li>
</ul></li>
<li><a href="#gee-count-outcome-epilepsy"><span class="toc-section-number">16</span> GEE, Count Outcome: Epilepsy</a>
<ul>
<li><a href="#packages-1"><span class="toc-section-number">16.1</span> Packages</a>
<ul>
<li><a href="#cran-1"><span class="toc-section-number">16.1.1</span> CRAN</a></li>
<li><a href="#github-1"><span class="toc-section-number">16.1.2</span> GitHub</a></li>
</ul></li>
<li><a href="#prepare-and-get-to-know-the-dataset-2"><span class="toc-section-number">16.2</span> Prepare and get to know the dataset</a>
<ul>
<li><a href="#read-in-the-data-2"><span class="toc-section-number">16.2.1</span> Read in the data</a></li>
<li><a href="#long-format-3"><span class="toc-section-number">16.2.2</span> Long Format</a></li>
<li><a href="#wide-format-3"><span class="toc-section-number">16.2.3</span> Wide Format</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-7"><span class="toc-section-number">16.3</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summarize"><span class="toc-section-number">16.3.1</span> Summarize</a></li>
<li><a href="#visualize-1"><span class="toc-section-number">16.3.2</span> Visualize</a></li>
</ul></li>
<li><a href="#poisson-regression-glm"><span class="toc-section-number">16.4</span> Poisson Regression (GLM)</a></li>
<li><a href="#generalized-estimating-equations-gee-1"><span class="toc-section-number">16.5</span> Generalized Estimating Equations (GEE)</a>
<ul>
<li><a href="#match-poisson-regresssion-glm"><span class="toc-section-number">16.5.1</span> Match Poisson Regresssion (GLM)</a></li>
<li><a href="#change-correlation-sturucture"><span class="toc-section-number">16.5.2</span> Change Correlation Sturucture</a></li>
<li><a href="#estimate-the-additional-scale-parameter"><span class="toc-section-number">16.5.3</span> Estimate the Additional Scale Parameter</a></li>
<li><a href="#compare-models"><span class="toc-section-number">16.5.4</span> Compare Models</a></li>
</ul></li>
</ul></li>
<li><a href="#gee-count-outcome-antibiotics-for-leprosy"><span class="toc-section-number">17</span> GEE, Count Outcome: Antibiotics for Leprosy</a>
<ul>
<li><a href="#packages-2"><span class="toc-section-number">17.1</span> Packages</a>
<ul>
<li><a href="#cran-2"><span class="toc-section-number">17.1.1</span> CRAN</a></li>
<li><a href="#github-2"><span class="toc-section-number">17.1.2</span> GitHub</a></li>
</ul></li>
<li><a href="#data"><span class="toc-section-number">17.2</span> Data</a>
<ul>
<li><a href="#import"><span class="toc-section-number">17.2.1</span> Import</a></li>
<li><a href="#wide-format-4"><span class="toc-section-number">17.2.2</span> Wide Format</a></li>
<li><a href="#long-format-4"><span class="toc-section-number">17.2.3</span> Long Format</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-8"><span class="toc-section-number">17.3</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summary-statistics-1"><span class="toc-section-number">17.3.1</span> Summary Statistics</a></li>
<li><a href="#visualize-2"><span class="toc-section-number">17.3.2</span> Visualize</a></li>
</ul></li>
<li><a href="#generalized-estimating-equations-gee-2"><span class="toc-section-number">17.4</span> Generalized Estimating Equations (GEE)</a>
<ul>
<li><a href="#compare-models-1"><span class="toc-section-number">17.4.1</span> Compare Models</a></li>
<li><a href="#visualize-the-final-model"><span class="toc-section-number">17.4.2</span> Visualize the Final Model</a></li>
</ul></li>
<li><a href="#follow-up-analysis"><span class="toc-section-number">17.5</span> Follow-up Analysis</a>
<ul>
<li><a href="#collapse-the-predictor"><span class="toc-section-number">17.5.1</span> Collapse the Predictor</a></li>
<li><a href="#reduce-the-model---geegee"><span class="toc-section-number">17.5.2</span> Reduce the Model - <code>gee::gee()</code></a></li>
<li><a href="#compare-parameters"><span class="toc-section-number">17.5.3</span> Compare Parameters</a></li>
<li><a href="#visualize-3"><span class="toc-section-number">17.5.4</span> Visualize</a></li>
</ul></li>
</ul></li>
<li><a href="#glmm-binary-outcome-contraception-amenorrhea"><span class="toc-section-number">18</span> GLMM, Binary Outcome: Contraception &amp; Amenorrhea</a>
<ul>
<li><a href="#packages-3"><span class="toc-section-number">18.1</span> Packages</a>
<ul>
<li><a href="#cran-3"><span class="toc-section-number">18.1.1</span> CRAN</a></li>
<li><a href="#github-3"><span class="toc-section-number">18.1.2</span> GitHub</a></li>
</ul></li>
<li><a href="#data-prep"><span class="toc-section-number">18.2</span> Data Prep</a>
<ul>
<li><a href="#import-1"><span class="toc-section-number">18.2.1</span> Import</a></li>
<li><a href="#long-format-5"><span class="toc-section-number">18.2.2</span> Long Format</a></li>
<li><a href="#wide-format-5"><span class="toc-section-number">18.2.3</span> Wide Format</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-9"><span class="toc-section-number">18.3</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summary-statistics-2"><span class="toc-section-number">18.3.1</span> Summary Statistics</a></li>
<li><a href="#visualize-4"><span class="toc-section-number">18.3.2</span> Visualize</a></li>
</ul></li>
<li><a href="#glmm---basic"><span class="toc-section-number">18.4</span> GLMM - Basic</a>
<ul>
<li><a href="#fit-models"><span class="toc-section-number">18.4.1</span> Fit Models</a></li>
<li><a href="#model-parameter-tables"><span class="toc-section-number">18.4.2</span> Model Parameter Tables</a></li>
<li><a href="#visualize-the-model-5"><span class="toc-section-number">18.4.3</span> Visualize the Model</a></li>
</ul></li>
<li><a href="#glmm---optimizers"><span class="toc-section-number">18.5</span> GLMM - Optimizers</a>
<ul>
<li><a href="#adaptive-gauss-hermite-quadrature-increase-the-number-of-quadrature-points"><span class="toc-section-number">18.5.1</span> Adaptive Gauss-Hermite Quadrature: Increase the number of quadrature points</a></li>
<li><a href="#laplace-approximation-switch-to-the-nelder_mead-optimizer"><span class="toc-section-number">18.5.2</span> Laplace Approximation: switch to the Nelder_Mead optimizer</a></li>
<li><a href="#laplace-approximation-switch-to-the-l-bfgs-b-method"><span class="toc-section-number">18.5.3</span> Laplace Approximation: Switch to the <code>L-BFGS-B</code> method</a></li>
<li><a href="#laplace-approximation-switch-to-the-nlminb-method"><span class="toc-section-number">18.5.4</span> Laplace Approximation: Switch to the <code>nlminb</code> method</a></li>
</ul></li>
<li><a href="#quadratic-time"><span class="toc-section-number">18.6</span> Quadratic Time?</a></li>
</ul></li>
<li><a href="#glmm-binary-outcome-muscatine-obesity"><span class="toc-section-number">19</span> GLMM, Binary Outcome: Muscatine Obesity</a>
<ul>
<li><a href="#packages-4"><span class="toc-section-number">19.1</span> Packages</a>
<ul>
<li><a href="#cran-4"><span class="toc-section-number">19.1.1</span> CRAN</a></li>
<li><a href="#github-4"><span class="toc-section-number">19.1.2</span> GitHub</a></li>
</ul></li>
<li><a href="#data-prep-1"><span class="toc-section-number">19.2</span> Data Prep</a>
<ul>
<li><a href="#import-2"><span class="toc-section-number">19.2.1</span> Import</a></li>
<li><a href="#restrict-to-350ids-of-children-with-complete-data-for-class-demonstration"><span class="toc-section-number">19.2.2</span> Restrict to 350ID’s of children with complete data for Class Demonstration</a></li>
<li><a href="#long-format-6"><span class="toc-section-number">19.2.3</span> Long Format</a></li>
<li><a href="#wide-format-6"><span class="toc-section-number">19.2.4</span> Wide Format</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-10"><span class="toc-section-number">19.3</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summary-statistics-3"><span class="toc-section-number">19.3.1</span> Summary Statistics</a></li>
<li><a href="#visualize-5"><span class="toc-section-number">19.3.2</span> Visualize</a></li>
</ul></li>
<li><a href="#analysis-goal"><span class="toc-section-number">19.4</span> Analysis Goal</a>
<ul>
<li><a href="#center-time-at-twelve-years-old"><span class="toc-section-number">19.4.1</span> Center time at twelve years old</a></li>
</ul></li>
<li><a href="#glm-analysis"><span class="toc-section-number">19.5</span> GLM Analysis</a>
<ul>
<li><a href="#standard-logistic-regression"><span class="toc-section-number">19.5.1</span> Standard logistic regression</a></li>
</ul></li>
<li><a href="#gee-analysis"><span class="toc-section-number">19.6</span> GEE Analysis</a>
<ul>
<li><a href="#drop-the-interaction-with-gender."><span class="toc-section-number">19.6.1</span> Drop the interaction with <code>gender</code>.</a></li>
<li><a href="#select-the-final-model."><span class="toc-section-number">19.6.2</span> Select the <strong>“final”</strong> model.</a></li>
</ul></li>
<li><a href="#glmm-analysis"><span class="toc-section-number">19.7</span> GLMM Analysis</a></li>
<li><a href="#compare-methods"><span class="toc-section-number">19.8</span> Compare Methods</a></li>
</ul></li>
<li><a href="#glmm-count-outcome-bolous"><span class="toc-section-number">20</span> GLMM, Count Outcome: Bolous</a>
<ul>
<li><a href="#packages-5"><span class="toc-section-number">20.1</span> Packages</a>
<ul>
<li><a href="#cran-5"><span class="toc-section-number">20.1.1</span> CRAN</a></li>
<li><a href="#github-5"><span class="toc-section-number">20.1.2</span> GitHub</a></li>
</ul></li>
<li><a href="#data-prep-2"><span class="toc-section-number">20.2</span> Data Prep</a>
<ul>
<li><a href="#import-3"><span class="toc-section-number">20.2.1</span> Import</a></li>
<li><a href="#long-format-7"><span class="toc-section-number">20.2.2</span> Long Format</a></li>
<li><a href="#wide-format-7"><span class="toc-section-number">20.2.3</span> Wide Format</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis-11"><span class="toc-section-number">20.3</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#summary-statistics-4"><span class="toc-section-number">20.3.1</span> Summary Statistics</a></li>
<li><a href="#visualize-6"><span class="toc-section-number">20.3.2</span> Visualize</a></li>
</ul></li>
<li><a href="#gee-analysis-1"><span class="toc-section-number">20.4</span> GEE Analysis</a>
<ul>
<li><a href="#fit-various-correlation-structures"><span class="toc-section-number">20.4.1</span> Fit Various Correlation Structures</a></li>
<li><a href="#compare-corelation-structures"><span class="toc-section-number">20.4.2</span> Compare Corelation Structures</a></li>
<li><a href="#add-interaction-terms"><span class="toc-section-number">20.4.3</span> Add Interaction Terms</a></li>
<li><a href="#visualize-best-model"><span class="toc-section-number">20.4.4</span> Visualize Best Model</a></li>
</ul></li>
<li><a href="#glmm-analysis-1"><span class="toc-section-number">20.5</span> GLMM Analysis</a>
<ul>
<li><a href="#ri-random-intercepts-only"><span class="toc-section-number">20.5.1</span> RI: Random Intercepts Only</a></li>
<li><a href="#rias-random-intercepts-and-slopes-1"><span class="toc-section-number">20.5.2</span> RIAS: Random Intercepts and Slopes</a></li>
<li><a href="#rais-add-interaction"><span class="toc-section-number">20.5.3</span> RAIS: Add Interaction</a></li>
<li><a href="#visualize-best-model-1"><span class="toc-section-number">20.5.4</span> Visualize Best Model</a></li>
</ul></li>
</ul></li>
<li><a href="#sample-size-and-power"><span class="toc-section-number">21</span> Sample Size and Power</a>
<ul>
<li><a href="#key-publications"><span class="toc-section-number">21.1</span> Key Publications</a></li>
<li><a href="#r-packages"><span class="toc-section-number">21.2</span> R packages</a>
<ul>
<li><a href="#powerlmm"><span class="toc-section-number">21.2.1</span> powerlmm</a></li>
<li><a href="#simr"><span class="toc-section-number">21.2.2</span> simr</a></li>
<li><a href="#sjstatssmpsize_lmm"><span class="toc-section-number">21.2.3</span> sjstats::smpsize_lmm()</a></li>
<li><a href="#mlpowsim"><span class="toc-section-number">21.2.4</span> MLPowSim</a></li>
</ul></li>
<li><a href="#online-interactive-interfaces"><span class="toc-section-number">21.3</span> Online Interactive Interfaces</a>
<ul>
<li><a href="#glimmpse"><span class="toc-section-number">21.3.1</span> GLIMMPSE</a></li>
<li><a href="#webpower"><span class="toc-section-number">21.3.2</span> WebPower</a></li>
</ul></li>
<li><a href="#stand-alone-computer-programs"><span class="toc-section-number">21.4</span> Stand-alone Computer Programs</a>
<ul>
<li><a href="#optimal-design"><span class="toc-section-number">21.4.1</span> Optimal Design</a></li>
<li><a href="#pint"><span class="toc-section-number">21.4.2</span> PinT</a></li>
<li><a href="#rmass2"><span class="toc-section-number">21.4.3</span> RMASS2</a></li>
<li><a href="#acluster"><span class="toc-section-number">21.4.4</span> ACluster</a></li>
</ul></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="welcome" class="section level1 unnumbered" number="">
<h1 class="unnumbered" number="">Welcome</h1>
<p>Backgroup and links to other volumes of this encyclopedia may be found at the <a href="https://cehs-research.github.io/eBooks/">Encyclopedia’s Home Website</a>.</p>
<p><img src="images/common/EQM_v5_header.png" /></p>
<div id="blocked-notes" class="section level2 unnumbered" number="">
<h2 class="unnumbered" number="">Blocked Notes</h2>
<p>Thoughout all the eBooks in this encyclopedia, several small secitons will be blocked out in the following ways:</p>
<div class="rmdconstruct">
<p>
These blocks denote an area <strong>UNDER CONSTRUCTION</strong>, so check back often. This massive undertaking started during the summer of 2018 and is far from complete. The outline of seven volumes is given above despite any one being complete. Feedback is welcome via either author’s email.
</p>
</div>
<div class="rmdimportant">
<p>
These blocks denote something <strong>EXTREMELY IMPORTANT</strong>. Do NOT skip these notes as they will be used very sparingly.
</p>
</div>
<div class="rmddownload">
<p>
These blocks denote something to <strong>DOWNLOAD</strong>. This may include software installations, example datasets, or notebook code files.
</p>
</div>
<div class="rmdlightbulb">
<p>
These blocks denote something <strong>INTERESTING</strong>. These point out information we found of interest or added value.
</p>
</div>
<div class="rmdlink">
<p>
These blocks denote <strong>LINKS</strong> to other websites. This may include instructional video clips, articles, or blog posts. We are all about NOT re-creating the wheel. If somebody else has described or illustrated a topic well, we celebrate it!
</p>
</div>
</div>
<div id="code-and-output" class="section level2 unnumbered" number="">
<h2 class="unnumbered" number="">Code and Output</h2>
<p>This is how <span class="math inline">\(R\)</span> code is shown:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span></code></pre></div>
<p>This is what the output of the <span class="math inline">\(R\)</span> code above will look:</p>
<pre><code>## [1] 2</code></pre>
</div>
<div id="the-authors" class="section level2 unnumbered" number="">
<h2 class="unnumbered" number="">The Authors</h2>
<table>
<thead>
<tr>
<th style="text-align:center;font-size: 20px;">
Dr. Sarah Schwartz
</th>
<th style="text-align:center;font-size: 20px;">
Dr. Tyson Barrett
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="images/common/Sarah_headshot.jpg" width="300" />
</td>
<td style="text-align:center;">
<img src="images/common/Tyson_headshot.jpg" width="300" />
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="http://www.sarahschwartzstats.com/">www.SarahSchwartzStats.com</a>
</td>
<td style="text-align:center;">
<a href="http://tysonbarrett.com/">www.TysonBarrett.com</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="mailto:Sarah.Schwartz@usu.edu" class="email">Sarah.Schwartz@usu.edu</a>
</td>
<td style="text-align:center;">
<a href="mailto:Tyson.Barrett@usu.edu" class="email">Tyson.Barrett@usu.edu</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://cehs.usu.edu/research/statstudio/index">Statistical Consulting Studio</a>
</td>
<td style="text-align:center;">
<a href="https://cehs.usu.edu/research/dsdu/index">Data Science and Discover Unit</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<img src="images/common/StatStudioLogo_dark_small.png" width="300" />
</td>
<td style="text-align:center;">
<img src="images/common/dsdu_logo.PNG" width="300" />
</td>
</tr>
</tbody>
</table>
<div id="why-choose-r" class="section level3 unnumbered" number="">
<h3 class="unnumbered" number="">Why choose R ?</h3>
<div class="rmdlink">
<p>
<strong>Check it out:</strong> an article from Fall 2016… <a href="https://datahowler.wordpress.com/2016/09/10/no-more-excuses-r-is-better-than-spss-for-psychology-undergrads-and-students-agree/">No more excuses: R is better than SPSS for psychology undergrads, and students agree</a>
</p>
</div>
</div>
<div id="fyi" class="section level3 unnumbered" number="">
<h3 class="unnumbered" number="">FYI</h3>
<p>This entire encyclopedia is written in <span class="math inline">\(R Markdown\)</span>, using <span class="math inline">\(R Studio\)</span> as the text editor and the <code>bookdown</code> package to turn a collection of markdown documents into a coherent whole. The book’s source code is hosted on GitHub. If you notice typos or other issues, feel free to email either of the authors.</p>
<p>This work is licensed under the <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/legalcode">Attribution-NonCommercial-NoDerivatives 4.0 International</a> License.</p>
<p><img src="images/common/Education_Logo_WHITE-02.png" width="300" /></p>
<!--chapter:end:index.Rmd-->
</div>
</div>
</div>
<div id="learning-resources" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Learning Resources</h1>
<div id="introduction" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Introduction</h2>
<div class="rmdlink">
<p>
“Multilevel Modeling for Psychologists” (chapter 11) by John B. Nezlek
</p>
<ul>
<li>
<a href="https://jbnezl.people.wm.edu/Reprints/2012-APA-Handbook-MLM.pdf">Full PDF online</a>
</li>
</ul>
</div>
<!--chapter:end:02-resources.Rmd-->
</div>
</div>
<div id="formula-warehouse" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Formula Warehouse</h1>
<div class="rmdconstruct">
<p>
This is the home for notation and formulas used thorugh this eBook. Most important equations will be located here.
</p>
</div>
<div id="data-notation" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Data Notation</h2>
<p>Sample Sizes:</p>
<ul>
<li><span class="math inline">\(n_j\)</span> = number of pupils in class <span class="math inline">\(j\)</span></li>
<li><span class="math inline">\(N\)</span> = number of classes</li>
</ul>
<p>Indicators:</p>
<ul>
<li><span class="math inline">\(i \in (1, 2, \dots, n_j)\)</span> = index for pupil number</li>
<li><span class="math inline">\(j \in (1, 2, \dots, N)\)</span> = index for class number</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Level</th>
<th>Type of Variable</th>
<th>Symbol</th>
<th>pupil <span class="math inline">\(i\)</span> in class <span class="math inline">\(j\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Outcome (Dependent)</td>
<td><span class="math inline">\(Y\)</span></td>
<td><span class="math inline">\(Y_{ij}\)</span></td>
</tr>
<tr class="even">
<td>1</td>
<td>Predictor (Independent)</td>
<td><span class="math inline">\(X_1\)</span></td>
<td><span class="math inline">\(X_{1ij}\)</span></td>
</tr>
<tr class="odd">
<td>1</td>
<td>Predictor (Independent)</td>
<td><span class="math inline">\(X_2\)</span></td>
<td><span class="math inline">\(X_{2ij}\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Predictor (Independent)</td>
<td><span class="math inline">\(Z\)</span></td>
<td><span class="math inline">\(Z_j\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="single-level-regression-analysis" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Single-level Regression Analysis</h2>
<div id="the-only-equation" class="section level3" number="2.2.1">
<h3 number="2.2.1"><span class="header-section-number">2.2.1</span> The Only Equation</h3>
<p>Since we are don’t have or are ignoring clustering, there is only one level.</p>
<div class="genericEq">
<p>
<strong>Single-Level Regression Equation</strong> <span class="math display"><span class="math display">\[
\overbrace{Y_{ij}}^{Outcome} = 
         \underbrace{\beta_{0}}_{\text{Fixed}\atop\text{intercept}}  + 
         \underbrace{\beta_{1}}_{\text{Fixed}\atop\text{slope } X_1} \overbrace{X_{1ij}}^{\text{Predictor 1}}  + 
         \underbrace{\beta_{2}}_{\text{Fixed}\atop\text{slope } X_2} \overbrace{X_{2ij}}^{\text{Predictor 2}} + 
         \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}} 
\tag{Hox 2.1}
\]</span></span>
</p>
</div>
</div>
<div id="parameters" class="section level3" number="2.2.2">
<h3 number="2.2.2"><span class="header-section-number">2.2.2</span> Parameters</h3>
<table>
<thead>
<tr class="header">
<th>Type</th>
<th align="left">Parameter of Interest</th>
<th>Estimates This</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fixed</td>
<td align="left">Intercept</td>
<td><span class="math inline">\(\beta_{0}\)</span></td>
</tr>
<tr class="even">
<td>Fixed</td>
<td align="left">Slope or main effect of <span class="math inline">\(X_1\)</span></td>
<td><span class="math inline">\(\beta_{1}\)</span></td>
</tr>
<tr class="odd">
<td>Fixed</td>
<td align="left">Slope or main effect of <span class="math inline">\(X_2\)</span></td>
<td><span class="math inline">\(\beta_{2}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Residual Variance <span class="math inline">\(var[e_{ij}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{e}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="assumptions-to-check" class="section level3" number="2.2.3">
<h3 number="2.2.3"><span class="header-section-number">2.2.3</span> Assumptions to Check</h3>
<ul>
<li>The <span class="math inline">\(e_{ij}\)</span>’s follow a normal distribution with a mean of <span class="math inline">\(0\)</span></li>
<li>The <span class="math inline">\(e_{ij}\)</span>’s have a constant variance <em>(homoscedasticity)</em></li>
</ul>
</div>
</div>
<div id="multi-level-regression-analysis" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Multi-level Regression Analysis</h2>
<p>Continue taking into account fixed slopes for two Level 1 variables, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</p>
<div id="level-1-regression-equation" class="section level3" number="2.3.1">
<h3 number="2.3.1"><span class="header-section-number">2.3.1</span> Level 1 Regression Equation*</h3>
<p><span class="math display">\[
\overbrace{Y_{ij}}^{\text{Level 1}\atop\text{Outcome}} = 
         \underbrace{\beta_{0j}}_{\text{Level 2}\atop\text{intercepts}}  + 
         \underbrace{\beta_{1j}}_{\text{Level 2}\atop\text{slopes}} 
         \overbrace{X_{1ij}}^{\text{Level 1}\atop\text{Predictor 1}}  + 
         \underbrace{\beta_{2j}}_{\text{Level 2}\atop\text{slopes}} 
         \overbrace{X_{2ij}}^{\text{Level 1}\atop\text{Predictor 2}}  + 
         \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}} 
\tag{Hox 2.1}
\]</span></p>
<p>Now we take clustering into account and include random intercepts (<span class="math inline">\(\beta_{0j}\)</span>) and slopes (<span class="math inline">\(\beta_{1j}, \beta_{2j}\)</span>), as well as including a single Level 2 variable, <span class="math inline">\(Z\)</span> that interacts with both Level 1 variables.</p>
</div>
<div id="level-2-regression-equations" class="section level3" number="2.3.2">
<h3 number="2.3.2"><span class="header-section-number">2.3.2</span> Level 2 Regression Equations</h3>
<div id="random-intercepts" class="section level4" number="2.3.2.1">
<h4 number="2.3.2.1"><span class="header-section-number">2.3.2.1</span> Random Intercepts:</h4>
<p><span class="math display">\[
\overbrace{\beta_{0j}}^{\text{Level 2}\atop\text{intercepts}} = 
     \underbrace{\gamma_{00}}_{\text{Fixed}\atop\text{intercept}}  + 
     \underbrace{\gamma_{01}}_{\text{Fixed}\atop\text{slope } Z}
     \overbrace{Z_{j}}^{\text{Level 2}\atop\text{Predictor 3}}  + 
     \underbrace{u_{0j}}_{\text{Intercept}\atop\text{residual}} 
\tag{Hox 2.3}
\]</span></p>
</div>
<div id="random-slopes" class="section level4" number="2.3.2.2">
<h4 number="2.3.2.2"><span class="header-section-number">2.3.2.2</span> Random Slopes</h4>
<ul>
<li>For the first predictor, <span class="math inline">\(X_1\)</span>:</li>
</ul>
<p><span class="math display">\[
\overbrace{\beta_{1j}}^{\text{Level 2}\atop\text{slopes}} = 
     \underbrace{\gamma_{10}}_{\text{Fixed}\atop\text{Slope  } X_1}  + 
     \underbrace{\gamma_{11}}_{\text{Fixed}\atop X_1 \times Z} 
     \overbrace{Z_{j}}^{\text{Level 2}\atop\text{Predictor 3}} + 
     \underbrace{u_{1j}}_{\text{Slope } X_1\atop\text{residual}} 
\tag{Hox 2.4a}
\]</span></p>
<ul>
<li>For the second predictor, <span class="math inline">\(X_2\)</span>:</li>
</ul>
<p><span class="math display">\[
\overbrace{\beta_{2j}}^{\text{Level 2}\atop\text{slopes}} = 
     \underbrace{\gamma_{20}}_{\text{Fixed}\atop\text{Slope  } X_2}  + 
     \underbrace{\gamma_{21}}_{\text{Fixed}\atop X_2 \times Z} 
     \overbrace{Z_{j}}^{\text{Level 2}\atop\text{Predictor 3}} + 
     \underbrace{u_{2j}}_{\text{Slope } X_2\atop\text{residual}} 
\tag{Hox 2.4a}
\]</span></p>
</div>
<div id="merging-the-equations" class="section level4" number="2.3.2.3">
<h4 number="2.3.2.3"><span class="header-section-number">2.3.2.3</span> Merging the Equations</h4>
<p>Starting with Level 1 equation (2.1) and allow the <span class="math inline">\(\beta\)</span>’s to be varry for each class and plug in the level 2 equations (2.3 and 2.4) into the level 1 equation (2.1) to make the combined equation.
<span class="math display">\[
Y_{ij} = \overbrace{(\gamma_{00} + \gamma_{01} Z_{j} + u_{0j})}^{\beta_{0j}} + 
         \overbrace{(\gamma_{10} + \gamma_{11} Z_{j} + u_{1j})}^{\beta_{1j}} X_{1ij} + 
         \overbrace{(\gamma_{20} + \gamma_{21} Z_{j} + u_{2j})}^{\beta_{2j}} X_{2ij} + e_{ij} 
\]</span></p>
<p>Use the distributive property of multiplication to get rid of the parentheses.
<span class="math display">\[
Y_{ij} = \overbrace{\gamma_{00}         + \gamma_{01} Z_{j}         + u_{0j}}^{\beta_{0j}} + 
         \overbrace{\gamma_{10} X_{1ij} + \gamma_{11} Z_{j} X_{1ij} + u_{1j} X_{1ij}}^{\beta_{1j} \times X_{1ij}}  +
         \overbrace{\gamma_{20} X_{2ij} + \gamma_{21} Z_{j} X_{2ij} + u_{2j} X_{2ij}}^{\beta_{2j} \times X_{2ij}}  +
         e_{ij} 
\]</span></p>
</div>
</div>
<div id="combinded-multilevel-regression-equation" class="section level3" number="2.3.3">
<h3 number="2.3.3"><span class="header-section-number">2.3.3</span> Combinded, Multilevel Regression Equation</h3>
<p>Collect ‘like-terms’ (i.e. get the <span class="math inline">\(\gamma\)</span>’s together and the <span class="math inline">\(u\)</span>’s together)</p>
<div class="genericEq">
<p>
<strong>Combinded, Multilevel Regression Equation - Generic</strong>
</p>
<p>
<span class="math display"><span class="math display">\[
Y_{ij} = \overbrace{\gamma_{00} + 
                      \gamma_{10} X_{1ij} + 
                      \gamma_{20} X_{2ij} + 
                      \gamma_{01} Z_{j} + 
                      \gamma_{11} Z_{j} X_{1ij} +  
                      \gamma_{21} Z_{j} X_{2ij}}^{\text{Fixed part}\atop\text{Deterministic}} + \\
         \underbrace{u_{0j} + u_{1j} X_{1ij} + u_{2j} X_{2ij} + e_{ij} }_{\text{Random part}\atop\text{Stochastic}}
 \tag{Hox 2.5}
\]</span></span>
</p>
</div>
</div>
<div id="parameters-1" class="section level3" number="2.3.4">
<h3 number="2.3.4"><span class="header-section-number">2.3.4</span> Parameters</h3>
<table>
<colgroup>
<col width="11%" />
<col width="65%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th align="left">Parameter of Interest</th>
<th>Estimates This</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fixed</td>
<td align="left">Intercept</td>
<td><span class="math inline">\(\gamma_{00}\)</span></td>
</tr>
<tr class="even">
<td>Fixed</td>
<td align="left">Main Effect of <span class="math inline">\(X_1\)</span></td>
<td><span class="math inline">\(\gamma_{10}\)</span></td>
</tr>
<tr class="odd">
<td>Fixed</td>
<td align="left">Main Effect of <span class="math inline">\(X_2\)</span></td>
<td><span class="math inline">\(\gamma_{20}\)</span></td>
</tr>
<tr class="even">
<td>Fixed</td>
<td align="left">Main Effect of <span class="math inline">\(Z\)</span></td>
<td><span class="math inline">\(\gamma_{01}\)</span></td>
</tr>
<tr class="odd">
<td>Fixed</td>
<td align="left">Cross-Level interaction between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Z\)</span></td>
<td><span class="math inline">\(\gamma_{11}\)</span></td>
</tr>
<tr class="even">
<td>Fixed</td>
<td align="left">Cross-Level interaction between <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Z\)</span></td>
<td><span class="math inline">\(\gamma_{21}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Variance in random intercepts, <span class="math inline">\(var[u_{0j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u0}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Variance in random slope of <span class="math inline">\(X_1\)</span>, <span class="math inline">\(var[u_{1j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u1}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Variance in random slope of <span class="math inline">\(X_2\)</span>, <span class="math inline">\(var[u_{2j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u2}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Covariance between random intercepts and random slope of <span class="math inline">\(X_1\)</span>, <span class="math inline">\(cov[u_{0j}, u_{1j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u01}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Covariance between random intercepts and random slope of <span class="math inline">\(X_2\)</span>, <span class="math inline">\(cov[u_{0j}, u_{2j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u02}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Covariance between random slopes of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, <span class="math inline">\(cov[u_{1j}, u_{2j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u12}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Residual Variance <span class="math inline">\(var[e_{ij}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{e}\)</span></td>
</tr>
</tbody>
</table>
<div class="rmdimportant">
<p>
The <span class="math inline"><span class="math inline">\(u_{1j}\)</span></span> and <span class="math inline"><span class="math inline">\(u_{2j}\)</span></span> terms allow for <strong>heteroscedasticity</strong> by fitting different error terms for different values of <span class="math inline"><span class="math inline">\(X_1\)</span></span> and <span class="math inline"><span class="math inline">\(X_2\)</span></span>. The HOV assumption is that AFTER accounting for this, the remaining residuals are HOV.
</p>
</div>
</div>
</div>
<div id="intraclass-correlation-icc" class="section level2" number="2.4">
<h2 number="2.4"><span class="header-section-number">2.4</span> Intraclass Correlation (ICC)</h2>
<div id="two-level-models" class="section level3" number="2.4.1">
<h3 number="2.4.1"><span class="header-section-number">2.4.1</span> Two Level Models</h3>
<div class="genericEq">
<p>
<strong>Combined, Multilevel Model Equation - Null Model, 2 levels</strong> <span class="math display"><span class="math display">\[ 
\overbrace{Y_{ij}}^{Outcome} = 
    \underbrace{\gamma_{00}}_{\text{Fixed}\atop\text{intercept}} + 
    \underbrace{u_{0j}}_{\text{Random}\atop\text{intercepts}} + 
    \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}}
\tag{Hox 2.8}
\]</span></span>
</p>
</div>
<p>Although the Null model above does not explain any variance in the dependent variable, since there are no independent variables, it does decompose (i.e. divide up) the variance into two pieces. We can compute the amount of total variance in the outcome that is attribute to the clustering of Level 1 untis <em>(micro-units)</em> into clusters of Level 2 units <em>(macro-units)</em> verses the total variance.</p>
<div class="genericEq">
<p>
<strong>Intraclass Correlation (ICC) Formula, 2 level model</strong> <span class="math display"><span class="math display">\[
\overbrace{\rho}^{\text{ICC}} = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random Intercept}\atop\text{Variance}}}
     {\underbrace{\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.9}
\]</span></span>
</p>
</div>
</div>
<div id="three-level-models" class="section level3" number="2.4.2">
<h3 number="2.4.2"><span class="header-section-number">2.4.2</span> Three Level Models</h3>
<p>Indicators:</p>
<ul>
<li><span class="math inline">\(i\)</span> = index for units in the lowest level (Level 1)</li>
<li><span class="math inline">\(j\)</span> = index for units in the middle level (Level 2)</li>
<li><span class="math inline">\(k\)</span> = index for units in the highest level (Level 3)</li>
</ul>
<div class="genericEq">
<p>
<strong>Combined, Multilevel Model Equation - Null Model, 3 levels</strong> <span class="math display"><span class="math display">\[ 
\overbrace{Y_{ijk}}^{Outcome} = 
    \underbrace{\gamma_{000}}_{\text{Fixed}\atop\text{intercept}} + 
    \underbrace{v_{0k }}_{\text{Random Intercepts}\atop\text{Level 3}} + 
    \underbrace{u_{0jk}}_{\text{Random Intercepts}\atop\text{Level 2}} + 
    \underbrace{e_{ijk}}_{\text{Random}\atop\text{residuals}}
\tag{Hox 2.15}
\]</span></span>
</p>
</div>
<p>If you are interested in teh decomposition of variance across all levels, use the Davis and Scott method:</p>
<div class="genericEq">
<p>
<strong>Intraclass Correlation (ICC) Formula, 3 level model - Davis and Scott Method</strong> <span class="math display"><span class="math display">\[
\overbrace{\rho_{mid}}^{\text{ICC}\atop\text{at level 2}} = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random Intercept}\atop\text{Variance Level 2}}}
     {\underbrace{\sigma^2_{v0}+\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.16}
\]</span></span> <span class="math display"><span class="math display">\[
\overbrace{\rho_{top}}^{\text{ICC}\atop\text{ at level 3}} = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random Intercept}\atop\text{Variance Level 3}}}
     {\underbrace{\sigma^2_{v0}+\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.17}
\]</span></span>
</p>
</div>
<p>If you would like to estimate the expected (population) correlation between two randomly chosen elements of the same group:</p>
<div class="genericEq">
<p>
<strong>Intraclass Correlation (ICC) Formula, 3 level model - Siddiqui Method </strong> <span class="math display"><span class="math display">\[
\overbrace{\rho_{mid}}^{\text{ICC}\atop\text{at level 2}} = 
\frac{\overbrace{\sigma^2_{v0}+\sigma^2_{u0}}^{\text{Random variance}\atop\text{at levels 2 &amp;amp; 3}}}
     {\underbrace{\sigma^2_{v0}+\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.18}
\]</span></span> <span class="math display"><span class="math display">\[
\overbrace{\rho_{top}}^{\text{ICC}\atop\text{ at level 3}} = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random variance}\atop\text{at only level 3}}}
     {\underbrace{\sigma^2_{v0}+\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.19}
\]</span></span>
</p>
</div>
</div>
</div>
<div id="proporion-of-variance-explianed" class="section level2" number="2.5">
<h2 number="2.5"><span class="header-section-number">2.5</span> Proporion of Variance Explianed</h2>
<p><strong>See pages 61-63 of <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></strong></p>
<p><a href="http://journals.sagepub.com/doi/10.1177/1094428114541701" class="uri">http://journals.sagepub.com/doi/10.1177/1094428114541701</a></p>
<p>Analogous to multiple <span class="math inline">\(R^2\)</span> - done seperately by level</p>
<ul>
<li><span class="math inline">\(BL\)</span> = Baseline model (Null)</li>
<li><span class="math inline">\(MC\)</span> = Model to Compare to</li>
</ul>
<div id="level-1-variance-explained" class="section level3" number="2.5.1">
<h3 number="2.5.1"><span class="header-section-number">2.5.1</span> Level 1 Variance Explained</h3>
<p><strong>MODELS SHOULD NOT INCLUDE ANY RANOM EFFECTS</strong>, OTHER THAN RANDOM INTERCEPTS.</p>
<p>Different approaches differ in values and meaning.</p>
<div id="snijders-and-bosker" class="section level4" number="2.5.1.1">
<h4 number="2.5.1.1"><span class="header-section-number">2.5.1.1</span> Snijders and Bosker</h4>
<ul>
<li>Explained variance is a proportion of the total variance, because in principle first-level variables can explain all variation, including the variation at the second level.</li>
<li>Correction removes the spurious increase in <span class="math inline">\(R^2\)</span> when random slopes are added to a model</li>
</ul>
<div class="genericEq">
<p>
<strong>Snijders and Bosker Formula - Level 1 </strong>
</p>
<p>
Random Intercepts Models Only, <em>address potential negative <span class="math inline"><span class="math inline">\(R^2\)</span></span> issue</em> <span class="math display"><span class="math display">\[
R^2_1 = 1 - \frac{\sigma^2_{e-MC} + \sigma^2_{u0-MC}}
                 {\sigma^2_{e-BL} + \sigma^2_{u0-BL}}
\]</span></span>
</p>
</div>
</div>
<div id="raudenbush-and-bryk" class="section level4" number="2.5.1.2">
<h4 number="2.5.1.2"><span class="header-section-number">2.5.1.2</span> Raudenbush and Bryk</h4>
<ul>
<li>Explained variance is a proportion of first-level variance only</li>
<li>A good option when the multilevel sampling process is is close to two-stage simple random sampling</li>
</ul>
<div class="genericEq">
<p>
<strong>Raudenbush and Bryk Approximate Formula - Level 1 </strong> <em>approximate</em> <span class="math display"><span class="math display">\[
approx \;R^2_1 = \frac{\sigma^2_{e-BL} - \sigma^2_{e-MC}}
             {\sigma^2_{e-BL} }
\tag{Hox 4.8}
\]</span></span>
</p>
</div>
</div>
</div>
<div id="level-2-variance-explined" class="section level3" number="2.5.2">
<h3 number="2.5.2"><span class="header-section-number">2.5.2</span> Level 2 Variance Explined</h3>
<div id="snijders-and-bosker-1" class="section level4" number="2.5.2.1">
<h4 number="2.5.2.1"><span class="header-section-number">2.5.2.1</span> Snijders and Bosker</h4>
<div class="genericEq">
<p>
<strong>Snijders and Bosker Formula Extended - Level 2 </strong> <span class="math display"><span class="math display">\[
R^2_2 = 1 - \frac{\frac{\sigma^2_{e-MC}}{B} + \sigma^2_{u0-MC}}
                 {\frac{\sigma^2_{e-BL}}{B} + \sigma^2_{u0-BL}}
\]</span></span>
</p>
<p>
<span class="math inline"><span class="math inline">\(B\)</span></span> is the average size of the Level 2 units (schools). Technically, you should use the <em>harmonic mean</em>, but unless the clusters differ greatly in size, it doesn’t make a huge difference.
</p>
</div>
</div>
<div id="raudenbush-and-bryk-1" class="section level4" number="2.5.2.2">
<h4 number="2.5.2.2"><span class="header-section-number">2.5.2.2</span> Raudenbush and Bryk</h4>
<div class="genericEq">
<p>
<strong>Raudenbush and Bryk Approximate Formula - Level 2 </strong> <span class="math display"><span class="math display">\[
approx \; R^2_s = \frac{\sigma^2_{u0-BL} - \sigma^2_{u0-MC}}
             {\sigma^2_{u0-BL} }
\tag{Hox 4.9}
\]</span></span>
</p>
</div>
</div>
</div>
</div>
<div id="using-latex-for-equation-typesetting" class="section level2" number="2.6">
<h2 number="2.6"><span class="header-section-number">2.6</span> Using <span class="math inline">\(\LaTeX\)</span> for Equation Typesetting</h2>
<div class="rmdlink">
<p>
R markdown is a user friendly, simplified language that allows for more complex formating utilizing standard <span class="math inline"><span class="math inline">\(\LaTeX\)</span></span> code. A great resource for learning how to many common tasks in <span class="math inline"><span class="math inline">\(\LaTeX\)</span></span> is the <a href="www.sharelatex.com">Sharewebsite</a>.
</p>
<p>
Specific mathematical equation documentation may be found on the <a href="https://www.sharelatex.com/learn/Mathematical_expressions">Mathematical Expressions</a> subpage.
</p>
<p>
There are also many websites that offer Point-n-click interfaces to build <span class="math inline"><span class="math inline">\(\LaTeX\)</span></span> equations, including: <a href="http://www.hostmath.com/">Host Math</a>, <a href="https://www.codecogs.com/latex/eqneditor.php">Code Cogs</a>, <a href="https://www.latex4technics.com/">LaTeX 4 Technics</a>, and <a href="http://www.sciweavers.org/free-online-latex-equation-editor">Sci-Weavers</a>
</p>
</div>
<!--chapter:end:03-notation.Rmd-->
</div>
</div>
<div id="example-articles" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Example Articles</h1>
<div id="cross-sectional-clustered-or-hierarchical" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Cross-sectional: clustered or hierarchical</h2>
<div id="non-randomized-intervention" class="section level3" number="3.1.1">
<h3 number="3.1.1"><span class="header-section-number">3.1.1</span> Non-randomized Intervention</h3>
<div class="rmdlink">
<p>
<strong>Efficacy Study of Zearn Math in a Large Urban School District</strong>
</p>
<ul>
<li>
<a href="https://jscholarship.library.jhu.edu/handle/1774.2/62395">Public link</a>
</li>
<li>
<a href="https://jscholarship.library.jhu.edu/bitstream/handle/1774.2/62395/Zearn%20Math%20Final%20Report.pdf?sequence=1&amp;isAllowed=y">USU-full text</a>
</li>
</ul>
</div>
<blockquote>
<p>Note: The schools chose where to implement the ‘treatment’ (n = 15) or not (n = 20).</p>
</blockquote>
<table>
<colgroup>
<col width="9%" />
<col width="90%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Concept</th>
<th align="left">Article Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Terms</strong></td>
<td align="left">hierarchical linear modeling (HLM)</td>
</tr>
<tr class="even">
<td align="left"><strong>Samples</strong></td>
<td align="left"><ul>
<li><p>Level 2: schools (<em>n</em> = 35)</p></li>
<li><p>Level 1: students (<em>n</em> = 8718)</p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><strong>Missing</strong></td>
<td align="left">none noted</td>
</tr>
<tr class="even">
<td align="left"><strong>Centering</strong></td>
<td align="left">none noted</td>
</tr>
<tr class="odd">
<td align="left"><strong>Components</strong></td>
<td align="left">descriptives, HLM, followup subgroup analysis (seems link only random intercepts)</td>
</tr>
<tr class="even">
<td align="left"><strong>Results</strong></td>
<td align="left">No plots, only tables presenting the main effect (treatment) and excluding covariates and variance components, effect sizes looks like the are Cohen’s d?</td>
</tr>
<tr class="odd">
<td align="left"><strong>Software</strong></td>
<td align="left"><strong>Stata</strong></td>
</tr>
</tbody>
</table>
</div>
<div id="dyadic-design" class="section level3" number="3.1.2">
<h3 number="3.1.2"><span class="header-section-number">3.1.2</span> Dyadic Design</h3>
<div class="rmdlink">
<p>
<strong>Parent couples’ participation in speech-language therapy for school-age children with autism spectrum disorder in the United States</strong>
</p>
<ul>
<li>
<a href="https://journals.sagepub.com/doi/10.1177/1362361319862113">Public link</a>
</li>
<li>
<a href="https://journals.sagepub.com/doi/pdf/10.1177/1362361319862113?casa_token=0diefubgXBUAAAAA:Fr_CdGdeSdzpo-aCr-zOrSxf59tRZa61TfiFspkjanu6ZsqHammZfVr3UPsgUvx-oe9qA3R5wKAK">USU-full text link</a>
</li>
</ul>
</div>
<table>
<colgroup>
<col width="11%" />
<col width="88%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Concept</th>
<th align="left">Article Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Terms</strong></td>
<td align="left">ICC, multilevel models</td>
</tr>
<tr class="even">
<td align="left"><strong>Samples</strong></td>
<td align="left"><ul>
<li><p>Level 2: child (<em>n</em> = 40)</p></li>
<li><p>Level 1: parent, mother and father (<em>n</em> = 80)</p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><strong>Missing</strong></td>
<td align="left">Only a small proportion of missing data, so composite variables were imputed using the expectation–maximization (EM) algorithm</td>
</tr>
<tr class="even">
<td align="left"><strong>Centering</strong></td>
<td align="left"><ul>
<li><p>Binary variables were entered <strong>uncentered</strong></p></li>
<li><p>Continuous variables were <strong>grand mean centered</strong></p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><strong>Components</strong></td>
<td align="left">Null for ICC, Random intercepts (no random slopes), residual diagnostics</td>
</tr>
<tr class="even">
<td align="left"><strong>Results</strong></td>
<td align="left">Table with 3 MLM models, discussed moderation</td>
</tr>
<tr class="odd">
<td align="left"><strong>Software</strong></td>
<td align="left"><strong>HLM</strong> (Version 7.01) using restricted maximum likelihood</td>
</tr>
</tbody>
</table>
<div class="figure">
<img src="https://journals.sagepub.com/na101/home/literatum/publisher/sage/journals/content/auta/2020/auta_24_2/1362361319862113/20200123/images/medium/10.1177_1362361319862113-table6.gif" width="550" alt="" />
<p class="caption"><img src="" /></p>
</div>
</div>
<div id="binary-outcome" class="section level3" number="3.1.3">
<h3 number="3.1.3"><span class="header-section-number">3.1.3</span> Binary Outcome</h3>
<div class="rmdlink">
<p>
<strong>County-level social factors and schizophrenia: A multilevel study of 1.9 million Chinese adults</strong>
</p>
<ul>
<li>
<a href="https://www.sciencedirect.com/science/article/pii/S0165178118305316?casa_token=IYd4CsFB7BkAAAAA:w6YBNcdqeqCrLbXiMyC-ut-IbhXud8JwJNWnDS_gHYTpl7UUa13b54R0DY0CbyAO-4cwNXZXgQ">Public link with PDF download</a>
</li>
</ul>
</div>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Concept</th>
<th align="left">Article Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Terms</strong></td>
<td align="left">multilevel logistic regression</td>
</tr>
<tr class="even">
<td align="left"><strong>Samples</strong></td>
<td align="left"><ul>
<li><p>Level 2: county (<em>n</em> = 734)</p></li>
<li><p>Level 1: person (<em>n</em> = 1,909,205)</p>
<p><em>Note: further nesting in 771,797 households, 2980 towns (streets) and 5964 communities (villages) from 31 province was not modeled</em></p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><strong>Missing</strong></td>
<td align="left"><em>-not mentioned-</em></td>
</tr>
<tr class="even">
<td align="left"><strong>Centering</strong></td>
<td align="left"><em>-not mentioned-</em></td>
</tr>
<tr class="odd">
<td align="left"><strong>Components</strong></td>
<td align="left">ICC, adjusted odds ratios from GzLMM, subgroup analysis by gender</td>
</tr>
<tr class="even">
<td align="left"><strong>Results</strong></td>
<td align="left">Tables of un-adjusted and adjusted odds ratios</td>
</tr>
<tr class="odd">
<td align="left"><strong>Software</strong></td>
<td align="left"><strong>Stata</strong> version 13.0 for Windows</td>
</tr>
</tbody>
</table>
<p><img src="images/china_gzlmm_or_table.PNG" width="588" /></p>
</div>
</div>
<div id="repeated-measures-longitudinal-change-over-time-or-conditional-no-time-component" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Repeated Measures: longitudinal (change over time) or conditional (no time component)</h2>
<div id="repeated-measures---linear-growth" class="section level3" number="3.2.1">
<h3 number="3.2.1"><span class="header-section-number">3.2.1</span> Repeated Measures - linear growth</h3>
<div class="rmdlink">
<p>
<strong>One-to-one iPad echnology in the Middle School Mathematics and Science Classrooms</strong>
</p>
<ul>
<li>
<a href="https://www.learntechlib.org/p/207269/">Public link with PDF download</a>
</li>
</ul>
</div>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Concept</th>
<th align="left">Article Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Terms</strong></td>
<td align="left">hierarchical linear modeling (HLM)</td>
</tr>
<tr class="even">
<td align="left"><strong>Samples</strong></td>
<td align="left"><ul>
<li><p>Level 2: students (<em>n</em> = 112)</p></li>
<li><p>Level 1: up to 6 observations across 2 years (<em>n</em> = 8718)</p>
<p><em>Note: further nesting among 10 teachers in 3 schools was not modeled</em></p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><strong>Time</strong></td>
<td align="left"><p><strong>Unclear</strong>, but assume time is treated as 6 equally spaced intervals</p>
<p><em>(t = numeric: 0, 1, 2, 3, 4, 5)</em></p></td>
</tr>
<tr class="even">
<td align="left"><strong>Missing</strong></td>
<td align="left">Students were not eliminated if they did not have six scores since HLM allows for missing data at the first level (i.e. complete case analysis)</td>
</tr>
<tr class="odd">
<td align="left"><strong>Centering</strong></td>
<td align="left">grand mean centering for the MAP test scores</td>
</tr>
<tr class="even">
<td align="left"><strong>Components</strong></td>
<td align="left">Single-level OLS, Null model HLM, RIAS (random slope for time), add covars</td>
</tr>
<tr class="odd">
<td align="left"><strong>Results</strong></td>
<td align="left">Table showing design, nested equations, several ‘final’ model tables of results</td>
</tr>
<tr class="even">
<td align="left"><strong>Software</strong></td>
<td align="left">SPSS</td>
</tr>
</tbody>
</table>
<p><img src="images/article_table1_desgn_long.PNG" width="566" /></p>
<p><img src="images/article_table4_desgn_long.PNG" width="552" /></p>
</div>
<div id="cohort-sequential-or-accelerated-longitudinal-design" class="section level3" number="3.2.2">
<h3 number="3.2.2"><span class="header-section-number">3.2.2</span> Cohort sequential or accelerated longitudinal design</h3>
<div class="rmdlink">
<p>
<strong>Examining the Links Between Received Network Support and Marital Quality Among Mothers of Children with ASD: A Longitudinal Mediation Analysis</strong>
</p>
<ul>
<li>
<a href="https://link.springer.com/article/10.1007/s10803-019-04330-4">Public link</a>
</li>
<li>
<a href="https://link.springer.com/article/10.1007/s10803-019-04330-4">USU-full text link</a>
</li>
<li>
<a href="https://link.springer.com/content/pdf/10.1007/s10803-019-04330-4.pdf">PDF download</a>
</li>
</ul>
</div>
<table>
<colgroup>
<col width="2%" />
<col width="97%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Concept</th>
<th align="left">Article Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Terms</strong></td>
<td align="left">multilevel modeling (MLM), conditional growth model, longitudinal multiple mediation models</td>
</tr>
<tr class="even">
<td align="left"><strong>Samples</strong></td>
<td align="left"><ul>
<li><p>Level 2 = mother/child (n = 96)</p></li>
<li><p>Level 1 = time point/age (n = 3 x 96 ? )</p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><strong>Time</strong></td>
<td align="left"><p><strong>Unclear</strong>, assume time is measured in years at study years 5, 7, and 9</p>
<p><em>(t = numeric age at each observation)</em></p></td>
</tr>
<tr class="even">
<td align="left"><strong>Missing</strong></td>
<td align="left">Assumed data was missing at random, so complete-case analysis</td>
</tr>
<tr class="odd">
<td align="left"><strong>Centering</strong></td>
<td align="left">Time-varying predictors and mediators were <strong>disaggregated</strong> into their constituent within and between-person effects. To assess within-person effects, Level 1 predictors were created by <strong>person-mean centering</strong> each predictor or mediator (i.e., subtracting each mother’s cross-time mean score on a predictor from her actual score on that measure). Level 2 predictors were created by first computing a cross-time <strong>mean</strong> score on a predictor for each mother and then <strong>grand-mean centering</strong> that score. Finally, baseline child problem behavior severity was <strong>grand-mean centered</strong> with a mean of zero.</td>
</tr>
<tr class="even">
<td align="left"><strong>Components</strong></td>
<td align="left">Bivariate correlation matrix at baseline, Null for ICC, add fixed effects, mediation</td>
</tr>
<tr class="odd">
<td align="left"><strong>Results</strong></td>
<td align="left">MLM only reported in text. All tables and figures apply to the mediation</td>
</tr>
<tr class="even">
<td align="left"><strong>Software</strong></td>
<td align="left"><strong>SPSS</strong> 25.0 with <em>MLmed</em>, a macro which tests for mediation and moderated mediation in multilevel data, Restricted maximum likelihood, 95% confidence intervals (CIs) based on Monte Carlo bootstrapping estimates</td>
</tr>
</tbody>
</table>
</div>
<div id="sem-framework" class="section level3" number="3.2.3">
<h3 number="3.2.3"><span class="header-section-number">3.2.3</span> SEM Framework</h3>
<div class="rmdlink">
<p>
<strong>Disability multilevel modelling in first episodes of psychosis at 3-year follow-up</strong>
</p>
<ul>
<li>
<a href="https://www.sciencedirect.com/science/article/pii/S0920996416305886?casa_token=3gH6YZPVq50AAAAA:3i9OBbBbY5TQGX0z5UnGo6j6WXA1_4w2hlsGIQI_VDJOskJQxkvswlHgL59inQrl_qqp-NbmaQ">Public link with PDF download</a>
</li>
</ul>
</div>
<table>
<colgroup>
<col width="6%" />
<col width="93%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Concept</th>
<th align="left">Article Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Terms</strong></td>
<td align="left">multilevel modeling statistical approach to repeated measures data, growth model</td>
</tr>
<tr class="even">
<td align="left"><strong>Samples</strong></td>
<td align="left"><ul>
<li><p>Level 2: participants (<em>n</em> = 449)</p></li>
<li><p>Level 1: observations = baseline, 1 year, and 3 years later (<em>n</em> = 3 x 449 = 1347)</p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><strong>Time</strong></td>
<td align="left"><strong>Very unclear</strong>, but it does include “linear time” in the results</td>
</tr>
<tr class="even">
<td align="left"><strong>Missing</strong></td>
<td align="left">Only patients providing data for all the study variables during follow-up, and those who were assessed from the beginning of the study to the 1-year and 3-year follow-up were finally analyzed.</td>
</tr>
<tr class="odd">
<td align="left"><strong>Centering</strong></td>
<td align="left"><em>-not mentioned-</em></td>
</tr>
<tr class="even">
<td align="left"><strong>Components</strong></td>
<td align="left">group comparisons with Cohen’s d effect sizes, and decrease in Bayesian Information Criterion adjusted to sample size (SABIC) used to assess significance when comparing models, RIAS: Random intercepts and slope of time, assumption checking</td>
</tr>
<tr class="odd">
<td align="left"><strong>Results</strong></td>
<td align="left">Table comparing nested models</td>
</tr>
<tr class="even">
<td align="left"><strong>Software</strong></td>
<td align="left"><strong>Mplus 6.11</strong></td>
</tr>
</tbody>
</table>
<p><img src="images/disability_growth_mplus_table.PNG" /></p>
</div>
</div>
<div id="both-hierarchical-longitudinal" class="section level2" number="3.3">
<h2 number="3.3"><span class="header-section-number">3.3</span> Both: Hierarchical longitudinal</h2>
<table>
<colgroup>
<col width="29%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Concept</th>
<th align="left">Article Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Terms</strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><strong>Samples</strong></td>
<td align="left"><ul>
<li><p>Level 2: child (<em>n</em> = 40)</p></li>
<li><p>Level 1: parent, mother and father (<em>n</em> = 80)</p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><strong>Missing</strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><strong>Centering</strong></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><strong>Components</strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><strong>Results</strong></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><strong>Software</strong></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<!--chapter:end:04-articles.Rmd-->
</div>
</div>
<div id="mlm-2-levels-pupil-popularity" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> MLM, 2-levels: Pupil Popularity</h1>
<p><img src="images/header_hox_popular2.PNG" /></p>
<p>Download a new GitHub package</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;goodekat/redres&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">library</span>(stargazer)    <span class="co"># display nice tables: summary &amp; regression</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">library</span>(gridExtra)    <span class="co"># place ggplots together as one plot</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">library</span>(car)          <span class="co"># Companion to Applied Regression</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="kw">library</span>(nlme)         <span class="co"># non-linear mixed-effects models</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="kw">library</span>(lmerTest)     <span class="co"># Tests on lmer objects</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="kw">library</span>(performance)  <span class="co"># icc and r-squared functions **NEWER**</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="kw">library</span>(interactions) <span class="co"># interaction plots **NEWER**</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="kw">library</span>(HLMdiag)      <span class="co"># Diagnostic Tools for for MLM</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="kw">library</span>(redres)       <span class="co"># Diagnosing MLM models</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="kw">library</span>(sjstats)      <span class="co"># ICC calculations</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="kw">library</span>(optimx)       <span class="co"># Different optimizers to solve mlm&#39;s</span></span></code></pre></div>
<div id="background" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Background</h2>
<div class="rmdlink">
<p>
The text <strong>“Multilevel Analysis: Techniques and Applications, Third Edition”</strong> <span class="citation"><span class="citation">(Hox, Moerbeek, and Van de Schoot <a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></span> has a companion <a href="https://multilevel-analysis.sites.uu.nl/">website</a> which includes links to all the data files used throughout the book (housed on the <a href="https://github.com/MultiLevelAnalysis">book’s GitHub repository</a>).
</p>
</div>
<p>The following example is used through out <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>’s chapater 2.</p>
<blockquote>
<p>From <strong>Appendix E</strong>:</p>
<p>The popularity data in <strong>popular2.sav</strong> are simulated data for <strong>2000 pupils in 100 schools</strong>. The purpose is to offer a very simple example for multilevel regression analysis. The main outcome variable is the <strong>pupil popularity</strong>, a popularity rating on a scale of 1-10 derived by a sociometric procedure. Typically, a sociometric procedure asks all pupils in a class to rate all the other pupils, and then assigns the average received popularity rating to each pupil. Because of the sociometric procedure, group effects as apparent from higher level variance components are rather strong. There is a second outcome variable: <strong>pupil popularity</strong> as rated by their teacher, on a scale from 1-10. The explanatory variables are <strong>pupil gender</strong> (boy=0, girl=1), <strong>pupil extroversion</strong> (10-point scale) and <strong>teacher experience</strong> in years. The popularity data have been generated to be a ‘nice’ well-behaved data set: the sample sizes at both levels are sufficient, the residuals have a normal distribution, and the multilevel effects are strong.</p>
</blockquote>
<p><img src="images/diagram_hox_popular2.PNG" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>data_raw &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_sav</span>(<span class="st">&quot;https://github.com/MultiLevelAnalysis/Datasets-third-edition-Multilevel-book/raw/master/chapter%202/popularity/SPSS/popular2.sav&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span>haven<span class="op">::</span><span class="kw">as_factor</span>()             <span class="co"># retain the labels from SPSS --&gt; factor</span></span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(data_raw) </span></code></pre></div>
<pre><code>Rows: 2,000
Columns: 15
$ pupil     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17...
$ class     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
$ extrav    &lt;dbl&gt; 5, 7, 4, 3, 5, 4, 5, 4, 5, 5, 5, 5, 5, 5, 5, 6, 4, 4, 7, ...
$ sex       &lt;fct&gt; girl, boy, girl, girl, girl, boy, boy, boy, boy, boy, gir...
$ texp      &lt;dbl&gt; 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 2...
$ popular   &lt;dbl&gt; 6.3, 4.9, 5.3, 4.7, 6.0, 4.7, 5.9, 4.2, 5.2, 3.9, 5.7, 4....
$ popteach  &lt;dbl&gt; 6, 5, 6, 5, 6, 5, 5, 5, 5, 3, 5, 5, 5, 6, 5, 5, 2, 3, 7, ...
$ Zextrav   &lt;dbl&gt; -0.1703149, 1.4140098, -0.9624772, -1.7546396, -0.1703149...
$ Zsex      &lt;dbl&gt; 0.9888125, -1.0108084, 0.9888125, 0.9888125, 0.9888125, -...
$ Ztexp     &lt;dbl&gt; 1.48615283, 1.48615283, 1.48615283, 1.48615283, 1.4861528...
$ Zpopular  &lt;dbl&gt; 0.88501327, -0.12762911, 0.16169729, -0.27229230, 0.66801...
$ Zpopteach &lt;dbl&gt; 0.66905609, -0.04308451, 0.66905609, -0.04308451, 0.66905...
$ Cextrav   &lt;dbl&gt; -0.215, 1.785, -1.215, -2.215, -0.215, -1.215, -0.215, -1...
$ Ctexp     &lt;dbl&gt; 9.737, 9.737, 9.737, 9.737, 9.737, 9.737, 9.737, 9.737, 9...
$ Csex      &lt;dbl&gt; 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0...</code></pre>
<div id="unique-identifiers" class="section level3" number="4.1.1">
<h3 number="4.1.1"><span class="header-section-number">4.1.1</span> Unique Identifiers</h3>
<p>We will restrict ourselves to a few of the variables and create a distinct identifier variable for each student.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>data_pop &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">paste</span>(class, pupil,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                           <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># create a unique id for each student (char)</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">                  </span><span class="kw">factor</span>()) <span class="op">%&gt;%</span><span class="st">             </span><span class="co"># declare id is a factor</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, pupil<span class="op">:</span>popteach)         <span class="co"># reduce the variables included</span></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(data_pop)</span></code></pre></div>
<pre><code>Rows: 2,000
Columns: 8
$ id       &lt;fct&gt; 1_1, 1_2, 1_3, 1_4, 1_5, 1_6, 1_7, 1_8, 1_9, 1_10, 1_11, 1...
$ pupil    &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,...
$ class    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
$ extrav   &lt;dbl&gt; 5, 7, 4, 3, 5, 4, 5, 4, 5, 5, 5, 5, 5, 5, 5, 6, 4, 4, 7, 4...
$ sex      &lt;fct&gt; girl, boy, girl, girl, girl, boy, boy, boy, boy, boy, girl...
$ texp     &lt;dbl&gt; 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24...
$ popular  &lt;dbl&gt; 6.3, 4.9, 5.3, 4.7, 6.0, 4.7, 5.9, 4.2, 5.2, 3.9, 5.7, 4.8...
$ popteach &lt;dbl&gt; 6, 5, 6, 5, 6, 5, 5, 5, 5, 3, 5, 5, 5, 6, 5, 5, 2, 3, 7, 4...</code></pre>
</div>
<div id="structure-and-variables" class="section level3" number="4.1.2">
<h3 number="4.1.2"><span class="header-section-number">4.1.2</span> Structure and variables</h3>
<p>Its a good idea to visually inspect the first few lines in the datast to get a sense of how it is organized.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>data_pop <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>(<span class="dt">top =</span> <span class="dv">25</span>, <span class="dt">bottom =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:96%;">
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="11%" />
<col width="12%" />
<col width="9%" />
<col width="9%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">id</th>
<th align="center">pupil</th>
<th align="center">class</th>
<th align="center">extrav</th>
<th align="center">sex</th>
<th align="center">texp</th>
<th align="center">popular</th>
<th align="center">popteach</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1_1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">6.3</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">1_2</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">7</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">4.9</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">1_3</td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">5.3</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">1_4</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">4.7</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">1_5</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">6</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">1_6</td>
<td align="center">6</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">4.7</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">1_7</td>
<td align="center">7</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">5.9</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">1_8</td>
<td align="center">8</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">4.2</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">1_9</td>
<td align="center">9</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">5.2</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">1_10</td>
<td align="center">10</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">3.9</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">1_11</td>
<td align="center">11</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">5.7</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">1_12</td>
<td align="center">12</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">4.8</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">1_13</td>
<td align="center">13</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">1_14</td>
<td align="center">14</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">5.5</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">1_15</td>
<td align="center">15</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">6</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">1_16</td>
<td align="center">16</td>
<td align="center">1</td>
<td align="center">6</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">5.7</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">1_17</td>
<td align="center">17</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">3.2</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">1_18</td>
<td align="center">18</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">3.1</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">1_19</td>
<td align="center">19</td>
<td align="center">1</td>
<td align="center">7</td>
<td align="center">girl</td>
<td align="center">24</td>
<td align="center">6.6</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">1_20</td>
<td align="center">20</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">boy</td>
<td align="center">24</td>
<td align="center">4.8</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">2_1</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">8</td>
<td align="center">girl</td>
<td align="center">14</td>
<td align="center">6.4</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">2_2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">4</td>
<td align="center">boy</td>
<td align="center">14</td>
<td align="center">2.4</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">2_3</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">6</td>
<td align="center">boy</td>
<td align="center">14</td>
<td align="center">3.7</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">2_4</td>
<td align="center">4</td>
<td align="center">2</td>
<td align="center">5</td>
<td align="center">girl</td>
<td align="center">14</td>
<td align="center">4.4</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">2_5</td>
<td align="center">5</td>
<td align="center">2</td>
<td align="center">5</td>
<td align="center">girl</td>
<td align="center">14</td>
<td align="center">4.3</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">NA</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">NA</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
<tr class="odd">
<td align="center">100_16</td>
<td align="center">16</td>
<td align="center">100</td>
<td align="center">4</td>
<td align="center">girl</td>
<td align="center">7</td>
<td align="center">4.3</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">100_17</td>
<td align="center">17</td>
<td align="center">100</td>
<td align="center">4</td>
<td align="center">boy</td>
<td align="center">7</td>
<td align="center">2.6</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">100_18</td>
<td align="center">18</td>
<td align="center">100</td>
<td align="center">8</td>
<td align="center">girl</td>
<td align="center">7</td>
<td align="center">6.7</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">100_19</td>
<td align="center">19</td>
<td align="center">100</td>
<td align="center">5</td>
<td align="center">boy</td>
<td align="center">7</td>
<td align="center">2.9</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">100_20</td>
<td align="center">20</td>
<td align="center">100</td>
<td align="center">9</td>
<td align="center">boy</td>
<td align="center">7</td>
<td align="center">5.3</td>
<td align="center">5</td>
</tr>
</tbody>
</table>
<p>Visual inspection reveals that most of the variables are measurements at level 1 and apply to specific pupils (<code>extrav</code>, <code>sex</code>, <code>popular</code>, and <code>popteach</code>), while the teacher’s years of experiene is a level 2 variable since it applies to the entire <code>class</code>. Notice how the <code>texp</code> variable is identical for all pupils in the same class. This is call <strong>Disaggregated</strong> data.</p>
</div>
</div>
<div id="exploratory-data-analysis" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Exploratory Data Analysis</h2>
<div id="summarize-descriptive-statistics" class="section level3" number="4.2.1">
<h3 number="4.2.1"><span class="header-section-number">4.2.1</span> Summarize Descriptive Statistics</h3>
<div id="the-stargazer-package" class="section level4" number="4.2.1.1">
<h4 number="4.2.1.1"><span class="header-section-number">4.2.1.1</span> The <code>stargazer</code> package</h4>
<p>Most posters, journal articles, and reports start with a table of descriptive statistics. Since it tends to come first, this type of table is often refered to as <em>Table 1</em>. The <code>stargazer()</code> function can be used to create such a table, but only for the entire dataset <span class="citation">(Hlavac <a href="#ref-R-stargazer" role="doc-biblioref">2018</a>)</span>. I haven’t been able to find a way to get it to summarize subsamples and compare them in the standard format.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(extrav, texp, popular) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">  </span>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="dt">title  =</span> <span class="st">&quot;Descriptive statistics, aggregate over entire sample&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                       <span class="dt">header =</span> <span class="ot">FALSE</span>,</span>
<span id="cb10-6"><a href="#cb10-6"></a>                       <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Descriptive statistics, aggregate over entire sample</strong>
</caption>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
extrav
</td>
<td>
2,000
</td>
<td>
5.215
</td>
<td>
1.262
</td>
<td>
1
</td>
<td>
4
</td>
<td>
6
</td>
<td>
10
</td>
</tr>
<tr>
<td style="text-align:left">
texp
</td>
<td>
2,000
</td>
<td>
14.263
</td>
<td>
6.552
</td>
<td>
2
</td>
<td>
8
</td>
<td>
20
</td>
<td>
25
</td>
</tr>
<tr>
<td style="text-align:left">
popular
</td>
<td>
2,000
</td>
<td>
5.076
</td>
<td>
1.383
</td>
<td>
0.000
</td>
<td>
4.100
</td>
<td>
6.000
</td>
<td>
9.500
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
<div id="the-furniture-package" class="section level4" number="4.2.1.2">
<h4 number="4.2.1.2"><span class="header-section-number">4.2.1.2</span> The <code>furniture</code> package</h4>
<p>Tyson Barrett’s <strong>furniture</strong> package includes the extremely useful function <code>table1()</code> which simplifies the common task of creating a stratified, comparative table of descriptive statistics. Full documentation can be accessed by executing <code>?furniture::table1</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Knit to Website: output = &quot;html&quot; </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># Knit to PDF:     output = &quot;latex2&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># View on Screen:  output = &quot;&quot;text&quot;, or &quot;markdown&quot;, &quot;html&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Pupil&#39;s extroversion (10 pt)&quot;</span>   =<span class="st"> </span>extrav, </span>
<span id="cb11-7"><a href="#cb11-7"></a>                     <span class="st">&quot;Teacher&#39;s Experience (years)&quot;</span>  =<span class="st"> </span>texp, </span>
<span id="cb11-8"><a href="#cb11-8"></a>                     <span class="st">&quot;Popularity, Sociometric Score&quot;</span> =<span class="st"> </span>popular, </span>
<span id="cb11-9"><a href="#cb11-9"></a>                     <span class="st">&quot;Popularity, Teacher Evaluated&quot;</span> =<span class="st"> </span>popteach,</span>
<span id="cb11-10"><a href="#cb11-10"></a>                     <span class="dt">splitby    =</span> <span class="op">~</span><span class="st"> </span>sex,                                     <span class="co"># divide sample into columns by...</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>                     <span class="dt">test       =</span> <span class="ot">TRUE</span>,                                      <span class="co"># test groups different?</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>                     <span class="dt">output     =</span> <span class="st">&quot;markdown&quot;</span>,                                <span class="co"># output for lon screen/knitting</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>                     <span class="dt">caption    =</span> <span class="st">&quot;Compare genders on four main variables&quot;</span>)  <span class="co"># title</span></span></code></pre></div>
<table>
<caption>
(#tab:unnamed-chunk-42)Compare genders on four main variables
</caption>
<thead>
<tr>
<th>
</th>
<th>
boy
</th>
<th>
girl
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 989
</td>
<td>
n = 1011
</td>
<td>
</td>
</tr>
<tr>
<td>
Pupil’s extroversion (10 pt)
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
</td>
<td>
5.1 (1.2)
</td>
<td>
5.3 (1.3)
</td>
<td>
</td>
</tr>
<tr>
<td>
Teacher’s Experience (years)
</td>
<td>
</td>
<td>
</td>
<td>
0.001
</td>
</tr>
<tr>
<td>
</td>
<td>
13.8 (6.3)
</td>
<td>
14.7 (6.8)
</td>
<td>
</td>
</tr>
<tr>
<td>
Popularity, Sociometric Score
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
</td>
<td>
4.3 (1.1)
</td>
<td>
5.9 (1.1)
</td>
<td>
</td>
</tr>
<tr>
<td>
Popularity, Teacher Evaluated
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
</td>
<td>
4.3 (1.2)
</td>
<td>
5.8 (1.2)
</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="visualizations-of-raw-data" class="section level3" number="4.2.2">
<h3 number="4.2.2"><span class="header-section-number">4.2.2</span> Visualizations of Raw Data</h3>
<div id="ignore-clustering" class="section level4" number="4.2.2.1">
<h4 number="4.2.2.1"><span class="header-section-number">4.2.2.1</span> Ignore Clustering</h4>
<div id="scatterplots" class="section level5" number="4.2.2.1.1">
<h5 number="4.2.2.1.1"><span class="header-section-number">4.2.2.1.1</span> Scatterplots</h5>
<p>For a first look, its useful to plot all the data points on a single scatterplot as displayed in Figure @ref(fig:scatter). Due to ganularity in the rating scale, many points end up being plotted on top of each other (<em>overplotted</em>), so its a good idea to use <code>geom_count()</code> rather than <code>geom_point()</code> so the size of the dot can convey the number of points at that location <span class="citation">(Wickham et al. <a href="#ref-R-ggplot2" role="doc-biblioref">2020</a>)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Disaggregate: pupil (level 1) only, ignore level 2&#39;s existance</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co"># extroversion treated: continuous measure</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,                                <span class="co"># x-axis variable</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>      <span class="dt">y =</span> popular) <span class="op">+</span><span class="st">                             </span><span class="co"># y-axis variable</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="st">  </span><span class="kw">geom_count</span>() <span class="op">+</span><span class="st">                                 </span><span class="co"># POINTS w/ SIZE = COUNT</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st">                   </span><span class="co"># linear regression line</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st">                                   </span><span class="co"># white background  </span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x    =</span> <span class="st">&quot;extroversion (10 pt scale)&quot;</span>,      <span class="co"># x-axis label</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>       <span class="dt">y    =</span> <span class="st">&quot;Popularity, Sociometric Score&quot;</span>,   <span class="co"># y-axis label</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>       <span class="dt">size =</span> <span class="st">&quot;Count&quot;</span>) <span class="op">+</span><span class="st">                         </span><span class="co"># legend key&#39;s title  </span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.2</span>),                          <span class="co"># key at</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span><span class="st">    </span><span class="co"># key box </span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># x-ticks</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))   <span class="co"># y-ticks</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/scatter-1.png" alt="Disaggregate: pupil level only with extroversion treated as an continuous measure." width="576" />
<p class="caption">
(#fig:scatter)Disaggregate: pupil level only with extroversion treated as an continuous measure.
</p>
</div>
</div>
<div id="density-plots" class="section level5" number="4.2.2.1.2">
<h5 number="4.2.2.1.2"><span class="header-section-number">4.2.2.1.2</span> Density Plots</h5>
<p>When the degree of overplotting as high as it is in Figure @ref(fig:scatter), it can be useful to represent the data with density contours as seen in Figure @ref(fig:scatter2d). I’ve chosen to leave the points displayed in this redition, but color them much lighter so that they are present, but do not detract from the pattern of association.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># visualize all the data - another way</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,                                <span class="co"># x-axis variable</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>      <span class="dt">y =</span> popular) <span class="op">+</span><span class="st">                             </span><span class="co"># y-axis variable</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="st">  </span><span class="kw">geom_count</span>(<span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st">                   </span><span class="co"># POINTS w/ SIZE = COUNT</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="st">  </span><span class="kw">geom_density2d</span>() <span class="op">+</span><span class="st">                             </span><span class="co"># DENSITY CURVES </span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st">    </span><span class="co"># linear regression line</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st">                                   </span><span class="co"># white background  </span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x    =</span> <span class="st">&quot;Extroversion (10 pt scale)&quot;</span>,      <span class="co"># x-axis label</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>       <span class="dt">y    =</span> <span class="st">&quot;Popularity, Sociometric Score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y-axis label </span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">size =</span> <span class="ot">FALSE</span>)  <span class="op">+</span><span class="st">                        </span><span class="co"># don&#39;t include a legend</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># x-ticks</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))   <span class="co"># y-ticks</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/scatter2d-1.png" alt="Disaggregate: pupil level only with extroversion treated as an continuous measure." width="576" />
<p class="caption">
(#fig:scatter2d)Disaggregate: pupil level only with extroversion treated as an continuous measure.
</p>
</div>
</div>
<div id="hexagonal-heatmap-plots" class="section level5" number="4.2.2.1.3">
<h5 number="4.2.2.1.3"><span class="header-section-number">4.2.2.1.3</span> Hexagonal Heatmap Plots</h5>
<p>Divides the x-y plane into regular hexagons, counts the number of cases in each hexagon, and then (by default) maps the number of cases to the hexagon fill.</p>
<p>The argument could be made that the extroversion score should be treated as an ordinal factor instead of as a truly continuous scale since the only valid values are the whole number 1 through 10 and there is no assurance that these category assignments represent a true ratio measurement scale. However, we must keep in mind that this was an observational study, ans as such, the number of pupils assignment each level of extroversion is not equal.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># count the number of pupils in assigned each extroversion value, 1:10</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>table &lt;-<span class="st"> </span>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">  </span><span class="kw">group_by</span>(extrav) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n_distinct</span>(id),</span>
<span id="cb14-5"><a href="#cb14-5"></a>            <span class="dt">percent  =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>count <span class="op">/</span><span class="st"> </span><span class="dv">2000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Knit to Website: type = &quot;html&quot; </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># Knit to PDF:     type = &quot;latex&quot;</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># View on Screen:  type = &quot;text&quot;</span></span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a>table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="st">  </span>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="dt">summary  =</span> <span class="ot">FALSE</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>                       <span class="dt">rownames =</span> <span class="ot">FALSE</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>                       <span class="dt">header   =</span> <span class="ot">FALSE</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>                       <span class="dt">type     =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>                       <span class="dt">title    =</span> <span class="st">&quot;Distribution of extroversion in pupils&quot;</span>)</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Distribution of extroversion in pupils</strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
extrav
</td>
<td>
count
</td>
<td>
percent
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
1
</td>
<td>
3
</td>
<td>
0.15
</td>
</tr>
<tr>
<td style="text-align:left">
2
</td>
<td>
13
</td>
<td>
0.65
</td>
</tr>
<tr>
<td style="text-align:left">
3
</td>
<td>
119
</td>
<td>
5.95
</td>
</tr>
<tr>
<td style="text-align:left">
4
</td>
<td>
423
</td>
<td>
21.15
</td>
</tr>
<tr>
<td style="text-align:left">
5
</td>
<td>
688
</td>
<td>
34.4
</td>
</tr>
<tr>
<td style="text-align:left">
6
</td>
<td>
478
</td>
<td>
23.9
</td>
</tr>
<tr>
<td style="text-align:left">
7
</td>
<td>
194
</td>
<td>
9.7
</td>
</tr>
<tr>
<td style="text-align:left">
8
</td>
<td>
58
</td>
<td>
2.9
</td>
</tr>
<tr>
<td style="text-align:left">
9
</td>
<td>
18
</td>
<td>
0.9
</td>
</tr>
<tr>
<td style="text-align:left">
10
</td>
<td>
6
</td>
<td>
0.3
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
<div id="boxplots" class="section level5" number="4.2.2.1.4">
<h5 number="4.2.2.1.4"><span class="header-section-number">4.2.2.1.4</span> Boxplots</h5>
<p>Figure @ref(fig:boxes) displays the same data as Figure @ref(fig:scatter), but uses boxplots for the distribution of scores at each level of extroversion. On one extreme, the lowest extroversion score possible was a value of “one”, but only 3 pupils or 0.15% of the 2000 pupils recieved this value. On the other extreme, the middle value of “five” was applied to 688 pupils or a wopping 34.4%. The option <code>varwidth=TRUE</code> in the <code>geom_boxplot()</code> function helps reflect such unbalanced sample sizes by allowing the width of the boxes to be proportional to the square-roots of the number of observations each box represents.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Disaggregate: pupil (level 1) only, ignore level 2&#39;s existance</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co"># extroversion treated: ordinal factor</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="kw">ggplot</span>(data_pop,                        <span class="co"># dataset&#39;s name</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>       <span class="kw">aes</span>(<span class="dt">x    =</span> <span class="kw">factor</span>(extrav),       <span class="co"># x-axis values - make factor!</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>           <span class="dt">y    =</span> popular,              <span class="co"># y-axis values</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>           <span class="dt">fill =</span> <span class="kw">factor</span>(extrav))) <span class="op">+</span><span class="st">    </span><span class="co"># makes seperate boxes</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">varwidth =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st">       </span><span class="co"># draw boxplots instead of points</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st">                          </span><span class="co"># white background  </span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)  <span class="op">+</span><span class="st">               </span><span class="co"># don&#39;t include a legend</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span><span class="st">  </span><span class="co"># y-ticks</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;extroversion (10 pt scale)&quot;</span>,                    <span class="co"># x-axis label</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>       <span class="dt">y =</span> <span class="st">&quot;Popularity, Sociometric Score&quot;</span>) <span class="op">+</span><span class="st">               </span><span class="co"># y-axis label</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Spectral&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>)    <span class="co"># select color</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/boxes-1.png" alt="Disaggregate: pupil level only with extroversion treated as an ordinal factor.  The width of the boxes are proportional to the square-roots of the number of observations each box represents." width="576" />
<p class="caption">
(#fig:boxes)Disaggregate: pupil level only with extroversion treated as an ordinal factor. The width of the boxes are proportional to the square-roots of the number of observations each box represents.
</p>
</div>
</div>
</div>
</div>
<div id="consider-clustering" class="section level3" number="4.2.3">
<h3 number="4.2.3"><span class="header-section-number">4.2.3</span> Consider Clustering</h3>
<div id="scatterplots-1" class="section level4" number="4.2.3.1">
<h4 number="4.2.3.1"><span class="header-section-number">4.2.3.1</span> Scatterplots</h4>
<p>Up to this point, all investigation of this dataset has been only at the pupil level and any nesting or clustering within classes has been ignored. Plotting is a good was to start to get an idea of the class-to-class variability.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># compare the first 9 classrooms becuase all of there are too many at once</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(class <span class="op">&lt;=</span><span class="st"> </span><span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st">                  </span><span class="co"># select ONLY NINE classes</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> extrav,                         <span class="co"># x-axis values</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>             <span class="dt">y =</span> popular)) <span class="op">+</span><span class="st">                     </span><span class="co"># y-axis values</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="st">  </span><span class="kw">geom_count</span>() <span class="op">+</span><span class="st">                                 </span><span class="co"># POINTS w/ SIZE = COUNT</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st">    </span><span class="co"># linear regression line</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st">                                   </span><span class="co"># white background  </span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x    =</span> <span class="st">&quot;extroversion (10 pt scale)&quot;</span>,      <span class="co"># x-axis label</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>       <span class="dt">y    =</span> <span class="st">&quot;Popularity, Sociometric Score&quot;</span>,   <span class="co"># y-axis label</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>       <span class="dt">size =</span> <span class="st">&quot;Count&quot;</span>) <span class="op">+</span><span class="st">                         </span><span class="co"># legend key&#39;s title  </span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">size =</span> <span class="ot">FALSE</span>)  <span class="op">+</span><span class="st">                        </span><span class="co"># don&#39;t include a legend</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># x-ticks</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># y-ticks</span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>class, </span>
<span id="cb17-16"><a href="#cb17-16"></a>             <span class="dt">labeller =</span> label_both) <span class="op">+</span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="ot">NA</span>, </span>
<span id="cb17-18"><a href="#cb17-18"></a>                                        <span class="dt">fill   =</span> <span class="ot">NA</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/scatter3x3-1.png" alt="Illustration of the degree of class level variability in the association between extroversion and popularity. Each panel represents a class and each point a pupil in that class.  First nice classes shown." width="576" />
<p class="caption">
(#fig:scatter3x3)Illustration of the degree of class level variability in the association between extroversion and popularity. Each panel represents a class and each point a pupil in that class. First nice classes shown.
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># select specific classes by number for illustration purposes</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(class <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">33</span>, </span>
<span id="cb18-4"><a href="#cb18-4"></a>                             <span class="dv">35</span>, <span class="dv">51</span>, <span class="dv">64</span>, </span>
<span id="cb18-5"><a href="#cb18-5"></a>                             <span class="dv">76</span>, <span class="dv">94</span>, <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> extrav,                         <span class="co"># x-axis values</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>             <span class="dt">y =</span> popular)) <span class="op">+</span><span class="st">                     </span><span class="co"># y-axis values</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="st">  </span><span class="kw">geom_count</span>() <span class="op">+</span><span class="st">                                 </span><span class="co"># POINTS w/ SIZE = COUNT</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st">    </span><span class="co"># linear regression line</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st">                                   </span><span class="co"># white background  </span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x    =</span> <span class="st">&quot;extroversion (10 pt scale)&quot;</span>,      <span class="co"># x-axis label</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>       <span class="dt">y    =</span> <span class="st">&quot;Popularity, Sociometric Score&quot;</span>,   <span class="co"># y-axis label</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>       <span class="dt">size =</span> <span class="st">&quot;Count&quot;</span>) <span class="op">+</span><span class="st">                         </span><span class="co"># legend key&#39;s title  </span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">size =</span> <span class="ot">FALSE</span>)  <span class="op">+</span><span class="st">                        </span><span class="co"># don&#39;t include a legend</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># x-ticks</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># y-ticks</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>class)  <span class="op">+</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb18-19"><a href="#cb18-19"></a>        <span class="dt">strip.text       =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/scatter3x3b-1.png" alt="Illustration of the degree of class level variability in the association between extroversion and popularity. Each panel represents a class and each point a pupil in that class.  A set of nine classes was chosen to show a sampling of variability.  The facet labels are not shown as the identification number probably would not be advisable for a general publication." width="576" />
<p class="caption">
(#fig:scatter3x3b)Illustration of the degree of class level variability in the association between extroversion and popularity. Each panel represents a class and each point a pupil in that class. A set of nine classes was chosen to show a sampling of variability. The facet labels are not shown as the identification number probably would not be advisable for a general publication.
</p>
</div>
</div>
<div id="cluster-wise-regression" class="section level4" number="4.2.3.2">
<h4 number="4.2.3.2"><span class="header-section-number">4.2.3.2</span> Cluster-wise Regression</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># compare all 100 classrooms via linear model for each</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x     =</span> extrav,                      <span class="co"># x-axis values</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>             <span class="dt">y     =</span> popular,                     <span class="co"># y-axis values</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>             <span class="dt">group =</span> class)) <span class="op">+</span><span class="st">                    </span><span class="co"># GROUPs for LINES</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,                      <span class="co"># linear regression line</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>              <span class="dt">color  =</span> <span class="st">&quot;gray40&quot;</span>,</span>
<span id="cb19-8"><a href="#cb19-8"></a>              <span class="dt">size   =</span> <span class="fl">0.4</span>,</span>
<span id="cb19-9"><a href="#cb19-9"></a>              <span class="dt">se     =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st">                                   </span><span class="co"># white background  </span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x    =</span> <span class="st">&quot;extroversion (10 pt scale)&quot;</span>,      <span class="co"># x-axis label</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>       <span class="dt">y    =</span> <span class="st">&quot;Popularity, Sociometric Score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y-axis label</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># x-ticks</span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))   <span class="co"># y-ticks</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/classLMs-1.png" alt="Spaghetti plot of seperate, independent linear models for each of the 100 classes." width="576" />
<p class="caption">
(#fig:classLMs)Spaghetti plot of seperate, independent linear models for each of the 100 classes.
</p>
</div>
<div class="rmdlink">
<p>
A helpful resource for choosing colors to use in plots: <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf">R color cheatsheet</a>
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># compare all 100 classrooms via independent linear models</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">texp3 =</span> <span class="kw">cut</span>(texp, </span>
<span id="cb20-4"><a href="#cb20-4"></a>                            <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">30</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;&lt; 10 yrs&quot;</span>, </span>
<span id="cb20-6"><a href="#cb20-6"></a>                                    <span class="st">&quot;10 - 18 yrs&quot;</span>, </span>
<span id="cb20-7"><a href="#cb20-7"></a>                                    <span class="st">&quot;&gt; 18 yrs&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x     =</span> extrav,                     <span class="co"># x-axis values</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>             <span class="dt">y     =</span> popular,                    <span class="co"># y-axis values</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>             <span class="dt">group =</span> class)) <span class="op">+</span><span class="st">                   </span><span class="co"># GROUPs for LINES</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> sex),</span>
<span id="cb20-12"><a href="#cb20-12"></a>              <span class="dt">size   =</span> <span class="fl">0.3</span>,</span>
<span id="cb20-13"><a href="#cb20-13"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,                     <span class="co"># linear regression line</span></span>
<span id="cb20-14"><a href="#cb20-14"></a>              <span class="dt">se     =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st">                                   </span><span class="co"># white background  </span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x    =</span> <span class="st">&quot;extroversion (10 pt scale)&quot;</span>,      <span class="co"># x-axis label</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>       <span class="dt">y    =</span> <span class="st">&quot;Popularity, Sociometric Score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y-axis label</span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st">                        </span><span class="co"># don&#39;t include a legend</span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># x-ticks</span></span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># y-ticks</span></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;maroon1&quot;</span>)) <span class="op">+</span></span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="st">  </span><span class="kw">facet_grid</span>(texp3 <span class="op">~</span><span class="st"> </span>sex) </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/classLMs3x2-1.png" alt="Spaghetti plot of seperate, independent linear models for each of the 100 classes.  Seperate panels are used to untangle the 'hairball' in the previous figure.  The columns are seperated by the pupils' gender and the rows by the teacher's experince in years." width="576" />
<p class="caption">
(#fig:classLMs3x2)Spaghetti plot of seperate, independent linear models for each of the 100 classes. Seperate panels are used to untangle the ‘hairball’ in the previous figure. The columns are seperated by the pupils’ gender and the rows by the teacher’s experince in years.
</p>
</div>
</div>
</div>
</div>
<div id="single-level-regression-analysis-1" class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> Single-level Regression Analysis</h2>
<div id="null-model" class="section level3" number="4.3.1">
<h3 number="4.3.1"><span class="header-section-number">4.3.1</span> Null Model</h3>
<blockquote>
<p>In a Null, intercept-only, or Empty model, no predictors are included.</p>
</blockquote>
<div id="equations" class="section level4" number="4.3.1.1">
<h4 number="4.3.1.1"><span class="header-section-number">4.3.1.1</span> Equations</h4>
<div class="genericEq">
<p>
<strong>Single-Level Regression Equation - Null Model</strong> <span class="math display"><span class="math display">\[
\overbrace{POP_{ij}}^{Outcome} = 
         \underbrace{\beta_{0}}_{\text{Fixed}\atop\text{intercept}}  + 
         \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}} 
\]</span></span>
</p>
</div>
</div>
<div id="parameters-2" class="section level4" number="4.3.1.2">
<h4 number="4.3.1.2"><span class="header-section-number">4.3.1.2</span> Parameters</h4>
<table>
<thead>
<tr class="header">
<th>Type</th>
<th align="left">Parameter of Interest</th>
<th>Estimates This</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fixed</td>
<td align="left">Intercept</td>
<td><span class="math inline">\(\beta_{0}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Residual Variance <span class="math inline">\(var[e_{ij}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{e}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="fit-the-model" class="section level4" number="4.3.1.3">
<h4 number="4.3.1.3"><span class="header-section-number">4.3.1.3</span> Fit the Model</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>pop_lm_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(popular <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,        <span class="co">#  The 1 represents the intercept</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>               <span class="dt">data =</span> data_pop) </span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="kw">summary</span>(pop_lm_<span class="dv">0</span>)</span></code></pre></div>
<pre><code>
Call:
lm(formula = popular ~ 1, data = data_pop)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.0765 -0.9765  0.0235  0.9236  4.4235 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.07645    0.03091   164.2   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.383 on 1999 degrees of freedom</code></pre>
<p><span class="math inline">\(\hat{\beta_0}\)</span> = 5.08 is the grand mean</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>pop_glm_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(popular <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,        <span class="co">#  The 1 represents the intercept</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>               <span class="dt">data =</span> data_pop) </span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="kw">summary</span>(pop_glm_<span class="dv">0</span>)</span></code></pre></div>
<pre><code>
Call:
glm(formula = popular ~ 1, data = data_pop)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.0764  -0.9764   0.0236   0.9236   4.4236  

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.07645    0.03091   164.2   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 1.911366)

    Null deviance: 3820.8  on 1999  degrees of freedom
Residual deviance: 3820.8  on 1999  degrees of freedom
AIC: 6974.4

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div id="model-fit" class="section level4" number="4.3.1.4">
<h4 number="4.3.1.4"><span class="header-section-number">4.3.1.4</span> Model Fit</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>performance<span class="op">::</span><span class="kw">performance</span>(pop_lm_<span class="dv">0</span>)</span></code></pre></div>
<pre><code># Indices of model performance

    AIC |     BIC | R2 | R2_adjusted | RMSE
-------------------------------------------
6974.39 | 6985.59 |  0 |           0 | 1.38</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>performance<span class="op">::</span><span class="kw">performance</span>(pop_glm_<span class="dv">0</span>)</span></code></pre></div>
<pre><code># Indices of model performance

    AIC |     BIC | R2_Nagelkerke | RMSE
----------------------------------------
6974.39 | 6985.59 |             0 | 1.38</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(pop_lm_<span class="dv">0</span>, pop_glm_<span class="dv">0</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model     | Type |     AIC |     BIC | RMSE | R2 | R2_adjusted | R2_Nagelkerke | BF
-----------------------------------------------------------------------------------
pop_lm_0  |   lm | 6974.39 | 6985.59 | 1.38 |  0 |           0 |               |   
pop_glm_0 |  glm | 6974.39 | 6985.59 | 1.38 |    |             |             0 |  1</code></pre>
<p>Residual variance:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">sigma</span>(pop_lm_<span class="dv">0</span>)    <span class="co"># standard deviation of the residuals</span></span></code></pre></div>
<pre><code>[1] 1.382522</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">sigma</span>(pop_lm_<span class="dv">0</span>)<span class="op">^</span><span class="dv">2</span>  <span class="co"># variance of the residuals</span></span></code></pre></div>
<pre><code>[1] 1.911366</code></pre>
<p><span class="math inline">\(\hat{\sigma_e^2}\)</span> = 1.9114 is residual variance (<code>RMSE</code> is sigma = 1.3825)</p>
<p>Variance Explained:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">summary</span>(pop_lm_<span class="dv">0</span>)<span class="op">$</span>r.squared</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<p><span class="math inline">\(R^2\)</span> = 0 is the proportion of variance in popularity that is explained by the grand mean alone.</p>
<p>Deviance:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="dv">-2</span> <span class="op">*</span><span class="st"> </span><span class="kw">logLik</span>(pop_lm_<span class="dv">0</span>)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 6970.39 (df=2)</code></pre>
</div>
<div id="interpretation" class="section level4" number="4.3.1.5">
<h4 number="4.3.1.5"><span class="header-section-number">4.3.1.5</span> Interpretation</h4>
<p>The grand average popularity of all pupils in all the classes is 5.08, and there is strong evidence that it is statistically significantly different than zero, <span class="math inline">\(p&lt;.0001\)</span>. The mean alone accounts for none of the variance in popularity. The residual variance is the same as the total variance in popularity, 1.9114.</p>
<p>Just to make sure…</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">mean</span>(data_pop<span class="op">$</span>popular)</span></code></pre></div>
<pre><code>[1] 5.07645</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">var</span>(data_pop<span class="op">$</span>popular)</span></code></pre></div>
<pre><code>[1] 1.911366</code></pre>
</div>
</div>
<div id="add-predictors-to-the-model" class="section level3" number="4.3.2">
<h3 number="4.3.2"><span class="header-section-number">4.3.2</span> Add Predictors to the Model</h3>
<div id="equations-1" class="section level4" number="4.3.2.1">
<h4 number="4.3.2.1"><span class="header-section-number">4.3.2.1</span> Equations</h4>
<blockquote>
<p>LEVEL 1: Student-specific predictors:</p>
<ul>
<li><span class="math inline">\(X_1 = GEN\)</span>, pupils’s gender <em>(girl vs. boy)</em></li>
<li><span class="math inline">\(X_2 = EXT\)</span>, pupil’s extroversion <em>(scale: 1-10)</em></li>
</ul>
</blockquote>
<div class="genericEq">
<p>
<strong>Single-Level Regression Equation</strong> <span class="math display"><span class="math display">\[
\overbrace{POP_{ij}}^{Outcome} = 
         \underbrace{\beta_{0}}_{\text{Fixed}\atop\text{intercept}}  + 
         \underbrace{\beta_{1}}_{\text{Fixed}\atop\text{slope}} \overbrace{GEN_{ij}}^{\text{Predictor 1}}  + 
         \underbrace{\beta_{2}}_{\text{Fixed}\atop\text{slope}} \overbrace{EXT_{ij}}^{\text{Predictor 2}} + 
         \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}} 
\tag{Hox 2.1}
\]</span></span>
</p>
</div>
</div>
<div id="parameters-3" class="section level4" number="4.3.2.2">
<h4 number="4.3.2.2"><span class="header-section-number">4.3.2.2</span> Parameters</h4>
<table>
<thead>
<tr class="header">
<th>Type</th>
<th align="left">Parameter of Interest</th>
<th>Estimates This</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fixed</td>
<td align="left">Intercept</td>
<td><span class="math inline">\(\beta_{0}\)</span></td>
</tr>
<tr class="even">
<td>Fixed</td>
<td align="left">Slope or effect of <code>sex</code></td>
<td><span class="math inline">\(\beta_{1}\)</span></td>
</tr>
<tr class="odd">
<td>Fixed</td>
<td align="left">Slope or effect of <code>extrav</code></td>
<td><span class="math inline">\(\beta_{2}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Residual Variance <span class="math inline">\(var[e_{ij}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{e}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="fit-the-model-1" class="section level4" number="4.3.2.3">
<h4 number="4.3.2.3"><span class="header-section-number">4.3.2.3</span> Fit the Model</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>pop_lm_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav,    <span class="co"># implies: 1 + sex + extrav</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>               <span class="dt">data =</span> data_pop) </span>
<span id="cb43-3"><a href="#cb43-3"></a></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="kw">summary</span>(pop_lm_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>
Call:
lm(formula = popular ~ sex + extrav, data = data_pop)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.2527 -0.6652 -0.0454  0.7422  3.0473 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.78954    0.10355   26.94   &lt;2e-16 ***
sexgirl      1.50508    0.04836   31.12   &lt;2e-16 ***
extrav       0.29263    0.01916   15.28   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.077 on 1997 degrees of freedom
Multiple R-squared:  0.3938,    Adjusted R-squared:  0.3932 
F-statistic: 648.6 on 2 and 1997 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>pop_glm_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav,    <span class="co"># implies: 1 + sex + extrav</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>               <span class="dt">data =</span> data_pop) </span>
<span id="cb45-3"><a href="#cb45-3"></a></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="kw">summary</span>(pop_glm_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>
Call:
glm(formula = popular ~ sex + extrav, data = data_pop)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2527  -0.6652  -0.0454   0.7422   3.0473  

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.78954    0.10355   26.94   &lt;2e-16 ***
sexgirl      1.50508    0.04836   31.12   &lt;2e-16 ***
extrav       0.29263    0.01916   15.28   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 1.159898)

    Null deviance: 3820.8  on 1999  degrees of freedom
Residual deviance: 2316.3  on 1997  degrees of freedom
AIC: 5977.4

Number of Fisher Scoring iterations: 2</code></pre>
<p><span class="math inline">\(\hat{\beta_0}\)</span> = 2.79 is the extrapolated mean for boys with an extroversion score of 0.<br />
<span class="math inline">\(\hat{\beta_1}\)</span> = 1.51 is the mean difference between girls and boys with the same extroversion score.</p>
<p><span class="math inline">\(\hat{\beta_2}\)</span> = 0.29 is the mean difference for pupils of the same gender that differ in extroversion by one point.</p>
</div>
<div id="model-fit-1" class="section level4" number="4.3.2.4">
<h4 number="4.3.2.4"><span class="header-section-number">4.3.2.4</span> Model Fit</h4>
<p>Residual variance:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">sigma</span>(pop_lm_<span class="dv">1</span>)    <span class="co"># standard deviation of the residuals</span></span></code></pre></div>
<pre><code>[1] 1.076985</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">sigma</span>(pop_lm_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>  <span class="co"># variance of the residuals</span></span></code></pre></div>
<pre><code>[1] 1.159898</code></pre>
<p><span class="math inline">\(\hat{\sigma_e^2}\)</span> = 1.1599 is residual variance (<code>RMSE</code> is sigma)</p>
<p>Variance Explained:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">summary</span>(pop_lm_<span class="dv">1</span>)<span class="op">$</span>r.squared</span></code></pre></div>
<pre><code>[1] 0.393765</code></pre>
<p>Deviance:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="dv">-2</span> <span class="op">*</span><span class="st"> </span><span class="kw">logLik</span>(pop_lm_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 5969.415 (df=4)</code></pre>
<p><span class="math inline">\(R^2\)</span> = 0.394 is the proportion of variance in popularity that is explained by tha pupils gender and extroversion score.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>performance<span class="op">::</span><span class="kw">performance</span>(pop_lm_<span class="dv">1</span>)</span></code></pre></div>
<pre><code># Indices of model performance

    AIC |     BIC |   R2 | R2_adjusted | RMSE
---------------------------------------------
5977.41 | 5999.82 | 0.39 |        0.39 | 1.08</code></pre>
<blockquote>
<p>Note": <code>BF</code> = the Bayes factor</p>
</blockquote>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(pop_lm_<span class="dv">0</span>, </span>
<span id="cb57-2"><a href="#cb57-2"></a>                                 pop_lm_<span class="dv">1</span>, </span>
<span id="cb57-3"><a href="#cb57-3"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model    | Type |     AIC |     BIC |   R2 | R2_adjusted | RMSE |        BF | Performance_Score
-----------------------------------------------------------------------------------------------
pop_lm_1 |   lm | 5977.41 | 5999.82 | 0.39 |        0.39 | 1.08 | 1.14e+214 |           100.00%
pop_lm_0 |   lm | 6974.39 | 6985.59 | 0.00 |        0.00 | 1.38 |      1.00 |             0.00%

Model pop_lm_1 (of class lm) performed best with an overall performance score of 100.00%.</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(pop_glm_<span class="dv">0</span>, </span>
<span id="cb59-2"><a href="#cb59-2"></a>                                 pop_glm_<span class="dv">1</span>, </span>
<span id="cb59-3"><a href="#cb59-3"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model     | Type |     AIC |     BIC | R2_Nagelkerke | RMSE |        BF | Performance_Score
-------------------------------------------------------------------------------------------
pop_glm_1 |  glm | 5977.41 | 5999.82 |          0.62 | 1.08 | 1.14e+214 |           100.00%
pop_glm_0 |  glm | 6974.39 | 6985.59 |          0.00 | 1.38 |      1.00 |             0.00%

Model pop_glm_1 (of class glm) performed best with an overall performance score of 100.00%.</code></pre>
</div>
<div id="interpretation-1" class="section level4" number="4.3.2.5">
<h4 number="4.3.2.5"><span class="header-section-number">4.3.2.5</span> Interpretation</h4>
<p>On average, girls were rated 1.51 points more popular than boys with the same extroversion score, <span class="math inline">\(p&lt;.0001\)</span>. One point higher extroversion scores were associated with 0.29 points higher popularity, within each gender, <span class="math inline">\(p&lt;.0001\)</span>. Together, these two factors account for 39.38% of the variance in populartiy.</p>
</div>
</div>
<div id="compare-fixed-effects" class="section level3" number="4.3.3">
<h3 number="4.3.3"><span class="header-section-number">4.3.3</span> Compare Fixed Effects</h3>
<div id="compare-nested-models" class="section level4" number="4.3.3.1">
<h4 number="4.3.3.1"><span class="header-section-number">4.3.3.1</span> Compare Nested Models</h4>
<p>Create a table to compare the two nested models:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_glm_<span class="dv">0</span>, </span>
<span id="cb61-2"><a href="#cb61-2"></a>                     pop_glm_<span class="dv">1</span>),</span>
<span id="cb61-3"><a href="#cb61-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Null Model&quot;</span>,</span>
<span id="cb61-4"><a href="#cb61-4"></a>                                       <span class="st">&quot;With Predictors&quot;</span>),</span>
<span id="cb61-5"><a href="#cb61-5"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Single Level Models: ML with the `glm()` function&quot;</span>,</span>
<span id="cb61-6"><a href="#cb61-6"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb61-7"><a href="#cb61-7"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>,</span>
<span id="cb61-8"><a href="#cb61-8"></a>                <span class="dt">bold =</span> <span class="ot">TRUE</span>,</span>
<span id="cb61-9"><a href="#cb61-9"></a>                <span class="dt">label =</span> <span class="st">&quot;wow&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Single Level Models: ML with the <code>glm()</code> function
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Null Model
</th>
<th style="padding-left: 5px;padding-right: 5px;">
With Predictors
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>5.08</b> (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>2.79</b> (0.10)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>1.51</b> (0.05)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.29</b> (0.02)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6974.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5977.42
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6985.59
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5999.82
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3485.20
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2984.71
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Deviance
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3820.82
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2316.32
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_glm_<span class="dv">0</span>, </span>
<span id="cb62-2"><a href="#cb62-2"></a>                     pop_glm_<span class="dv">1</span>),</span>
<span id="cb62-3"><a href="#cb62-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Null Model&quot;</span>,</span>
<span id="cb62-4"><a href="#cb62-4"></a>                                       <span class="st">&quot;With Predictors&quot;</span>),</span>
<span id="cb62-5"><a href="#cb62-5"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Single Level Models: ML with the `glm()` function&quot;</span>,</span>
<span id="cb62-6"><a href="#cb62-6"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb62-7"><a href="#cb62-7"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Single Level Models: ML with the <code>glm()</code> function
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Null Model
</th>
<th style="padding-left: 5px;padding-right: 5px;">
With Predictors
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.08 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.79 (0.10)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.51 (0.05)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.29 (0.02)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6974.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5977.42
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6985.59
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5999.82
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3485.20
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2984.71
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Deviance
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3820.82
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2316.32
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="rmdlightbulb">
<p>
When comparing the fit of two single-level models fit via the <code>lm()</code> function, the <code>anova()</code> function runs an F-test where the test statistic is the difference in RSS.
</p>
</div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">anova</span>(pop_lm_<span class="dv">0</span>, pop_lm_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: popular ~ 1
Model 2: popular ~ sex + extrav
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1   1999 3820.8                                  
2   1997 2316.3  2    1504.5 648.55 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">anova</span>(pop_glm_<span class="dv">0</span>, pop_glm_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table

Model 1: popular ~ 1
Model 2: popular ~ sex + extrav
  Resid. Df Resid. Dev Df Deviance
1      1999     3820.8            
2      1997     2316.3  2   1504.5</code></pre>
<p>Obviously the model with predictors fits better than the model with no predictors.</p>
</div>
<div id="terminology" class="section level4" number="4.3.3.2">
<h4 number="4.3.3.2"><span class="header-section-number">4.3.3.2</span> Terminology</h4>
<p>The following terminology applies to single-level models fit with ordinary least-squared estimation (the <code>lm()</code> function in <span class="math inline">\(R\)</span>). Values are calculated below for the NULL model.</p>
<ul>
<li><strong>Mean squared error (MSE)</strong> is the MEAN of the square of the residuals:</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>mse &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">residuals</span>(pop_lm_<span class="dv">0</span>)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb67-2"><a href="#cb67-2"></a>mse</span></code></pre></div>
<pre><code>[1] 1.91041</code></pre>
<ul>
<li><strong>Root mean squared error (RMSE)</strong> which is the SQUARE ROOT of MSE:</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>rmse &lt;-<span class="st"> </span><span class="kw">sqrt</span>(mse)</span>
<span id="cb69-2"><a href="#cb69-2"></a>rmse</span></code></pre></div>
<pre><code>[1] 1.382176</code></pre>
<ul>
<li><strong>Residual sum of squares (RSS)</strong> is the SUM of the squared residuals:</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>rss &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">residuals</span>(pop_lm_<span class="dv">0</span>)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a>rss</span></code></pre></div>
<pre><code>[1] 3820.821</code></pre>
<ul>
<li><strong>Residual standard error (RSE)</strong> is the SQUARE ROOT of (RSS / degrees of freedom):</li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>rse &lt;-<span class="st"> </span><span class="kw">sqrt</span>( <span class="kw">sum</span>(<span class="kw">residuals</span>(pop_lm_<span class="dv">0</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>pop_lm_<span class="dv">0</span><span class="op">$</span>df.residual ) </span>
<span id="cb73-2"><a href="#cb73-2"></a>rse</span></code></pre></div>
<pre><code>[1] 1.382522</code></pre>
<p>The same calculation, may be simplified with the previously calculated RSS:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">sqrt</span>(rss <span class="op">/</span><span class="st"> </span>pop_lm_<span class="dv">0</span><span class="op">$</span>df.residual)</span></code></pre></div>
<pre><code>[1] 1.382522</code></pre>
<div class="rmdimportant">
<p>
When the ‘deviance()’ function is applied to a single-level model fit via ‘lm()’, the Residual sum of squares (RSS) is returned, not the deviance as defined as twice the negative log likelihood (-2LL).
</p>
</div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">deviance</span>(pop_lm_<span class="dv">0</span>)  <span class="co"># returns the RSS, not deviance = -2LL</span></span></code></pre></div>
<pre><code>[1] 3820.821</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="dv">-2</span> <span class="op">*</span><span class="st"> </span><span class="kw">logLik</span>(pop_lm_<span class="dv">0</span>)  <span class="co"># this is how get deviance = -2LL</span></span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 6970.39 (df=2)</code></pre>
</div>
</div>
</div>
<div id="multi-level-regression-analysis-1" class="section level2" number="4.4">
<h2 number="4.4"><span class="header-section-number">4.4</span> Multi-level Regression Analysis</h2>
<div id="intercept-only-or-null-model" class="section level3" number="4.4.1">
<h3 number="4.4.1"><span class="header-section-number">4.4.1</span> Intercept-only or Null Model</h3>
<blockquote>
<p>In a Null, intercept-only, or Empty model, no predictors are included.</p>
</blockquote>
<div class="rmdlightbulb">
<p>
“The intercept-only model is useful as a null-model that serves as a benchmark with which other models are compared.” <span class="citation"><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></span>, page 13
</p>
</div>
<div id="equations-2" class="section level4" number="4.4.1.1">
<h4 number="4.4.1.1"><span class="header-section-number">4.4.1.1</span> Equations</h4>
<p><strong>Level 1 Model Equation:</strong></p>
<p><span class="math display">\[
\overbrace{Y_{ij}}^{Outcome} = 
         \underbrace{\beta_{0j}}_{\text{Level 2}\atop\text{intercepts}}  + 
         \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}}
\tag{Hox 2.6}
\]</span></p>
<p><strong>Level 2 Model Equation:</strong></p>
<p><span class="math display">\[
\overbrace{\beta_{0j}}^{\text{Level 2}\atop\text{intercepts}} = 
      \underbrace{\gamma_{00}}_{\text{Fixed}\atop\text{intercept}} + 
      \underbrace{u_{0j}}_{\text{Random}\atop\text{intercepts}}
\tag{Hox 2.7}
\]</span></p>
<p>Substitute equation (2.7) into equation (2.6):</p>
<div class="genericEq">
<p>
<strong>Combined, Multilevel Model Equation - Null Model</strong> <span class="math display"><span class="math display">\[ 
\overbrace{Y_{ij}}^{Outcome} = 
    \underbrace{\gamma_{00}}_{\text{Fixed}\atop\text{intercept}} + 
    \underbrace{u_{0j}}_{\text{Random}\atop\text{intercepts}} + 
    \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}}
\tag{Hox 2.8}
\]</span></span>
</p>
</div>
</div>
<div id="parameters-4" class="section level4" number="4.4.1.2">
<h4 number="4.4.1.2"><span class="header-section-number">4.4.1.2</span> Parameters</h4>
<table>
<thead>
<tr class="header">
<th>Type</th>
<th align="left">Parameter of Interest</th>
<th>Estimates This</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fixed</td>
<td align="left">Intercept</td>
<td><span class="math inline">\(\gamma_{00}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Variance in random intercepts, <span class="math inline">\(var[u_{0j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u0}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Residual Variance <span class="math inline">\(var[e_{ij}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{e}\)</span></td>
</tr>
</tbody>
</table>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span> labeled the Null model for this dataset “<span class="math inline">\(M_0\)</span>” in chapter 2:</p>
<div class="genericEq">
<p>
<strong>Combined, Multilevel Model Equation - Popularity,</strong> Random Intercepts Only! <span class="math display"><span class="math display">\[ 
\overbrace{POP_{ij}}^{Outcome} = 
    \underbrace{\gamma_{00}}_{\text{Fixed}\atop\text{intercept}} + 
    \underbrace{u_{0j}}_{\text{Random}\atop\text{intercepts}} + 
    \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}}
\tag{M0: intercept only}
\]</span></span>
</p>
</div>
</div>
<div id="fit-the-model-2" class="section level4" number="4.4.1.3">
<h4 number="4.4.1.3"><span class="header-section-number">4.4.1.3</span> Fit the Model</h4>
<p>Fit the model to the data.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>pop_lmer_<span class="dv">0</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>class),  <span class="co"># include a fixed and random intercept</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>                                <span class="dt">data =</span> data_pop,</span>
<span id="cb81-3"><a href="#cb81-3"></a>                                <span class="dt">REML =</span> <span class="ot">TRUE</span>)             <span class="co"># fit via REML (the default) for ICC calculations</span></span>
<span id="cb81-4"><a href="#cb81-4"></a></span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="kw">summary</span>(pop_lmer_<span class="dv">0</span>_re)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: popular ~ 1 + (1 | class)
   Data: data_pop

REML criterion at convergence: 6330.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5655 -0.6975  0.0020  0.6758  3.3175 

Random effects:
 Groups   Name        Variance Std.Dev.
 class    (Intercept) 0.7021   0.8379  
 Residual             1.2218   1.1053  
Number of obs: 2000, groups:  class, 100

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)  5.07786    0.08739 98.90973    58.1   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="rmdimportant">
<p>
<strong>Estimation Methods</strong>
</p>
<p>
Multilevel models may be fit by various methods. The most commonly used (and availabel in ‘lme4’) optimize various criterions: Maximum Likelihood <em>(ML)</em> -or- Restricted Maximum Likelihood <em>(REML)</em>. <span class="citation"><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></span> discusses these and other methods in chapter 3. At the end of chapter 2, the authors’ second note staes that the details of estimation methods are glossed over in the current example in an effort to simplfy the introductory. Here we follow these guidelines:
</p>
<ul>
<li>
Use <strong>ML</strong> for fitting:
<ul>
<li>
nested models that differ only by inclusion/exclusion of FIXED effects, to test parameter significance via a likelihood ratio test
</li>
</ul>
</li>
<li>
Use <strong>REML</strong> for fitting:
<ul>
<li>
the NULL model, on which to base ICC calculations
</li>
<li>
nested models that differ only by inclusion/exclusion of RANDOM effects, to test parameter significance via a likelihood ratio test<br />
</li>
<li>
the FINAL model
</li>
</ul>
</li>
</ul>
<p>
This often leads to refitting identical models via BOTH estimation methods.
</p>
</div>
</div>
<div id="interpretation-2" class="section level4" number="4.4.1.4">
<h4 number="4.4.1.4"><span class="header-section-number">4.4.1.4</span> Interpretation</h4>
<p>The grand average popularity of all students is 5.0779 and the class averages tend to vary by about 0.8333 points above or below that.</p>
</div>
</div>
<div id="intraclass-correlation-icc-1" class="section level3" number="4.4.2">
<h3 number="4.4.2"><span class="header-section-number">4.4.2</span> Intraclass Correlation (ICC)</h3>
<p>Although the Null model above does not explain any variance in the dependent variable <em>(popularity)</em>, since there are no independent variables, it does decompose (i.e. divide up) the variance into two pieces. We can compute the amount of total variance in popularity that is attribute to the clustering of students in classes verses the residual variance.</p>
<div class="genericEq">
<p>
<strong>Intraclass Correlation (ICC) Formula</strong> <span class="math display"><span class="math display">\[
\overbrace{\rho}^{\text{ICC}} = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random Intercept}\atop\text{Variance}}}
     {\underbrace{\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.9}
\]</span></span>
</p>
</div>
<div class="rmdlightbulb">
<p>
The <code>VarCorr()</code> function in the <code>lme4</code> package returns the standard deviations, not the variances (<span class="math inline"><span class="math inline">\(var = SD^2\)</span></span>) for a model fit via the <code>lme4::lmer()</code> function. The <code>summary()</code> function reports both the variances and the stadard deviations.
</p>
</div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(pop_lmer_<span class="dv">0</span>_re) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># extract random compondent: varrainces and correlations </span></span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),</span>
<span id="cb83-3"><a href="#cb83-3"></a>        <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code> Groups   Name        Variance Std.Dev.
 class    (Intercept) 0.702    0.838   
 Residual             1.222    1.105   </code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>insight<span class="op">::</span><span class="kw">get_variance</span>(pop_lmer_<span class="dv">0</span>_re)</span></code></pre></div>
<pre><code>$var.fixed
[1] 0

$var.random
[1] 0.7021047

$var.residual
[1] 1.221793

$var.distribution
[1] 1.221793

$var.dispersion
[1] 0

$var.intercept
    class 
0.7021047 </code></pre>
<p><span class="math display">\[
\begin{align*}
\text{classes}      \rightarrow \; &amp; \sigma^2_{u0} = 0.83792^2 = 0.702\\
\text{pupils within classes}      \rightarrow \; &amp; \sigma^2_{e}  = 1.10535^2 = 1.222\\
\end{align*}
\]</span></p>
<div id="by-hand" class="section level4" number="4.4.2.1">
<h4 number="4.4.2.1"><span class="header-section-number">4.4.2.1</span> By Hand</h4>
<p>Calculate the ICC by hand:</p>
<p><span class="math display">\[
\overbrace{\rho}^{\text{ICC}} 
     = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random Intercept}\atop\text{Variance}}}
     {\underbrace{\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}} 
     = \frac{0.702}
            {0.702+1.222} 
     = \frac{0.702}
            {1.924}
     = 0.3648649
\]</span></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fl">0.702</span> <span class="op">/</span><span class="st"> </span>(<span class="fl">0.702</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.222</span>)</span></code></pre></div>
<pre><code>[1] 0.3648649</code></pre>
</div>
<div id="the-performance-package" class="section level4" number="4.4.2.2">
<h4 number="4.4.2.2"><span class="header-section-number">4.4.2.2</span> The <code>performance</code> package</h4>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">citation</span>(<span class="st">&quot;performance&quot;</span>)</span></code></pre></div>
<pre><code>
To cite performance in publications use:

  Lüdecke, Makowski, Waggoner &amp; Patil (2020). Assessment of Regression
  Models Performance. CRAN. Available from
  https://easystats.github.io/performance/

A BibTeX entry for LaTeX users is

  @Article{,
    title = {performance: Assessment of Regression Models Performance},
    author = {Daniel Lüdecke and Dominique Makowski and Philip Waggoner and Indrajeet Patil},
    journal = {CRAN},
    year = {2020},
    note = {R package},
    doi = {10.5281/zenodo.3952174},
    url = {https://easystats.github.io/performance/},
  }</code></pre>
<p>Calculate the <strong>ICC</strong> with the <code>icc()</code> function in the <code>performance</code> package:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>performance<span class="op">::</span><span class="kw">icc</span>(pop_lmer_<span class="dv">0</span>_re)</span></code></pre></div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.365
  Conditional ICC: 0.365</code></pre>
</div>
<div id="interpretation-3" class="section level4" number="4.4.2.3">
<h4 number="4.4.2.3"><span class="header-section-number">4.4.2.3</span> Interpretation</h4>
<p>WOW! 36.5% of the variance of the popularity scores is at the group level, which is very high for social science data.</p>
<div class="rmdimportant">
<p>
The ICC should be based on a Null (intercept only) model fit via REML (restricted maximum likelihood) estimation. This is the default for the ‘lme4::lmer()’ function. In chapter 2, <span class="citation"><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></span> presents the numbers based on fitting the model via ML (maximum likelihood) estimation and thus does not match the presentation above exactly <em>(not just rounding error)</em>. This is because: (1) estimation methods (REML &amp; ML) are not discussed until chapter 3 and (2) due to the Null model also being used for model fit comparisons in Table 2.1 on the top of page 14. Here we will fit the empty model twice, above by ML and below by REML
</p>
</div>
</div>
<div id="percent-of-variance-explained" class="section level4" number="4.4.2.4">
<h4 number="4.4.2.4"><span class="header-section-number">4.4.2.4</span> Percent of variance explained</h4>
<p>The <strong>marginal <span class="math inline">\(R^2\)</span></strong> considers only the variance of the fixed effects, while the <strong>conditional <span class="math inline">\(R^2\)</span></strong> takes both the fixed <em>and</em> random effects into account. The random effect variances are actually the mean random effect variances, thus the <span class="math inline">\(R^2\)</span> value is also appropriate for mixed models with random slopes or nested random effects <em>(see Johnson 2014</em>)*.</p>
<blockquote>
<p>Johnson, P. C. D. (2014). Extension of Nakagawa &amp; Schielzeth’s R2 GLMM to random slopes models. Methods in Ecology and Evolution, 5(9), 944–946. doi: 10.1111/2041-210X.12225</p>
</blockquote>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>performance<span class="op">::</span><span class="kw">r2</span>(pop_lmer_<span class="dv">0</span>_re)  <span class="co"># for MLM&#39;s it computes Nakagawa&#39;s R2</span></span></code></pre></div>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.365
     Marginal R2: 0.000</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>performance<span class="op">::</span><span class="kw">performance</span>(pop_lmer_<span class="dv">0</span>_re)</span></code></pre></div>
<pre><code># Indices of model performance

    AIC |     BIC | R2_conditional | R2_marginal |  ICC | RMSE
--------------------------------------------------------------
6336.51 | 6353.31 |           0.36 |           0 | 0.36 | 1.08</code></pre>
</div>
</div>
<div id="add-predictors-to-the-model-1" class="section level3" number="4.4.3">
<h3 number="4.4.3"><span class="header-section-number">4.4.3</span> Add Predictors to the Model</h3>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span> labeled this as “<span class="math inline">\(M_1\)</span>” in chapter 2 for their Table 2.1 (page 14), but adjusted it for Tables 2.2 (page 15) and 2.3 (page 17).</p>
<blockquote>
<p>LEVEL 1: Student-specific predictors:</p>
<ul>
<li><span class="math inline">\(X_1 = GEN\)</span>, pupils’s gender <em>(girl vs. boy)</em></li>
<li><span class="math inline">\(X_2 = EXT\)</span>, pupil’s extroversion <em>(scale: 1-10)</em></li>
</ul>
</blockquote>
<blockquote>
<p>LEVEL 2: Class-specific Predictors:</p>
<ul>
<li><span class="math inline">\(Z = YRS\)</span>, teacher’s experience <em>(range of 2-25 years)</em></li>
</ul>
</blockquote>
<div id="equations-3" class="section level4" number="4.4.3.1">
<h4 number="4.4.3.1"><span class="header-section-number">4.4.3.1</span> Equations</h4>
<p><strong>Level 1 Model Equation:</strong></p>
<p>Include main effects for <code>sex</code> and <code>extrav</code></p>
<p><span class="math display">\[
\overbrace{POP_{ij}}^{Outcome} = 
    \underbrace{\beta_{0j}}_{\text{Level 2}\atop\text{intercept}} + 
    \underbrace{\beta_{1j}}_{\text{Level 2}\atop\text{slopes}} 
    \overbrace{GEN_{ij}}^{\text{Level 1}\atop\text{Predictor 1}} + 
    \underbrace{\beta_{2j}}_{\text{Level 2}\atop\text{slopes}} 
    \overbrace{EXT_{ij}}^{\text{Level 1}\atop\text{Predictor 2}} + 
    \underbrace{e_{ij}}_{\text{Random}\atop\text{residuals}}
\]</span></p>
<p><strong>Level 2 Model Equations:</strong></p>
<p>Include a random intercepts and random slopes for both for <code>sex</code> and <code>extrav</code>, but <strong>NO</strong> cross level interactions for now.</p>
<p>We will assume this is due to some theoretical reasoning to be our starting point after the fitting of the null model.</p>
<ul>
<li>Random Intercepts:</li>
</ul>
<p><span class="math display">\[
\overbrace{\beta_{0j}}^{\text{Level 2}\atop\text{intercepts}} = 
     \underbrace{\gamma_{00}}_{\text{Fixed}\atop\text{intercept}}  + 
     \underbrace{\gamma_{01}}_{\text{Fixed}\atop\text{slope } Z}
     \overbrace{YRS_{j}}^{\text{Level 2}\atop\text{Predictor 3}}  + 
     \underbrace{u_{0j}}_{\text{Intercept}\atop\text{residual}} 
\]</span></p>
<ul>
<li>Random Slopes, for the first predictor, <code>sex</code>:</li>
</ul>
<p><span class="math display">\[
\overbrace{\beta_{1j}}^{\text{Level 2}\atop\text{slopes}} = 
     \underbrace{\gamma_{10}}_{\text{Fixed}\atop\text{Slope  } X_1}  + 
     \underbrace{u_{1j}}_{\text{Slope } X_1\atop\text{residual}} 
\]</span></p>
<ul>
<li>Random Slopes, for the second predictor, <code>extrav</code>:</li>
</ul>
<p><span class="math display">\[
\overbrace{\beta_{2j}}^{\text{Level 2}\atop\text{slopes}} = 
     \underbrace{\gamma_{20}}_{\text{Fixed}\atop\text{Slope  } X_2}  + 
     \underbrace{u_{2j}}_{\text{Slope } X_2\atop\text{residual}} 
\]</span></p>
<p>Substitute the level 2 equations into the level 1 equation:</p>
<div class="genericEq">
<p>
<strong>Combined, Multilevel Model Equation - Popularity,</strong> Include Predictors (no cross-level interactions) <span class="math display"><span class="math display">\[
\overbrace{POP_{ij}}^{Outcome}
        = \overbrace{\gamma_{00} + 
                      \gamma_{10} GEN_{ij} + 
                      \gamma_{20} EXT_{ij} + 
                      \gamma_{01} YRS_{j}}^{\text{Fixed part}\atop\text{Deterministic}} + \\
         \underbrace{u_{0j} + u_{1j} GEN_{ij} + u_{2j} EXT_{ij} + e_{ij} }_{\text{Random part}\atop\text{Stochastic}}
\tag{M1}
\]</span></span>
</p>
</div>
</div>
<div id="parameters-5" class="section level4" number="4.4.3.2">
<h4 number="4.4.3.2"><span class="header-section-number">4.4.3.2</span> Parameters</h4>
<table>
<colgroup>
<col width="11%" />
<col width="65%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th align="left">Parameter of Interest</th>
<th>Estimates This</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fixed</td>
<td align="left">Intercept</td>
<td><span class="math inline">\(\gamma_{00}\)</span></td>
</tr>
<tr class="even">
<td>Fixed</td>
<td align="left">Main Effect of <code>sex</code></td>
<td><span class="math inline">\(\gamma_{10}\)</span></td>
</tr>
<tr class="odd">
<td>Fixed</td>
<td align="left">Main Effect of <code>extrav</code></td>
<td><span class="math inline">\(\gamma_{20}\)</span></td>
</tr>
<tr class="even">
<td>Fixed</td>
<td align="left">Main Effect of <code>texp</code></td>
<td><span class="math inline">\(\gamma_{01}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Variance in random intercepts, <span class="math inline">\(var[u_{0j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u0}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Variance in random slope of <code>sex</code>, <span class="math inline">\(var[u_{1j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u1}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Variance in random slope of <code>extrav</code>, <span class="math inline">\(var[u_{2j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u2}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Covariance between random intercepts and random slope of <code>sex</code>, <span class="math inline">\(cov[u_{0j}, u_{1j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u01}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Covariance between random intercepts and random slope of <code>extrav</code>, <span class="math inline">\(cov[u_{0j}, u_{2j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u02}\)</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td align="left">Covariance between random slopes of <code>sex</code> and <code>extrav</code>, <span class="math inline">\(cov[u_{1j}, u_{2j}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{u12}\)</span></td>
</tr>
<tr class="odd">
<td>Random</td>
<td align="left">Residual Variance <span class="math inline">\(var[e_{ij}]\)</span></td>
<td><span class="math inline">\(\sigma^2_{e}\)</span></td>
</tr>
</tbody>
</table>
<div class="rmdimportant">
<p>
Troubleshooting ‘lme4’ Linear Mixed-Effects Models <a href="https://rdrr.io/cran/lme4/man/troubleshooting.html">website</a>. This website attempts to summarize some of the common problems with fitting lmer models and how to troubleshoot them.
</p>
<p>
This is a helpful <a href="https://stats.stackexchange.com/questions/242109/model-failed-to-converge-warning-in-lmer">post on Stack Exchange</a> regarding using differen t optimizers to get the ‘lme4::lmer()’ function to converge.
</p>
<p>
Note: Convergence issues MAY signify problems in the model specification.
</p>
</div>
</div>
<div id="fit-the-model-3" class="section level4" number="4.4.3.3">
<h4 number="4.4.3.3"><span class="header-section-number">4.4.3.3</span> Fit the Model</h4>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>pop_lmer_<span class="dv">0</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>class), </span>
<span id="cb97-2"><a href="#cb97-2"></a>                                <span class="dt">data   =</span> data_pop,</span>
<span id="cb97-3"><a href="#cb97-3"></a>                                <span class="dt">REML   =</span> <span class="ot">FALSE</span>)        <span class="co"># refit via ML to compare the model below to </span></span>
<span id="cb97-4"><a href="#cb97-4"></a></span>
<span id="cb97-5"><a href="#cb97-5"></a></span>
<span id="cb97-6"><a href="#cb97-6"></a>pop_lmer_<span class="dv">1</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav <span class="op">+</span><span class="st"> </span>texp <span class="op">+</span><span class="st"> </span>(sex <span class="op">+</span><span class="st"> </span>extrav<span class="op">|</span>class), </span>
<span id="cb97-7"><a href="#cb97-7"></a>                                <span class="dt">data   =</span> data_pop,</span>
<span id="cb97-8"><a href="#cb97-8"></a>                                <span class="dt">REML   =</span> <span class="ot">FALSE</span>,</span>
<span id="cb97-9"><a href="#cb97-9"></a>                                <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>)) <span class="co">#helps converge</span></span>
<span id="cb97-10"><a href="#cb97-10"></a></span>
<span id="cb97-11"><a href="#cb97-11"></a><span class="kw">summary</span>(pop_lmer_<span class="dv">1</span>_ml)</span></code></pre></div>
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite&#39;s
  method [lmerModLmerTest]
Formula: popular ~ sex + extrav + texp + (sex + extrav | class)
   Data: data_pop
Control: lmerControl(optimizer = &quot;Nelder_Mead&quot;)

     AIC      BIC   logLik deviance df.resid 
  4833.3   4894.9  -2405.6   4811.3     1989 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.1686 -0.6550 -0.0227  0.6728  2.9571 

Random effects:
 Groups   Name        Variance Std.Dev. Corr       
 class    (Intercept) 1.319429 1.14866             
          sexgirl     0.002389 0.04888  -0.40      
          extrav      0.034115 0.18470  -0.88 -0.09
 Residual             0.551144 0.74239             
Number of obs: 2000, groups:  class, 100

Fixed effects:
             Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept) 7.601e-01  1.959e-01 1.839e+02   3.879 0.000146 ***
sexgirl     1.251e+00  3.692e-02 9.930e+02  33.884  &lt; 2e-16 ***
extrav      4.529e-01  2.451e-02 9.715e+01  18.477  &lt; 2e-16 ***
texp        8.942e-02  8.533e-03 1.034e+02  10.480  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
        (Intr) sexgrl extrav
sexgirl -0.063              
extrav  -0.720 -0.066       
texp    -0.683 -0.040  0.090
convergence code: 0
boundary (singular) fit: see ?isSingular</code></pre>
</div>
<div id="interpretation-4" class="section level4" number="4.4.3.4">
<h4 number="4.4.3.4"><span class="header-section-number">4.4.3.4</span> Interpretation</h4>
<p>After accounting for the heiarchical nesting of students in classes, girls were rated 1.25 points more popular on average, than boys with the same extroversion score. One point higher extroversion scores were associated with 0.45 points higher popularity, within each gender.</p>
<p>Reproduce Table 2.1 on the top of page 14 <span class="citation">(Hox, Moerbeek, and Van de Schoot <a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_lm_<span class="dv">0</span>, </span>
<span id="cb99-2"><a href="#cb99-2"></a>                     pop_glm_<span class="dv">0</span>,</span>
<span id="cb99-3"><a href="#cb99-3"></a>                     pop_lmer_<span class="dv">0</span>_ml, </span>
<span id="cb99-4"><a href="#cb99-4"></a>                     pop_lmer_<span class="dv">1</span>_ml),</span>
<span id="cb99-5"><a href="#cb99-5"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Single-level, OLS&quot;</span>, </span>
<span id="cb99-6"><a href="#cb99-6"></a>                                       <span class="st">&quot;Single-level, ML&quot;</span>,</span>
<span id="cb99-7"><a href="#cb99-7"></a>                                       <span class="st">&quot;M0: int only&quot;</span>, </span>
<span id="cb99-8"><a href="#cb99-8"></a>                                       <span class="st">&quot;M1: w pred&quot;</span>),</span>
<span id="cb99-9"><a href="#cb99-9"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Hox Table 2.1 on the top of page 14&quot;</span>,</span>
<span id="cb99-10"><a href="#cb99-10"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb99-11"><a href="#cb99-11"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Hox Table 2.1 on the top of page 14
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Single-level, OLS
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Single-level, ML
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M0: int only
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1: w pred
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.08 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.08 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.08 (0.09)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.76 (0.20)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.25 (0.04)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.45 (0.02)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
texp
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.01)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Adj. R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6974.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6333.47
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4833.29
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6985.59
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6350.27
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4894.90
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3485.20
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3163.73
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2405.64
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Deviance
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3820.82
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: class
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.69
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.32
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.19
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class sexgirl extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.00
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>The regression tables from the <code>texreg</code> package include estimates of the covariances between random components.</p>
<blockquote>
<p>“These covarianes are rarely interpreted <em>(for an exception see Chapter 5 and Chapter 16 where growth models are discussed)</em>, and for that reason they are often not included in the reported tables. However, as Table 2.2 demonstrates, they can be quite large adn significant, so as a rule they are always included in the model.”</p>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>, Chapter 2, pages 15-16</p>
</blockquote>
<div class="rmdlightbulb">
<p>
<strong>Comparing Model Fit</strong>
</p>
<ol style="list-style-type: decimal">
<li>
Residual Variance in the Residuals
</li>
</ol>
<ul>
<li>
In single-level regression, the Root Mean Squared Error (RMSE) is usually reported. It is the standard deviation of the residuals and is called “Residual standard error” in the R output of <code>summary()</code> function applied to an model fit via <code>lm</code>.
</li>
<li>
In multi-level regression, residual variance is reported as <span class="math inline"><span class="math inline">\(\sigma_e^2\)</span></span>.
</li>
</ul>
<p>
<span class="math display"><span class="math display">\[
{\text{RMSE}}^2 = MSE = \sigma_e^2
\]</span></span>
</p>
<ol start="2" style="list-style-type: decimal">
<li>
Deviance
</li>
</ol>
<ul>
<li>
<p>
In single-level regression, the model is fit in such a way as to make the sum of the squared residuals as small as possible. Deviance is the sum of the squared residuals.
</p>
</li>
<li>
<p>
In multi-level regression, the model is fit via a method called ‘Maximum Likelihood’.
</p>
</li>
</ul>
<p>
<span class="math display"><span class="math display">\[
\text{Deviance} = -2LL = -2 \times log(likelihood)
\]</span></span>
</p>
</div>
</div>
</div>
<div id="testing-random-components" class="section level3" number="4.4.4">
<h3 number="4.4.4"><span class="header-section-number">4.4.4</span> Testing Random Components</h3>
<p>In Hox’s table 2.1 (page 14) we see that the MLM with predictors (<span class="math inline">\(M_0\)</span>) includes a random compondnt with virtually no variance. This is likely why the model didn’t easily converge (a different optimizer was employed). It makes sence to remove the random slope component for gender and refit the model. While we are at it, we will also fit a third model dropping the second random slope component for extroversion.</p>
<div id="fit-nested-models" class="section level4" number="4.4.4.1">
<h4 number="4.4.4.1"><span class="header-section-number">4.4.4.1</span> Fit Nested Models</h4>
<p>Since we are going to compare models that are nested on random effects <em>(identical except for inclusing/exclusing of random components</em>, we will specify the <code>REML = TRUE</code> option.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>pop_lmer_<span class="dv">1</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav <span class="op">+</span><span class="st"> </span>texp <span class="op">+</span><span class="st"> </span>(sex <span class="op">+</span><span class="st"> </span>extrav<span class="op">|</span>class), </span>
<span id="cb100-2"><a href="#cb100-2"></a>                                <span class="dt">data  =</span> data_pop,</span>
<span id="cb100-3"><a href="#cb100-3"></a>                                <span class="dt">REML  =</span> <span class="ot">TRUE</span>,</span>
<span id="cb100-4"><a href="#cb100-4"></a>                                <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>)) <span class="co">#helps converge</span></span>
<span id="cb100-5"><a href="#cb100-5"></a></span>
<span id="cb100-6"><a href="#cb100-6"></a>pop_lmer_1a_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav <span class="op">+</span><span class="st"> </span>texp <span class="op">+</span><span class="st"> </span>(extrav<span class="op">|</span>class), </span>
<span id="cb100-7"><a href="#cb100-7"></a>                                 <span class="dt">data =</span> data_pop,</span>
<span id="cb100-8"><a href="#cb100-8"></a>                                 <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span>
<span id="cb100-9"><a href="#cb100-9"></a></span>
<span id="cb100-10"><a href="#cb100-10"></a>pop_lmer_1b_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav <span class="op">+</span><span class="st"> </span>texp <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span>class), </span>
<span id="cb100-11"><a href="#cb100-11"></a>                                 <span class="dt">data =</span> data_pop,</span>
<span id="cb100-12"><a href="#cb100-12"></a>                                 <span class="dt">REML =</span> <span class="ot">TRUE</span>) </span></code></pre></div>
<p>Create a table to compare the three nested models:</p>
<p>The middle column below reproduces Hox’s Table 2.2 found on the bottom of page 15 <span class="citation">(Hox, Moerbeek, and Van de Schoot <a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>, except the values differ slightly becuase here the model was fit via <code>REML</code> where as in the text, Hox used <code>ML</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_lmer_<span class="dv">1</span>_re, pop_lmer_1a_re, pop_lmer_1b_re),</span>
<span id="cb101-2"><a href="#cb101-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M1&quot;</span>, <span class="st">&quot;M1a&quot;</span>, <span class="st">&quot;M1b&quot;</span>),</span>
<span id="cb101-3"><a href="#cb101-3"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Assessing Significance of Random Slopes&quot;</span>,</span>
<span id="cb101-4"><a href="#cb101-4"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb101-5"><a href="#cb101-5"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Assessing Significance of Random Slopes
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1a
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1b
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.76 (0.20)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.74 (0.20)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.81 (0.17)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.25 (0.04)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.25 (0.04)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.25 (0.04)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.45 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.45 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.45 (0.02)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
texp
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.01)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4855.26
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4850.77
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4897.02
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4916.87
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4895.58
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4930.63
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2416.63
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2417.38
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2442.51
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: class
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.34
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.30
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.19
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.19
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class sexgirl extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.59
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="compare-fit" class="section level4" number="4.4.4.2">
<h4 number="4.4.4.2"><span class="header-section-number">4.4.4.2</span> Compare Fit</h4>
<div class="rmdlightbulb">
<p>
<strong>Likelihood Ratio Test (LRT) of Nested MLM Models</strong>
</p>
<p>
When comparing the fit of two multi-level models fit via the <code>lmer()</code> function, the <code>anova()</code> function runs an Chi-squared test where the test statistic is the difference in -2LL (deviances).
</p>
</div>
<div class="rmdimportant">
<p>
<strong>Likelihood Ratio Test (LRT) for Random Effects</strong>
</p>
<p>
When using the ‘anova()’ function to conduct a LRT for RANDOM effects, make sure:
</p>
<ol style="list-style-type: decimal">
<li>
the nested models have identical FIXED effects
</li>
</ol>
<ul>
<li>
never test models that differ in fixed and random effects at the same time
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>
the models were fit with ‘REML = TRUE’
</li>
</ol>
<ul>
<li>
this results in the best variance/covariance component estimation
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>
add the ‘refit = FALSE’ option to the ‘anova()’ call
</li>
</ol>
<ul>
<li>
without this <span class="math inline"><span class="math inline">\(R\)</span></span> re-runs the models with ‘REML = FALSE’ for you
</li>
</ul>
</div>
<ul>
<li>Investigate dropping the random slope component for <code>sex</code></li>
</ul>
<p>These two models are identical, except for the inclusing/exclusion of the random specification of the level 1 <code>sex</code> predictor. Note, both models were fit with REML. Although we are dropping only ONE variance component, we are also dropping TWO covariances (<code>sex</code> paired with both the random intercept and random slope for <code>extrav</code>). This results in a <span class="math inline">\(\chi^2\)</span> test with THREE degrees of freedom.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="kw">anova</span>(pop_lmer_<span class="dv">1</span>_re, </span>
<span id="cb102-2"><a href="#cb102-2"></a>      pop_lmer_1a_re, </span>
<span id="cb102-3"><a href="#cb102-3"></a>      <span class="dt">refit =</span> <span class="ot">FALSE</span>)  <span class="co"># don&#39;t let it refit the models via LM</span></span></code></pre></div>
<pre><code>Data: data_pop
Models:
pop_lmer_1a_re: popular ~ sex + extrav + texp + (extrav | class)
pop_lmer_1_re: popular ~ sex + extrav + texp + (sex + extrav | class)
               npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
pop_lmer_1a_re    8 4850.8 4895.6 -2417.4   4834.8                     
pop_lmer_1_re    11 4855.3 4916.9 -2416.6   4833.3 1.5133  3     0.6792</code></pre>
<p>The NON-significance likelihood ratio test (LRT: <span class="math inline">\(\chi^2(3) = 1.51\)</span>, <span class="math inline">\(p = .679\)</span>) conveys that the more complex model does NOT fit the data better. Thus the more SIMPLE model does just as good of a job. This is evidence for the EXCLUSION of <code>sex</code> as a random component.</p>
<ul>
<li>Investigate dropping the random slope component for <code>extrav</code></li>
</ul>
<p>These two models are identical, except for the inclusing/exclusion of the random specification of the level 1 <code>extrav</code> predictor. Note, both models were fit with REML. Although we are dropping only ONE variance component, we are also dropping ONE covariances (<code>extrav</code> paired with the random intercept). This results in a <span class="math inline">\(\chi^2\)</span> test with TWO degrees of freedom.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="kw">anova</span>(pop_lmer_1a_re, </span>
<span id="cb104-2"><a href="#cb104-2"></a>      pop_lmer_1b_re, </span>
<span id="cb104-3"><a href="#cb104-3"></a>      <span class="dt">refit =</span> <span class="ot">FALSE</span>)  <span class="co"># don&#39;t let it refit the models via LM</span></span></code></pre></div>
<pre><code>Data: data_pop
Models:
pop_lmer_1b_re: popular ~ sex + extrav + texp + (1 | class)
pop_lmer_1a_re: popular ~ sex + extrav + texp + (extrav | class)
               npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
pop_lmer_1b_re    6 4897.0 4930.6 -2442.5   4885.0                         
pop_lmer_1a_re    8 4850.8 4895.6 -2417.4   4834.8 50.256  2  1.222e-11 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The significance likelihood ratio test (LRT: <span class="math inline">\(\chi^2(2) = 50.26\)</span>, <span class="math inline">\(p &lt; .0001\)</span>) conveys that the more complex model DOES fit the data better. Thus the more COMPLEX model does just as good of a job. This is evidence for the INCLUSION of <code>extrav</code> as a random component.</p>
</div>
</div>
<div id="testing-cross-level-interactions" class="section level3" number="4.4.5">
<h3 number="4.4.5"><span class="header-section-number">4.4.5</span> Testing Cross-Level Interactions</h3>
<p>We have already seen formulas of this form for a NULL or emply models, as well as for intercept implied models of main effects:</p>
<ul>
<li>intercept only
<ul>
<li><code>Y ~ 1</code></li>
</ul></li>
<li>intercept implied
<ul>
<li><code>Y ~ A</code> = <code>Y ~ 1 + A</code></li>
<li><code>Y ~ A + B</code> = <code>Y ~ 1 + A + B</code></li>
</ul></li>
</ul>
<div class="rmdlightbulb">
<p>
<strong>Including Interactions in Formulas</strong>
</p>
<p>
If we wish to include an <strong>interaction</strong> between the two predictors, we signify this with a colon (:) between the two predictor names. A <strong>shortcut</strong> may also be employed to signify the including of the main effects and the interaction at the same time by placing an astric (*) between the two variable names. Both of the following specify the outcome is being predicted by an intercept (implied), the main effects for 2 predictors, and the interaction between the two predictors
</p>
<ul>
<li>
<code>Y ~ A + B + A:B</code>
</li>
<li>
<code>Y ~ A*B</code>
</li>
</ul>
</div>
<p>Examples</p>
<ul>
<li>2-way: <code>A*B</code> = <code>A + B + A:B</code></li>
<li>3-way: <code>A*B*C</code> = <code>A + B + C + A:B + A:C + B:C + A:B:C</code></li>
<li>4-way: <code>A*B*C*D</code> = <code>A + B + C + D + A:B + A:C + A:D + B:C + B:D + A:B:C + A:B:D+ A:C:D + B:C:D + A:B:C:D</code></li>
</ul>
<div id="fit-nested-models-1" class="section level4" number="4.4.5.1">
<h4 number="4.4.5.1"><span class="header-section-number">4.4.5.1</span> Fit Nested Models</h4>
<blockquote>
<p>“Given the significant variance of the regression coefficient of pupil extroversion across the classes, it is attractive to attempt to predict its variation using class-level variables. We have one class-level variable: teacher experience.”</p>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>, Chapter 2, page 16</p>
</blockquote>
<p>Now that we wish to compare nested that will differ only in terms of the inclusing/exclusion of a FIXED effect, the estimation method should be standard maximum likelihood (<code>REML = FALSE</code>).</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>pop_lmer_1a_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav <span class="op">+</span><span class="st"> </span>texp <span class="op">+</span><span class="st"> </span>(extrav<span class="op">|</span>class), <span class="co"># main effects only</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>                                 <span class="dt">data =</span> data_pop,</span>
<span id="cb106-3"><a href="#cb106-3"></a>                                 <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb106-4"><a href="#cb106-4"></a></span>
<span id="cb106-5"><a href="#cb106-5"></a>pop_lmer_<span class="dv">2</span>_ml  &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav<span class="op">*</span>texp <span class="op">+</span><span class="st"> </span>(extrav<span class="op">|</span>class), <span class="co"># include cross-level interaction</span></span>
<span id="cb106-6"><a href="#cb106-6"></a>                                 <span class="dt">data =</span> data_pop,</span>
<span id="cb106-7"><a href="#cb106-7"></a>                                 <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb106-8"><a href="#cb106-8"></a></span>
<span id="cb106-9"><a href="#cb106-9"></a>pop_lmer_<span class="dv">3</span>_ml  &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>extrav<span class="op">*</span>texp <span class="op">+</span><span class="st"> </span>sex<span class="op">*</span>texp <span class="op">+</span><span class="st"> </span>sex<span class="op">*</span>extrav <span class="op">+</span><span class="st">  </span>(extrav<span class="op">|</span>class),  </span>
<span id="cb106-10"><a href="#cb106-10"></a>                                 <span class="dt">data =</span> data_pop,</span>
<span id="cb106-11"><a href="#cb106-11"></a>                                 <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb106-12"><a href="#cb106-12"></a></span>
<span id="cb106-13"><a href="#cb106-13"></a>pop_lmer_<span class="dv">4</span>_ml  &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>extrav<span class="op">*</span>texp<span class="op">*</span>sex <span class="op">+</span><span class="st"> </span>(extrav<span class="op">|</span>class),  </span>
<span id="cb106-14"><a href="#cb106-14"></a>                                 <span class="dt">data =</span> data_pop,</span>
<span id="cb106-15"><a href="#cb106-15"></a>                                 <span class="dt">REML =</span> <span class="ot">FALSE</span>,</span>
<span id="cb106-16"><a href="#cb106-16"></a>                                 <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>))</span></code></pre></div>
<p>Create a table to compare the two nested models:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_lmer_1a_ml, pop_lmer_<span class="dv">2</span>_ml),</span>
<span id="cb107-2"><a href="#cb107-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M1a: Main Effects&quot;</span>,</span>
<span id="cb107-3"><a href="#cb107-3"></a>                                       <span class="st">&quot;M2: With Interaction&quot;</span>),</span>
<span id="cb107-4"><a href="#cb107-4"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Hox Table 2.3 on page 17&quot;</span>,</span>
<span id="cb107-5"><a href="#cb107-5"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb107-6"><a href="#cb107-6"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Hox Table 2.3 on page 17
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1a: Main Effects
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M2: With Interaction
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.74 (0.20)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.21 (0.27)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.25 (0.04)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.24 (0.04)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.45 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.80 (0.04)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
texp
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.23 (0.02)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav:texp
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4828.81
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4765.62
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4873.61
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4816.03
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2406.40
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2373.81
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: class
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.28
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.45
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Investigate further interactions, not shown in by <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_lmer_1a_ml, pop_lmer_<span class="dv">2</span>_ml, pop_lmer_<span class="dv">3</span>_ml, pop_lmer_<span class="dv">4</span>_ml),</span>
<span id="cb108-2"><a href="#cb108-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M1a: Main Effects&quot;</span>,</span>
<span id="cb108-3"><a href="#cb108-3"></a>                                       <span class="st">&quot;M2: With Interaction&quot;</span>,</span>
<span id="cb108-4"><a href="#cb108-4"></a>                                       <span class="st">&quot;Add 2-way Inter&quot;</span>,</span>
<span id="cb108-5"><a href="#cb108-5"></a>                                       <span class="st">&quot;Add 3-way Interaction&quot;</span>),</span>
<span id="cb108-6"><a href="#cb108-6"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Hox Table 2.3 on page 17&quot;</span>,</span>
<span id="cb108-7"><a href="#cb108-7"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb108-8"><a href="#cb108-8"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Hox Table 2.3 on page 17
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1a: Main Effects
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M2: With Interaction
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Add 2-way Inter
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Add 3-way Interaction
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.74 (0.20)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.21 (0.27)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.09 (0.28)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.94 (0.33)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.25 (0.04)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.24 (0.04)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.96 (0.21)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.66 (0.38)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.45 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.80 (0.04)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.78 (0.04)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.75 (0.05)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
texp
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.23 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.23 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22 (0.02)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav:texp
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
texp:sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00 (0.01)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.02)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav:sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.03)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10 (0.06)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav:texp:sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.00 (0.00)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4828.81
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4765.62
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4767.17
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4768.26
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4873.61
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4816.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4828.78
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4835.47
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2406.40
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2373.81
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2372.58
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2372.13
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: class
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.28
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.45
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="compare-fit-1" class="section level4" number="4.4.5.2">
<h4 number="4.4.5.2"><span class="header-section-number">4.4.5.2</span> Compare Fit</h4>
<p>Since these two models only differ by the including/exclusing of a FIXED effect, they both employed <code>ML</code> estimation. Thus we do not need worry about the <code>anova()</code> function refitting the models prior to conduction the LRT.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="kw">anova</span>(pop_lmer_1a_ml, pop_lmer_<span class="dv">2</span>_ml)</span></code></pre></div>
<pre><code>Data: data_pop
Models:
pop_lmer_1a_ml: popular ~ sex + extrav + texp + (extrav | class)
pop_lmer_2_ml: popular ~ sex + extrav * texp + (extrav | class)
               npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
pop_lmer_1a_ml    8 4828.8 4873.6 -2406.4   4812.8                         
pop_lmer_2_ml     9 4765.6 4816.0 -2373.8   4747.6 65.183  1  6.827e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The significance likelihood ratio test (LRT: <span class="math inline">\(\chi^2(1) = 65.18\)</span>, <span class="math inline">\(p &lt; .0001\)</span>) conveys that the more complex model DOES fit the data better. Thus the more COMPLEX model does just as good of a job. This is evidence for the INCLUSION of cross-level interaction between <code>extrav</code> and <code>texp</code> as a fixed component.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="kw">anova</span>(pop_lmer_<span class="dv">2</span>_ml, pop_lmer_<span class="dv">3</span>_ml)</span></code></pre></div>
<pre><code>Data: data_pop
Models:
pop_lmer_2_ml: popular ~ sex + extrav * texp + (extrav | class)
pop_lmer_3_ml: popular ~ extrav * texp + sex * texp + sex * extrav + (extrav | 
pop_lmer_3_ml:     class)
              npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
pop_lmer_2_ml    9 4765.6 4816.0 -2373.8   4747.6                     
pop_lmer_3_ml   11 4767.2 4828.8 -2372.6   4745.2 2.4552  2      0.293</code></pre>
<p>The significance likelihood ratio test (LRT: <span class="math inline">\(\chi^2(2) = 2.46\)</span>, <span class="math inline">\(p=.293\)</span>) conveys that the more complex model does NOT fit the data better. Thus the more SIMPLE model does just as good of a job. This is evidence for the EXCLUSION of the additional 2-way interactions as a fixed components.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="kw">anova</span>(pop_lmer_<span class="dv">2</span>_ml, pop_lmer_<span class="dv">4</span>_ml)</span></code></pre></div>
<pre><code>Data: data_pop
Models:
pop_lmer_2_ml: popular ~ sex + extrav * texp + (extrav | class)
pop_lmer_4_ml: popular ~ extrav * texp * sex + (extrav | class)
              npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
pop_lmer_2_ml    9 4765.6 4816.0 -2373.8   4747.6                     
pop_lmer_4_ml   12 4768.3 4835.5 -2372.1   4744.3 3.3636  3     0.3389</code></pre>
<p>The significance likelihood ratio test (LRT: <span class="math inline">\(\chi^2(3) = 3.36\)</span>, <span class="math inline">\(p=.339\)</span>) conveys that the more complex model does NOT fit the data better. Thus the more SIMPLE model does just as good of a job. This is evidence for the EXCLUSION of the additional 3-way interactions as a fixed components.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(pop_lmer_1a_ml, </span>
<span id="cb115-2"><a href="#cb115-2"></a>                                 pop_lmer_<span class="dv">2</span>_ml,</span>
<span id="cb115-3"><a href="#cb115-3"></a>                                 pop_lmer_<span class="dv">3</span>_ml,</span>
<span id="cb115-4"><a href="#cb115-4"></a>                                 pop_lmer_<span class="dv">4</span>_ml,</span>
<span id="cb115-5"><a href="#cb115-5"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model          |            Type |     AIC |     BIC | R2_conditional | R2_marginal |  ICC | RMSE |       BF | Performance_Score
--------------------------------------------------------------------------------------------------------------------------------
pop_lmer_2_ml  | lmerModLmerTest | 4765.62 | 4816.03 |           0.71 |        0.55 | 0.34 | 0.72 | 3.19e+12 |            68.18%
pop_lmer_3_ml  | lmerModLmerTest | 4767.17 | 4828.78 |           0.71 |        0.56 | 0.34 | 0.72 | 5.44e+09 |            54.82%
pop_lmer_4_ml  | lmerModLmerTest | 4768.26 | 4835.47 |           0.71 |        0.56 | 0.34 | 0.72 | 1.92e+08 |            54.69%
pop_lmer_1a_ml | lmerModLmerTest | 4828.81 | 4873.61 |           0.69 |        0.51 | 0.38 | 0.71 |     1.00 |            28.57%

Model pop_lmer_2_ml (of class lmerModLmerTest) performed best with an overall performance score of 68.18%.</code></pre>
</div>
</div>
<div id="final-model" class="section level3" number="4.4.6">
<h3 number="4.4.6"><span class="header-section-number">4.4.6</span> Final Model</h3>
<div id="refit-with-reml" class="section level4" number="4.4.6.1">
<h4 number="4.4.6.1"><span class="header-section-number">4.4.6.1</span> Refit with REML</h4>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>pop_lmer_<span class="dv">2</span>_re  &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>extrav<span class="op">*</span>texp <span class="op">+</span><span class="st"> </span>(extrav<span class="op">|</span>class), </span>
<span id="cb117-2"><a href="#cb117-2"></a>                                 <span class="dt">data =</span> data_pop,</span>
<span id="cb117-3"><a href="#cb117-3"></a>                                 <span class="dt">REML =</span> <span class="ot">TRUE</span>)       <span class="co"># re-fit the final model via REML</span></span></code></pre></div>
</div>
<div id="parameter-summary-table" class="section level4" number="4.4.6.2">
<h4 number="4.4.6.2"><span class="header-section-number">4.4.6.2</span> Parameter Summary Table</h4>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_lmer_<span class="dv">2</span>_re),</span>
<span id="cb118-2"><a href="#cb118-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Final Model&quot;</span>),</span>
<span id="cb118-3"><a href="#cb118-3"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM for Popularity&quot;</span>,</span>
<span id="cb118-4"><a href="#cb118-4"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb118-5"><a href="#cb118-5"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM for Popularity
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Final Model
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.21 (0.27)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexgirl
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.24 (0.04)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.80 (0.04)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
texp
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.23 (0.02)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav:texp
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4798.45
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4848.86
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2390.23
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: class
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.48
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.55
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="visualization---interactions-package" class="section level4" number="4.4.6.3">
<h4 number="4.4.6.3"><span class="header-section-number">4.4.6.3</span> Visualization - <code>interactions</code> package</h4>
<p><strong>Predictors:</strong> involved in the interaction …
* <code>extrav</code> 1 value per student, continuous, score with range 1-10<br />
* <code>texp</code> 1 value per class, continuous, years with range 2-25</p>
<p>Fastest way: all defaults</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(pop_lmer_<span class="dv">2</span>_re,    <span class="co"># model name</span></span>
<span id="cb119-2"><a href="#cb119-2"></a>                            <span class="dt">pred =</span> extrav,    <span class="co"># x-axis &#39;predictor&#39; independent variable name</span></span>
<span id="cb119-3"><a href="#cb119-3"></a>                            <span class="dt">modx =</span> texp,      <span class="co"># &#39;moderator&#39; (x) independent variable name</span></span>
<span id="cb119-4"><a href="#cb119-4"></a>                            <span class="dt">mod2 =</span> sex)       <span class="co"># 2nd moderator independent variable name (optional)</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-114-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>For publications, you can get fancier</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(pop_lmer_<span class="dv">2</span>_re,                <span class="co"># model name</span></span>
<span id="cb120-2"><a href="#cb120-2"></a>                            <span class="dt">pred =</span> extrav,                <span class="co"># x-axis &#39;predictor&#39; variable name</span></span>
<span id="cb120-3"><a href="#cb120-3"></a>                            <span class="dt">modx =</span> texp,                  <span class="co"># &#39;moderator&#39; variable name</span></span>
<span id="cb120-4"><a href="#cb120-4"></a>                            <span class="dt">modx.values =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">25</span>),   <span class="co"># values to pick for a continuous &quot;modx&quot;</span></span>
<span id="cb120-5"><a href="#cb120-5"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>,              <span class="co"># adds CI bands for pop/marginal mean</span></span>
<span id="cb120-6"><a href="#cb120-6"></a>                            <span class="dt">y.label =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Pupil Popularity, Mean Rating of Classroom Peers&quot;</span>,</span>
<span id="cb120-7"><a href="#cb120-7"></a>                            <span class="dt">x.label =</span> <span class="st">&quot;Pupil&#39;s Extroversion, as Rated by Teacher&quot;</span>,</span>
<span id="cb120-8"><a href="#cb120-8"></a>                            <span class="dt">legend.main =</span> <span class="st">&quot;Teacher&#39;s Experience&quot;</span>,</span>
<span id="cb120-9"><a href="#cb120-9"></a>                            <span class="dt">modx.labels =</span> <span class="kw">c</span>(<span class="st">&quot;5 years&quot;</span>,</span>
<span id="cb120-10"><a href="#cb120-10"></a>                                            <span class="st">&quot;15 years&quot;</span>,</span>
<span id="cb120-11"><a href="#cb120-11"></a>                                            <span class="st">&quot;25 years&quot;</span>),</span>
<span id="cb120-12"><a href="#cb120-12"></a>                            <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span><span class="st">   </span><span class="co"># default is &quot;Blues&quot; for modx.values</span></span>
<span id="cb120-13"><a href="#cb120-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb120-14"><a href="#cb120-14"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb120-15"><a href="#cb120-15"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;Black&quot;</span>),</span>
<span id="cb120-16"><a href="#cb120-16"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb120-17"><a href="#cb120-17"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">-0.1</span>)) <span class="op">+</span></span>
<span id="cb120-18"><a href="#cb120-18"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb120-19"><a href="#cb120-19"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>)) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-115-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="visualization---effects-ggplot2-packages" class="section level4" number="4.4.6.4">
<h4 number="4.4.6.4"><span class="header-section-number">4.4.6.4</span> Visualization - <code>effects</code> &amp; <code>ggplot2</code> packages</h4>
<p>Get Estimated Marginal Means - default ‘nice’ predictor values:</p>
<p><strong>Focal predictors:</strong> All combinations of…
* <code>sex</code> categorical, both levels<br />
* <code>extrav</code> continuous 1-10, default: 1, 3, 6, 8, 10<br />
* <code>texp</code> continuous, default: 2.0, 7.8, 14.0, 19.0, 25.0</p>
<p><strong>Always followed by:</strong>
* <code>fit</code> estimated marginal mean
* <code>se</code> standard error for the marginal mean
* <code>lower</code> lower end of the 95% confidence interval around the estimated marginal mean
* <code>upper</code> upper end of the 95% confidence interval around the estimated marginal mean</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;extrav&quot;</span>, <span class="st">&quot;texp&quot;</span>),</span>
<span id="cb121-2"><a href="#cb121-2"></a>                <span class="dt">mod =</span> pop_lmer_<span class="dv">2</span>_re) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb121-3"><a href="#cb121-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb121-4"><a href="#cb121-4"></a><span class="st">  </span><span class="kw">head</span>(<span class="dt">n =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>    sex extrav texp          fit        se      lower     upper
1   boy      1  2.0 -0.003090894 0.2113412 -0.4175635 0.4113817
2  girl      1  2.0  1.237606960 0.2138275  0.8182583 1.6569556
3   boy      3  2.0  1.505152972 0.1580311  1.1952296 1.8150763
4  girl      3  2.0  2.745850827 0.1602411  2.4315933 3.0601083
5   boy      6  2.0  3.767518772 0.1201240  3.5319371 4.0031004
6  girl      6  2.0  5.008216627 0.1208411  4.7712286 5.2452046
7   boy      8  2.0  5.275762639 0.1416414  4.9979820 5.5535433
8  girl      8  2.0  6.516460494 0.1410013  6.2399352 6.7929857
9   boy     10  2.0  6.784006506 0.1892732  6.4128127 7.1552003
10 girl     10  2.0  8.024704360 0.1878555  7.6562909 8.3931179
11  boy      1  7.8  1.165430181 0.1405323  0.8898247 1.4410356
12 girl      1  7.8  2.406128036 0.1432174  2.1252567 2.6869993</code></pre>
<p>Pick ‘nicer’ illustrative values for <code>texp</code></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;extrav&quot;</span>, <span class="st">&quot;texp&quot;</span>),</span>
<span id="cb123-2"><a href="#cb123-2"></a>                <span class="dt">mod =</span> pop_lmer_<span class="dv">2</span>_re,</span>
<span id="cb123-3"><a href="#cb123-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">texp =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">25</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb123-4"><a href="#cb123-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb123-5"><a href="#cb123-5"></a><span class="st">  </span><span class="kw">head</span>(<span class="dt">n =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>    sex extrav texp       fit         se    lower     upper
1   boy      1    5 0.6013166 0.17311622 0.261809 0.9408241
2  girl      1    5 1.8420144 0.17570895 1.497422 2.1866067
3   boy      3    5 1.9611918 0.12950715 1.707208 2.2151752
4  girl      3    5 3.2018897 0.13175620 2.943495 3.4602838
5   boy      6    5 4.0010047 0.09856839 3.807697 4.1943124
6  girl      6    5 5.2417025 0.09913677 5.047280 5.4361250
7   boy      8    5 5.3608799 0.11620822 5.132978 5.5887821
8  girl      8    5 6.6015778 0.11532522 6.375407 6.8277483
9   boy     10    5 6.7207552 0.15520075 6.416383 7.0251277
10 girl     10    5 7.9614530 0.15351226 7.660392 8.2625142
11  boy      1   15 2.6160081 0.09471133 2.430265 2.8017516
12 girl      1   15 3.8567059 0.09677625 3.666913 4.0464990</code></pre>
<p><strong>Basic, default plot</strong></p>
<p>Other than selecting three illustrative values for the teacher extroversion rating, most everything is left to default.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;extrav&quot;</span>, <span class="st">&quot;texp&quot;</span>),</span>
<span id="cb125-2"><a href="#cb125-2"></a>                <span class="dt">mod =</span> pop_lmer_<span class="dv">2</span>_re,</span>
<span id="cb125-3"><a href="#cb125-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">texp =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">25</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb125-4"><a href="#cb125-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb125-5"><a href="#cb125-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">texp =</span> <span class="kw">factor</span>(texp)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb125-6"><a href="#cb125-6"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb125-7"><a href="#cb125-7"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb125-8"><a href="#cb125-8"></a>      <span class="dt">y =</span> fit,</span>
<span id="cb125-9"><a href="#cb125-9"></a>      <span class="dt">fill =</span> texp,</span>
<span id="cb125-10"><a href="#cb125-10"></a>      <span class="dt">linetype =</span> texp) <span class="op">+</span></span>
<span id="cb125-11"><a href="#cb125-11"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,</span>
<span id="cb125-12"><a href="#cb125-12"></a>                  <span class="dt">ymax =</span> upper),</span>
<span id="cb125-13"><a href="#cb125-13"></a>              <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb125-14"><a href="#cb125-14"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> texp)) <span class="op">+</span></span>
<span id="cb125-15"><a href="#cb125-15"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>sex) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-118-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>More Clean Plot</strong></p>
<p>There are many ways to clean up a plot, including labeling the axes.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;extrav&quot;</span>, <span class="st">&quot;texp&quot;</span>),</span>
<span id="cb126-2"><a href="#cb126-2"></a>                <span class="dt">mod =</span> pop_lmer_<span class="dv">2</span>_re,</span>
<span id="cb126-3"><a href="#cb126-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">texp =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">25</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb126-4"><a href="#cb126-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb126-5"><a href="#cb126-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">texp =</span> <span class="kw">factor</span>(texp)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb126-6"><a href="#cb126-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sex =</span> sex <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb126-7"><a href="#cb126-7"></a><span class="st">                  </span>forcats<span class="op">::</span><span class="kw">fct_recode</span>(<span class="st">&quot;Amoung Boys&quot;</span> =<span class="st"> &quot;boy&quot;</span>,</span>
<span id="cb126-8"><a href="#cb126-8"></a>                                      <span class="st">&quot;Among Girls&quot;</span> =<span class="st"> &quot;girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb126-9"><a href="#cb126-9"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb126-10"><a href="#cb126-10"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb126-11"><a href="#cb126-11"></a>      <span class="dt">y =</span> fit,</span>
<span id="cb126-12"><a href="#cb126-12"></a>      <span class="dt">fill =</span> texp,</span>
<span id="cb126-13"><a href="#cb126-13"></a>      <span class="dt">linetype =</span> texp) <span class="op">+</span></span>
<span id="cb126-14"><a href="#cb126-14"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,</span>
<span id="cb126-15"><a href="#cb126-15"></a>                  <span class="dt">ymax =</span> upper),</span>
<span id="cb126-16"><a href="#cb126-16"></a>              <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb126-17"><a href="#cb126-17"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> texp)) <span class="op">+</span></span>
<span id="cb126-18"><a href="#cb126-18"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb126-19"><a href="#cb126-19"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>sex) <span class="op">+</span></span>
<span id="cb126-20"><a href="#cb126-20"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Pupil&#39;s Extroversion, Rated by Teacher&quot;</span>,</span>
<span id="cb126-21"><a href="#cb126-21"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Pupil Popularity, Mean Rating of Classroom Peers&quot;</span>,</span>
<span id="cb126-22"><a href="#cb126-22"></a>       <span class="dt">color    =</span> <span class="st">&quot;Teacher&#39;s Experience, Years&quot;</span>,</span>
<span id="cb126-23"><a href="#cb126-23"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Teacher&#39;s Experience, Years&quot;</span>,</span>
<span id="cb126-24"><a href="#cb126-24"></a>       <span class="dt">fill     =</span> <span class="st">&quot;Teacher&#39;s Experience, Years&quot;</span>) <span class="op">+</span></span>
<span id="cb126-25"><a href="#cb126-25"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span></span>
<span id="cb126-26"><a href="#cb126-26"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-119-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Publishable Plot</strong></p>
<p>Since <code>gender</code> only exhibited a main effect and is not involved in any interactions, if would be a better use of space to not muddy the water with seperate panels. The <code>Effect()</code> function will estimate the marginal means using the reference category for categorical variables and the mean for continuous variables.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;extrav&quot;</span>, <span class="st">&quot;texp&quot;</span>),  <span class="co"># choose not to investigate sex (the reference category will be used)</span></span>
<span id="cb127-2"><a href="#cb127-2"></a>                <span class="dt">mod =</span> pop_lmer_<span class="dv">2</span>_re,</span>
<span id="cb127-3"><a href="#cb127-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">texp =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">25</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb127-4"><a href="#cb127-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb127-5"><a href="#cb127-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">texp =</span> <span class="kw">factor</span>(texp) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb127-6"><a href="#cb127-6"></a><span class="st">                  </span>forcats<span class="op">::</span><span class="kw">fct_rev</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb127-7"><a href="#cb127-7"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb127-8"><a href="#cb127-8"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb127-9"><a href="#cb127-9"></a>      <span class="dt">y =</span> fit,</span>
<span id="cb127-10"><a href="#cb127-10"></a>      <span class="dt">linetype =</span> texp) <span class="op">+</span></span>
<span id="cb127-11"><a href="#cb127-11"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,</span>
<span id="cb127-12"><a href="#cb127-12"></a>                  <span class="dt">ymax =</span> upper),</span>
<span id="cb127-13"><a href="#cb127-13"></a>              <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb127-14"><a href="#cb127-14"></a>              <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb127-15"><a href="#cb127-15"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb127-16"><a href="#cb127-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb127-17"><a href="#cb127-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Pupil&#39;s Extroversion, Rated by Teacher&quot;</span>,</span>
<span id="cb127-18"><a href="#cb127-18"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Pupil Popularity, Mean Rating of Classroom Peers&quot;</span>,</span>
<span id="cb127-19"><a href="#cb127-19"></a>       <span class="dt">color    =</span> <span class="st">&quot;Teacher&#39;s</span><span class="ch">\n</span><span class="st">Experience,</span><span class="ch">\n</span><span class="st">Years&quot;</span>,</span>
<span id="cb127-20"><a href="#cb127-20"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Teacher&#39;s</span><span class="ch">\n</span><span class="st">Experience,</span><span class="ch">\n</span><span class="st">Years&quot;</span>,</span>
<span id="cb127-21"><a href="#cb127-21"></a>       <span class="dt">alpha    =</span> <span class="st">&quot;Teacher&#39;s</span><span class="ch">\n</span><span class="st">Experience,</span><span class="ch">\n</span><span class="st">Years&quot;</span>) <span class="op">+</span></span>
<span id="cb127-22"><a href="#cb127-22"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb127-23"><a href="#cb127-23"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;Black&quot;</span>),</span>
<span id="cb127-24"><a href="#cb127-24"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb127-25"><a href="#cb127-25"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">-0.1</span>)) <span class="op">+</span></span>
<span id="cb127-26"><a href="#cb127-26"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>)) <span class="op">+</span></span>
<span id="cb127-27"><a href="#cb127-27"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb127-28"><a href="#cb127-28"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>))  </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-120-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="interpretation-5" class="section level4" number="4.4.6.5">
<h4 number="4.4.6.5"><span class="header-section-number">4.4.6.5</span> Interpretation</h4>
<p>Form more infromation, see the <a href="https://goodekat.github.io/redres/articles/redres-vignette.html">vingette page for the <code>redre</code> package</a>.</p>
<p>After accounting for class-to-class variation and the effect of gender, a positive association was found between teacher rated extroversion and peer rated popularity. This relationship was more marked for less experienced teachers.</p>
</div>
</div>
<div id="residual-plots" class="section level3" number="4.4.7">
<h3 number="4.4.7"><span class="header-section-number">4.4.7</span> Residual Plots</h3>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(pop_lmer_<span class="dv">2</span>_re,</span>
<span id="cb128-2"><a href="#cb128-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;diag&quot;</span>)</span></code></pre></div>
<pre><code>[[1]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-121-1.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>
[[2]]
[[2]]$class</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-121-2.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>

[[3]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-121-3.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>
[[4]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-121-4.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Standardized residuals vs. fitted values</strong></p>
<p>You always want to use <em>studentized, conditional</em> residuals for MLM!</p>
<p>As you look across the plot, left to right:</p>
<ul>
<li>GOOD = no pattern &amp; HOV</li>
<li>BAD = any pattern or change in the spread</li>
</ul>
<p>This plot looks great!</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>redres<span class="op">::</span><span class="kw">plot_redres</span>(pop_lmer_<span class="dv">2</span>_re, <span class="dt">type =</span> <span class="st">&quot;std_cond&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-122-1.png" width="576" style="display: block; margin: auto;" />
<strong>Standardized residuals vs. a predictor’s values</strong></p>
<p>You are looking for the same things as above. Note: the vertical stripes are fine, as they just reflect the fact that the <code>extrav</code> variable was a whole number value, ranging from one to ten.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>redres<span class="op">::</span><span class="kw">plot_redres</span>(pop_lmer_<span class="dv">2</span>_re, <span class="dt">type =</span> <span class="st">&quot;std_cond&quot;</span>, <span class="dt">xvar =</span> <span class="st">&quot;extrav&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-123-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Normal Quantile plot of Residuals</strong></p>
<p>As you look across the plot, along the diagonal:</p>
<ul>
<li>GOOD: roughly a straight line</li>
<li>BAD: curvature (S-shaped)</li>
</ul>
<p>This plot looks great! The slight flare at the far ends is not too drastic.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a>redres<span class="op">::</span><span class="kw">plot_resqq</span>(pop_lmer_<span class="dv">2</span>_re)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-124-1.png" width="576" style="display: block; margin: auto;" />
Our model had both random intercepts and random slopes (RIAS). The panel on the left is more the random intercepts and the right is of random slopes (for the <code>extrav</code> predictor).</p>
<p>You are looking for the same things as above…and these are not too bad!</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>redres<span class="op">::</span><span class="kw">plot_ranef</span>(pop_lmer_<span class="dv">2</span>_re)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-125-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>To explor more plots, you can use the <code>shiny</code> app by running the code below:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a>redres<span class="op">::</span><span class="kw">launch_redres</span>(pop_lmer_<span class="dv">2</span>_re)</span></code></pre></div>
<!--chapter:end:05-example_hox2_popular2.Rmd-->
</div>
</div>
</div>
<div id="mlm-3-levels-nurses-stress-intervention" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> MLM, 3 levels: Nurse’s Stress Intervention</h1>
<p><img src="images/header_hox_nurses.PNG" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># basically everything ;)</span></span>
<span id="cb138-2"><a href="#cb138-2"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span>
<span id="cb138-3"><a href="#cb138-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb138-4"><a href="#cb138-4"></a><span class="kw">library</span>(stargazer)    <span class="co"># display nice tables: summary &amp; regression</span></span>
<span id="cb138-5"><a href="#cb138-5"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb138-6"><a href="#cb138-6"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb138-7"><a href="#cb138-7"></a><span class="kw">library</span>(car)          <span class="co"># Companion to Applied Regression</span></span>
<span id="cb138-8"><a href="#cb138-8"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb138-9"><a href="#cb138-9"></a><span class="kw">library</span>(lmerTest)     <span class="co"># Tests on lmer objects</span></span>
<span id="cb138-10"><a href="#cb138-10"></a><span class="kw">library</span>(performance)  <span class="co"># ICC calculations</span></span>
<span id="cb138-11"><a href="#cb138-11"></a><span class="kw">library</span>(interactions) <span class="co"># plotting interactions</span></span>
<span id="cb138-12"><a href="#cb138-12"></a><span class="kw">library</span>(effects)      <span class="co"># Effects for regression models</span></span>
<span id="cb138-13"><a href="#cb138-13"></a><span class="kw">library</span>(optimx)       <span class="co"># Different optimizers to solve mlm&#39;s</span></span></code></pre></div>
<!-- ========================================================= -->
<div id="background-1" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Background</h2>
<!-- ========================================================= -->
<div class="rmdlink">
<p>
The text <strong>“Multilevel Analysis: Techniques and Applications, Third Edition”</strong> <span class="citation"><span class="citation">(Hox, Moerbeek, and Van de Schoot <a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></span> has a companion <a href="https://multilevel-analysis.sites.uu.nl/">website</a> which includes links to all the data files used throughout the book (housed on the <a href="https://github.com/MultiLevelAnalysis">book’s GitHub repository</a>).
</p>
</div>
<p>The following example is used through out <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>’s chapater 2.</p>
<blockquote>
<p>From <strong>Appendix E</strong>:</p>
<p>The <strong>nurses.sav</strong> file contains three-level simulated data from a hypothetical study on stress in hospitals. The data are from nurses working in wards nested within hospitals. It is a cluster-randomized experiment. In each of <strong>25</strong> hospitals, <strong>four wards</strong> are selected and randomly assigned to an experimental and a control condition. In the experimental condition, a training program is offered to all nurses to cope with job-related stress. After the program is completed, a sample of about 10 nurses from each ward is given a test that measures job-related stress. Additional variables <em>(covariates)</em> are: nurse age (years), nurse experience (years), nurse gender (0=male, 1 = female), type of ward (0=general care, 1=special care), and hospital size (0=small, 1 = medium, 2=large). The data have been generated to illustrate three-level analysis with a random slope for the effect of the intervention.</p>
</blockquote>
<p><img src="images/diagram_hox_nurses.PNG" /></p>
<p>Here the data is read in and the SPSS variables with labels are converted to <span class="math inline">\(R\)</span> factors.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a>data_raw &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_spss</span>(<span class="st">&quot;https://github.com/MultiLevelAnalysis/Datasets-third-edition-Multilevel-book/raw/master/chapter%202/Nurses/SPSS/Nurses.sav&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="st">  </span>haven<span class="op">::</span><span class="kw">as_factor</span>()             <span class="co"># retain the labels from SPSS --&gt; factor</span></span></code></pre></div>
<div id="unique-identifiers-1" class="section level3" number="5.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> Unique Identifiers</h3>
<p>All standardized <em>(starts with “Z”)</em> and mean centered <em>(starts with “C”)</em> variables will be remove so that their creation may be shown later. A new indicator varible for nurses with be created by combining the <code>hospital</code>, <code>ward</code>, and <code>nurse</code> indicators. Having a unique, distinct identifier variable for each of the units on lower (Level 1 and 2) levels is helpful for multilevel anlayses.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a>data_nurse &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">genderF =</span> <span class="kw">factor</span>(gender, </span>
<span id="cb140-3"><a href="#cb140-3"></a>                                 <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># apply factor labels</span></span>
<span id="cb140-4"><a href="#cb140-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">paste</span>(hospital, ward, nurse,</span>
<span id="cb140-5"><a href="#cb140-5"></a>                           <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st">                                   </span><span class="co"># unique id for each nurse</span></span>
<span id="cb140-6"><a href="#cb140-6"></a><span class="st">                  </span><span class="kw">factor</span>()) <span class="op">%&gt;%</span><span class="st">                                             </span><span class="co"># declare id is a factor</span></span>
<span id="cb140-7"><a href="#cb140-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(hospital, ward, </span>
<span id="cb140-8"><a href="#cb140-8"></a>                        wardid, nurse), factor) <span class="op">%&gt;%</span><span class="st">                         </span><span class="co"># declare to be factors</span></span>
<span id="cb140-9"><a href="#cb140-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age =</span> age <span class="op">%&gt;%</span><span class="st"> </span>as.character <span class="op">%&gt;%</span><span class="st"> </span>as.numeric) <span class="op">%&gt;%</span><span class="st">              </span><span class="co"># declare to be numeric</span></span>
<span id="cb140-10"><a href="#cb140-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, wardid, nurse, ward, hospital,</span>
<span id="cb140-11"><a href="#cb140-11"></a>                age, gender, genderF, experien, </span>
<span id="cb140-12"><a href="#cb140-12"></a>                wardtype, hospsize,</span>
<span id="cb140-13"><a href="#cb140-13"></a>                expcon, stress)                                             <span class="co"># reduce variables included</span></span>
<span id="cb140-14"><a href="#cb140-14"></a></span>
<span id="cb140-15"><a href="#cb140-15"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(data_nurse)</span></code></pre></div>
<pre><code>Rows: 1,000
Columns: 13
$ id       &lt;fct&gt; 1_1_1, 1_1_2, 1_1_3, 1_1_4, 1_1_5, 1_1_6, 1_1_7, 1_1_8, 1_...
$ wardid   &lt;fct&gt; 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12...
$ nurse    &lt;fct&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,...
$ ward     &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3...
$ hospital &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
$ age      &lt;dbl&gt; 36, 45, 32, 57, 46, 60, 23, 32, 60, 45, 57, 47, 32, 42, 42...
$ gender   &lt;dbl&gt; 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0...
$ genderF  &lt;fct&gt; Male, Male, Male, Female, Female, Female, Female, Female, ...
$ experien &lt;dbl&gt; 11, 20, 7, 25, 22, 22, 13, 13, 17, 21, 24, 24, 14, 13, 17,...
$ wardtype &lt;fct&gt; general care, general care, general care, general care, ge...
$ hospsize &lt;fct&gt; large, large, large, large, large, large, large, large, la...
$ expcon   &lt;fct&gt; experiment, experiment, experiment, experiment, experiment...
$ stress   &lt;dbl&gt; 7, 7, 7, 6, 6, 6, 6, 7, 7, 6, 6, 6, 6, 6, 6, 5, 5, 6, 5, 5...</code></pre>
</div>
<div id="centering-variables" class="section level3" number="5.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> Centering Variables</h3>
<div class="rmdlightbulb">
<p>
When variables are involved in an interaction, it may be advantageous to center the variables. <span class="citation"><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></span> covers this in chapter 4.
</p>
</div>
<p>To center categorical variables:<br />
1. Convert then to integers, starting with zero: <span class="math inline">\(0, 1, \dots\)</span><br />
2. Subtract the mean</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a>data_nurse <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb142-2"><a href="#cb142-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">expconN    =</span> <span class="kw">as.numeric</span>(expcon)   <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Numeric Version of experimental condition</span></span>
<span id="cb142-3"><a href="#cb142-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">hospsizeN  =</span> <span class="kw">as.numeric</span>(hospsize) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Numeric Version of hospital size</span></span>
<span id="cb142-4"><a href="#cb142-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(expcon, expconN, hospsize, hospsizeN) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb142-5"><a href="#cb142-5"></a><span class="st">  </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>        expcon       expconN        hospsize     hospsizeN    
 control   :496   Min.   :0.000   small :374   Min.   :0.000  
 experiment:504   1st Qu.:0.000   medium:476   1st Qu.:0.000  
                  Median :1.000   large :150   Median :1.000  
                  Mean   :0.504                Mean   :0.776  
                  3rd Qu.:1.000                3rd Qu.:1.000  
                  Max.   :1.000                Max.   :2.000  </code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a>data_nurse &lt;-<span class="st"> </span>data_nurse <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb144-2"><a href="#cb144-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">expconN    =</span> <span class="kw">as.numeric</span>(expcon)   <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Numeric Version of experimental condition</span></span>
<span id="cb144-3"><a href="#cb144-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">hospsizeN  =</span> <span class="kw">as.numeric</span>(hospsize) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Numeric Version of hospital size</span></span>
<span id="cb144-4"><a href="#cb144-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">expconNG   =</span> expconN   <span class="op">-</span><span class="st"> </span><span class="fl">0.504</span>) <span class="op">%&gt;%</span><span class="st">         </span><span class="co"># Grand-Mean Centered version of experimental condition</span></span>
<span id="cb144-5"><a href="#cb144-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">hospsizeNG =</span> hospsizeN <span class="op">-</span><span class="st"> </span><span class="fl">0.776</span>)             <span class="co"># Grand-Mean Centered version of ehospital size</span></span></code></pre></div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>data_nurse <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb145-2"><a href="#cb145-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(expcon, expconNG) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb145-3"><a href="#cb145-3"></a><span class="st">  </span><span class="kw">table</span>()</span></code></pre></div>
<pre><code>            expconNG
expcon       -0.504 0.496
  control       496     0
  experiment      0   504</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a>data_nurse <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb147-2"><a href="#cb147-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(hospsize, hospsizeNG) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb147-3"><a href="#cb147-3"></a><span class="st">  </span><span class="kw">table</span>()</span></code></pre></div>
<pre><code>        hospsizeNG
hospsize -0.776 0.224 1.224
  small     374     0     0
  medium      0   476     0
  large       0     0   150</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-1" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Exploratory Data Analysis</h2>
<div id="summarize-descriptive-statistics-1" class="section level3" number="5.2.1">
<h3 number="5.2.1"><span class="header-section-number">5.2.1</span> Summarize Descriptive Statistics</h3>
<div id="the-stargazer-package-1" class="section level4" number="5.2.1.1">
<h4 number="5.2.1.1"><span class="header-section-number">5.2.1.1</span> The <code>stargazer</code> package</h4>
<p>Most posters, journal articles, and reports start with a table of descriptive statistics. Since it tends to come first, this type of table is often refered to as <em>Table 1</em>. The <code>stargazer()</code> function can be used to create such a table, but only for the entire dataset <span class="citation">(Hlavac <a href="#ref-R-stargazer" role="doc-biblioref">2018</a>)</span>. I haven’t been able to find a way to get it to summarize subsamples and compare them in the standard format.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="co"># Knit to Website: type = &quot;html&quot; </span></span>
<span id="cb149-2"><a href="#cb149-2"></a><span class="co"># Knit to PDF:     type = &quot;latex&quot;</span></span>
<span id="cb149-3"><a href="#cb149-3"></a><span class="co"># View on Screen:  type = &quot;text&quot;</span></span>
<span id="cb149-4"><a href="#cb149-4"></a></span>
<span id="cb149-5"><a href="#cb149-5"></a>data_nurse <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb149-6"><a href="#cb149-6"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb149-7"><a href="#cb149-7"></a><span class="st">  </span>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="dt">title  =</span> <span class="st">&quot;Descriptive statistics, aggregate over entire sample&quot;</span>,</span>
<span id="cb149-8"><a href="#cb149-8"></a>                       <span class="dt">header =</span> <span class="ot">FALSE</span>,</span>
<span id="cb149-9"><a href="#cb149-9"></a>                       <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Descriptive statistics, aggregate over entire sample</strong>
</caption>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
age
</td>
<td>
1,000
</td>
<td>
43.005
</td>
<td>
12.042
</td>
<td>
23
</td>
<td>
33
</td>
<td>
53
</td>
<td>
64
</td>
</tr>
<tr>
<td style="text-align:left">
gender
</td>
<td>
1,000
</td>
<td>
0.735
</td>
<td>
0.442
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
</tr>
<tr>
<td style="text-align:left">
experien
</td>
<td>
1,000
</td>
<td>
17.057
</td>
<td>
6.042
</td>
<td>
1
</td>
<td>
13
</td>
<td>
21
</td>
<td>
38
</td>
</tr>
<tr>
<td style="text-align:left">
stress
</td>
<td>
1,000
</td>
<td>
4.977
</td>
<td>
0.980
</td>
<td>
1
</td>
<td>
4
</td>
<td>
6
</td>
<td>
7
</td>
</tr>
<tr>
<td style="text-align:left">
expconN
</td>
<td>
1,000
</td>
<td>
0.504
</td>
<td>
0.500
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
</tr>
<tr>
<td style="text-align:left">
hospsizeN
</td>
<td>
1,000
</td>
<td>
0.776
</td>
<td>
0.689
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
2
</td>
</tr>
<tr>
<td style="text-align:left">
expconNG
</td>
<td>
1,000
</td>
<td>
-0.000
</td>
<td>
0.500
</td>
<td>
-0.504
</td>
<td>
-0.504
</td>
<td>
0.496
</td>
<td>
0.496
</td>
</tr>
<tr>
<td style="text-align:left">
hospsizeNG
</td>
<td>
1,000
</td>
<td>
-0.000
</td>
<td>
0.689
</td>
<td>
-0.776
</td>
<td>
-0.776
</td>
<td>
0.224
</td>
<td>
1.224
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
<div id="the-furniture-package-1" class="section level4" number="5.2.1.2">
<h4 number="5.2.1.2"><span class="header-section-number">5.2.1.2</span> The <code>furniture</code> package</h4>
<p>Tyson Barrett’s <strong>furniture</strong> package includes the extremely useful function <code>table1()</code> which simplifies the common task of creating a stratified, comparative table of descriptive statistics. Full documentation can be accessed by executing <code>?furniture::table1</code>.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a><span class="co"># Knit to Website: output = &quot;html&quot; </span></span>
<span id="cb150-2"><a href="#cb150-2"></a><span class="co"># Knit to PDF:     output = &quot;latex2&quot;</span></span>
<span id="cb150-3"><a href="#cb150-3"></a><span class="co"># View on Screen:  output = &quot;&quot;text&quot;, or &quot;markdown&quot;, &quot;html&quot;</span></span>
<span id="cb150-4"><a href="#cb150-4"></a></span>
<span id="cb150-5"><a href="#cb150-5"></a>data_nurse <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb150-6"><a href="#cb150-6"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(age, genderF, experien, wardtype, hospsize, hospsizeN, hospsizeNG,</span>
<span id="cb150-7"><a href="#cb150-7"></a>                    <span class="dt">splitby    =</span> <span class="op">~</span><span class="st"> </span>expcon,                                              <span class="co"># var to divide sample by</span></span>
<span id="cb150-8"><a href="#cb150-8"></a>                    <span class="dt">test       =</span> <span class="ot">TRUE</span>,                                                  <span class="co"># test groups different?</span></span>
<span id="cb150-9"><a href="#cb150-9"></a>                    <span class="dt">type       =</span> <span class="st">&quot;full&quot;</span>,                                                <span class="co"># give the test statistic</span></span>
<span id="cb150-10"><a href="#cb150-10"></a>                    <span class="dt">output     =</span> <span class="st">&quot;text&quot;</span>,                                                <span class="co"># output for html</span></span>
<span id="cb150-11"><a href="#cb150-11"></a>                    <span class="dt">caption    =</span> <span class="st">&quot;Compare Intervention groups on five main variables&quot;</span>)  <span class="co"># title</span></span></code></pre></div>
<table>
<caption>
(#tab:unnamed-chunk-141)Compare Intervention groups on five main variables
</caption>
<thead>
<tr>
<th>
</th>
<th>
control
</th>
<th>
experiment
</th>
<th>
Test
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 496
</td>
<td>
n = 504
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
age
</td>
<td>
</td>
<td>
</td>
<td>
T-Test: 0.82
</td>
<td>
0.411
</td>
</tr>
<tr>
<td>
</td>
<td>
43.3 (11.6)
</td>
<td>
42.7 (12.5)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
genderF
</td>
<td>
</td>
<td>
</td>
<td>
Chi Square: 0.19
</td>
<td>
0.661
</td>
</tr>
<tr>
<td>
Male
</td>
<td>
135 (27.2%)
</td>
<td>
130 (25.8%)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
Female
</td>
<td>
361 (72.8%)
</td>
<td>
374 (74.2%)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
experien
</td>
<td>
</td>
<td>
</td>
<td>
T-Test: 0.69
</td>
<td>
0.492
</td>
</tr>
<tr>
<td>
</td>
<td>
17.2 (5.8)
</td>
<td>
16.9 (6.3)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
wardtype
</td>
<td>
</td>
<td>
</td>
<td>
Chi Square: 0
</td>
<td>
1
</td>
</tr>
<tr>
<td>
general care
</td>
<td>
247 (49.8%)
</td>
<td>
252 (50%)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
special care
</td>
<td>
249 (50.2%)
</td>
<td>
252 (50%)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
hospsize
</td>
<td>
</td>
<td>
</td>
<td>
Chi Square: 0.01
</td>
<td>
0.993
</td>
</tr>
<tr>
<td>
small
</td>
<td>
185 (37.3%)
</td>
<td>
189 (37.5%)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
medium
</td>
<td>
237 (47.8%)
</td>
<td>
239 (47.4%)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
large
</td>
<td>
74 (14.9%)
</td>
<td>
76 (15.1%)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
hospsizeN
</td>
<td>
</td>
<td>
</td>
<td>
T-Test: 0.01
</td>
<td>
0.992
</td>
</tr>
<tr>
<td>
</td>
<td>
0.8 (0.7)
</td>
<td>
0.8 (0.7)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
hospsizeNG
</td>
<td>
</td>
<td>
</td>
<td>
T-Test: 0.01
</td>
<td>
0.992
</td>
</tr>
<tr>
<td>
</td>
<td>
0.0 (0.7)
</td>
<td>
-0.0 (0.7)
</td>
<td>
</td>
<td>
</td>
</tr>
</tbody>
</table>
<div class="rmdlightbulb">
<p>
The t-test performed by the <code>furniture::table1()</code> function will always assume indepent groups and that HOV is not violated. This may or may not be appropriate.
</p>
</div>
<!-- ========================================================= -->
</div>
</div>
</div>
<div id="mlm-null-model" class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> MLM: Null Model</h2>
<!-- ========================================================= -->
<blockquote>
<p>In a Null, intercept-only, or Empty model, no predictors are included.</p>
</blockquote>
<div id="fit-the-model-4" class="section level4" number="5.3.0.1">
<h4 number="5.3.0.1"><span class="header-section-number">5.3.0.1</span> Fit the Model</h4>
<p>Fit the model to the data, with both ML and REML.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>nurse_lmer_<span class="dv">0</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st">              </span><span class="co"># Fixed Intercept for all nurses</span></span>
<span id="cb151-2"><a href="#cb151-2"></a><span class="st">                                    </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward),      <span class="co"># Random Intercepts for wards within hospitals</span></span>
<span id="cb151-3"><a href="#cb151-3"></a>                                  <span class="dt">data =</span> data_nurse,</span>
<span id="cb151-4"><a href="#cb151-4"></a>                                  <span class="dt">REML =</span> <span class="ot">TRUE</span>)              <span class="co"># fit via REML (the default) for ICC calculations</span></span>
<span id="cb151-5"><a href="#cb151-5"></a></span>
<span id="cb151-6"><a href="#cb151-6"></a>nurse_lmer_<span class="dv">0</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st">              </span><span class="co"># Fixed Intercept for all nurses</span></span>
<span id="cb151-7"><a href="#cb151-7"></a><span class="st">                                    </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward),      <span class="co"># Random Intercepts for wards within hospitals </span></span>
<span id="cb151-8"><a href="#cb151-8"></a>                                  <span class="dt">data =</span> data_nurse,</span>
<span id="cb151-9"><a href="#cb151-9"></a>                                  <span class="dt">REML =</span> <span class="ot">FALSE</span>)             <span class="co"># fit via ML for comparing FIXED effects inclusion</span></span></code></pre></div>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_<span class="dv">0</span>_ml, </span>
<span id="cb152-2"><a href="#cb152-2"></a>                     nurse_lmer_<span class="dv">0</span>_re),</span>
<span id="cb152-3"><a href="#cb152-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M0: Null, ML&quot;</span>, </span>
<span id="cb152-4"><a href="#cb152-4"></a>                                       <span class="st">&quot;M0: Null, REML&quot;</span>),</span>
<span id="cb152-5"><a href="#cb152-5"></a>                <span class="dt">caption            =</span> <span class="st">&quot;NULL Model: different estimation methods&quot;</span>,</span>
<span id="cb152-6"><a href="#cb152-6"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb152-7"><a href="#cb152-7"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
NULL Model: different estimation methods
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M0: Null, ML
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M0: Null, REML
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.00 (0.11)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.00 (0.11)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1950.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1952.95
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1969.99
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1972.58
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-971.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-972.48
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward:hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.17
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.30
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<!-- ========================================================= -->
</div>
</div>
<div id="estimate-the-icc" class="section level2" number="5.4">
<h2 number="5.4"><span class="header-section-number">5.4</span> Estimate the ICC</h2>
<!-- ========================================================= -->
<p>The ICC is calculated by dividing the between-group-variance (random intercept variance) by the total variance (i.e. sum of between-group-variance and within-group (residual) variance).</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(nurse_lmer_<span class="dv">0</span>_re) </span></code></pre></div>
<pre><code> Groups        Name        Std.Dev.
 ward:hospital (Intercept) 0.69916 
 hospital      (Intercept) 0.41749 
 Residual                  0.54887 </code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(nurse_lmer_<span class="dv">0</span>_re) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb155-2"><a href="#cb155-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),</span>
<span id="cb155-3"><a href="#cb155-3"></a>        <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code> Groups        Name        Variance Std.Dev.
 ward:hospital (Intercept) 0.489    0.699   
 hospital      (Intercept) 0.174    0.417   
 Residual                  0.301    0.549   </code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a>vc &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">VarCorr</span>(nurse_lmer_<span class="dv">0</span>_re) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb157-2"><a href="#cb157-2"></a><span class="st">  </span><span class="kw">data.frame</span>() </span>
<span id="cb157-3"><a href="#cb157-3"></a></span>
<span id="cb157-4"><a href="#cb157-4"></a><span class="kw">pie</span>(<span class="dt">x =</span> vc<span class="op">$</span>vcov,</span>
<span id="cb157-5"><a href="#cb157-5"></a>    <span class="dt">labels =</span> vc<span class="op">$</span>grp)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-147-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The <code>performance</code> package has a few really helpful funcitons:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(nurse_lmer_<span class="dv">0</span>_re)</span></code></pre></div>
<pre><code> Groups        Name        Std.Dev.
 ward:hospital (Intercept) 0.69916 
 hospital      (Intercept) 0.41749 
 Residual                  0.54887 </code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a>insight<span class="op">::</span><span class="kw">get_variance</span>(nurse_lmer_<span class="dv">0</span>_re)</span></code></pre></div>
<pre><code>$var.fixed
[1] 0

$var.random
[1] 0.6631239

$var.residual
[1] 0.3012569

$var.distribution
[1] 0.3012569

$var.dispersion
[1] 0

$var.intercept
ward:hospital      hospital 
    0.4888231     0.1743008 </code></pre>
<p><span class="math display">\[
\begin{align*}
\text{hospitals}                                 \rightarrow \; &amp; \sigma^2_{v0} = 0.417^2 = 0.174\\
\text{wards within hospitals}                    \rightarrow \; &amp; \sigma^2_{u0} = 0.699^2 = 0.489\\
\text{nurses within wards within hospitals}      \rightarrow \; &amp; \sigma^2_{e}  = 0.549^2 = 0.301\\
\end{align*}
\]</span></p>
<div class="genericEq">
<p>
<strong>Intraclass Correlation (ICC) Formula, 3 level model - Davis and Scott Method</strong> <span class="math display"><span class="math display">\[
\overbrace{\rho_{mid}}^{\text{ICC}\atop\text{at level 2}} = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random Intercept}\atop\text{Variance Level 2}}}
     {\underbrace{\sigma^2_{v0}+\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.16}
\]</span></span> <span class="math display"><span class="math display">\[
\overbrace{\rho_{top}}^{\text{ICC}\atop\text{ at level 3}} = 
\frac{\overbrace{\sigma^2_{v0}}^{\text{Random Intercept}\atop\text{Variance Level 3}}}
     {\underbrace{\sigma^2_{v0}+\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.17}
\]</span></span>
</p>
</div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1"></a><span class="fl">0.489</span> <span class="op">/</span><span class="st"> </span>(<span class="fl">0.174</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.489</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.301</span>) <span class="co"># middle level (wards)</span></span></code></pre></div>
<pre><code>[1] 0.5072614</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1"></a><span class="fl">0.174</span> <span class="op">/</span><span class="st"> </span>(<span class="fl">0.174</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.489</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.301</span>) <span class="co"># top level (hospitals)</span></span></code></pre></div>
<pre><code>[1] 0.1804979</code></pre>
<div class="rmdimportant">
<p>
For more than two levels, the ‘performance::icc()’ function computes ICC’s by the Davis and Scott method.
</p>
</div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a>performance<span class="op">::</span><span class="kw">icc</span>(nurse_lmer_<span class="dv">0</span>_re)</span></code></pre></div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.688
  Conditional ICC: 0.688</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a>performance<span class="op">::</span><span class="kw">icc</span>(nurse_lmer_<span class="dv">0</span>_re, <span class="dt">by_group =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># ICC by Group

Group         |   ICC
---------------------
ward:hospital | 0.507
hospital      | 0.181</code></pre>
<p>The proportion of variance in nurse stress level is 0.51 at the ward level and 0.18 at the hospital level, for a total of 0.69.</p>
<p>To test if the three level model is justified statistically, compare the null models with and without the nesting of wards in hospitals.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a>nurse_lmer_<span class="dv">0</span>_re_2level &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>wardid),  <span class="co"># each hospital contains several wards</span></span>
<span id="cb170-2"><a href="#cb170-2"></a>                                         <span class="dt">data =</span> data_nurse,</span>
<span id="cb170-3"><a href="#cb170-3"></a>                                         <span class="dt">REML =</span> <span class="ot">TRUE</span>)              <span class="co"># fit via REML (the default) for ICC calculations</span></span></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_<span class="dv">0</span>_re_2level, </span>
<span id="cb171-2"><a href="#cb171-2"></a>                     nurse_lmer_<span class="dv">0</span>_re),</span>
<span id="cb171-3"><a href="#cb171-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;2 levels&quot;</span>, </span>
<span id="cb171-4"><a href="#cb171-4"></a>                                       <span class="st">&quot;3 levels&quot;</span>),</span>
<span id="cb171-5"><a href="#cb171-5"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Two or Three Levels?&quot;</span>,</span>
<span id="cb171-6"><a href="#cb171-6"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb171-7"><a href="#cb171-7"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Two or Three Levels?
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
2 levels
</th>
<th style="padding-left: 5px;padding-right: 5px;">
3 levels
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.00 (0.08)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.00 (0.11)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1958.43
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1952.95
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1973.15
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1972.58
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-976.21
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-972.48
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: wardid
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: wardid (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.66
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.30
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward:hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.17
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>The deviance test or likelihood-ratio test shows that the inclusion of the nesting of wards within hospitals better explains the variance in nurse stress levels.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1"></a><span class="kw">anova</span>(nurse_lmer_<span class="dv">0</span>_re, nurse_lmer_<span class="dv">0</span>_re_2level, </span>
<span id="cb172-2"><a href="#cb172-2"></a>      <span class="dt">refit =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>Data: data_nurse
Models:
nurse_lmer_0_re_2level: stress ~ 1 + (1 | wardid)
nurse_lmer_0_re: stress ~ 1 + (1 | hospital/ward)
                       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
nurse_lmer_0_re_2level    3 1958.4 1973.2 -976.21   1952.4                     
nurse_lmer_0_re           4 1953.0 1972.6 -972.48   1945.0 7.4738  1    0.00626
                         
nurse_lmer_0_re_2level   
nurse_lmer_0_re        **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<!-- ========================================================= -->
</div>
<div id="mlm-add-fixed-effects" class="section level2" number="5.5">
<h2 number="5.5"><span class="header-section-number">5.5</span> MLM: Add Fixed Effects</h2>
<!-- ========================================================= -->
<div id="fit-the-model-5" class="section level3" number="5.5.1">
<h3 number="5.5.1"><span class="header-section-number">5.5.1</span> Fit the Model</h3>
<blockquote>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>, page 22:</p>
<p>“In this example, the variable <code>expcon</code> is of main interest, and the other variables are covariates. Their funciton is to control for differences between the groups, which can occur even if randomization is used, especially with small samples, and to explain variance in the outcome variable stress. To the extent that these variables successfully explain the variance, the power of the test for the effect of <code>expcon</code> will be increased.”</p>
</blockquote>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a>nurse_lmer_<span class="dv">1</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expcon <span class="op">+</span><span class="st">             </span><span class="co"># experimental condition = CATEGORICAL FACTOR</span></span>
<span id="cb174-2"><a href="#cb174-2"></a><span class="st">                                    </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">   </span><span class="co"># level 1 covariates</span></span>
<span id="cb174-3"><a href="#cb174-3"></a><span class="st">                                    </span>wardtype <span class="op">+</span><span class="st">                  </span><span class="co"># level 2 covariates</span></span>
<span id="cb174-4"><a href="#cb174-4"></a><span class="st">                                    </span>hospsize <span class="op">+</span><span class="st">                  </span><span class="co"># level 3 covariates, hospital size = CATEGORICAL FACTOR </span></span>
<span id="cb174-5"><a href="#cb174-5"></a><span class="st">                                    </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward),          <span class="co"># Random Intercepts for wards within hospitals</span></span>
<span id="cb174-6"><a href="#cb174-6"></a>                                  <span class="dt">data =</span> data_nurse,</span>
<span id="cb174-7"><a href="#cb174-7"></a>                                  <span class="dt">REML =</span> <span class="ot">FALSE</span>)                 <span class="co"># fit via ML for nested FIXED effects</span></span></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_<span class="dv">0</span>_ml, </span>
<span id="cb175-2"><a href="#cb175-2"></a>                     nurse_lmer_<span class="dv">1</span>_ml),</span>
<span id="cb175-3"><a href="#cb175-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M0: null&quot;</span>, </span>
<span id="cb175-4"><a href="#cb175-4"></a>                                       <span class="st">&quot;M1: fixed pred&quot;</span>),</span>
<span id="cb175-5"><a href="#cb175-5"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Nested Models: Fixed effects via ML&quot;</span>,</span>
<span id="cb175-6"><a href="#cb175-6"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb175-7"><a href="#cb175-7"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Nested Models: Fixed effects via ML
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M0: null
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1: fixed pred
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.00 (0.11)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.38 (0.18)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconexperiment
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gender
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
experien
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
wardtypespecial care
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizemedium
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.19)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizelarge
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90 (0.26)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1950.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1626.32
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1969.99
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1680.30
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-971.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-802.16
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward:hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.33
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="assess-significance" class="section level3" number="5.5.2">
<h3 number="5.5.2"><span class="header-section-number">5.5.2</span> Assess Significance</h3>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a><span class="kw">anova</span>(nurse_lmer_<span class="dv">0</span>_ml, nurse_lmer_<span class="dv">1</span>_ml)</span></code></pre></div>
<pre><code>Data: data_nurse
Models:
nurse_lmer_0_ml: stress ~ 1 + (1 | hospital/ward)
nurse_lmer_1_ml: stress ~ expcon + age + gender + experien + wardtype + hospsize + 
nurse_lmer_1_ml:     (1 | hospital/ward)
                npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
nurse_lmer_0_ml    4 1950.4 1970.0 -971.18   1942.4                         
nurse_lmer_1_ml   11 1626.3 1680.3 -802.16   1604.3 338.04  7  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>It is clear that the inclusing of these fixed, main effects improves the model’s fit, but it is questionable that the type of ward is significant <em>(Wald test is non-significant)</em>. Rather than test it directly, we will leave it in the model. This is common practice to show that an expected variable is not significant.</p>
</div>
<div id="centering-variables-1" class="section level3" number="5.5.3">
<h3 number="5.5.3"><span class="header-section-number">5.5.3</span> Centering Variables</h3>
<p>Because we will will find that the experimental condition is moderated by hospital size <em>(in other words there is a significant interaction between <code>expcon</code> and <code>hospsize</code>)</em>, <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span> presents the models fit with centered values for these two variables. Let us see how this changes the model.</p>
<p><strong>(1) Experimental Condition</strong></p>
<p>Experimental conditon is a BINARY or two-level factor.</p>
<ul>
<li><p>When it is alternatively coded as a numeric, continuous variable taking the values of zero (<span class="math inline">\(0\)</span>) for the reference category and one (<span class="math inline">\(1\)</span>) for the other category, the model estimates are exactly the same, including the paramters for the variables and the intercept, AND the model fit statistics.</p></li>
<li><p>When the numeric, continuous variable is further grand-mean centered by additionally subtraction the MEAN of the numberic version, the value of the intercept is the only estimate that changes.</p></li>
</ul>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a>nurse_lmer_1a_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconN <span class="op">+</span><span class="st">            </span><span class="co"># experimental condition = CONTINUOUS CODED 0/1</span></span>
<span id="cb178-2"><a href="#cb178-2"></a><span class="st">                                     </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">   </span></span>
<span id="cb178-3"><a href="#cb178-3"></a><span class="st">                                     </span>wardtype <span class="op">+</span><span class="st">                  </span></span>
<span id="cb178-4"><a href="#cb178-4"></a><span class="st">                                     </span>hospsize <span class="op">+</span><span class="st">                 </span><span class="co"># hospital size = CATEGORICAL FACTOR         </span></span>
<span id="cb178-5"><a href="#cb178-5"></a><span class="st">                                     </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward),          </span>
<span id="cb178-6"><a href="#cb178-6"></a>                                   <span class="dt">data =</span> data_nurse,</span>
<span id="cb178-7"><a href="#cb178-7"></a>                                   <span class="dt">REML =</span> <span class="ot">FALSE</span>)                  </span>
<span id="cb178-8"><a href="#cb178-8"></a></span>
<span id="cb178-9"><a href="#cb178-9"></a>nurse_lmer_1b_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconNG <span class="op">+</span><span class="st">           </span><span class="co"># experimental condition = CONTINUOUS GRAND-MEAN CENTERED</span></span>
<span id="cb178-10"><a href="#cb178-10"></a><span class="st">                                     </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">   </span></span>
<span id="cb178-11"><a href="#cb178-11"></a><span class="st">                                     </span>wardtype <span class="op">+</span><span class="st">                  </span></span>
<span id="cb178-12"><a href="#cb178-12"></a><span class="st">                                     </span>hospsize <span class="op">+</span><span class="st">                  </span><span class="co"># hospital size = CATEGORICAL FACTOR                 </span></span>
<span id="cb178-13"><a href="#cb178-13"></a><span class="st">                                     </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward),          </span>
<span id="cb178-14"><a href="#cb178-14"></a>                                   <span class="dt">data =</span> data_nurse,</span>
<span id="cb178-15"><a href="#cb178-15"></a>                                   <span class="dt">REML =</span> <span class="ot">FALSE</span>)                  </span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_<span class="dv">1</span>_ml, </span>
<span id="cb179-2"><a href="#cb179-2"></a>                     nurse_lmer_1a_ml, </span>
<span id="cb179-3"><a href="#cb179-3"></a>                     nurse_lmer_1b_ml),</span>
<span id="cb179-4"><a href="#cb179-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Factor&quot;</span>, </span>
<span id="cb179-5"><a href="#cb179-5"></a>                                       <span class="st">&quot;0 vs 1&quot;</span>, </span>
<span id="cb179-6"><a href="#cb179-6"></a>                                       <span class="st">&quot;Centered&quot;</span>),</span>
<span id="cb179-7"><a href="#cb179-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Model 1 - Expereimental Condiditon Coding (2-levels)&quot;</span>,</span>
<span id="cb179-8"><a href="#cb179-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb179-9"><a href="#cb179-9"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Model 1 - Expereimental Condiditon Coding (2-levels)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Factor
</th>
<th style="padding-left: 5px;padding-right: 5px;">
0 vs 1
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Centered
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.38 (0.18)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.38 (0.18)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.03 (0.17)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconexperiment
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gender
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
experien
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
wardtypespecial care
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizemedium
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.19)<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.19)<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.19)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizelarge
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90 (0.26)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90 (0.26)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90 (0.26)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconN
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1626.32
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1626.32
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1626.32
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1680.30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1680.30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1680.30
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-802.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-802.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-802.16
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward:hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.33
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p><strong>(2) Hospital Size</strong></p>
<p>Experimental conditon is a three-level factor.</p>
<ul>
<li><p>When it is alternatively coded as a numeric, continuous variables taking the values of whole numbers, starting with zero (<span class="math inline">\(0, 1, 2, \dots\)</span>), the model there will only be ONE parameter estimated instead of several (one less than the number of categories). This is becuase the levels are treated as being equally different from each other in terms of the outcome. This treats the effect of the categorical variable as if it is linear, which may or may not be appropriate. User beware!</p></li>
<li><p>When the numeric, continuous variable is further grand-mean centered by additionally subtraction the MEAN of the numberic version, the value of the intercept is the only estimate that changes.</p></li>
</ul>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a>nurse_lmer_1c_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconNG <span class="op">+</span><span class="st">           </span><span class="co"># experimental condition = CONTINUOUS GRAND-MEAN CENTERED</span></span>
<span id="cb180-2"><a href="#cb180-2"></a><span class="st">                                     </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">   </span></span>
<span id="cb180-3"><a href="#cb180-3"></a><span class="st">                                     </span>wardtype <span class="op">+</span><span class="st">                  </span></span>
<span id="cb180-4"><a href="#cb180-4"></a><span class="st">                                     </span>hospsizeN <span class="op">+</span><span class="st">                 </span><span class="co"># hospital size = CONTINUOUS CODED 0/1          </span></span>
<span id="cb180-5"><a href="#cb180-5"></a><span class="st">                                     </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward),          </span>
<span id="cb180-6"><a href="#cb180-6"></a>                                   <span class="dt">data =</span> data_nurse,</span>
<span id="cb180-7"><a href="#cb180-7"></a>                                   <span class="dt">REML =</span> <span class="ot">FALSE</span>)   </span>
<span id="cb180-8"><a href="#cb180-8"></a></span>
<span id="cb180-9"><a href="#cb180-9"></a>nurse_lmer_1d_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconNG <span class="op">+</span><span class="st">           </span><span class="co"># experimental condition = CONTINUOUS GRAND-MEAN CENTERED</span></span>
<span id="cb180-10"><a href="#cb180-10"></a><span class="st">                                     </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">   </span></span>
<span id="cb180-11"><a href="#cb180-11"></a><span class="st">                                     </span>wardtype <span class="op">+</span><span class="st">                  </span></span>
<span id="cb180-12"><a href="#cb180-12"></a><span class="st">                                     </span>hospsizeNG <span class="op">+</span><span class="st">                </span><span class="co"># hospital size = CONTINUOUS GRAND-MEAN CENTERED           </span></span>
<span id="cb180-13"><a href="#cb180-13"></a><span class="st">                                     </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward),          </span>
<span id="cb180-14"><a href="#cb180-14"></a>                                   <span class="dt">data =</span> data_nurse,</span>
<span id="cb180-15"><a href="#cb180-15"></a>                                   <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_1b_ml, </span>
<span id="cb181-2"><a href="#cb181-2"></a>                     nurse_lmer_1c_ml, </span>
<span id="cb181-3"><a href="#cb181-3"></a>                     nurse_lmer_1d_ml),</span>
<span id="cb181-4"><a href="#cb181-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Factor&quot;</span>, </span>
<span id="cb181-5"><a href="#cb181-5"></a>                                       <span class="st">&quot;0 vs 1&quot;</span>, </span>
<span id="cb181-6"><a href="#cb181-6"></a>                                       <span class="st">&quot;Centered&quot;</span>),</span>
<span id="cb181-7"><a href="#cb181-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Model 1 - Hospital Coding (3-levels)&quot;</span>,</span>
<span id="cb181-8"><a href="#cb181-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb181-9"><a href="#cb181-9"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Model 1 - Hospital Coding (3-levels)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Factor
</th>
<th style="padding-left: 5px;padding-right: 5px;">
0 vs 1
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Centered
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.03 (0.17)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.04 (0.16)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.40 (0.12)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gender
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
experien
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
wardtypespecial care
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizemedium
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.19)<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizelarge
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90 (0.26)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizeN
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizeNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.12)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1626.32
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1624.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1624.36
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1680.30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1673.44
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1673.44
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-802.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-802.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-802.18
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward:hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.33
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm-add-random-slope" class="section level2" number="5.6">
<h2 number="5.6"><span class="header-section-number">5.6</span> MLM: Add Random Slope</h2>
<!-- ========================================================= -->
<blockquote>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>, page 22:</p>
<p>“Although logically we can test if explanatory variables at the first level have random coefficients (slopes) at the second or third level, and if explanatory variables at teh second level have random coefficients (slopes) at the third level, these possibilities are not pursued. We DO test a model with a random coefficient (slope) for <code>expcon</code> at the third level, where there turns out to be significant slope variation.”</p>
</blockquote>
<div id="fit-the-model-6" class="section level3" number="5.6.1">
<h3 number="5.6.1"><span class="header-section-number">5.6.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a>nurse_lmer_1d_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconNG <span class="op">+</span><span class="st">            </span><span class="co"># experimental condition = CONTINUOUS GRAND-MEAN CENTERED</span></span>
<span id="cb182-2"><a href="#cb182-2"></a><span class="st">                                     </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">    </span><span class="co"># level 1 covariates</span></span>
<span id="cb182-3"><a href="#cb182-3"></a><span class="st">                                     </span>wardtype <span class="op">+</span><span class="st">                   </span><span class="co"># level 2 covariate</span></span>
<span id="cb182-4"><a href="#cb182-4"></a><span class="st">                                     </span>hospsizeNG <span class="op">+</span><span class="st">                 </span><span class="co"># level 3 covariate, hospital size = CONTINUOUS GRAND-MEAN CENTERED           </span></span>
<span id="cb182-5"><a href="#cb182-5"></a><span class="st">                                     </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward),           <span class="co"># Random Intercepts for wards within hospitals</span></span>
<span id="cb182-6"><a href="#cb182-6"></a>                                   <span class="dt">data =</span> data_nurse, </span>
<span id="cb182-7"><a href="#cb182-7"></a>                                   <span class="dt">REML =</span> <span class="ot">TRUE</span>)                   <span class="co"># fit via REML for nested Random Effects</span></span>
<span id="cb182-8"><a href="#cb182-8"></a></span>
<span id="cb182-9"><a href="#cb182-9"></a>nurse_lmer_<span class="dv">2</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconNG <span class="op">+</span><span class="st">             </span><span class="co"># experimental condition = CONTINUOUS GRAND-MEAN CENTERED</span></span>
<span id="cb182-10"><a href="#cb182-10"></a><span class="st">                                    </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">     </span><span class="co"># level 1 covariates</span></span>
<span id="cb182-11"><a href="#cb182-11"></a><span class="st">                                    </span>wardtype <span class="op">+</span><span class="st">                    </span><span class="co"># level 2 covariate</span></span>
<span id="cb182-12"><a href="#cb182-12"></a><span class="st">                                    </span>hospsizeNG <span class="op">+</span><span class="st">                  </span><span class="co"># level 3 covariate, hospital size = CONTINUOUS GRAND-MEAN CENTERED           </span></span>
<span id="cb182-13"><a href="#cb182-13"></a><span class="st">                                    </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward) <span class="op">+</span><span class="st">           </span><span class="co"># Random Intercepts for wards within hospitals</span></span>
<span id="cb182-14"><a href="#cb182-14"></a><span class="st">                                    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>expconNG<span class="op">|</span>hospital),      <span class="co"># RANDOM SLOPES for exp cond within hospital (does not vary witin a ward!)</span></span>
<span id="cb182-15"><a href="#cb182-15"></a>                                  <span class="dt">data =</span> data_nurse,</span>
<span id="cb182-16"><a href="#cb182-16"></a>                                  <span class="dt">REML =</span> <span class="ot">TRUE</span>)                    <span class="co"># fit via REML for nested Random Effects</span></span></code></pre></div>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_1d_re, </span>
<span id="cb183-2"><a href="#cb183-2"></a>                     nurse_lmer_<span class="dv">2</span>_re),</span>
<span id="cb183-3"><a href="#cb183-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M1: RI&quot;</span>, </span>
<span id="cb183-4"><a href="#cb183-4"></a>                                       <span class="st">&quot;M2: RIAS&quot;</span>),</span>
<span id="cb183-5"><a href="#cb183-5"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Nested Models: Random Slope via REML&quot;</span>,</span>
<span id="cb183-6"><a href="#cb183-6"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb183-7"><a href="#cb183-7"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Nested Models: Random Slope via REML
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1: RI
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M2: RIAS
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.40 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.39 (0.11)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.18)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gender
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
experien
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
wardtypespecial care
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.07)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizeNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.13)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.13)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1659.89
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1633.18
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1708.97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1687.17
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-819.94
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-805.59
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward:hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.34
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.17
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward.hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital.1 expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.69
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="assess-significance-1" class="section level3" number="5.6.2">
<h3 number="5.6.2"><span class="header-section-number">5.6.2</span> Assess Significance</h3>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a><span class="kw">anova</span>(nurse_lmer_1d_re, nurse_lmer_<span class="dv">2</span>_re, <span class="dt">refit =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>Data: data_nurse
Models:
nurse_lmer_1d_re: stress ~ expconNG + age + gender + experien + wardtype + hospsizeNG + 
nurse_lmer_1d_re:     (1 | hospital/ward)
nurse_lmer_2_re: stress ~ expconNG + age + gender + experien + wardtype + hospsizeNG + 
nurse_lmer_2_re:     (1 | hospital/ward) + (0 + expconNG | hospital)
                 npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
nurse_lmer_1d_re   10 1659.9 1709.0 -819.94   1639.9                         
nurse_lmer_2_re    11 1633.2 1687.2 -805.59   1611.2 28.708  1  8.417e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The inclusion of a random slope effect for the experimental condition <code>expcon</code> significantly improves the models’s fit, thus is should be retained.</p>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm-add-cross-level-interaction" class="section level2" number="5.7">
<h2 number="5.7"><span class="header-section-number">5.7</span> MLM: Add Cross-Level Interaction</h2>
<!-- ========================================================= -->
<blockquote>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>, page 22:</p>
<p>“The varying slope can be predicted by adding a cross-level interaction between the variables <code>expcon</code> and <code>hospsize</code>. In view of this interaction, the variables <code>expcon</code> and <code>hospsize</code> have been centered on tehir overal means.”</p>
</blockquote>
<div id="fit-the-model-7" class="section level3" number="5.7.1">
<h3 number="5.7.1"><span class="header-section-number">5.7.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a>nurse_lmer_<span class="dv">2</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconNG <span class="op">+</span><span class="st">           </span><span class="co"># experimental condition = CONTINUOUS GRAND-MEAN CENTERED</span></span>
<span id="cb186-2"><a href="#cb186-2"></a><span class="st">                                    </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">   </span><span class="co"># level 1 covariates</span></span>
<span id="cb186-3"><a href="#cb186-3"></a><span class="st">                                    </span>wardtype <span class="op">+</span><span class="st">                  </span><span class="co"># level 2 covariate</span></span>
<span id="cb186-4"><a href="#cb186-4"></a><span class="st">                                    </span>hospsizeNG <span class="op">+</span><span class="st">                </span><span class="co"># level 3 covariate, hospital size = CONTINUOUS GRAND-MEAN CENTERED           </span></span>
<span id="cb186-5"><a href="#cb186-5"></a><span class="st">                                    </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward) <span class="op">+</span><span class="st">         </span><span class="co"># Random Intercepts for wards within hospitals</span></span>
<span id="cb186-6"><a href="#cb186-6"></a><span class="st">                                    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>expconNG<span class="op">|</span>hospital),    <span class="co"># RANDOM SLOPES for exp cond within hospital (does not vary witin a ward!) </span></span>
<span id="cb186-7"><a href="#cb186-7"></a>                                  <span class="dt">data =</span> data_nurse,</span>
<span id="cb186-8"><a href="#cb186-8"></a>                                  <span class="dt">REML =</span> <span class="ot">FALSE</span>)                 <span class="co"># fit via ML for nested FIXED Effects</span></span>
<span id="cb186-9"><a href="#cb186-9"></a></span>
<span id="cb186-10"><a href="#cb186-10"></a>nurse_lmer_<span class="dv">3</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconNG <span class="op">+</span><span class="st">           </span><span class="co"># experimental condition = CONTINUOUS GRAND-MEAN CENTERED</span></span>
<span id="cb186-11"><a href="#cb186-11"></a><span class="st">                                    </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">   </span><span class="co"># level 1 covariates</span></span>
<span id="cb186-12"><a href="#cb186-12"></a><span class="st">                                    </span>wardtype <span class="op">+</span><span class="st">                  </span><span class="co"># level 2 covariate</span></span>
<span id="cb186-13"><a href="#cb186-13"></a><span class="st">                                    </span>hospsizeNG <span class="op">+</span><span class="st">                </span><span class="co"># level 3 covariate, hospital size = CONTINUOUS GRAND-MEAN CENTERED   </span></span>
<span id="cb186-14"><a href="#cb186-14"></a><span class="st">                                    </span>expconNG<span class="op">*</span>hospsizeNG <span class="op">+</span><span class="st">       </span><span class="co"># CROSS-LEVEL interaction</span></span>
<span id="cb186-15"><a href="#cb186-15"></a><span class="st">                                    </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward) <span class="op">+</span><span class="st">         </span><span class="co"># Random Intercepts for wards within hospitals</span></span>
<span id="cb186-16"><a href="#cb186-16"></a><span class="st">                                    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>expconNG<span class="op">|</span>hospital),    <span class="co"># RANDOM SLOPES for exp cond within hospital (does not vary within a ward!) </span></span>
<span id="cb186-17"><a href="#cb186-17"></a>                                  <span class="dt">data =</span> data_nurse,</span>
<span id="cb186-18"><a href="#cb186-18"></a>                                  <span class="dt">REML =</span> <span class="ot">FALSE</span>)                 <span class="co"># fit via ML for nested FIXED Effects</span></span></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_<span class="dv">2</span>_ml, </span>
<span id="cb187-2"><a href="#cb187-2"></a>                     nurse_lmer_<span class="dv">3</span>_ml),</span>
<span id="cb187-3"><a href="#cb187-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M2: RAIS&quot;</span>, </span>
<span id="cb187-4"><a href="#cb187-4"></a>                                       <span class="st">&quot;M3: Xlevel Int&quot;</span>),</span>
<span id="cb187-5"><a href="#cb187-5"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Nested Models: Fixed Cross-Level Interaction via ML&quot;</span>,</span>
<span id="cb187-6"><a href="#cb187-6"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb187-7"><a href="#cb187-7"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Nested Models: Fixed Cross-Level Interaction via ML
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M2: RAIS
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M3: Xlevel Int
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.39 (0.11)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.39 (0.11)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.18)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.72 (0.11)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gender
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.46 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.46 (0.03)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
experien
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
wardtypespecial care
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.07)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.07)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizeNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.12)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG:hospsizeNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.00 (0.16)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1597.48
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1576.07
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1651.47
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1634.96
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-787.74
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-776.03
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward.hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.15
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital.1 expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.66
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.18
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="assess-significance-2" class="section level3" number="5.7.2">
<h3 number="5.7.2"><span class="header-section-number">5.7.2</span> Assess Significance</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a><span class="kw">anova</span>(nurse_lmer_<span class="dv">2</span>_ml, nurse_lmer_<span class="dv">3</span>_ml)</span></code></pre></div>
<pre><code>Data: data_nurse
Models:
nurse_lmer_2_ml: stress ~ expconNG + age + gender + experien + wardtype + hospsizeNG + 
nurse_lmer_2_ml:     (1 | hospital/ward) + (0 + expconNG | hospital)
nurse_lmer_3_ml: stress ~ expconNG + age + gender + experien + wardtype + hospsizeNG + 
nurse_lmer_3_ml:     expconNG * hospsizeNG + (1 | hospital/ward) + (0 + expconNG | 
nurse_lmer_3_ml:     hospital)
                npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
nurse_lmer_2_ml   11 1597.5 1651.5 -787.74   1575.5                         
nurse_lmer_3_ml   12 1576.1 1635.0 -776.03   1552.1 23.413  1  1.307e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>There is evidence that hospital size moderated the effect of the intervention. We will want to plot the estimated marginal means to interpret the meaning of this interaction.</p>
</div>
</div>
<div id="final-model-1" class="section level2" number="5.8">
<h2 number="5.8"><span class="header-section-number">5.8</span> Final Model</h2>
<div id="fit-the-model-8" class="section level3" number="5.8.1">
<h3 number="5.8.1"><span class="header-section-number">5.8.1</span> Fit the model</h3>
<p>The final model should be fit via REML.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a>nurse_lmer_<span class="dv">3</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>expconNG <span class="op">+</span><span class="st">           </span><span class="co"># experimental condition = CONTINUOUS GRAND-MEAN CENTERED</span></span>
<span id="cb190-2"><a href="#cb190-2"></a><span class="st">                                    </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>experien <span class="op">+</span><span class="st">   </span><span class="co"># level 1 covariates</span></span>
<span id="cb190-3"><a href="#cb190-3"></a><span class="st">                                    </span>wardtype <span class="op">+</span><span class="st">                  </span><span class="co"># level 2 covariate</span></span>
<span id="cb190-4"><a href="#cb190-4"></a><span class="st">                                    </span>hospsizeNG <span class="op">+</span><span class="st">                </span><span class="co"># level 3 covariate, hospital size = CONTINUOUS GRAND-MEAN CENTERED   </span></span>
<span id="cb190-5"><a href="#cb190-5"></a><span class="st">                                    </span>expconNG<span class="op">*</span>hospsizeNG <span class="op">+</span><span class="st">       </span><span class="co"># CROSS-LEVEL interaction</span></span>
<span id="cb190-6"><a href="#cb190-6"></a><span class="st">                                    </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">/</span>ward) <span class="op">+</span><span class="st">         </span><span class="co"># Random Intercepts for wards within hospitals</span></span>
<span id="cb190-7"><a href="#cb190-7"></a><span class="st">                                    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>expconNG<span class="op">|</span>hospital),    <span class="co"># RANDOM SLOPES for exp cond within hospital (does not vary witin a ward!)  </span></span>
<span id="cb190-8"><a href="#cb190-8"></a>                                  <span class="dt">data =</span> data_nurse,</span>
<span id="cb190-9"><a href="#cb190-9"></a>                                  <span class="dt">REML =</span> <span class="ot">TRUE</span>)                                       <span class="co"># fit via REML for final model        </span></span></code></pre></div>
</div>
<div id="table-of-estimated-parameters" class="section level3" number="5.8.2">
<h3 number="5.8.2"><span class="header-section-number">5.8.2</span> Table of Estimated Parameters</h3>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_<span class="dv">3</span>_re),</span>
<span id="cb191-2"><a href="#cb191-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M3: Xlevel Int&quot;</span>),</span>
<span id="cb191-3"><a href="#cb191-3"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Final Model: with REML&quot;</span>,</span>
<span id="cb191-4"><a href="#cb191-4"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb191-5"><a href="#cb191-5"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Final Model: with REML
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M3: Xlevel Int
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.39 (0.11)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.72 (0.12)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gender
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.46 (0.03)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
experien
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
wardtypespecial care
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.07)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizeNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.13)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG:hospsizeNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.00 (0.17)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1614.47
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1673.36
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-795.23
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward.hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.17
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital.1 expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.20
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="visualization-estimated-marginal-means-plot" class="section level3" number="5.8.3">
<h3 number="5.8.3"><span class="header-section-number">5.8.3</span> Visualization: Estimated Marginal Means Plot</h3>
<p>Although there are many variables in this model, only two are involved in any interaction(s). For this reason, we will choose to display the estimated marginal means across only experimental condition and hospital size. For this illustration, all other continuous predictors are taken to be at their mean and categorical predictors at their reference category.</p>
<div id="using-interactionsinteract_plot" class="section level4" number="5.8.3.1">
<h4 number="5.8.3.1"><span class="header-section-number">5.8.3.1</span> Using <code>interactions::interact_plot()</code></h4>
<p>All Defaults:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(nurse_lmer_<span class="dv">3</span>_re,</span>
<span id="cb192-2"><a href="#cb192-2"></a>                            <span class="dt">pred =</span> <span class="st">&quot;hospsizeNG&quot;</span>,  <span class="co"># main predictor/independent variable, for x-axis</span></span>
<span id="cb192-3"><a href="#cb192-3"></a>                            <span class="dt">modx =</span> <span class="st">&quot;expconNG&quot;</span>,    <span class="co"># moderating independent variable, for different lines</span></span>
<span id="cb192-4"><a href="#cb192-4"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-173-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Adding more options:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(nurse_lmer_<span class="dv">3</span>_re,</span>
<span id="cb193-2"><a href="#cb193-2"></a>                            <span class="dt">pred =</span> <span class="st">&quot;hospsizeNG&quot;</span>,</span>
<span id="cb193-3"><a href="#cb193-3"></a>                            <span class="dt">modx =</span> <span class="st">&quot;expconNG&quot;</span>,</span>
<span id="cb193-4"><a href="#cb193-4"></a>                            <span class="dt">modx.values =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.504</span>, <span class="fl">0.496</span>),</span>
<span id="cb193-5"><a href="#cb193-5"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>,</span>
<span id="cb193-6"><a href="#cb193-6"></a>                            <span class="dt">y.label =</span> <span class="st">&quot;Estimated Marginal Mean Norse&#39;s Stress Score&quot;</span>,</span>
<span id="cb193-7"><a href="#cb193-7"></a>                            <span class="dt">x.label =</span> <span class="st">&quot;Hospital Size&quot;</span>,</span>
<span id="cb193-8"><a href="#cb193-8"></a>                            <span class="dt">legend.main =</span> <span class="st">&quot;Condition:&quot;</span>,</span>
<span id="cb193-9"><a href="#cb193-9"></a>                            <span class="dt">modx.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>),</span>
<span id="cb193-10"><a href="#cb193-10"></a>                            <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb193-11"><a href="#cb193-11"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb193-12"><a href="#cb193-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb193-13"><a href="#cb193-13"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;Black&quot;</span>),</span>
<span id="cb193-14"><a href="#cb193-14"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb193-15"><a href="#cb193-15"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">-0.1</span>)) <span class="op">+</span></span>
<span id="cb193-16"><a href="#cb193-16"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.776</span>, <span class="fl">0.224</span>, <span class="fl">1.224</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Large&quot;</span>)) <span class="op">+</span></span>
<span id="cb193-17"><a href="#cb193-17"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>)) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-174-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="using-sjplotplot_model" class="section level4" number="5.8.3.2">
<h4 number="5.8.3.2"><span class="header-section-number">5.8.3.2</span> Using <code>sjPlot::plot_model()</code></h4>
<p>All Defaults:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(nurse_lmer_<span class="dv">3</span>_re, </span>
<span id="cb194-2"><a href="#cb194-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>, </span>
<span id="cb194-3"><a href="#cb194-3"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;hospsizeNG&quot;</span>, <span class="st">&quot;expconNG&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-175-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Adding more options:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(nurse_lmer_<span class="dv">3</span>_re, </span>
<span id="cb195-2"><a href="#cb195-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>, </span>
<span id="cb195-3"><a href="#cb195-3"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;hospsizeNG [-0.776, 0.224, 1.224]&quot;</span>, </span>
<span id="cb195-4"><a href="#cb195-4"></a>                             <span class="st">&quot;expconNG [-0.504, 0.496]&quot;</span>)) <span class="op">+</span></span>
<span id="cb195-5"><a href="#cb195-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.776</span>, <span class="fl">0.224</span>, <span class="fl">1.224</span>),</span>
<span id="cb195-6"><a href="#cb195-6"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;large&quot;</span>)) <span class="op">+</span></span>
<span id="cb195-7"><a href="#cb195-7"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>),</span>
<span id="cb195-8"><a href="#cb195-8"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)) <span class="op">+</span></span>
<span id="cb195-9"><a href="#cb195-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Multilevel Modeling of Hospital Nurse Stress Intervention&quot;</span>,</span>
<span id="cb195-10"><a href="#cb195-10"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Ribbons display 95% Confidene Intervals&quot;</span>,</span>
<span id="cb195-11"><a href="#cb195-11"></a>       <span class="dt">x =</span> <span class="st">&quot;Hospital Size&quot;</span>,</span>
<span id="cb195-12"><a href="#cb195-12"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Norse&#39;s Stress Score&quot;</span>,</span>
<span id="cb195-13"><a href="#cb195-13"></a>       <span class="dt">color =</span> <span class="st">&quot;Condition&quot;</span>) <span class="op">+</span></span>
<span id="cb195-14"><a href="#cb195-14"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-176-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="using-effectseffect-and-ggplot" class="section level4" number="5.8.3.3">
<h4 number="5.8.3.3"><span class="header-section-number">5.8.3.3</span> Using <code>effects::Effect()</code> and <code>ggplot</code></h4>
<p>Get Estimated Marginal Means - default ‘nice’ predictor values:</p>
<p><strong>Focal predictors:</strong> All combinations of…</p>
<ul>
<li><code>expcon</code> categorical, both levels <code>control</code> and <code>experiment</code><br />
</li>
<li><code>hospsize</code> categorical, all three levels<code>small</code> , <code>medium</code>, <code>large</code></li>
</ul>
<p><strong>Always followed by:</strong></p>
<ul>
<li><code>fit</code> estimated marginal mean</li>
<li><code>se</code> standard error for the marginal mean</li>
<li><code>lower</code> lower end of the 95% confidence interval around the estimated marginal mean</li>
<li><code>upper</code> upper end of the 95% confidence interval around the estimated marginal mean</li>
</ul>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;expconNG&quot;</span>, <span class="st">&quot;hospsizeNG&quot;</span>),</span>
<span id="cb196-2"><a href="#cb196-2"></a>                <span class="dt">mod =</span> nurse_lmer_<span class="dv">3</span>_re,</span>
<span id="cb196-3"><a href="#cb196-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">expconNG   =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.504</span>, <span class="fl">0.496</span>),</span>
<span id="cb196-4"><a href="#cb196-4"></a>                               <span class="dt">hospsizeNG =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.776</span>, <span class="fl">0.224</span>, <span class="fl">1.224</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb196-5"><a href="#cb196-5"></a><span class="st">  </span><span class="kw">data.frame</span>()  </span></code></pre></div>
<pre><code>  expconNG hospsizeNG      fit        se    lower    upper
1   -0.504     -0.776 5.382989 0.1631606 5.062810 5.703169
2    0.496     -0.776 3.885142 0.1626423 3.565979 4.204304
3   -0.504      0.224 5.341652 0.1112649 5.123310 5.559993
4    0.496      0.224 4.842621 0.1109167 4.624962 5.060279
5   -0.504      1.224 5.300315 0.2138881 4.880590 5.720040
6    0.496      1.224 5.800100 0.2131937 5.381737 6.218462</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;expconNG&quot;</span>, <span class="st">&quot;hospsizeNG&quot;</span>),</span>
<span id="cb198-2"><a href="#cb198-2"></a>                <span class="dt">mod =</span> nurse_lmer_<span class="dv">3</span>_re,</span>
<span id="cb198-3"><a href="#cb198-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">expconNG   =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.504</span>, <span class="fl">0.496</span>),</span>
<span id="cb198-4"><a href="#cb198-4"></a>                               <span class="dt">hospsizeNG =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.776</span>, <span class="fl">0.224</span>, <span class="fl">1.224</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb198-5"><a href="#cb198-5"></a><span class="st">  </span><span class="kw">data.frame</span>()  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb198-6"><a href="#cb198-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">expcon =</span> <span class="kw">factor</span>(expconNG <span class="op">+</span><span class="st"> </span><span class="fl">0.504</span>,</span>
<span id="cb198-7"><a href="#cb198-7"></a>                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb198-8"><a href="#cb198-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">hopsize =</span> <span class="kw">factor</span>(hospsizeNG <span class="op">+</span><span class="st"> </span><span class="fl">0.776</span>,</span>
<span id="cb198-9"><a href="#cb198-9"></a>                                 <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Large&quot;</span>)))</span></code></pre></div>
<pre><code>  expconNG hospsizeNG      fit        se    lower    upper       expcon hopsize
1   -0.504     -0.776 5.382989 0.1631606 5.062810 5.703169      Control   Small
2    0.496     -0.776 3.885142 0.1626423 3.565979 4.204304 Intervention   Small
3   -0.504      0.224 5.341652 0.1112649 5.123310 5.559993      Control  Medium
4    0.496      0.224 4.842621 0.1109167 4.624962 5.060279 Intervention  Medium
5   -0.504      1.224 5.300315 0.2138881 4.880590 5.720040      Control   Large
6    0.496      1.224 5.800100 0.2131937 5.381737 6.218462 Intervention   Large</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;expconNG&quot;</span>, <span class="st">&quot;hospsizeNG&quot;</span>),</span>
<span id="cb200-2"><a href="#cb200-2"></a>                <span class="dt">mod =</span> nurse_lmer_<span class="dv">3</span>_re,</span>
<span id="cb200-3"><a href="#cb200-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">expconNG   =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.504</span>, <span class="fl">0.496</span>),</span>
<span id="cb200-4"><a href="#cb200-4"></a>                               <span class="dt">hospsizeNG =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.776</span>, <span class="fl">0.224</span>, <span class="fl">1.224</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb200-5"><a href="#cb200-5"></a><span class="st">  </span><span class="kw">data.frame</span>()  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb200-6"><a href="#cb200-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">expcon =</span> <span class="kw">factor</span>(expconNG <span class="op">+</span><span class="st"> </span><span class="fl">0.504</span>,</span>
<span id="cb200-7"><a href="#cb200-7"></a>                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb200-8"><a href="#cb200-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">hospsize =</span> <span class="kw">factor</span>(hospsizeNG <span class="op">+</span><span class="st"> </span><span class="fl">0.776</span>,</span>
<span id="cb200-9"><a href="#cb200-9"></a>                                 <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Large&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb200-10"><a href="#cb200-10"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb200-11"><a href="#cb200-11"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> hospsize,</span>
<span id="cb200-12"><a href="#cb200-12"></a>      <span class="dt">y =</span> fit,</span>
<span id="cb200-13"><a href="#cb200-13"></a>      <span class="dt">group =</span> expcon,</span>
<span id="cb200-14"><a href="#cb200-14"></a>      <span class="dt">shape =</span> expcon,</span>
<span id="cb200-15"><a href="#cb200-15"></a>      <span class="dt">color =</span> expcon) <span class="op">+</span></span>
<span id="cb200-16"><a href="#cb200-16"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> fit  <span class="op">-</span><span class="st"> </span>se,      <span class="co"># mean plus/minus one Std Error</span></span>
<span id="cb200-17"><a href="#cb200-17"></a>                    <span class="dt">ymax =</span> fit <span class="op">+</span><span class="st"> </span>se),</span>
<span id="cb200-18"><a href="#cb200-18"></a>                <span class="dt">width =</span> <span class="fl">.4</span>,</span>
<span id="cb200-19"><a href="#cb200-19"></a>                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb200-20"><a href="#cb200-20"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,           <span class="co"># 95% CIs</span></span>
<span id="cb200-21"><a href="#cb200-21"></a>                    <span class="dt">ymax =</span> upper),</span>
<span id="cb200-22"><a href="#cb200-22"></a>                <span class="dt">width =</span> <span class="fl">.2</span>,</span>
<span id="cb200-23"><a href="#cb200-23"></a>                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb200-24"><a href="#cb200-24"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> expcon),</span>
<span id="cb200-25"><a href="#cb200-25"></a>            <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.2</span>)) <span class="op">+</span></span>
<span id="cb200-26"><a href="#cb200-26"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>,</span>
<span id="cb200-27"><a href="#cb200-27"></a>             <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.2</span>)) <span class="op">+</span></span>
<span id="cb200-28"><a href="#cb200-28"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb200-29"><a href="#cb200-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Hospital Size&quot;</span>,</span>
<span id="cb200-30"><a href="#cb200-30"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean, Stress&quot;</span>,</span>
<span id="cb200-31"><a href="#cb200-31"></a>       <span class="dt">shape    =</span> <span class="st">&quot;Condition&quot;</span>,</span>
<span id="cb200-32"><a href="#cb200-32"></a>       <span class="dt">color    =</span> <span class="st">&quot;Condition&quot;</span>,</span>
<span id="cb200-33"><a href="#cb200-33"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Condition&quot;</span>) <span class="op">+</span></span>
<span id="cb200-34"><a href="#cb200-34"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb200-35"><a href="#cb200-35"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb200-36"><a href="#cb200-36"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb200-37"><a href="#cb200-37"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">-0.1</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-179-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>This plot illustrates the estimated marginal means among male (gender’s reference category) nurses at the overall mean age (43.01 years), with the mean level experience (17.06 years), since thoes variables were not included as <code>focal.predictors</code> in the <code>effects::Effect()</code> function. Different values for thoes predictors would yield the exact sample plot, shifted as a whole either up or down.</p>
</div>
</div>
</div>
<div id="interpretation-6" class="section level2" number="5.9">
<h2 number="5.9"><span class="header-section-number">5.9</span> Interpretation</h2>
<p>There is evidence this intervention lowered stress among nurses working in small hospitals and to a smaller degree in medium sized hospitals. The intervention did not exhibit an effect in large hospitals.</p>
<div id="strength" class="section level3" number="5.9.1">
<h3 number="5.9.1"><span class="header-section-number">5.9.1</span> Strength</h3>
<p>This analysis was able to incorporated all three levels of clustering while additionally controlling for many covariates, both categorical (nurse gender and ward type) and continuous (nurse age and experience in years). Also heterogeneity was accounted for in terms of the interventions’s effect at various hospitals. This would NOT be possible via any ANOVA type anlysis.</p>
</div>
<div id="weakness" class="section level3" number="5.9.2">
<h3 number="5.9.2"><span class="header-section-number">5.9.2</span> Weakness</h3>
<p>The approach presented by <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span> and shown above involved mean-centering categorical variables. This would only be appropriate for a factor with more than two levels if its effect on the outcome was linear. Also, as the mean-centered variables are treated as continuous variables, post hoc tests are increasingly difficult.</p>
</div>
</div>
<div id="reproduction-of-table-2.5" class="section level2" number="5.10">
<h2 number="5.10"><span class="header-section-number">5.10</span> Reproduction of Table 2.5</h2>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span> presents a table on page 23 comparing various models. Note, that table includes models only fit via maximum likelihood, not REML. Also, the model <span class="math inline">\(M_3\)</span>: with cross-level interaction is slightly different for an unknown reason.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(nurse_lmer_<span class="dv">0</span>_ml, </span>
<span id="cb201-2"><a href="#cb201-2"></a>                     nurse_lmer_1d_ml, </span>
<span id="cb201-3"><a href="#cb201-3"></a>                     nurse_lmer_<span class="dv">2</span>_ml, </span>
<span id="cb201-4"><a href="#cb201-4"></a>                     nurse_lmer_<span class="dv">3</span>_ml),</span>
<span id="cb201-5"><a href="#cb201-5"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M0&quot;</span>, <span class="st">&quot;M1&quot;</span>, <span class="st">&quot;M2&quot;</span>, <span class="st">&quot;M3&quot;</span>),</span>
<span id="cb201-6"><a href="#cb201-6"></a>                <span class="dt">caption            =</span> <span class="st">&quot;Hox Table 2.5: Models for stress in hospitals and wards&quot;</span>,</span>
<span id="cb201-7"><a href="#cb201-7"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb201-8"><a href="#cb201-8"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Hox Table 2.5: Models for stress in hospitals and wards
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M0
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M2
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M3
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.00 (0.11)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.40 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.39 (0.11)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.39 (0.11)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70 (0.18)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.72 (0.11)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gender
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.45 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.46 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.46 (0.03)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
experien
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06 (0.00)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
wardtypespecial care
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.12)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.07)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.07)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hospsizeNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.12)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.46 (0.12)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
expconNG:hospsizeNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.00 (0.16)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1950.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1624.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1597.48
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1576.07
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1969.99
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1673.44
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1651.47
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1634.96
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-971.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-802.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-787.74
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-776.03
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: ward:hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: hospital
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward:hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.15
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: ward.hospital (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: hospital.1 expconNG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.66
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.18
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Deviance:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1"></a><span class="kw">c</span>(<span class="kw">deviance</span>(nurse_lmer_<span class="dv">0</span>_ml),         </span>
<span id="cb202-2"><a href="#cb202-2"></a>  <span class="kw">deviance</span>(nurse_lmer_1d_ml),</span>
<span id="cb202-3"><a href="#cb202-3"></a>  <span class="kw">deviance</span>(nurse_lmer_<span class="dv">2</span>_ml),</span>
<span id="cb202-4"><a href="#cb202-4"></a>  <span class="kw">deviance</span>(nurse_lmer_<span class="dv">3</span>_ml)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb202-5"><a href="#cb202-5"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 1942.4 1604.4 1575.5 1552.1</code></pre>
<!--chapter:end:06-example_hox2_nurses.Rmd-->
</div>
</div>
<div id="mlm-centeringscaling-reading-achievement-2-levels-only" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> MLM, Centering/Scaling: Reading Achievement (2-levels only)</h1>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb204-2"><a href="#cb204-2"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span>
<span id="cb204-3"><a href="#cb204-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb204-4"><a href="#cb204-4"></a><span class="kw">library</span>(stargazer)    <span class="co"># display nice tables: summary &amp; regression</span></span>
<span id="cb204-5"><a href="#cb204-5"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb204-6"><a href="#cb204-6"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb204-7"><a href="#cb204-7"></a><span class="kw">library</span>(performance)  <span class="co"># ICC and R2 calculations</span></span>
<span id="cb204-8"><a href="#cb204-8"></a><span class="kw">library</span>(effects)      <span class="co"># Effects for regression models</span></span>
<span id="cb204-9"><a href="#cb204-9"></a><span class="kw">library</span>(optimx)       <span class="co"># Different optimizers to solve mlm&#39;s</span></span>
<span id="cb204-10"><a href="#cb204-10"></a><span class="kw">library</span>(lme4)         <span class="co"># non-linear mixed-effects models</span></span>
<span id="cb204-11"><a href="#cb204-11"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span></code></pre></div>
<!-- ========================================================= -->
<div id="background-2" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Background</h2>
<!-- ========================================================= -->
<div class="rmdlink">
<p>
The following example was included in the text “Multilevel Modeling in R” by <span class="citation"><span class="citation">Finch, Bolin, and Kelley (<a href="#ref-finch2016" role="doc-biblioref">2016</a>)</span></span>.
</p>
<p>
The datasets for this textbook may be downloaded from the website: <a href="http://www.mlminr.com/data-sets/" class="uri">http://www.mlminr.com/data-sets/</a>.
</p>
</div>
<p>I was unable to find any documentation on this dataset in the book or online, so I contacted the authors. There were unable to provide much either, but based on visual inspection designated the class of <em>factor</em> to thoes vairables that seem to represent categorical quantities. The labels for gender and class size are relative to the frequencies in the journal article the authors did point me to <em>(although the samples sizes do not match up)</em>.</p>
<div class="rmdimportant">
<p>
FOR THIS CHAPTER WE WILL IGNORE ALL LEVELS EXCEPT FOR STUDNETS BEING NESTED WITHIN SCHOOLS.
</p>
</div>
<p>Read the SPSS data in with the <code>haven</code> package .</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1"></a>data_raw &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_sav</span>(<span class="st">&quot;http://www.mlminr.com/data-sets/Achieve.sav?attredirects=0&quot;</span>)</span></code></pre></div>
<p>Declare all categorical variables to be factors and apply labels where meaningful.</p>
<blockquote>
<p>Student-specific<br />
* <code>gender</code> = Male or Female<br />
* <code>age</code> = Age, in months<br />
* <code>gevocab</code> = Vocabulary Score<br />
* <code>geread</code> = Reading Score</p>
</blockquote>
<blockquote>
<p>Class-specific<br />
* <code>classsize</code> = category of class’s size</p>
</blockquote>
<blockquote>
<p>School-specific<br />
* <code>senroll</code> = school enrollment<br />
* <code>ses</code> = school’s SES level</p>
</blockquote>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1"></a>data_achieve &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb206-2"><a href="#cb206-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(id, region, corp, school, class), factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb206-3"><a href="#cb206-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">gender =</span> gender <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb206-4"><a href="#cb206-4"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb206-5"><a href="#cb206-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">classize =</span> classize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb206-6"><a href="#cb206-6"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;12-17&quot;</span>, <span class="st">&quot;18-21&quot;</span>, </span>
<span id="cb206-7"><a href="#cb206-7"></a>                                    <span class="st">&quot;22-26&quot;</span>, <span class="st">&quot;&gt;26&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb206-8"><a href="#cb206-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, region, corp, school, class,           <span class="co"># Identifiers</span></span>
<span id="cb206-9"><a href="#cb206-9"></a>                gender, age, geread, gevocab,              <span class="co"># Pupil-level vars</span></span>
<span id="cb206-10"><a href="#cb206-10"></a>                classize,                                  <span class="co"># Class-Level vars</span></span>
<span id="cb206-11"><a href="#cb206-11"></a>                senroll, ses)                              <span class="co"># School-level vars</span></span></code></pre></div>
<div id="sample-structure" class="section level3" number="6.1.1">
<h3 number="6.1.1"><span class="header-section-number">6.1.1</span> Sample Structure</h3>
<p>It is obvious that the sample is hiarchical in nature. The nesting starts with <code>students</code> (level 1) nested within <code>class</code> (level 2), which are further nested within <code>school</code> (level 3), <code>corp</code> (level 4), and finally <code>region</code> (level 5).</p>
<p>For this chapter we will only focus on TWO levels: <strong>students</strong> (level 1) are the units on which the outcome is measured and <strong>schools</strong> (level 2) are the units in which they are nested.</p>
<p>The number of <strong><em>regions</em></strong> = 9:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a>num_regions &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb207-2"><a href="#cb207-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(region) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb207-3"><a href="#cb207-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb207-4"><a href="#cb207-4"></a><span class="st">  </span><span class="kw">nrow</span>()</span>
<span id="cb207-5"><a href="#cb207-5"></a></span>
<span id="cb207-6"><a href="#cb207-6"></a>num_regions</span></code></pre></div>
<pre><code>[1] 9</code></pre>
<p>The number of <strong>corps</strong> = 60:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1"></a>num_corps &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb209-2"><a href="#cb209-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(region, corp) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb209-3"><a href="#cb209-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb209-4"><a href="#cb209-4"></a><span class="st">  </span><span class="kw">nrow</span>()</span>
<span id="cb209-5"><a href="#cb209-5"></a></span>
<span id="cb209-6"><a href="#cb209-6"></a>num_corps </span></code></pre></div>
<pre><code>[1] 60</code></pre>
<p>The number of <strong>schools</strong> = 160</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1"></a>num_schools &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb211-2"><a href="#cb211-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(region, corp, school) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb211-3"><a href="#cb211-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb211-4"><a href="#cb211-4"></a><span class="st">  </span><span class="kw">nrow</span>()</span>
<span id="cb211-5"><a href="#cb211-5"></a></span>
<span id="cb211-6"><a href="#cb211-6"></a>num_schools</span></code></pre></div>
<pre><code>[1] 160</code></pre>
<p>The number of <strong>classes</strong> = 568</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1"></a>num_classes &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb213-2"><a href="#cb213-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(region, corp, school, class) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb213-3"><a href="#cb213-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb213-4"><a href="#cb213-4"></a><span class="st">  </span><span class="kw">nrow</span>()</span>
<span id="cb213-5"><a href="#cb213-5"></a></span>
<span id="cb213-6"><a href="#cb213-6"></a>num_classes</span></code></pre></div>
<pre><code>[1] 568</code></pre>
<p>The number of <strong>students</strong> = 10320</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1"></a>num_subjects &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb215-2"><a href="#cb215-2"></a></span>
<span id="cb215-3"><a href="#cb215-3"></a>num_subjects</span></code></pre></div>
<pre><code>[1] 10320</code></pre>
<!-- ========================================================= -->
</div>
</div>
<div id="exploratory-data-analysis-2" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Exploratory Data Analysis</h2>
<!-- ========================================================= -->
<div id="summarize-descriptive-statistics-2" class="section level3" number="6.2.1">
<h3 number="6.2.1"><span class="header-section-number">6.2.1</span> Summarize Descriptive Statistics</h3>
<div id="the-stargazer-package-2" class="section level4" number="6.2.1.1">
<h4 number="6.2.1.1"><span class="header-section-number">6.2.1.1</span> The <code>stargazer</code> package</h4>
<p>Most posters, journal articles, and reports start with a table of descriptive statistics. Since it tends to come first, this type of table is often refered to as Table 1. The <code>stargazer()</code> function can be used to create such a table, but only for the entire dataset. I haven’t been able to find a way to get it to summarize subsamples and compare them in the standard format. Also, it only summarises continuous, not categorical variables.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1"></a><span class="co"># Knit to Website: type = &quot;html&quot; </span></span>
<span id="cb217-2"><a href="#cb217-2"></a><span class="co"># Knit to PDF:     type = &quot;latex&quot;</span></span>
<span id="cb217-3"><a href="#cb217-3"></a><span class="co"># View on Screen:  type = &quot;text&quot;</span></span>
<span id="cb217-4"><a href="#cb217-4"></a></span>
<span id="cb217-5"><a href="#cb217-5"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb217-6"><a href="#cb217-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(classize, gender, geread, gevocab, age, ses, senroll) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb217-7"><a href="#cb217-7"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb217-8"><a href="#cb217-8"></a><span class="st">  </span>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="dt">header =</span> <span class="ot">FALSE</span>,</span>
<span id="cb217-9"><a href="#cb217-9"></a>                      <span class="dt">title =</span> <span class="st">&quot;Summary of the numeric variables with `stargazer`&quot;</span>,</span>
<span id="cb217-10"><a href="#cb217-10"></a>                       <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Summary of the numeric variables with <code>stargazer</code></strong>
</caption>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
geread
</td>
<td>
10,320
</td>
<td>
4.341
</td>
<td>
2.332
</td>
<td>
0.000
</td>
<td>
2.800
</td>
<td>
4.900
</td>
<td>
12.000
</td>
</tr>
<tr>
<td style="text-align:left">
gevocab
</td>
<td>
10,320
</td>
<td>
4.494
</td>
<td>
2.368
</td>
<td>
0.000
</td>
<td>
2.900
</td>
<td>
5.200
</td>
<td>
11.200
</td>
</tr>
<tr>
<td style="text-align:left">
age
</td>
<td>
10,320
</td>
<td>
107.529
</td>
<td>
5.060
</td>
<td>
82
</td>
<td>
104
</td>
<td>
111
</td>
<td>
135
</td>
</tr>
<tr>
<td style="text-align:left">
ses
</td>
<td>
10,320
</td>
<td>
72.849
</td>
<td>
21.982
</td>
<td>
0.000
</td>
<td>
66.300
</td>
<td>
87.800
</td>
<td>
100.000
</td>
</tr>
<tr>
<td style="text-align:left">
senroll
</td>
<td>
10,320
</td>
<td>
533.415
</td>
<td>
154.797
</td>
<td>
115
</td>
<td>
438
</td>
<td>
644
</td>
<td>
916
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
<div id="the-furniture-package-2" class="section level4" number="6.2.1.2">
<h4 number="6.2.1.2"><span class="header-section-number">6.2.1.2</span> The <code>furniture</code> package</h4>
<p>Tyson Barrett’s <strong>furniture</strong> package includes the extremely useful function <code>table1()</code> which simplifies the common task of creating a stratified, comparative table of descriptive statistics. Full documentation can be accessed by executing <code>?furniture::table1</code>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1"></a><span class="co"># Knit to Website: output = &quot;html&quot; </span></span>
<span id="cb218-2"><a href="#cb218-2"></a><span class="co"># Knit to PDF:     output = &quot;latex2&quot;</span></span>
<span id="cb218-3"><a href="#cb218-3"></a><span class="co"># View on Screen:  output = &quot;&quot;text&quot;, or &quot;markdown&quot;, &quot;html&quot;</span></span>
<span id="cb218-4"><a href="#cb218-4"></a></span>
<span id="cb218-5"><a href="#cb218-5"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb218-6"><a href="#cb218-6"></a><span class="st">  </span>furniture<span class="op">::</span><span class="st"> </span><span class="kw">table1</span>(<span class="st">&quot;Reading Score&quot;</span>       =<span class="st"> </span>geread, </span>
<span id="cb218-7"><a href="#cb218-7"></a>                     <span class="st">&quot;Vocabulary Score&quot;</span>    =<span class="st"> </span>gevocab, </span>
<span id="cb218-8"><a href="#cb218-8"></a>                     <span class="st">&quot;Age (in months)&quot;</span>     =<span class="st"> </span>age, </span>
<span id="cb218-9"><a href="#cb218-9"></a>                     <span class="st">&quot;School SES&quot;</span>          =<span class="st"> </span>ses, </span>
<span id="cb218-10"><a href="#cb218-10"></a>                     <span class="st">&quot;School&#39;s Enrollment&quot;</span> =<span class="st"> </span>senroll,</span>
<span id="cb218-11"><a href="#cb218-11"></a>                     <span class="dt">splitby   =</span> <span class="op">~</span><span class="st"> </span>gender,                                        <span class="co"># var to divide sample by</span></span>
<span id="cb218-12"><a href="#cb218-12"></a>                     <span class="dt">test      =</span> <span class="ot">TRUE</span>,                                            <span class="co"># test groups different?</span></span>
<span id="cb218-13"><a href="#cb218-13"></a>                     <span class="dt">caption   =</span> <span class="st">&quot;Summary of the numeric variables with `table1`&quot;</span>, </span>
<span id="cb218-14"><a href="#cb218-14"></a>                     <span class="dt">output    =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table>
<caption>
(#tab:sumtable1)Summary of the numeric variables with <code>table1</code>
</caption>
<thead>
<tr>
<th>
</th>
<th>
Female
</th>
<th>
Male
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 5143
</td>
<td>
n = 5177
</td>
<td>
</td>
</tr>
<tr>
<td>
Reading Score
</td>
<td>
</td>
<td>
</td>
<td>
0.218
</td>
</tr>
<tr>
<td>
</td>
<td>
4.4 (2.3)
</td>
<td>
4.3 (2.3)
</td>
<td>
</td>
</tr>
<tr>
<td>
Vocabulary Score
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
</td>
<td>
4.6 (2.4)
</td>
<td>
4.4 (2.3)
</td>
<td>
</td>
</tr>
<tr>
<td>
Age (in months)
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
</td>
<td>
107.1 (5.0)
</td>
<td>
107.9 (5.1)
</td>
<td>
</td>
</tr>
<tr>
<td>
School SES
</td>
<td>
</td>
<td>
</td>
<td>
0.155
</td>
</tr>
<tr>
<td>
</td>
<td>
72.5 (22.3)
</td>
<td>
73.2 (21.7)
</td>
<td>
</td>
</tr>
<tr>
<td>
School’s Enrollment
</td>
<td>
</td>
<td>
</td>
<td>
0.483
</td>
</tr>
<tr>
<td>
</td>
<td>
532.3 (154.5)
</td>
<td>
534.5 (155.1)
</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="visualization-of-raw-data" class="section level3" number="6.2.2">
<h3 number="6.2.2"><span class="header-section-number">6.2.2</span> Visualization of Raw Data</h3>
<div id="level-one-plots-disaggregate-or-ignore-higher-levels" class="section level4" number="6.2.2.1">
<h4 number="6.2.2.1"><span class="header-section-number">6.2.2.1</span> Level One Plots: Disaggregate or ignore higher levels</h4>
<p>For a first look, its useful to plot all the data points on a single scatterplot as displayed in the previous plot. Due to the large sample size, many points end up being plotted on top of or very near each other (<em>overplotted</em>). When this is the case, it can be useful to use <code>geom_binhex()</code> rather than <code>geom_point()</code> so the color saturation of the hexigons convey the number of points at that location, as seen in Figure .</p>
<p><em>Note: I had to manually install the package <code>hexbin</code> for the <code>geom_hex()</code> to run.</em></p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb219-2"><a href="#cb219-2"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb219-3"><a href="#cb219-3"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> gevocab, </span>
<span id="cb219-4"><a href="#cb219-4"></a>      <span class="dt">y =</span> geread) <span class="op">+</span></span>
<span id="cb219-5"><a href="#cb219-5"></a><span class="st">  </span><span class="kw">stat_binhex</span>(<span class="dt">colour =</span> <span class="st">&quot;grey85&quot;</span>, <span class="dt">na.rm  =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st">     </span><span class="co"># outlines</span></span>
<span id="cb219-6"><a href="#cb219-6"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors   =</span> <span class="kw">c</span>(<span class="st">&quot;grey80&quot;</span>,<span class="st">&quot;navyblue&quot;</span>), <span class="co"># fill color extremes</span></span>
<span id="cb219-7"><a href="#cb219-7"></a>                       <span class="dt">name     =</span> <span class="st">&quot;Frequency&quot;</span>,        <span class="co"># legend title</span></span>
<span id="cb219-8"><a href="#cb219-8"></a>                       <span class="dt">na.value =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st">               </span><span class="co"># color for count = 0</span></span>
<span id="cb219-9"><a href="#cb219-9"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/densityHex-1.png" alt="Raw Data: Density, Vocab vs. Reading" width="576" />
<p class="caption">
(#fig:densityHex)Raw Data: Density, Vocab vs. Reading
</p>
</div>
</div>
<div id="multilevel-plots-illustrate-two-nested-levels" class="section level4" number="6.2.2.2">
<h4 number="6.2.2.2"><span class="header-section-number">6.2.2.2</span> Multilevel plots: illustrate two nested levels</h4>
<p>Up to this point, all investigation of this dataset has been only at the pupil level and any nesting or clustering within schools has been ignored. Plotting is a good was to start to get an idea of the school-to-school variability. This figure displays four handpicked school to illustrate the degreen of school-to-school variability in the <strong>association between vocab and reading</strong> scores.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb220-2"><a href="#cb220-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(school <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1321</span>, <span class="dv">6181</span>, </span>
<span id="cb220-3"><a href="#cb220-3"></a>                              <span class="dv">6197</span>, <span class="dv">6823</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># choose school numbers</span></span>
<span id="cb220-4"><a href="#cb220-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,</span>
<span id="cb220-5"><a href="#cb220-5"></a>             <span class="dt">y =</span> geread))<span class="op">+</span></span>
<span id="cb220-6"><a href="#cb220-6"></a><span class="st">  </span><span class="kw">geom_count</span>() <span class="op">+</span><span class="st">             </span><span class="co"># creates points, size by overplotted number</span></span>
<span id="cb220-7"><a href="#cb220-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st">     </span><span class="co"># linear model (OLS) </span></span>
<span id="cb220-8"><a href="#cb220-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>school) <span class="op">+</span><span class="st">           </span><span class="co"># panels by school</span></span>
<span id="cb220-9"><a href="#cb220-9"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/schoolRegEx-1.png" alt="Raw Data: Independent Single-Level Regression within each school, a few illustrative cases" width="576" />
<p class="caption">
(#fig:schoolRegEx)Raw Data: Independent Single-Level Regression within each school, a few illustrative cases
</p>
</div>
<p>Another way to explore the <strong>school-to-school variability</strong> is to plot the linear model fit <em>independently</em> to each of the schools. This next figure displays only the smooth lines without the standard error bands or the raw data in the form of points or hexagons.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb221-2"><a href="#cb221-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,</span>
<span id="cb221-3"><a href="#cb221-3"></a>             <span class="dt">y =</span> geread)) <span class="op">+</span></span>
<span id="cb221-4"><a href="#cb221-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> school),</span>
<span id="cb221-5"><a href="#cb221-5"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb221-6"><a href="#cb221-6"></a>              <span class="dt">se     =</span> <span class="ot">FALSE</span>,      <span class="co"># do NOT want the SE bands</span></span>
<span id="cb221-7"><a href="#cb221-7"></a>              <span class="dt">size   =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st">   </span></span>
<span id="cb221-8"><a href="#cb221-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb221-9"><a href="#cb221-9"></a>              <span class="dt">se     =</span> <span class="ot">FALSE</span>,</span>
<span id="cb221-10"><a href="#cb221-10"></a>              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,       <span class="co"># do NOT want the SE bands</span></span>
<span id="cb221-11"><a href="#cb221-11"></a>              <span class="dt">size   =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st">        </span><span class="co"># make the lines thinner</span></span>
<span id="cb221-12"><a href="#cb221-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/schoolRegAll-1.png" alt="Raw Data: Independent Single-Level Regression within each school, all schools shown together" width="576" />
<p class="caption">
(#fig:schoolRegAll)Raw Data: Independent Single-Level Regression within each school, all schools shown together
</p>
</div>
<p>Due to the high number of schools, the figure with all the school’s independent linear regression lines resembles a hairball and is hard to deduce much about individual schools. By using the <code>facet_grid()</code> layer, we can separate the schools out so better see school-to-school variability. It also allows investigation of higher level predictors, such as the school’s SES (median split with <code>ntile(var, 2)</code>) and class size.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-2"><a href="#cb222-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ses2 =</span> <span class="kw">ntile</span>(ses, <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st">                  </span><span class="co"># median split</span></span>
<span id="cb222-3"><a href="#cb222-3"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;SES: Lower Half&quot;</span>, </span>
<span id="cb222-4"><a href="#cb222-4"></a>                                    <span class="st">&quot;SES: Upper Half&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-5"><a href="#cb222-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">senroll =</span> <span class="kw">ntile</span>(senroll, <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-6"><a href="#cb222-6"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Enroll: Smallest Third&quot;</span>,</span>
<span id="cb222-7"><a href="#cb222-7"></a>                                    <span class="st">&quot;Enroll: Middle Third&quot;</span>,</span>
<span id="cb222-8"><a href="#cb222-8"></a>                                    <span class="st">&quot;Enroll: Largest Third&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-9"><a href="#cb222-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x       =</span> gevocab,</span>
<span id="cb222-10"><a href="#cb222-10"></a>             <span class="dt">y       =</span> geread,</span>
<span id="cb222-11"><a href="#cb222-11"></a>             <span class="dt">group   =</span> school)) <span class="op">+</span><span class="st">     </span><span class="co"># separates students into schools</span></span>
<span id="cb222-12"><a href="#cb222-12"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb222-13"><a href="#cb222-13"></a>              <span class="dt">se     =</span> <span class="ot">FALSE</span>,         </span>
<span id="cb222-14"><a href="#cb222-14"></a>              <span class="dt">size   =</span> <span class="fl">0.3</span>,</span>
<span id="cb222-15"><a href="#cb222-15"></a>              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb222-16"><a href="#cb222-16"></a>              <span class="dt">alpha =</span> <span class="fl">.2</span>) <span class="op">+</span><span class="st">         </span></span>
<span id="cb222-17"><a href="#cb222-17"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb222-18"><a href="#cb222-18"></a><span class="st">  </span><span class="kw">facet_grid</span>(senroll <span class="op">~</span><span class="st"> </span>ses2)     <span class="co"># makes separate panels (rows ~ columns)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/classRegSep-1.png" alt="Raw Data: Independent Single-Level Regression within each school, sepearated by school size and school SES" width="576" />
<p class="caption">
(#fig:classRegSep)Raw Data: Independent Single-Level Regression within each school, sepearated by school size and school SES
</p>
</div>
<!-- ========================================================= -->
</div>
</div>
</div>
<div id="single-level-regression" class="section level2" number="6.3">
<h2 number="6.3"><span class="header-section-number">6.3</span> Single-Level Regression</h2>
<!-- ========================================================= -->
<div id="fit-nested-models-2" class="section level3" number="6.3.1">
<h3 number="6.3.1"><span class="header-section-number">6.3.1</span> Fit Nested Models</h3>
<p>Ignoring the fact that students are nested or clustered within schools, is called dissagregating. This treats all students as independent units.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a><span class="co"># linear model - ignores school (for reference only)</span></span>
<span id="cb223-2"><a href="#cb223-2"></a>fit_read_lm_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> geread <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,               <span class="co"># intercept only</span></span>
<span id="cb223-3"><a href="#cb223-3"></a>                    <span class="dt">data    =</span> data_achieve)</span>
<span id="cb223-4"><a href="#cb223-4"></a></span>
<span id="cb223-5"><a href="#cb223-5"></a>fit_read_lm_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> geread <span class="op">~</span><span class="st"> </span>gevocab ,        <span class="co"># one predictor</span></span>
<span id="cb223-6"><a href="#cb223-6"></a>                    <span class="dt">data    =</span> data_achieve)</span>
<span id="cb223-7"><a href="#cb223-7"></a></span>
<span id="cb223-8"><a href="#cb223-8"></a>fit_read_lm_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>age,   <span class="co"># two predictors</span></span>
<span id="cb223-9"><a href="#cb223-9"></a>                    <span class="dt">data    =</span> data_achieve)</span>
<span id="cb223-10"><a href="#cb223-10"></a></span>
<span id="cb223-11"><a href="#cb223-11"></a>fit_read_lm_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age,    <span class="co"># interation+main effects</span></span>
<span id="cb223-12"><a href="#cb223-12"></a>                    <span class="dt">data    =</span> data_achieve)</span></code></pre></div>
<p>Now compare the models:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_lm_<span class="dv">0</span>, </span>
<span id="cb224-2"><a href="#cb224-2"></a>                     fit_read_lm_<span class="dv">1</span>, </span>
<span id="cb224-3"><a href="#cb224-3"></a>                     fit_read_lm_<span class="dv">2</span>, </span>
<span id="cb224-4"><a href="#cb224-4"></a>                     fit_read_lm_<span class="dv">3</span>),</span>
<span id="cb224-5"><a href="#cb224-5"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Null&quot;</span>,</span>
<span id="cb224-6"><a href="#cb224-6"></a>                                       <span class="st">&quot;1 IV&quot;</span>,</span>
<span id="cb224-7"><a href="#cb224-7"></a>                                       <span class="st">&quot;2 IV&quot;</span>,</span>
<span id="cb224-8"><a href="#cb224-8"></a>                                       <span class="st">&quot;Interaction&quot;</span>),</span>
<span id="cb224-9"><a href="#cb224-9"></a>                <span class="dt">caption            =</span> <span class="st">&quot;OLS: Investigate Fixed, Pupil-level Predictors&quot;</span>,</span>
<span id="cb224-10"><a href="#cb224-10"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb224-11"><a href="#cb224-11"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
OLS: Investigate Fixed, Pupil-level Predictors
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Null
</th>
<th style="padding-left: 5px;padding-right: 5px;">
1 IV
</th>
<th style="padding-left: 5px;padding-right: 5px;">
2 IV
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Interaction
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.34 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.96 (0.04)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.19 (0.42)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.28 (0.87)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.53 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.53 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01 (0.19)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.01 (0.00)<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03 (0.01)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab:age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00 (0.00)<sup>**</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.29
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.29
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.29
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Adj. R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.29
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.29
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.29
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Assess the significance of terms in the last ‘best’ model</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1"></a><span class="kw">summary</span>(fit_read_lm_<span class="dv">3</span>) </span></code></pre></div>
<pre><code>
Call:
lm(formula = geread ~ gevocab * age, data = data_achieve)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2069 -1.1250 -0.4362  0.6041  8.6476 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.282607   0.869769   6.074  1.3e-09 ***
gevocab      0.009154   0.189113   0.048 0.961394    
age         -0.030814   0.008066  -3.820 0.000134 ***
gevocab:age  0.004830   0.001759   2.746 0.006039 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.965 on 10316 degrees of freedom
Multiple R-squared:  0.2902,    Adjusted R-squared:   0.29 
F-statistic:  1406 on 3 and 10316 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a>performance<span class="op">::</span><span class="kw">r2</span>(fit_read_lm_<span class="dv">3</span>)</span></code></pre></div>
<pre><code># R2 for Linear Regression

       R2: 0.290
  adj. R2: 0.290</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1"></a><span class="kw">anova</span>(fit_read_lm_<span class="dv">3</span>)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: geread
               Df Sum Sq Mean Sq   F value    Pr(&gt;F)    
gevocab         1  16224 16223.9 4202.2783 &lt; 2.2e-16 ***
age             1     34    33.7    8.7356  0.003128 ** 
gevocab:age     1     29    29.1    7.5419  0.006039 ** 
Residuals   10316  39827     3.9                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="visualize-the-interaction" class="section level3" number="6.3.2">
<h3 number="6.3.2"><span class="header-section-number">6.3.2</span> Visualize the Interaction</h3>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>),     <span class="co"># chooses default values for</span></span>
<span id="cb231-2"><a href="#cb231-2"></a>                <span class="dt">mod =</span> fit_read_lm_<span class="dv">3</span>)                        <span class="co"># continuous vars</span></span></code></pre></div>
<pre><code>
 gevocab*age effect
       age
gevocab       82       95      110      120       140
     0  2.755830 2.355243 1.893028 1.584884 0.9685969
     3  3.971571 3.759370 3.514523 3.351291 3.0248284
     6  5.187313 5.163497 5.136018 5.117699 5.0810599
     8  5.997807 6.099582 6.217015 6.295304 6.4518809
     10 6.808301 7.035667 7.298012 7.472909 7.8227019</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>),     <span class="co"># chooses default values for</span></span>
<span id="cb233-2"><a href="#cb233-2"></a>                <span class="dt">mod =</span> fit_read_lm_<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st">                    </span><span class="co"># continuous vars</span></span>
<span id="cb233-3"><a href="#cb233-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb233-4"><a href="#cb233-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age =</span> <span class="kw">factor</span>(age)) <span class="op">%&gt;%</span><span class="st">           </span><span class="co"># must make a factor to separate lines</span></span>
<span id="cb233-5"><a href="#cb233-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,</span>
<span id="cb233-6"><a href="#cb233-6"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb233-7"><a href="#cb233-7"></a>             <span class="dt">color =</span> age)) <span class="op">+</span></span>
<span id="cb233-8"><a href="#cb233-8"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb233-9"><a href="#cb233-9"></a><span class="st">  </span><span class="kw">geom_line</span>() </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-195-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is a better version of the plot.</p>
<p>Age is in months, so we want multiples of 12 for good visualization</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1"></a><span class="kw">summary</span>(data_achieve<span class="op">$</span>age)<span class="op">/</span><span class="dv">12</span>   <span class="co"># divide by 12 to change months to years</span></span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  6.833   8.667   8.917   8.961   9.250  11.250 </code></pre>
<p>A good set set of illustrative ages could be: 7, 9, and 11:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1"></a><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>) <span class="op">*</span><span class="st"> </span><span class="dv">12</span>   <span class="co"># times by 12 to change years to months</span></span></code></pre></div>
<pre><code>[1]  84 108 132</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>),</span>
<span id="cb238-2"><a href="#cb238-2"></a>                <span class="dt">mod =</span> fit_read_lm_<span class="dv">3</span>,</span>
<span id="cb238-3"><a href="#cb238-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">108</span>, <span class="dv">132</span>))) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># age is in months</span></span>
<span id="cb238-4"><a href="#cb238-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb238-5"><a href="#cb238-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_yr =</span> <span class="kw">factor</span>(age<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># it would be nice to plot age in years</span></span>
<span id="cb238-6"><a href="#cb238-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x        =</span> gevocab,</span>
<span id="cb238-7"><a href="#cb238-7"></a>             <span class="dt">y        =</span> fit,</span>
<span id="cb238-8"><a href="#cb238-8"></a>             <span class="dt">color    =</span> age_yr,</span>
<span id="cb238-9"><a href="#cb238-9"></a>             <span class="dt">linetype =</span> age_yr)) <span class="op">+</span></span>
<span id="cb238-10"><a href="#cb238-10"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.25</span>) <span class="op">+</span></span>
<span id="cb238-11"><a href="#cb238-11"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb238-12"><a href="#cb238-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Best Linear Model - Disaggregated Data (OLS)&quot;</span>,</span>
<span id="cb238-13"><a href="#cb238-13"></a>       <span class="dt">x =</span> <span class="st">&quot;Vocabulary Score&quot;</span>,</span>
<span id="cb238-14"><a href="#cb238-14"></a>       <span class="dt">y =</span> <span class="st">&quot;Reading Score&quot;</span>,</span>
<span id="cb238-15"><a href="#cb238-15"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Age (yrs)&quot;</span>,</span>
<span id="cb238-16"><a href="#cb238-16"></a>       <span class="dt">color    =</span> <span class="st">&quot;Age (yrs)&quot;</span>) <span class="op">+</span></span>
<span id="cb238-17"><a href="#cb238-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.85</span>, <span class="fl">0.2</span>),</span>
<span id="cb238-18"><a href="#cb238-18"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb238-19"><a href="#cb238-19"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb238-20"><a href="#cb238-20"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>)) <span class="op">+</span></span>
<span id="cb238-21"><a href="#cb238-21"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">11</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb238-22"><a href="#cb238-22"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">11</span>, <span class="dt">by =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/mlInteraction-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm---step-1-null-model-only-fixed-and-random-intercepts" class="section level2" number="6.4">
<h2 number="6.4"><span class="header-section-number">6.4</span> MLM - Step 1: Null Model, only fixed and random intercepts</h2>
<!-- ========================================================= -->
<p>A so called <em>Empty Model</em> only includes random intercepts. No independent variables are involved, other the grouping or clustering variable that designates how <em>level 1</em> units are nested within <em>level 2</em> units. For a cross-sectional study design this would be the grouping variables, where as for longitudinal or repeated measures designs this would be the subject identifier. This <strong>nested structure</strong> variable should be set to have class <code>factor</code>.</p>
<div id="fit-the-model-9" class="section level3" number="6.4.1">
<h3 number="6.4.1"><span class="header-section-number">6.4.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a>fit_read_0ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school), </span>
<span id="cb239-2"><a href="#cb239-2"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb239-3"><a href="#cb239-3"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)                  <span class="co"># fit via ML (not the default)</span></span>
<span id="cb239-4"><a href="#cb239-4"></a></span>
<span id="cb239-5"><a href="#cb239-5"></a>fit_read_0re &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school) , </span>
<span id="cb239-6"><a href="#cb239-6"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb239-7"><a href="#cb239-7"></a>                           <span class="dt">REML =</span> <span class="ot">TRUE</span>)                   <span class="co"># fit = REML (the default)</span></span></code></pre></div>
<p>Compare the two models to OLS:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_lm_<span class="dv">0</span>, </span>
<span id="cb240-2"><a href="#cb240-2"></a>                     fit_read_0ml, </span>
<span id="cb240-3"><a href="#cb240-3"></a>                     fit_read_0re),</span>
<span id="cb240-4"><a href="#cb240-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;OLS&quot;</span>, </span>
<span id="cb240-5"><a href="#cb240-5"></a>                                       <span class="st">&quot;MLM-ML&quot;</span>, </span>
<span id="cb240-6"><a href="#cb240-6"></a>                                       <span class="st">&quot;MLM-REML&quot;</span>),</span>
<span id="cb240-7"><a href="#cb240-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: NULL Model,two estimation methods&quot;</span>,</span>
<span id="cb240-8"><a href="#cb240-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb240-9"><a href="#cb240-9"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: NULL Model,two estimation methods
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
OLS
</th>
<th style="padding-left: 5px;padding-right: 5px;">
MLM-ML
</th>
<th style="padding-left: 5px;padding-right: 5px;">
MLM-REML
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.34 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.31 (0.05)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.31 (0.05)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Adj. R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
46270.34
</td>
<td style="padding-left: 5px;padding-right: 5px;">
46274.31
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
46292.06
</td>
<td style="padding-left: 5px;padding-right: 5px;">
46296.03
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-23132.17
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-23134.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.05
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.05
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Notice that the estimate for the intercept is nearly the same in the linear regression and intercept only models, but the standard errors are quite different. When there is clustering in sample, the result of ignoring it is under estimation of the standard errors and over stating the significance of associations. This table was made with the <code>screenreg()</code> function in the self named package. I tend to prefer this display over <code>stargazer()</code>.</p>
</div>
<div id="estimate-the-icc-1" class="section level3" number="6.4.2">
<h3 number="6.4.2"><span class="header-section-number">6.4.2</span> Estimate the ICC</h3>
<p>First, ask for the variance compenents:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_read_0re) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb241-2"><a href="#cb241-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),</span>
<span id="cb241-3"><a href="#cb241-3"></a>        <span class="dt">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code> Groups   Name        Variance Std.Dev.
 school   (Intercept) 0.3915   0.6257  
 Residual             5.0450   2.2461  </code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a>insight<span class="op">::</span><span class="kw">get_variance</span>(fit_read_0re)</span></code></pre></div>
<pre><code>$var.fixed
[1] 0

$var.random
[1] 0.3915154

$var.residual
[1] 5.045008

$var.distribution
[1] 5.045008

$var.dispersion
[1] 0

$var.intercept
   school 
0.3915154 </code></pre>
<p><span class="math display">\[
\begin{align*}
\text{schools}                      \rightarrow \; &amp; \sigma^2_{u0} = 0.6257^2 = 0.392 \\
\text{students within schools}      \rightarrow \; &amp;   \sigma^2_{e}  = 2.2461^2 = 5.045 \\
\end{align*}
\]</span></p>
<div class="genericEq">
<p>
<strong>Intraclass Correlation (ICC) Formula</strong> <span class="math display"><span class="math display">\[
\overbrace{\rho}^{\text{ICC}} = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random Intercept}\atop\text{Variance}}}
     {\underbrace{\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.9}
\]</span></span>
</p>
</div>
<p>Then you can manually calculate the ICC.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1"></a><span class="fl">0.392</span> <span class="op">/</span><span class="st"> </span>(<span class="fl">0.392</span> <span class="op">+</span><span class="st"> </span><span class="fl">5.045</span>)</span></code></pre></div>
<pre><code>[1] 0.07209858</code></pre>
<p>Or you can use the <code>icc()</code> function in the <code>performance</code> package.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a>performance<span class="op">::</span><span class="kw">icc</span>(fit_read_0re)</span></code></pre></div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.072
  Conditional ICC: 0.072</code></pre>
<p><em>Note: On page 45 <span class="citation">(Finch, Bolin, and Kelley <a href="#ref-finch2016" role="doc-biblioref">2016</a>)</span>, the authors substituted standard deviations into the formula, rather than variances. The mistake is listed on their webpage errata (<a href="http://www.mlminr.com/errata" class="uri">http://www.mlminr.com/errata</a>) and is repeated through the text.</em></p>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm---step-2-add-lower-level-explanatory-variables-fixed-ml" class="section level2" number="6.5">
<h2 number="6.5"><span class="header-section-number">6.5</span> MLM - Step 2: Add Lower-level explanatory variables, fixed, ML</h2>
<!-- ========================================================= -->
<p><strong>Variance Component</strong> models (steps 2 and 3) - decompose the INTERCEPT variance into different variance compondents for each level. The regression intercepts are assumed to varry ACROSS the groups, while the slopes are assumed fixed (no random effects).</p>
<p>Fixed effects selection should come <strong>prior</strong> to random effects. You should use <em>Maximum Likelihood (ML)</em> estimation when fitting these models.</p>
<div class="rmdlightbulb">
<ul>
<li>
IF: only level 1 predictors and random intercepts are incorporated<br />
</li>
<li>
Then: MLM <span class="math inline"><span class="math inline">\(\approx\)</span></span> ANCOVA .
</li>
</ul>
</div>
<div id="add-pupils-vocab-score-as-a-fixed-effects-predictor" class="section level3" number="6.5.1">
<h3 number="6.5.1"><span class="header-section-number">6.5.1</span> Add pupil’s vocab score as a fixed effects predictor</h3>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a>fit_read_1ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school), </span>
<span id="cb249-2"><a href="#cb249-2"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb249-3"><a href="#cb249-3"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)            <span class="co"># to compare fixed var sig</span></span>
<span id="cb249-4"><a href="#cb249-4"></a></span>
<span id="cb249-5"><a href="#cb249-5"></a>fit_read_1re &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school), </span>
<span id="cb249-6"><a href="#cb249-6"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb249-7"><a href="#cb249-7"></a>                           <span class="dt">REML =</span> <span class="ot">TRUE</span>)             <span class="co"># for R-sq calcs</span></span></code></pre></div>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_0ml, </span>
<span id="cb250-2"><a href="#cb250-2"></a>                     fit_read_1ml),</span>
<span id="cb250-3"><a href="#cb250-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Null&quot;</span>, </span>
<span id="cb250-4"><a href="#cb250-4"></a>                                       <span class="st">&quot;w Pred&quot;</span>),</span>
<span id="cb250-5"><a href="#cb250-5"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM: Investigate a Fixed Pupil-level Predictor&quot;</span>,</span>
<span id="cb250-6"><a href="#cb250-6"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb250-7"><a href="#cb250-7"></a>                <span class="dt">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Investigate a Fixed Pupil-level Predictor
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Null
</th>
<th style="padding-left: 5px;padding-right: 5px;">
w Pred
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.3068<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.0231<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0548)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0492)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.5130<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0084)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
46270.3388
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43132.4318
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
46292.0643
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43161.3991
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-23132.1694
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21562.2159
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.3885
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0987
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.0450
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.7661
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div id="assess-significance-of-effects" class="section level4" number="6.5.1.1">
<h4 number="6.5.1.1"><span class="header-section-number">6.5.1.1</span> Assess Significance of Effects</h4>
<p>Likelihood Ratio Test (LRT)</p>
<p>Since models 0 and 1 are nested models, only differing by the the inclusion or exclusion of the fixed effects predictor <code>gevocab</code>, AND both models were fit via Maximum Likelihood, we can compare the model fit may be compared via the <em>Likilihood-Ratio Test (LRT)</em>. The <em>Likelihood Ratio</em> value <em>(L. Ratio)</em> is found by subtracting the two model’s <code>-2 * logLik</code> or <code>deviance</code> values. Significance is judged by the Chi Squared distribution, using the difference in the number of parameters fit as the degrees of freedom.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1"></a><span class="kw">anova</span>(fit_read_0ml, fit_read_1ml)</span></code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_0ml: geread ~ 1 + (1 | school)
fit_read_1ml: geread ~ gevocab + (1 | school)
             npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_read_0ml    3 46270 46292 -23132    46264                         
fit_read_1ml    4 43132 43161 -21562    43124 3139.9  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>What does the model look like?</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>), </span>
<span id="cb253-2"><a href="#cb253-2"></a>                <span class="dt">mod =</span> fit_read_1ml) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb253-3"><a href="#cb253-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb253-4"><a href="#cb253-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,</span>
<span id="cb253-5"><a href="#cb253-5"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb253-6"><a href="#cb253-6"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,</span>
<span id="cb253-7"><a href="#cb253-7"></a>                  <span class="dt">ymax =</span> upper),</span>
<span id="cb253-8"><a href="#cb253-8"></a>                <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb253-9"><a href="#cb253-9"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb253-10"><a href="#cb253-10"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-208-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="proportion-of-variance-explained" class="section level4" number="6.5.1.2">
<h4 number="6.5.1.2"><span class="header-section-number">6.5.1.2</span> Proportion of Variance Explained</h4>
<p>Extract the variance-covariance estimates:</p>
<p>BL = BAseline: The Null Model (fit via REML)</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_read_0re) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb254-2"><a href="#cb254-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),</span>
<span id="cb254-3"><a href="#cb254-3"></a>        <span class="dt">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code> Groups   Name        Variance Std.Dev.
 school   (Intercept) 0.3915   0.6257  
 Residual             5.0450   2.2461  </code></pre>
<p><span class="math display">\[
\sigma^2_{u0-BL} = 0.392 \\
\sigma^2_{e-BL}  = 5.045 
\]</span></p>
<p>MC = Model to Compare: Model with Predictor (fit via REML)</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_read_1re) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-2"><a href="#cb256-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),</span>
<span id="cb256-3"><a href="#cb256-3"></a>        <span class="dt">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code> Groups   Name        Variance Std.Dev.
 school   (Intercept) 0.09978  0.3159  
 Residual             3.76647  1.9407  </code></pre>
<p><span class="math display">\[
\sigma^2_{u0-MC} = 0.100 \\
\sigma^2_{e-MC}  = 3.766 
\]</span></p>
<p><strong>Level 1 <span class="math inline">\(R^2\)</span> - Snijders and Bosker</strong></p>
<p>Found on page 47 <span class="citation">(Finch, Bolin, and Kelley <a href="#ref-finch2016" role="doc-biblioref">2016</a>)</span>, the proportion of variance in the outcome explained by predictor on level one is given by:</p>
<div class="genericEq">
<p>
<strong>Snijders and Bosker Formula - Level 1 </strong> <span class="math display"><span class="math display">\[
R^2_1 = 1 - \frac{\sigma^2_{e-MC} + \sigma^2_{u0-MC}}
                 {\sigma^2_{e-BL} + \sigma^2_{u0-BL}}
\]</span></span>
</p>
</div>
<p><em>Note: This formula also apprears in the Finch errata. The subscripts in the denominator of the fraction should be for model 0, not model 1. The formula is given correctly here. They did substitute in the correct values.</em></p>
<p>Calculate the value by hand:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">0.100</span> <span class="op">+</span><span class="st"> </span><span class="fl">3.766</span>)<span class="op">/</span>(<span class="fl">0.392</span> <span class="op">+</span><span class="st"> </span><span class="fl">5.045</span>)</span></code></pre></div>
<pre><code>[1] 0.2889461</code></pre>
<p>Or use the <code>performance</code> package to help out: (Note it is using a difference method…)</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1"></a>performance<span class="op">::</span><span class="kw">r2</span>(fit_read_1re)</span></code></pre></div>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.295
     Marginal R2: 0.276</code></pre>
<p>This means nearly 30% of the variance in reading scores, above and beyond that accounted for by school membership <em>(i.e. school makeup or school-to-school variation)</em>, is attributable to vocabulary scores.</p>
<p><strong>Level 1 <span class="math inline">\(R^2\)</span> - Raudenbush and Bryk</strong></p>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span> presents this formula on page 58 of chapter 2</p>
<div class="genericEq">
<p>
<strong>Raudenbush and Bryk Approximate Formula - Level 1 </strong> <span class="math display"><span class="math display">\[
approx\; R^2_1 = \frac{\sigma^2_{e-BL} - \sigma^2_{e-MC}}
              {\sigma^2_{e-BL} }
\tag{Hox 4.8}
\]</span></span>
</p>
</div>
<p>Calculate the value by hand:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1"></a>(<span class="fl">5.045</span> <span class="op">-</span><span class="st"> </span><span class="fl">3.766</span>) <span class="op">/</span><span class="st"> </span><span class="fl">5.045</span></span></code></pre></div>
<pre><code>[1] 0.2535183</code></pre>
<p>Although slightly different in value and meaning, this value also conveys that vocabulary scores are highly associated with reading scores.</p>
<p><strong>Level 2 <span class="math inline">\(R^2\)</span> - Snijders and Bosker Formula Extended </strong></p>
<div class="genericEq">
<p>
<strong>Snijders and Bosker Formula Extended - Level 2 </strong> <span class="math display"><span class="math display">\[
R^2_2 = 1 - \frac{\frac{\sigma^2_{e-MC}}{B} + \sigma^2_{u0-MC}}
                 {\frac{\sigma^2_{e-BL}}{B} + \sigma^2_{u0-BL}}
\]</span></span>
</p>
<p>
<span class="math inline"><span class="math inline">\(B\)</span></span> is the average size of the Level 2 units (schools). Technically, you should use the <em>harmonic mean</em>, but unless the clusters differ greatly in size, it doesn’t make a huge difference.
</p>
</div>
<ul>
<li>Average sample cluster size</li>
</ul>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1"></a>num_subjects <span class="op">/</span><span class="st"> </span>num_schools</span></code></pre></div>
<pre><code>[1] 64.5</code></pre>
<ul>
<li>Calculate by hand:</li>
</ul>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>((<span class="fl">3.766</span> <span class="op">/</span><span class="st"> </span><span class="fl">64.5</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.100</span>) <span class="op">/</span><span class="st"> </span>((<span class="fl">5.045</span> <span class="op">/</span><span class="st"> </span><span class="fl">64.5</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.391</span>)</span></code></pre></div>
<pre><code>[1] 0.6624428</code></pre>
<p>This means that over two-thirds in school mean reading levels may be explained by their student’s vocabulary scores.</p>
<p><strong>Level 2 <span class="math inline">\(R^2\)</span> - Raudenbush and Bryk</strong></p>
<div class="genericEq">
<p>
<strong>Raudenbush and Bryk Approximate Formula - Level 2 </strong> <span class="math display"><span class="math display">\[
R^2_1 = \frac{\sigma^2_{u0-BL} - \sigma^2_{u0-MC}}
                 {\sigma^2_{u0-BL} }
\tag{Hox 4.9}
\]</span></span>
</p>
</div>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1"></a>(<span class="fl">0.392</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.100</span>)<span class="op">/</span>(<span class="fl">0.392</span>)</span></code></pre></div>
<pre><code>[1] 0.744898</code></pre>
<p>Remeber that these ‘variance accounted for’ estimations are not as straight forwards as we would like.</p>
</div>
</div>
<div id="investigate-more-level-1-predictors" class="section level3" number="6.5.2">
<h3 number="6.5.2"><span class="header-section-number">6.5.2</span> Investigate More Level 1 Predictors</h3>
<p>Part of investigating lower level explanatory variables, is checking for interactions between these variables. The interaction between fixed effects is also considered to be a fixed effect, so we need to employ <em>Maximum Likelihood</em> estimation to compare nested models.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1"></a>fit_read_2ml &lt;-<span class="st"> </span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), <span class="co"># add main effect of age</span></span>
<span id="cb270-2"><a href="#cb270-2"></a>                     <span class="dt">data =</span> data_achieve,</span>
<span id="cb270-3"><a href="#cb270-3"></a>                     <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb270-4"><a href="#cb270-4"></a></span>
<span id="cb270-5"><a href="#cb270-5"></a>fit_read_3ml &lt;-<span class="st"> </span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), <span class="co"># add interaction between vocab and age</span></span>
<span id="cb270-6"><a href="#cb270-6"></a>                     <span class="dt">data =</span> data_achieve,</span>
<span id="cb270-7"><a href="#cb270-7"></a>                     <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_1ml, </span>
<span id="cb271-2"><a href="#cb271-2"></a>                     fit_read_2ml, </span>
<span id="cb271-3"><a href="#cb271-3"></a>                     fit_read_3ml),</span>
<span id="cb271-4"><a href="#cb271-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Only Vocab&quot;</span>, </span>
<span id="cb271-5"><a href="#cb271-5"></a>                                       <span class="st">&quot;Both Main Effects&quot;</span>, </span>
<span id="cb271-6"><a href="#cb271-6"></a>                                       <span class="st">&quot;Interaction&quot;</span>),</span>
<span id="cb271-7"><a href="#cb271-7"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM: Investigate Other Fixed Pupil-level Predictors&quot;</span>,</span>
<span id="cb271-8"><a href="#cb271-8"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb271-9"><a href="#cb271-9"></a>                <span class="dt">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Investigate Other Fixed Pupil-level Predictors
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Only Vocab
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Both Main Effects
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Interaction
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.0231<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.0049<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.1874<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0492)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.4172)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.8666)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.5130<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.5121<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0279
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0084)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0084)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1881)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0091<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0294<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0038)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0080)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab:age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0050<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0017)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43132.4318
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43128.8201
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43122.5687
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43161.3991
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43165.0293
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43166.0198
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21562.2159
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21559.4100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21555.2844
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0987
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0973
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0977
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.7661
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.7646
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.7614
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div id="assess-significance-of-effects-1" class="section level4" number="6.5.2.1">
<h4 number="6.5.2.1"><span class="header-section-number">6.5.2.1</span> Assess Significance of Effects</h4>
<p>Likelihood Ratio Test (LRT)</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1"></a><span class="kw">anova</span>(fit_read_1ml, fit_read_2ml, fit_read_3ml)</span></code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_1ml: geread ~ gevocab + (1 | school)
fit_read_2ml: geread ~ gevocab + age + (1 | school)
fit_read_3ml: geread ~ gevocab * age + (1 | school)
             npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)   
fit_read_1ml    4 43132 43161 -21562    43124                        
fit_read_2ml    5 43129 43165 -21559    43119 5.6117  1   0.017841 * 
fit_read_3ml    6 43123 43166 -21555    43111 8.2514  1   0.004072 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Not only is student’s age predictive of their reading level (I could have guessed that), but that age moderated the relationship between vocabulary and reading.</p>
</div>
<div id="visulaize-the-interation" class="section level4" number="6.5.2.2">
<h4 number="6.5.2.2"><span class="header-section-number">6.5.2.2</span> Visulaize the Interation</h4>
<p>Visulaizations are extremely helpful to interpred interactions.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1"></a><span class="kw">summary</span>(data_achieve<span class="op">$</span>age)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   82.0   104.0   107.0   107.5   111.0   135.0 </code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>),   <span class="co"># variables involved in the interaction</span></span>
<span id="cb276-2"><a href="#cb276-2"></a>                <span class="dt">mod =</span> fit_read_3ml,</span>
<span id="cb276-3"><a href="#cb276-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">108</span>, <span class="dv">132</span>))) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># age is in months</span></span>
<span id="cb276-4"><a href="#cb276-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb276-5"><a href="#cb276-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_yr =</span> <span class="kw">factor</span>(age<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># it would be nice to plot age in years </span></span>
<span id="cb276-6"><a href="#cb276-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,</span>
<span id="cb276-7"><a href="#cb276-7"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb276-8"><a href="#cb276-8"></a>             <span class="dt">color =</span> age_yr)) <span class="op">+</span></span>
<span id="cb276-9"><a href="#cb276-9"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb276-10"><a href="#cb276-10"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-225-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>There is a positive association between vocabulary and reading, but it is strongest for older childred. Among younger children, reading scores are more stable across vocabulary differences.</p>
<!-- ========================================================= -->
</div>
</div>
</div>
<div id="mlm---step-3-higher-level-explanatory-variables-fixed-ml" class="section level2" number="6.6">
<h2 number="6.6"><span class="header-section-number">6.6</span> MLM - Step 3: Higher-level explanatory variables, fixed, ML</h2>
<!-- ========================================================= -->
<p>School enrollment (<code>senroll</code>) applies to each school as a whole. When a variable is measured at a higher level, all units in the same group have the same value. In this case, all student in the same school have the same value for <code>senroll</code>.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1"></a>fit_read_4ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>senroll <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb277-2"><a href="#cb277-2"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb277-3"><a href="#cb277-3"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_0ml, </span>
<span id="cb278-2"><a href="#cb278-2"></a>                     fit_read_3ml, </span>
<span id="cb278-3"><a href="#cb278-3"></a>                     fit_read_4ml),</span>
<span id="cb278-4"><a href="#cb278-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Null&quot;</span>, </span>
<span id="cb278-5"><a href="#cb278-5"></a>                                       <span class="st">&quot;Level 1 only&quot;</span>, </span>
<span id="cb278-6"><a href="#cb278-6"></a>                                       <span class="st">&quot;Level 2 Pred&quot;</span>),</span>
<span id="cb278-7"><a href="#cb278-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Investigate a Fixed School-Level Predictor&quot;</span>,</span>
<span id="cb278-8"><a href="#cb278-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb278-9"><a href="#cb278-9"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Investigate a Fixed School-Level Predictor
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Null
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Level 1 only
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Level 2 Pred
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.31 (0.05)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.19 (0.87)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.24 (0.87)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03 (0.19)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03 (0.19)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03 (0.01)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab:age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01 (0.00)<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01 (0.00)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
senroll
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.00 (0.00)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
46270.34
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43122.57
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43124.31
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
46292.06
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43166.02
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43175.01
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-23132.17
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21555.28
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21555.16
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.05
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.76
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.76
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div id="assess-significance-of-effects-2" class="section level3" number="6.6.1">
<h3 number="6.6.1"><span class="header-section-number">6.6.1</span> Assess Significance of Effects</h3>
<p>Likelihood Ratio Test (LRT)</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1"></a><span class="kw">anova</span>(fit_read_0ml, fit_read_3ml, fit_read_4ml)</span></code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_0ml: geread ~ 1 + (1 | school)
fit_read_3ml: geread ~ gevocab * age + (1 | school)
fit_read_4ml: geread ~ gevocab * age + senroll + (1 | school)
             npar   AIC   BIC logLik deviance     Chisq Df Pr(&gt;Chisq)    
fit_read_0ml    3 46270 46292 -23132    46264                            
fit_read_3ml    6 43123 43166 -21555    43111 3153.7701  3     &lt;2e-16 ***
fit_read_4ml    7 43124 43175 -21555    43110    0.2548  1     0.6137    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>School enrollment (or size) does not seem be related to reading scores.</p>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm---step-4-explanatory-variables-predict-slopes-random-reml" class="section level2" number="6.7">
<h2 number="6.7"><span class="header-section-number">6.7</span> MLM - Step 4: Explanatory variables predict Slopes, random, REML</h2>
<!-- ========================================================= -->
<p><strong>Random Coefficient</strong> models - decompose the SLOPE variance BETWEEN groups.</p>
<p>The fixed effect of the predictor captures the overall association it has with the outcome (intercept), while the random effect of the predictor captures the group-to-group variation in the association (slope). <em>Note: A variable can be fit as BOTH a fixed and random effect.</em></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1"></a>fit_read_3re &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), <span class="co"># refit the previous &#39;best&#39; model via REML</span></span>
<span id="cb281-2"><a href="#cb281-2"></a>                     <span class="dt">data =</span> data_achieve,</span>
<span id="cb281-3"><a href="#cb281-3"></a>                     <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span>
<span id="cb281-4"><a href="#cb281-4"></a></span>
<span id="cb281-5"><a href="#cb281-5"></a><span class="co">#fit_read_5re &lt;- lmer(geread ~ gevocab + (gevocab | school), </span></span>
<span id="cb281-6"><a href="#cb281-6"></a><span class="co">#                     data = achieve,</span></span>
<span id="cb281-7"><a href="#cb281-7"></a><span class="co">#                     REML = TRUE)         # failed to converge :(</span></span>
<span id="cb281-8"><a href="#cb281-8"></a></span>
<span id="cb281-9"><a href="#cb281-9"></a>fit_read_5re &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb281-10"><a href="#cb281-10"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb281-11"><a href="#cb281-11"></a>                           <span class="dt">REML =</span> <span class="ot">TRUE</span>,</span>
<span id="cb281-12"><a href="#cb281-12"></a>                           <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>,    <span class="co"># get it to converge</span></span>
<span id="cb281-13"><a href="#cb281-13"></a>                                                 <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb281-14"><a href="#cb281-14"></a>                                                 <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,</span>
<span id="cb281-15"><a href="#cb281-15"></a>                                                                <span class="dt">starttests =</span> <span class="ot">FALSE</span>,</span>
<span id="cb281-16"><a href="#cb281-16"></a>                                                                <span class="dt">kkt =</span> <span class="ot">FALSE</span>))) </span></code></pre></div>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_3re, </span>
<span id="cb282-2"><a href="#cb282-2"></a>                       fit_read_5re),</span>
<span id="cb282-3"><a href="#cb282-3"></a>                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Rand Int&quot;</span>, </span>
<span id="cb282-4"><a href="#cb282-4"></a>                                         <span class="st">&quot;Rand Int and Slopes&quot;</span>),</span>
<span id="cb282-5"><a href="#cb282-5"></a>                  <span class="dt">caption            =</span> <span class="st">&quot;MLM: Investigate Random Effects&quot;</span>,</span>
<span id="cb282-6"><a href="#cb282-6"></a>                  <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb282-7"><a href="#cb282-7"></a>                  <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Investigate Random Effects
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Rand Int
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Rand Int and Slopes
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.19 (0.87)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.61 (0.87)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03 (0.19)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.14 (0.19)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03 (0.01)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab:age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01 (0.00)<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01 (0.00)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43155.49
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43011.65
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43198.95
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43069.58
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21571.75
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21497.82
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.28
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.76
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.66
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: school (Intercept) gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div id="assess-significance-of-effect" class="section level4" number="6.7.0.1">
<h4 number="6.7.0.1"><span class="header-section-number">6.7.0.1</span> Assess Significance of Effect</h4>
<div class="rmdlightbulb">
<p>
Likelihood Ratio Test (LRT) for Random Effects
</p>
<p>
You can use the Chi-squared LRT test based on deviances even though we fit our modesl with REML, since the models only differ in terms of including/exclusing of a random effects; they have same fixed effects. Just make sure to include the <code>refit = FALSE</code> option.
</p>
</div>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1"></a><span class="kw">anova</span>(fit_read_3re, fit_read_5re, <span class="dt">refit =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_3re: geread ~ gevocab * age + (1 | school)
fit_read_5re: geread ~ gevocab * age + (gevocab | school)
             npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_read_3re    6 43155 43199 -21572    43143                         
fit_read_5re    8 43012 43070 -21498    42996 147.84  2  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>There is evidence the effect child vocabulary has on reading varies across schools.</p>
</div>
<div id="visualize-the-model" class="section level4" number="6.7.0.2">
<h4 number="6.7.0.2"><span class="header-section-number">6.7.0.2</span> Visualize the Model</h4>
<p>What does the model look like?</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>), </span>
<span id="cb285-2"><a href="#cb285-2"></a>                <span class="dt">mod =</span> fit_read_5re,                              <span class="co"># just different model</span></span>
<span id="cb285-3"><a href="#cb285-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">108</span>, <span class="dv">132</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb285-4"><a href="#cb285-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb285-5"><a href="#cb285-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_yr =</span> <span class="kw">factor</span>(age<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb285-6"><a href="#cb285-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,</span>
<span id="cb285-7"><a href="#cb285-7"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb285-8"><a href="#cb285-8"></a>             <span class="dt">color =</span> age_yr)) <span class="op">+</span></span>
<span id="cb285-9"><a href="#cb285-9"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb285-10"><a href="#cb285-10"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-233-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We are seeming much the same trends, but perhaps more separation between the lines.</p>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm---step-5-cross-level-interactions-between-explanatory-variables---fixed-ml" class="section level2" number="6.8">
<h2 number="6.8"><span class="header-section-number">6.8</span> MLM - Step 5: Cross-Level interactions between explanatory variables - fixed, ML</h2>
<!-- ========================================================= -->
<p>Cross-level interacitons involve variables at different levels. Here we will investigate the school-level enrollment moderating vocabulary’s effect since we say that vocab’s effect differs across schools (step 4).</p>
<p>Remember that an interaction beween fixed effects is also fixed.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1"></a>fit_read_5ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb286-2"><a href="#cb286-2"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb286-3"><a href="#cb286-3"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>,</span>
<span id="cb286-4"><a href="#cb286-4"></a>                           <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>, </span>
<span id="cb286-5"><a href="#cb286-5"></a>                                                 <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb286-6"><a href="#cb286-6"></a>                                                 <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,</span>
<span id="cb286-7"><a href="#cb286-7"></a>                                                                <span class="dt">starttests =</span> <span class="ot">FALSE</span>,</span>
<span id="cb286-8"><a href="#cb286-8"></a>                                                                <span class="dt">kkt =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb286-9"><a href="#cb286-9"></a></span>
<span id="cb286-10"><a href="#cb286-10"></a>fit_read_6ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>senroll <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb286-11"><a href="#cb286-11"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb286-12"><a href="#cb286-12"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>,</span>
<span id="cb286-13"><a href="#cb286-13"></a>                           <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>))</span>
<span id="cb286-14"><a href="#cb286-14"></a></span>
<span id="cb286-15"><a href="#cb286-15"></a>fit_read_7ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>gevocab<span class="op">*</span>senroll <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb286-16"><a href="#cb286-16"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb286-17"><a href="#cb286-17"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb286-18"><a href="#cb286-18"></a></span>
<span id="cb286-19"><a href="#cb286-19"></a>fit_read_8ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age<span class="op">*</span>senroll <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb286-20"><a href="#cb286-20"></a>                           <span class="dt">data =</span> data_achieve,</span>
<span id="cb286-21"><a href="#cb286-21"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="rmdlightbulb">
<p>
If you get the<code>lmer()</code> message: <strong>Some predictor variables are on very different scales: consider rescaling</strong>, you can trust your results, but you really should try re-scaling your variables.
</p>
</div>
<p>We are getting this message since <code>gevoab</code> is on mostly a single digit scale,0 to 11.2, and age (in months) ranges in the low thripe-digits, 82 through 135, while school enrollment is in the mid-hundreds, 112-916. When we compute the interactions we get much, much larger values. Having variables on such widely different ranges of values can cause estimation problems.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb287-2"><a href="#cb287-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(gevocab, age, senroll) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb287-3"><a href="#cb287-3"></a><span class="st">  </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>    gevocab            age           senroll     
 Min.   : 0.000   Min.   : 82.0   Min.   :115.0  
 1st Qu.: 2.900   1st Qu.:104.0   1st Qu.:438.0  
 Median : 3.800   Median :107.0   Median :519.0  
 Mean   : 4.494   Mean   :107.5   Mean   :533.4  
 3rd Qu.: 5.200   3rd Qu.:111.0   3rd Qu.:644.0  
 Max.   :11.200   Max.   :135.0   Max.   :916.0  </code></pre>
<p>For now, let us look at the results.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_5ml, </span>
<span id="cb289-2"><a href="#cb289-2"></a>                     fit_read_6ml, </span>
<span id="cb289-3"><a href="#cb289-3"></a>                     fit_read_7ml,</span>
<span id="cb289-4"><a href="#cb289-4"></a>                     fit_read_8ml),</span>
<span id="cb289-5"><a href="#cb289-5"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Level 1 only&quot;</span>, </span>
<span id="cb289-6"><a href="#cb289-6"></a>                                       <span class="st">&quot;Both Levels&quot;</span>, </span>
<span id="cb289-7"><a href="#cb289-7"></a>                                       <span class="st">&quot;Cross-Level&quot;</span>,</span>
<span id="cb289-8"><a href="#cb289-8"></a>                                       <span class="st">&quot;3-way&quot;</span>),</span>
<span id="cb289-9"><a href="#cb289-9"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Investigate a Fixed Cross-level Interaction&quot;</span>,</span>
<span id="cb289-10"><a href="#cb289-10"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb289-11"><a href="#cb289-11"></a>                <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb289-12"><a href="#cb289-12"></a>                <span class="dt">bold =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Investigate a Fixed Cross-level Interaction
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Level 1 only
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Both Levels
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Cross-Level
</th>
<th style="padding-left: 5px;padding-right: 5px;">
3-way
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>5.614</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>5.603</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>5.515</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>5.503</b>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.872)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.878)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.894)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.111)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.138</b>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.138</b>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.114</b>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.530</b>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.192)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.192)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.198)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.661)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.033</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.033</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.033</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.033</b>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.008)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.008)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.008)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.029)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab:age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.006</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.006</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.006</b><sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.000</b>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.002)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.002)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.002)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.006)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
senroll
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.000</b>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.000</b>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.000</b>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.000)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.000)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.006)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab:senroll
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.000</b>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.001</b>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.000)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.001)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age:senroll
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-0.000</b>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.000)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab:age:senroll
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>0.000</b>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.000)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42979.711
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42981.698
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42983.452
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42982.851
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43037.646
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43046.874
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43055.870
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43069.753
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21481.855
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21481.849
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21481.726
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21479.426
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.272
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.271
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.274
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.269
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.019
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.019
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.019
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.019
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: school (Intercept) gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.062
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.062
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.063
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.061
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.660
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.660
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.660
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.659
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>There is no evidence school enrollment moderates either of age or vocabulary’s effects.</p>
<div id="assess-significance-of-effects-3" class="section level4" number="6.8.0.1">
<h4 number="6.8.0.1"><span class="header-section-number">6.8.0.1</span> Assess Significance of Effects</h4>
<p>Likelihood Ratio Test (LRT)</p>
<p>When you have a list of sequentially nested models, you can test them in order with one call to the <code>anova()</code> funtion.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1"></a><span class="kw">anova</span>(fit_read_5ml, fit_read_6ml)</span></code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_5ml: geread ~ gevocab * age + (gevocab | school)
fit_read_6ml: geread ~ gevocab * age + senroll + (gevocab | school)
             npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_read_5ml    8 42980 43038 -21482    42964                     
fit_read_6ml    9 42982 43047 -21482    42964 0.0132  1     0.9087</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1"></a><span class="kw">anova</span>(fit_read_5ml, fit_read_7ml)</span></code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_5ml: geread ~ gevocab * age + (gevocab | school)
fit_read_7ml: geread ~ gevocab * age + gevocab * senroll + (gevocab | school)
             npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_read_5ml    8 42980 43038 -21482    42964                     
fit_read_7ml   10 42983 43056 -21482    42963 0.2593  2     0.8784</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1"></a><span class="kw">anova</span>(fit_read_5ml, fit_read_8ml)</span></code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_5ml: geread ~ gevocab * age + (gevocab | school)
fit_read_8ml: geread ~ gevocab * age * senroll + (gevocab | school)
             npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_read_5ml    8 42980 43038 -21482    42964                     
fit_read_8ml   12 42983 43070 -21479    42959 4.8597  4      0.302</code></pre>
<!-- ========================================================= -->
</div>
</div>
<div id="centering-predictors-change-center" class="section level2" number="6.9">
<h2 number="6.9"><span class="header-section-number">6.9</span> Centering Predictors: Change Center</h2>
<!-- ========================================================= -->
<p>Centering variables measured on the lowest level only involves subtacting the mean from every value. The spread or standard deviation is not changed.</p>
<div class="rmdlightbulb">
<p>
Although there are functions to automatically center and standardize variables, it is beneficial to manually create these variables, as it is more transparent and facilitates un-centering them later.
</p>
</div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb296-2"><a href="#cb296-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(gevocab, age, senroll) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb296-3"><a href="#cb296-3"></a><span class="st">  </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>    gevocab            age           senroll     
 Min.   : 0.000   Min.   : 82.0   Min.   :115.0  
 1st Qu.: 2.900   1st Qu.:104.0   1st Qu.:438.0  
 Median : 3.800   Median :107.0   Median :519.0  
 Mean   : 4.494   Mean   :107.5   Mean   :533.4  
 3rd Qu.: 5.200   3rd Qu.:111.0   3rd Qu.:644.0  
 Max.   :11.200   Max.   :135.0   Max.   :916.0  </code></pre>
<div id="use-centered-variables" class="section level3" number="6.9.1">
<h3 number="6.9.1"><span class="header-section-number">6.9.1</span> Use Centered Variables</h3>
<p>NOTE: The models with CENTERED variables are able to be fit with the default optimizer settings and do not return the error: <code>"unable to evaluate scaled gradientModel failed to converge: degenerate  Hessian with 1 negative eigenvalues"</code></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1"></a>fit_read_5ml_c &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(age <span class="op">-</span><span class="st"> </span><span class="fl">107.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb298-2"><a href="#cb298-2"></a><span class="st">                               </span>(<span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb298-3"><a href="#cb298-3"></a>                             <span class="dt">data =</span> data_achieve,</span>
<span id="cb298-4"><a href="#cb298-4"></a>                             <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div id="compare-the-models" class="section level4" number="6.9.1.1">
<h4 number="6.9.1.1"><span class="header-section-number">6.9.1.1</span> Compare the Models</h4>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_5ml, </span>
<span id="cb299-2"><a href="#cb299-2"></a>                     fit_read_5ml_c),</span>
<span id="cb299-3"><a href="#cb299-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Raw Units&quot;</span>, </span>
<span id="cb299-4"><a href="#cb299-4"></a>                                       <span class="st">&quot;Grand Mean Centered&quot;</span>),</span>
<span id="cb299-5"><a href="#cb299-5"></a>                <span class="dt">groups =</span> <span class="kw">list</span>(<span class="st">&quot;Raw Scale&quot;</span> =<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">4</span>,</span>
<span id="cb299-6"><a href="#cb299-6"></a>                              <span class="st">&quot;Mean Centered&quot;</span> =<span class="st"> </span><span class="dv">5</span><span class="op">:</span><span class="dv">7</span>),</span>
<span id="cb299-7"><a href="#cb299-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Investigate Centering Variables Involved in an Interaction&quot;</span>,</span>
<span id="cb299-8"><a href="#cb299-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb299-9"><a href="#cb299-9"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>,</span>
<span id="cb299-10"><a href="#cb299-10"></a>                <span class="dt">digits             =</span> <span class="dv">3</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Investigate Centering Variables Involved in an Interaction
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Raw Units
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Grand Mean Centered
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.614 (0.872)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.348 (0.033)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Raw Scale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.138 (0.192)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.033 (0.008)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     gevocab:age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.006 (0.002)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Mean Centered
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     gevocab - 4.494
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.519 (0.014)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     age - 107.5
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.006 (0.004)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     I(gevocab - 4.494):age - 107.5
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.006 (0.002)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42979.711
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42979.711
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43037.646
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43037.646
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21481.855
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21481.855
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.272
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.019
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: school (Intercept) gevocab
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.062
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.660
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.660
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school I(gevocab - 4.494)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.019
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: school (Intercept) I(gevocab - 4.494)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.024
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Notice that the interactions yield the exact same parameter estimates and significances, but the main effects (including the interactions) are different. Model fit statistics include <span class="math inline">\(-2LL\)</span> are exactly the same, too.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(fit_read_5ml, fit_read_5ml_c)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model          |    Type |      AIC |      BIC | R2_conditional | R2_marginal |  ICC | RMSE | BF
------------------------------------------------------------------------------------------------
fit_read_5ml   | lmerMod | 42979.71 | 43037.65 |           0.32 |        0.28 | 0.05 | 1.90 |   
fit_read_5ml_c | lmerMod | 42979.71 | 43037.65 |           0.32 |        0.28 | 0.05 | 1.90 |  1</code></pre>
</div>
<div id="visualize-the-model-1" class="section level4" number="6.9.1.2">
<h4 number="6.9.1.2"><span class="header-section-number">6.9.1.2</span> Visualize the Model</h4>
<p>What does the model look like?</p>
<p>First plot the model fit to the centered variables with all defaut settings.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_read_5ml_c,</span>
<span id="cb302-2"><a href="#cb302-2"></a>                            <span class="dt">pred  =</span> gevocab,</span>
<span id="cb302-3"><a href="#cb302-3"></a>                            <span class="dt">modx  =</span> age)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-246-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_read_5ml_c,</span>
<span id="cb303-2"><a href="#cb303-2"></a>                            <span class="dt">pred  =</span> gevocab,</span>
<span id="cb303-3"><a href="#cb303-3"></a>                            <span class="dt">modx  =</span> age,</span>
<span id="cb303-4"><a href="#cb303-4"></a>                            <span class="dt">modx.values =</span> <span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">110</span>, <span class="dv">150</span>),</span>
<span id="cb303-5"><a href="#cb303-5"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-247-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- ========================================================= -->
</div>
</div>
</div>
<div id="rescaling-predictors-change-units-or-standardize" class="section level2" number="6.10">
<h2 number="6.10"><span class="header-section-number">6.10</span> Rescaling Predictors: Change Units or Standardize</h2>
<!-- ========================================================= -->
<p>Where centering variables involved subtracting a set value, scalling a varaibles involves dividing by a set amount. When we both center to the mean and divide by the standard deviation, the new resulting varaible is said to be standardized (not to be confusing with normalizing, which is does not do).</p>
<p>To retain meaningful units, you can multiply or divide all the measured values of a variable by a set amount, like a multiple of 10. This retains the meaning behind the units while still bringing them into line with other variables in the model and can avoid some convergence issues.</p>
<div id="scale-varaibles" class="section level3" number="6.10.1">
<h3 number="6.10.1"><span class="header-section-number">6.10.1</span> Scale Varaibles</h3>
<div id="divide-by-a-meaningful-value" class="section level4" number="6.10.1.1">
<h4 number="6.10.1.1"><span class="header-section-number">6.10.1.1</span> Divide by a Meaningful Value</h4>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb304-2"><a href="#cb304-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(gevocab, age, ses) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb304-3"><a href="#cb304-3"></a><span class="st">  </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>    gevocab            age             ses        
 Min.   : 0.000   Min.   : 82.0   Min.   :  0.00  
 1st Qu.: 2.900   1st Qu.:104.0   1st Qu.: 66.30  
 Median : 3.800   Median :107.0   Median : 81.70  
 Mean   : 4.494   Mean   :107.5   Mean   : 72.85  
 3rd Qu.: 5.200   3rd Qu.:111.0   3rd Qu.: 87.80  
 Max.   :11.200   Max.   :135.0   Max.   :100.00  </code></pre>
<p>For this situation, lets only divide SES by ten.</p>
</div>
</div>
<div id="use-scaled-variables" class="section level3" number="6.10.2">
<h3 number="6.10.2"><span class="header-section-number">6.10.2</span> Use Scaled Variables</h3>
<p>Using the new versions of our variables, investigate is SES has an effect, either in 2-way or 3-way interactions with age and vocabulary.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1"></a>fit_read_5ml_s &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(age <span class="op">-</span><span class="st"> </span><span class="fl">107.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb306-2"><a href="#cb306-2"></a><span class="st">                                     </span>(<span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb306-3"><a href="#cb306-3"></a>                             <span class="dt">data   =</span> data_achieve,</span>
<span id="cb306-4"><a href="#cb306-4"></a>                             <span class="dt">REML   =</span> <span class="ot">FALSE</span>)</span>
<span id="cb306-5"><a href="#cb306-5"></a></span>
<span id="cb306-6"><a href="#cb306-6"></a>fit_read_6ml_s &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(age <span class="op">-</span><span class="st"> </span><span class="fl">107.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb306-7"><a href="#cb306-7"></a><span class="st">                                      </span><span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(ses<span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></span>
<span id="cb306-8"><a href="#cb306-8"></a><span class="st">                                     </span>(<span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb306-9"><a href="#cb306-9"></a>                             <span class="dt">data   =</span> data_achieve,</span>
<span id="cb306-10"><a href="#cb306-10"></a>                             <span class="dt">REML   =</span> <span class="ot">FALSE</span>,</span>
<span id="cb306-11"><a href="#cb306-11"></a>                             <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>))</span>
<span id="cb306-12"><a href="#cb306-12"></a></span>
<span id="cb306-13"><a href="#cb306-13"></a>fit_read_7ml_s &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(age <span class="op">-</span><span class="st"> </span><span class="fl">107.5</span>) <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(ses<span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></span>
<span id="cb306-14"><a href="#cb306-14"></a><span class="st">                                     </span>(<span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">|</span><span class="st"> </span>school),  </span>
<span id="cb306-15"><a href="#cb306-15"></a>                             <span class="dt">data   =</span> data_achieve,</span>
<span id="cb306-16"><a href="#cb306-16"></a>                             <span class="dt">REML  =</span> <span class="ot">FALSE</span>,</span>
<span id="cb306-17"><a href="#cb306-17"></a>                             <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_read_5ml_s, </span>
<span id="cb307-2"><a href="#cb307-2"></a>                     fit_read_6ml_s, </span>
<span id="cb307-3"><a href="#cb307-3"></a>                     fit_read_7ml_s),</span>
<span id="cb307-4"><a href="#cb307-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;no SES&quot;</span>, </span>
<span id="cb307-5"><a href="#cb307-5"></a>                                       <span class="st">&quot;2-way&quot;</span>, </span>
<span id="cb307-6"><a href="#cb307-6"></a>                                       <span class="st">&quot;3-way&quot;</span>),</span>
<span id="cb307-7"><a href="#cb307-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Investigate More Complex Fixed Interactions (with Scalling)&quot;</span>,</span>
<span id="cb307-8"><a href="#cb307-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb307-9"><a href="#cb307-9"></a>                <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Investigate More Complex Fixed Interactions (with Scalling)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
no SES
</th>
<th style="padding-left: 5px;padding-right: 5px;">
2-way
</th>
<th style="padding-left: 5px;padding-right: 5px;">
3-way
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.348<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.945<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.942<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.033)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.107)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.107)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab - 4.494
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.519<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.671<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.674<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.014)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.051)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.051)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 107.5
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.006
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.004
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.008
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.004)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.004)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.014)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
I(gevocab - 4.494):age - 107.5
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.006<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.006<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.002)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.002)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.007)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
ses/10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.057<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.058<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.014)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.014)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
I(gevocab - 4.494):ses/10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.021<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.022<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.007)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.007)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
I(age - 107.5):ses/10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.002)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
I(gevocab - 4.494):I(age - 107.5):ses/10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.001
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.001)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42979.711
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42928.813
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42932.046
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43037.646
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43001.232
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43018.948
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21481.855
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21454.407
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21454.023
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.079
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.079
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school I(gevocab - 4.494)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.019
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.017
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.017
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: school (Intercept) I(gevocab - 4.494)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.024
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.031
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.031
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.660
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.662
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.662
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1"></a><span class="kw">anova</span>(fit_read_5ml_s, fit_read_6ml_s, fit_read_7ml_s)</span></code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_5ml_s: geread ~ I(gevocab - 4.494) * I(age - 107.5) + (I(gevocab - 4.494) | 
fit_read_5ml_s:     school)
fit_read_6ml_s: geread ~ I(gevocab - 4.494) * I(age - 107.5) + I(gevocab - 4.494) * 
fit_read_6ml_s:     I(ses/10) + (I(gevocab - 4.494) | school)
fit_read_7ml_s: geread ~ I(gevocab - 4.494) * I(age - 107.5) * I(ses/10) + (I(gevocab - 
fit_read_7ml_s:     4.494) | school)
               npar   AIC   BIC logLik deviance   Chisq Df Pr(&gt;Chisq)    
fit_read_5ml_s    8 42980 43038 -21482    42964                          
fit_read_6ml_s   10 42929 43001 -21454    42909 54.8974  2    1.2e-12 ***
fit_read_7ml_s   12 42932 43019 -21454    42908  0.7674  2     0.6813    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>There is evidence that SES moderates the main effect of vocabulary, after accounting for the interaction between age and vocabulary. But there is NOT evidence of a three-way interaction between vobaculary, age, and SES.</p>
</div>
</div>
<div id="final-model-2" class="section level2" number="6.11">
<h2 number="6.11"><span class="header-section-number">6.11</span> Final Model</h2>
<p>Always refit the final model via REML.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1"></a>fit_read_6re_s &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(age <span class="op">-</span><span class="st"> </span><span class="fl">107.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb310-2"><a href="#cb310-2"></a><span class="st">                                      </span><span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(ses<span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></span>
<span id="cb310-3"><a href="#cb310-3"></a><span class="st">                                     </span>(<span class="kw">I</span>(gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.494</span>) <span class="op">|</span><span class="st"> </span>school), </span>
<span id="cb310-4"><a href="#cb310-4"></a>                             <span class="dt">data   =</span> data_achieve,</span>
<span id="cb310-5"><a href="#cb310-5"></a>                             <span class="dt">REML   =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div id="table" class="section level3" number="6.11.1">
<h3 number="6.11.1"><span class="header-section-number">6.11.1</span> Table</h3>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(fit_read_6re_s,</span>
<span id="cb311-2"><a href="#cb311-2"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Final Model&quot;</span>,</span>
<span id="cb311-3"><a href="#cb311-3"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb311-4"><a href="#cb311-4"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>,</span>
<span id="cb311-5"><a href="#cb311-5"></a>                <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Final Model
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.945 (0.107)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab - 4.494
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.671 (0.051)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 107.5
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.004 (0.004)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
ses/10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.057 (0.014)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
I(gevocab - 4.494):age - 107.5
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.006 (0.002)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
I(gevocab - 4.494):ses/10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.021 (0.007)<sup>**</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42976.511
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43048.929
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21478.255
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.081
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school I(gevocab - 4.494)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.018
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: school (Intercept) I(gevocab - 4.494)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.032
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.662
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div id="visualize-the-model-2" class="section level4" number="6.11.1.1">
<h4 number="6.11.1.1"><span class="header-section-number">6.11.1.1</span> Visualize the Model</h4>
<p>Recall the scales that the revised variables are now on:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1"></a>data_achieve <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb312-2"><a href="#cb312-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(gevocab, age, ses) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb312-3"><a href="#cb312-3"></a><span class="st">  </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>    gevocab            age             ses        
 Min.   : 0.000   Min.   : 82.0   Min.   :  0.00  
 1st Qu.: 2.900   1st Qu.:104.0   1st Qu.: 66.30  
 Median : 3.800   Median :107.0   Median : 81.70  
 Mean   : 4.494   Mean   :107.5   Mean   : 72.85  
 3rd Qu.: 5.200   3rd Qu.:111.0   3rd Qu.: 87.80  
 Max.   :11.200   Max.   :135.0   Max.   :100.00  </code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_read_6ml_s,  <span class="co"># model name</span></span>
<span id="cb314-2"><a href="#cb314-2"></a>                            <span class="dt">pred  =</span> gevocab,         <span class="co"># x-axis, main independent variable (continuous, ordinal)</span></span>
<span id="cb314-3"><a href="#cb314-3"></a>                            <span class="dt">modx  =</span> age,             <span class="co"># lines by moderator, another independent variable</span></span>
<span id="cb314-4"><a href="#cb314-4"></a>                            <span class="dt">mod2 =</span> ses)              <span class="co"># panel by 2nd moderator, another indep var</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-255-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Define values for the moderator(s):</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_read_6ml_s,</span>
<span id="cb315-2"><a href="#cb315-2"></a>                            <span class="dt">pred  =</span> gevocab,</span>
<span id="cb315-3"><a href="#cb315-3"></a>                            <span class="dt">modx  =</span> age,</span>
<span id="cb315-4"><a href="#cb315-4"></a>                            <span class="dt">mod2 =</span> ses,</span>
<span id="cb315-5"><a href="#cb315-5"></a>                            <span class="dt">modx.values =</span> <span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">110</span>, <span class="dv">130</span>),</span>
<span id="cb315-6"><a href="#cb315-6"></a>                            <span class="dt">mod2.values =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">55</span>, <span class="dv">90</span>),</span>
<span id="cb315-7"><a href="#cb315-7"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-256-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Swap the moderators:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_read_6ml_s,</span>
<span id="cb316-2"><a href="#cb316-2"></a>                            <span class="dt">pred  =</span> gevocab,</span>
<span id="cb316-3"><a href="#cb316-3"></a>                            <span class="dt">mod2  =</span> age,</span>
<span id="cb316-4"><a href="#cb316-4"></a>                            <span class="dt">modx =</span> ses,</span>
<span id="cb316-5"><a href="#cb316-5"></a>                            <span class="dt">mod2.values =</span> <span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">110</span>, <span class="dv">130</span>),</span>
<span id="cb316-6"><a href="#cb316-6"></a>                            <span class="dt">modx.values =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">55</span>, <span class="dv">90</span>),</span>
<span id="cb316-7"><a href="#cb316-7"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-257-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="interpretation-of-model" class="section level3" number="6.11.2">
<h3 number="6.11.2"><span class="header-section-number">6.11.2</span> Interpretation of model</h3>
<p>There is strong evidence that higher vocabulary scores correlate with higher reading scores. This relationship is strongest in low SES schools and among older students. This relationship is also weaker in younger students and those attending high SES schools.</p>
<p>See: <span class="citation">Nakagawa and Schielzeth (<a href="#ref-nakagawa2013" role="doc-biblioref">2013</a>)</span> for more regarding model <span class="math inline">\(R^2\)</span></p>
<p>From the <code>performance::r2()</code> documentation, for mixed models:</p>
<ul>
<li><strong>marginal r-squared</strong> considers only the variance of the fixed effects<br />
</li>
<li><strong>conditional r-squared</strong> takes both the fixed and random effects into account</li>
</ul>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1"></a>performance<span class="op">::</span><span class="kw">r2</span>(fit_read_6re_s)</span></code></pre></div>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.322
     Marginal R2: 0.289</code></pre>
<p>Over 32% of the variance in student reading is attributable vocab, ses, age, and school-to-school differences, R^2 = .322.</p>
<hr />
<p>Helpful links:</p>
<p><a href="http://maths-people.anu.edu.au/~johnm/r-book/xtras/mlm-ohp.pdf" class="uri">http://maths-people.anu.edu.au/~johnm/r-book/xtras/mlm-ohp.pdf</a></p>
<p><a href="http://ase.tufts.edu/gsc/gradresources/guidetomixedmodelsinr/mixed%20model%20guide.html" class="uri">http://ase.tufts.edu/gsc/gradresources/guidetomixedmodelsinr/mixed%20model%20guide.html</a></p>
<p><a href="http://web.stanford.edu/class/psych252/section_2015/Section_week9.html" class="uri">http://web.stanford.edu/class/psych252/section_2015/Section_week9.html</a></p>
<p><a href="https://www.r-bloggers.com/visualizing-generalized-linear-mixed-effects-models-with-ggplot-rstats-lme4/" class="uri">https://www.r-bloggers.com/visualizing-generalized-linear-mixed-effects-models-with-ggplot-rstats-lme4/</a></p>
<p><a href="https://www.r-bloggers.com/visualizing-generalized-linear-mixed-effects-models-part-2-rstats-lme4/" class="uri">https://www.r-bloggers.com/visualizing-generalized-linear-mixed-effects-models-part-2-rstats-lme4/</a></p>
<p><a href="http://www.strengejacke.de/sjPlot/sjp.lmer/" class="uri">http://www.strengejacke.de/sjPlot/sjp.lmer/</a></p>
<!--chapter:end:07-example_finch_read.Rmd-->
</div>
</div>
</div>
<div id="mlm-centeringscaling-student-popularity" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> MLM, Centering/Scaling: Student Popularity</h1>
<p><img src="images/header_hox_popular2.PNG" /></p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb319-2"><a href="#cb319-2"></a><span class="kw">library</span>(broom)        <span class="co"># converst stats objestcs to tidy tibbles</span></span>
<span id="cb319-3"><a href="#cb319-3"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span>
<span id="cb319-4"><a href="#cb319-4"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb319-5"><a href="#cb319-5"></a><span class="kw">library</span>(stargazer)    <span class="co"># display nice tables: summary &amp; regression</span></span>
<span id="cb319-6"><a href="#cb319-6"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb319-7"><a href="#cb319-7"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb319-8"><a href="#cb319-8"></a><span class="kw">library</span>(sjstats)      <span class="co"># ICC calculations</span></span>
<span id="cb319-9"><a href="#cb319-9"></a></span>
<span id="cb319-10"><a href="#cb319-10"></a><span class="kw">library</span>(lme4)         <span class="co"># non-linear mixed-effects models</span></span>
<span id="cb319-11"><a href="#cb319-11"></a></span>
<span id="cb319-12"><a href="#cb319-12"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span></code></pre></div>
<div id="background-3" class="section level2" number="7.1">
<h2 number="7.1"><span class="header-section-number">7.1</span> Background</h2>
<div class="rmdlink">
<p>
The text <strong>“Multilevel Analysis: Techniques and Applications, Third Edition”</strong> <span class="citation"><span class="citation">(Hox, Moerbeek, and Van de Schoot <a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></span> has a companion <a href="https://multilevel-analysis.sites.uu.nl/">website</a> which includes links to all the data files used throughout the book (housed on the <a href="https://github.com/MultiLevelAnalysis">book’s GitHub repository</a>).
</p>
</div>
<p>The following example is used through out <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>’s chapater 2.</p>
<blockquote>
<p>From <strong>Appendix E</strong>:</p>
<p>The popularity data in <strong>popular2.sav</strong> are simulated data for <strong>2000 pupils in 100 schools</strong>. The purpose is to offer a very simple example for multilevel regression analysis. The main outcome variable is the <strong>pupil popularity</strong>, a popularity rating on a scale of 1-10 derived by a sociometric procedure. Typically, a sociometric procedure asks all pupils in a class to rate all the other pupils, and then assigns the average received popularity rating to each pupil. Because of the sociometric procedure, group effects as apparent from higher level variance components are rather strong. There is a second outcome variable: <strong>pupil popularity</strong> as rated by their teacher, on a scale from 1-10. The explanatory variables are <strong>pupil gender</strong> (boy=0, girl=1), <strong>pupil extraversion</strong> (10-point scale) and <strong>teacher experience</strong> in years. The popularity data have been generated to be a ‘nice’ well-behaved data set: the sample sizes at both levels are sufficient, the residuals have a normal distribution, and the multilevel effects are strong.</p>
</blockquote>
<p><img src="images/diagram_hox_popular2.PNG" /></p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1"></a>data_raw &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_sav</span>(<span class="st">&quot;https://github.com/MultiLevelAnalysis/Datasets-third-edition-Multilevel-book/raw/master/chapter%202/popularity/SPSS/popular2.sav&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb320-2"><a href="#cb320-2"></a><span class="st">  </span>haven<span class="op">::</span><span class="kw">as_factor</span>()             <span class="co"># retain the labels from SPSS --&gt; factor</span></span>
<span id="cb320-3"><a href="#cb320-3"></a></span>
<span id="cb320-4"><a href="#cb320-4"></a>data_pop &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb320-5"><a href="#cb320-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">paste</span>(class, pupil,</span>
<span id="cb320-6"><a href="#cb320-6"></a>                           <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># create a unique id for each student (char)</span></span>
<span id="cb320-7"><a href="#cb320-7"></a><span class="st">                  </span><span class="kw">factor</span>()) <span class="op">%&gt;%</span><span class="st">             </span><span class="co"># declare id is a factor</span></span>
<span id="cb320-8"><a href="#cb320-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, pupil<span class="op">:</span>popteach)         <span class="co"># reduce the variables included</span></span>
<span id="cb320-9"><a href="#cb320-9"></a></span>
<span id="cb320-10"><a href="#cb320-10"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(data_pop)</span></code></pre></div>
<pre><code>Rows: 2,000
Columns: 8
$ id       &lt;fct&gt; 1_1, 1_2, 1_3, 1_4, 1_5, 1_6, 1_7, 1_8, 1_9, 1_10, 1_11, 1...
$ pupil    &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,...
$ class    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
$ extrav   &lt;dbl&gt; 5, 7, 4, 3, 5, 4, 5, 4, 5, 5, 5, 5, 5, 5, 5, 6, 4, 4, 7, 4...
$ sex      &lt;fct&gt; girl, boy, girl, girl, girl, boy, boy, boy, boy, boy, girl...
$ texp     &lt;dbl&gt; 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24...
$ popular  &lt;dbl&gt; 6.3, 4.9, 5.3, 4.7, 6.0, 4.7, 5.9, 4.2, 5.2, 3.9, 5.7, 4.8...
$ popteach &lt;dbl&gt; 6, 5, 6, 5, 6, 5, 5, 5, 5, 3, 5, 5, 5, 6, 5, 5, 2, 3, 7, 4...</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb322-2"><a href="#cb322-2"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb322-3"><a href="#cb322-3"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb322-4"><a href="#cb322-4"></a>      <span class="dt">y =</span> popular,</span>
<span id="cb322-5"><a href="#cb322-5"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb322-6"><a href="#cb322-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb322-7"><a href="#cb322-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,</span>
<span id="cb322-8"><a href="#cb322-8"></a>              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb322-9"><a href="#cb322-9"></a>              <span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb322-10"><a href="#cb322-10"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb322-11"><a href="#cb322-11"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb322-12"><a href="#cb322-12"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb322-13"><a href="#cb322-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;OLS: Single Level Regression&quot;</span>,</span>
<span id="cb322-14"><a href="#cb322-14"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are OLS regression ran independently on each class&quot;</span>,</span>
<span id="cb322-15"><a href="#cb322-15"></a>       <span class="dt">x =</span> <span class="st">&quot;Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb322-16"><a href="#cb322-16"></a>       <span class="dt">y =</span> <span class="st">&quot;Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb322-17"><a href="#cb322-17"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb322-18"><a href="#cb322-18"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb322-19"><a href="#cb322-19"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb322-20"><a href="#cb322-20"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-263-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="grand-mean-centering-and-standardizing-variables" class="section level2" number="7.2">
<h2 number="7.2"><span class="header-section-number">7.2</span> Grand-Mean-Centering and Standardizing Variables</h2>
<p>It is best to manually determine the variable’s mean (<code>mean()</code>) and standard deviation (<code>sd()</code>).</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1"></a><span class="kw">mean</span>(data_pop<span class="op">$</span>extrav)</span></code></pre></div>
<pre><code>[1] 5.215</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1"></a><span class="kw">sd</span>(data_pop<span class="op">$</span>extrav)</span></code></pre></div>
<pre><code>[1] 1.262368</code></pre>
<div id="grand-mean-centering" class="section level3" number="7.2.1">
<h3 number="7.2.1"><span class="header-section-number">7.2.1</span> Grand-Mean-Centering</h3>
<p><span class="math display">\[
VAR_G = VAR - mean(VAR)
\]</span></p>
</div>
<div id="standardizing" class="section level3" number="7.2.2">
<h3 number="7.2.2"><span class="header-section-number">7.2.2</span> Standardizing</h3>
<p><span class="math display">\[
VAR_Z = \frac{VAR - mean(VAR)}{sd(VAR)}
\]</span></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1"></a>data_pop &lt;-<span class="st"> </span>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb327-2"><a href="#cb327-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">extravG =</span>  extrav <span class="op">-</span><span class="st"> </span><span class="fl">5.215</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb327-3"><a href="#cb327-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">extravZ =</span> (extrav <span class="op">-</span><span class="st"> </span><span class="fl">5.215</span>) <span class="op">/</span><span class="st"> </span><span class="fl">1.262368</span>)</span></code></pre></div>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb328-2"><a href="#cb328-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(extrav, extravG, extravZ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb328-3"><a href="#cb328-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb328-4"><a href="#cb328-4"></a><span class="st">  </span>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="dt">title  =</span> <span class="st">&quot;Descriptive statistics: Three versions of Extraversion&quot;</span>,</span>
<span id="cb328-5"><a href="#cb328-5"></a>                       <span class="dt">header =</span> <span class="ot">FALSE</span>,</span>
<span id="cb328-6"><a href="#cb328-6"></a>                       <span class="dt">type   =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Descriptive statistics: Three versions of Extraversion</strong>
</caption>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
extrav
</td>
<td>
2,000
</td>
<td>
5.215
</td>
<td>
1.262
</td>
<td>
1
</td>
<td>
4
</td>
<td>
6
</td>
<td>
10
</td>
</tr>
<tr>
<td style="text-align:left">
extravG
</td>
<td>
2,000
</td>
<td>
0.000
</td>
<td>
1.262
</td>
<td>
-4.215
</td>
<td>
-1.215
</td>
<td>
0.785
</td>
<td>
4.785
</td>
</tr>
<tr>
<td style="text-align:left">
extravZ
</td>
<td>
2,000
</td>
<td>
0.000
</td>
<td>
1.000
</td>
<td>
-3.339
</td>
<td>
-0.962
</td>
<td>
0.622
</td>
<td>
3.790
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
</div>
<div id="ri-only-random-intercepts" class="section level2" number="7.3">
<h2 number="7.3"><span class="header-section-number">7.3</span> RI = ONLY Random Intercepts</h2>
<div id="fit-mlm-with-all-3-versions-of-the-predictor" class="section level3" number="7.3.1">
<h3 number="7.3.1"><span class="header-section-number">7.3.1</span> Fit MLM with all 3 versions of the predictor</h3>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1"></a>pop_lmer_<span class="dv">1</span>_raw &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>extrav <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>class),</span>
<span id="cb329-2"><a href="#cb329-2"></a>                           <span class="dt">data =</span> data_pop,</span>
<span id="cb329-3"><a href="#cb329-3"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb329-4"><a href="#cb329-4"></a></span>
<span id="cb329-5"><a href="#cb329-5"></a>pop_lmer_<span class="dv">1</span>_cen &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>extravG <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>class),</span>
<span id="cb329-6"><a href="#cb329-6"></a>                           <span class="dt">data =</span> data_pop,</span>
<span id="cb329-7"><a href="#cb329-7"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb329-8"><a href="#cb329-8"></a></span>
<span id="cb329-9"><a href="#cb329-9"></a>pop_lmer_<span class="dv">1</span>_std &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>extravZ <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>class),</span>
<span id="cb329-10"><a href="#cb329-10"></a>                           <span class="dt">data =</span> data_pop,</span>
<span id="cb329-11"><a href="#cb329-11"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_lmer_<span class="dv">1</span>_raw, </span>
<span id="cb330-2"><a href="#cb330-2"></a>                     pop_lmer_<span class="dv">1</span>_cen, </span>
<span id="cb330-3"><a href="#cb330-3"></a>                     pop_lmer_<span class="dv">1</span>_std),</span>
<span id="cb330-4"><a href="#cb330-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Raw&quot;</span>, </span>
<span id="cb330-5"><a href="#cb330-5"></a>                                       <span class="st">&quot;Centered&quot;</span>, </span>
<span id="cb330-6"><a href="#cb330-6"></a>                                       <span class="st">&quot;Standardized&quot;</span>),</span>
<span id="cb330-7"><a href="#cb330-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM - RI: Effect of Grand-Mean Centering and Standardizing&quot;</span>,</span>
<span id="cb330-8"><a href="#cb330-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb330-9"><a href="#cb330-9"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM - RI: Effect of Grand-Mean Centering and Standardizing
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Raw
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Centered
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Standardized
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.54 (0.14)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.08 (0.09)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.08 (0.09)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extravG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extravZ
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.61 (0.03)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5831.78
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5831.78
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5831.78
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5854.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5854.18
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5854.18
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2911.89
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2911.89
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2911.89
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: class
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.83
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.83
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.83
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.93
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.93
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.93
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="rmdimportant">
<p>
** MLM - Random Intercepts ONLY**
</p>
<ol style="list-style-type: decimal">
<li>
Grand-Mean Centering a Predictor
</li>
</ol>
<ul>
<li>
Different than when using the Raw Predictor:
<ul>
<li>
fixed intercept
</li>
</ul>
</li>
<li>
Same as when using the Raw Predictor:
<ul>
<li>
fixed estimates or slopes for all predictors (main effects and interactions)<br />
</li>
<li>
random estimates, i.e. variance and covariance components, includin the residual variance
</li>
<li>
model fit statistics, including AIC, BIC, and the Log Loikelihood (-2LL or deviance)
</li>
</ul>
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>
Standardize a Predictor
</li>
</ol>
<ul>
<li>
Different than when using the Raw Predictor:
<ul>
<li>
fixed intercept (same as if using the grand-mean centered predictor)<br />
</li>
<li>
fixed estimate (slope) for that variable
</li>
</ul>
</li>
<li>
Stays the SAME:
<ul>
<li>
random estimates, i.e. variance and covariance components, includin the residual variance<br />
</li>
<li>
model fit statistics, including AIC, BIC, and the Log Loikelihood (-2LL or deviance)
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="investigating-a-mlm-ri-model" class="section level3" number="7.3.2">
<h3 number="7.3.2"><span class="header-section-number">7.3.2</span> Investigating a MLM-RI Model</h3>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1"></a><span class="co"># pop_lmer_1_raw %&gt;% </span></span>
<span id="cb331-2"><a href="#cb331-2"></a><span class="co">#   broom::tidy()</span></span></code></pre></div>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1"></a><span class="co"># pop_lmer_1_raw %&gt;% </span></span>
<span id="cb332-2"><a href="#cb332-2"></a><span class="co">#   broom::glance()</span></span></code></pre></div>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1"></a><span class="co"># pop_lmer_1_raw %&gt;% </span></span>
<span id="cb333-2"><a href="#cb333-2"></a><span class="co">#   broom::augment() %&gt;% </span></span>
<span id="cb333-3"><a href="#cb333-3"></a><span class="co">#   head()                  # onle line per observation (2000 students)</span></span></code></pre></div>
<div id="fixed-effects-intercept-and-slope" class="section level4" number="7.3.2.1">
<h4 number="7.3.2.1"><span class="header-section-number">7.3.2.1</span> Fixed Effects: intercept and slope</h4>
<p>There is only ONE fixed intercept and ONE fixed slope.</p>
<p>The <code>fixef()</code> function extracts the estimates of the fixed effects.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1"></a><span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw) </span></code></pre></div>
<pre><code>(Intercept)      extrav 
  2.5427027   0.4862002 </code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1"></a><span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]</span></code></pre></div>
<pre><code>[1] 2.542703</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1"></a><span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;extrav&quot;</span>]]</span></code></pre></div>
<pre><code>[1] 0.4862002</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb340-2"><a href="#cb340-2"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb340-3"><a href="#cb340-3"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb340-4"><a href="#cb340-4"></a>      <span class="dt">y =</span> popular,</span>
<span id="cb340-5"><a href="#cb340-5"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb340-6"><a href="#cb340-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb340-7"><a href="#cb340-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,</span>
<span id="cb340-8"><a href="#cb340-8"></a>              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb340-9"><a href="#cb340-9"></a>              <span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb340-10"><a href="#cb340-10"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb340-11"><a href="#cb340-11"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;extrav&quot;</span>]],</span>
<span id="cb340-12"><a href="#cb340-12"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb340-13"><a href="#cb340-13"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb340-14"><a href="#cb340-14"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb340-15"><a href="#cb340-15"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb340-16"><a href="#cb340-16"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb340-17"><a href="#cb340-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RI: Extroversion = raw score&quot;</span>,</span>
<span id="cb340-18"><a href="#cb340-18"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are OLS regression ran independently on each class&quot;</span>,</span>
<span id="cb340-19"><a href="#cb340-19"></a>       <span class="dt">x =</span> <span class="st">&quot;Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb340-20"><a href="#cb340-20"></a>       <span class="dt">y =</span> <span class="st">&quot;Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb340-21"><a href="#cb340-21"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb340-22"><a href="#cb340-22"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb340-23"><a href="#cb340-23"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb340-24"><a href="#cb340-24"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-277-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="random-effects-intercepts" class="section level4" number="7.3.2.2">
<h4 number="7.3.2.2"><span class="header-section-number">7.3.2.2</span> Random Effects: intercepts</h4>
<p>There is a different random intercept for EACH CLASS. These tell how far each class’s average is off of the grand average.</p>
<p>The <code>ranef()</code> function extracts the random effects from a fitted model object</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1"></a><span class="kw">ranef</span>(pop_lmer_<span class="dv">1</span>_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb341-2"><a href="#cb341-2"></a><span class="st">  </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>List of 1
 $ class:&#39;data.frame&#39;:  100 obs. of  1 variable:
  ..$ (Intercept): num [1:100] 0.165 -0.7536 -0.3646 0.5405 -0.0994 ...
  ..- attr(*, &quot;postVar&quot;)= num [1, 1, 1:100] 0.044 0.044 0.0486 0.0386 0.042 ...
 - attr(*, &quot;class&quot;)= chr &quot;ranef.mer&quot;</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1"></a><span class="kw">ranef</span>(pop_lmer_<span class="dv">1</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb343-2"><a href="#cb343-2"></a><span class="st">  </span><span class="kw">head</span>()                  <span class="co"># onle line per group (100 classes)</span></span></code></pre></div>
<pre><code>  (Intercept)
1  0.16499938
2 -0.75362983
3 -0.36464658
4  0.54049206
5 -0.09943663
6 -0.60487822</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1"></a><span class="kw">ranef</span>(pop_lmer_<span class="dv">1</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb345-2"><a href="#cb345-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Random_Intercepts =</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb345-3"><a href="#cb345-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Random_Intercepts)) <span class="op">+</span></span>
<span id="cb345-4"><a href="#cb345-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">.25</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-280-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="predictions" class="section level4" number="7.3.2.3">
<h4 number="7.3.2.3"><span class="header-section-number">7.3.2.3</span> Predictions</h4>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1"></a><span class="kw">predict</span>(pop_lmer_<span class="dv">1</span>_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb346-2"><a href="#cb346-2"></a><span class="st">  </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code> Named num [1:2000] 5.14 6.11 4.65 4.17 5.14 ...
 - attr(*, &quot;names&quot;)= chr [1:2000] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1"></a><span class="kw">predict</span>(pop_lmer_<span class="dv">1</span>_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb348-2"><a href="#cb348-2"></a><span class="st">  </span><span class="kw">head</span>()                  <span class="co"># onle value per observation (2000 students)</span></span></code></pre></div>
<pre><code>       1        2        3        4        5        6 
5.138703 6.111103 4.652503 4.166303 5.138703 4.652503 </code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb350-2"><a href="#cb350-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(pop_lmer_<span class="dv">1</span>_raw)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb350-3"><a href="#cb350-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb350-4"><a href="#cb350-4"></a>             <span class="dt">y =</span> pred,</span>
<span id="cb350-5"><a href="#cb350-5"></a>             <span class="dt">group =</span> class)) <span class="op">+</span></span>
<span id="cb350-6"><a href="#cb350-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb350-7"><a href="#cb350-7"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb350-8"><a href="#cb350-8"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;extrav&quot;</span>]],</span>
<span id="cb350-9"><a href="#cb350-9"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb350-10"><a href="#cb350-10"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb350-11"><a href="#cb350-11"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb350-12"><a href="#cb350-12"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb350-13"><a href="#cb350-13"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb350-14"><a href="#cb350-14"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">5.215</span>,</span>
<span id="cb350-15"><a href="#cb350-15"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb350-16"><a href="#cb350-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RI: Extroversion = raw score&quot;</span>,</span>
<span id="cb350-17"><a href="#cb350-17"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are group-wise predictions, one per class&quot;</span>,</span>
<span id="cb350-18"><a href="#cb350-18"></a>       <span class="dt">x =</span> <span class="st">&quot;Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb350-19"><a href="#cb350-19"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted</span><span class="ch">\n</span><span class="st">Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb350-20"><a href="#cb350-20"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb350-21"><a href="#cb350-21"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb350-22"><a href="#cb350-22"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb350-23"><a href="#cb350-23"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-283-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="combined-effects" class="section level4" number="7.3.2.4">
<h4 number="7.3.2.4"><span class="header-section-number">7.3.2.4</span> Combined Effects</h4>
<p>The <code>coef()</code> function computes the sum of the random and fixed effects coefficients for each explanatory variable for each level of each grouping factor.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1"></a><span class="kw">coef</span>(pop_lmer_<span class="dv">1</span>_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb351-2"><a href="#cb351-2"></a><span class="st">  </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>List of 1
 $ class:&#39;data.frame&#39;:  100 obs. of  2 variables:
  ..$ (Intercept): num [1:100] 2.71 1.79 2.18 3.08 2.44 ...
  ..$ extrav     : num [1:100] 0.486 0.486 0.486 0.486 0.486 ...
 - attr(*, &quot;class&quot;)= chr &quot;coef.mer&quot;</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1"></a><span class="kw">coef</span>(pop_lmer_<span class="dv">1</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-2"><a href="#cb353-2"></a><span class="st">  </span><span class="kw">head</span>()                  <span class="co"># onle line per group (100 classes)</span></span></code></pre></div>
<pre><code>  (Intercept)    extrav
1    2.707702 0.4862002
2    1.789073 0.4862002
3    2.178056 0.4862002
4    3.083195 0.4862002
5    2.443266 0.4862002
6    1.937824 0.4862002</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb355-2"><a href="#cb355-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(pop_lmer_<span class="dv">1</span>_raw)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb355-3"><a href="#cb355-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb355-4"><a href="#cb355-4"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb355-5"><a href="#cb355-5"></a>      <span class="dt">y =</span> pred,</span>
<span id="cb355-6"><a href="#cb355-6"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb355-7"><a href="#cb355-7"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, </span>
<span id="cb355-8"><a href="#cb355-8"></a>                <span class="dt">xmax =</span> <span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb355-9"><a href="#cb355-9"></a>                <span class="dt">ymin =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">-</span><span class="st"> </span><span class="fl">2.5</span>,</span>
<span id="cb355-10"><a href="#cb355-10"></a>                <span class="dt">ymax =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">+</span><span class="st"> </span><span class="fl">2.5</span>),</span>
<span id="cb355-11"><a href="#cb355-11"></a>            <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb355-12"><a href="#cb355-12"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></span>
<span id="cb355-13"><a href="#cb355-13"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">data =</span> <span class="kw">coef</span>(pop_lmer_<span class="dv">1</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Intercept =</span> <span class="st">&quot;(Intercept)&quot;</span>),</span>
<span id="cb355-14"><a href="#cb355-14"></a>              <span class="kw">aes</span>(<span class="dt">intercept =</span> Intercept,</span>
<span id="cb355-15"><a href="#cb355-15"></a>                  <span class="dt">slope     =</span> extrav),</span>
<span id="cb355-16"><a href="#cb355-16"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb355-17"><a href="#cb355-17"></a>              <span class="dt">size =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb355-18"><a href="#cb355-18"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb355-19"><a href="#cb355-19"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb355-20"><a href="#cb355-20"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;extrav&quot;</span>]],</span>
<span id="cb355-21"><a href="#cb355-21"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb355-22"><a href="#cb355-22"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb355-23"><a href="#cb355-23"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb355-24"><a href="#cb355-24"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb355-25"><a href="#cb355-25"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb355-26"><a href="#cb355-26"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">5.215</span>,</span>
<span id="cb355-27"><a href="#cb355-27"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb355-28"><a href="#cb355-28"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RI: Extroversion = raw score&quot;</span>,</span>
<span id="cb355-29"><a href="#cb355-29"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are group-wise predictions, one per class EXTRAPOLATED OUT&quot;</span>,</span>
<span id="cb355-30"><a href="#cb355-30"></a>       <span class="dt">x =</span> <span class="st">&quot;Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb355-31"><a href="#cb355-31"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted</span><span class="ch">\n</span><span class="st">Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb355-32"><a href="#cb355-32"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb355-33"><a href="#cb355-33"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb355-34"><a href="#cb355-34"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb355-35"><a href="#cb355-35"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-286-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="comapre-the-centered-version" class="section level3" number="7.3.3">
<h3 number="7.3.3"><span class="header-section-number">7.3.3</span> Comapre the Centered Version</h3>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb356-2"><a href="#cb356-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(pop_lmer_<span class="dv">1</span>_cen)) <span class="op">%&gt;%</span></span>
<span id="cb356-3"><a href="#cb356-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb356-4"><a href="#cb356-4"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extravG,</span>
<span id="cb356-5"><a href="#cb356-5"></a>      <span class="dt">y =</span> pred,</span>
<span id="cb356-6"><a href="#cb356-6"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb356-7"><a href="#cb356-7"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="fl">-5.215</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, </span>
<span id="cb356-8"><a href="#cb356-8"></a>                <span class="dt">xmax =</span> <span class="fl">-5.215</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb356-9"><a href="#cb356-9"></a>                <span class="dt">ymin =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">-</span><span class="st"> </span><span class="fl">2.5</span>,</span>
<span id="cb356-10"><a href="#cb356-10"></a>                <span class="dt">ymax =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">+</span><span class="st"> </span><span class="fl">2.5</span>),</span>
<span id="cb356-11"><a href="#cb356-11"></a>            <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb356-12"><a href="#cb356-12"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></span>
<span id="cb356-13"><a href="#cb356-13"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, </span>
<span id="cb356-14"><a href="#cb356-14"></a>                <span class="dt">xmax =</span> <span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb356-15"><a href="#cb356-15"></a>                <span class="dt">ymin =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">-</span><span class="st"> </span><span class="fl">2.5</span>,</span>
<span id="cb356-16"><a href="#cb356-16"></a>                <span class="dt">ymax =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">+</span><span class="st"> </span><span class="fl">2.5</span>),</span>
<span id="cb356-17"><a href="#cb356-17"></a>            <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb356-18"><a href="#cb356-18"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></span>
<span id="cb356-19"><a href="#cb356-19"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">data =</span> <span class="kw">coef</span>(pop_lmer_<span class="dv">1</span>_cen)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Intercept =</span> <span class="st">&quot;(Intercept)&quot;</span>),</span>
<span id="cb356-20"><a href="#cb356-20"></a>              <span class="kw">aes</span>(<span class="dt">intercept =</span> Intercept,</span>
<span id="cb356-21"><a href="#cb356-21"></a>                  <span class="dt">slope     =</span> extravG),</span>
<span id="cb356-22"><a href="#cb356-22"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb356-23"><a href="#cb356-23"></a>              <span class="dt">size =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb356-24"><a href="#cb356-24"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb356-25"><a href="#cb356-25"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb356-26"><a href="#cb356-26"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_cen)[[<span class="st">&quot;extravG&quot;</span>]],</span>
<span id="cb356-27"><a href="#cb356-27"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb356-28"><a href="#cb356-28"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb356-29"><a href="#cb356-29"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb356-30"><a href="#cb356-30"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">-5.215</span>,</span>
<span id="cb356-31"><a href="#cb356-31"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb356-32"><a href="#cb356-32"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb356-33"><a href="#cb356-33"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb356-34"><a href="#cb356-34"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RI: Extroversion = grand-mean centered&quot;</span>,</span>
<span id="cb356-35"><a href="#cb356-35"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are group-wise predictions, one per class EXTRAPOLATED OUT&quot;</span>,</span>
<span id="cb356-36"><a href="#cb356-36"></a>       <span class="dt">x =</span> <span class="st">&quot;GRAND-MEAN CENTERED Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb356-37"><a href="#cb356-37"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted</span><span class="ch">\n</span><span class="st">Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb356-38"><a href="#cb356-38"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb356-39"><a href="#cb356-39"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb356-40"><a href="#cb356-40"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-4</span>, <span class="dt">to =</span>  <span class="dv">4</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb356-41"><a href="#cb356-41"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span>  <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-287-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="comapre-the-standardized-version" class="section level3" number="7.3.4">
<h3 number="7.3.4"><span class="header-section-number">7.3.4</span> Comapre the Standardized Version</h3>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb357-2"><a href="#cb357-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(pop_lmer_<span class="dv">1</span>_std)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb357-3"><a href="#cb357-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb357-4"><a href="#cb357-4"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extravZ,</span>
<span id="cb357-5"><a href="#cb357-5"></a>      <span class="dt">y =</span> pred,</span>
<span id="cb357-6"><a href="#cb357-6"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb357-7"><a href="#cb357-7"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, </span>
<span id="cb357-8"><a href="#cb357-8"></a>                <span class="dt">xmax =</span> <span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb357-9"><a href="#cb357-9"></a>                <span class="dt">ymin =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">-</span><span class="st"> </span><span class="fl">2.5</span>,</span>
<span id="cb357-10"><a href="#cb357-10"></a>                <span class="dt">ymax =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">+</span><span class="st"> </span><span class="fl">2.5</span>),</span>
<span id="cb357-11"><a href="#cb357-11"></a>            <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb357-12"><a href="#cb357-12"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></span>
<span id="cb357-13"><a href="#cb357-13"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">data =</span> <span class="kw">coef</span>(pop_lmer_<span class="dv">1</span>_std)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Intercept =</span> <span class="st">&quot;(Intercept)&quot;</span>),</span>
<span id="cb357-14"><a href="#cb357-14"></a>              <span class="kw">aes</span>(<span class="dt">intercept =</span> Intercept,</span>
<span id="cb357-15"><a href="#cb357-15"></a>                  <span class="dt">slope     =</span> extravZ),</span>
<span id="cb357-16"><a href="#cb357-16"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb357-17"><a href="#cb357-17"></a>              <span class="dt">size =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb357-18"><a href="#cb357-18"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb357-19"><a href="#cb357-19"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_std)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb357-20"><a href="#cb357-20"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">1</span>_std)[[<span class="st">&quot;extravZ&quot;</span>]],</span>
<span id="cb357-21"><a href="#cb357-21"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb357-22"><a href="#cb357-22"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb357-23"><a href="#cb357-23"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb357-24"><a href="#cb357-24"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb357-25"><a href="#cb357-25"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb357-26"><a href="#cb357-26"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">-5.215</span>,</span>
<span id="cb357-27"><a href="#cb357-27"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb357-28"><a href="#cb357-28"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RI: Extroversion = standardized&quot;</span>,</span>
<span id="cb357-29"><a href="#cb357-29"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are group-wise predictions, one per class EXTRAPOLATED OUT&quot;</span>,</span>
<span id="cb357-30"><a href="#cb357-30"></a>       <span class="dt">x =</span> <span class="st">&quot;STANDARDIZED Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb357-31"><a href="#cb357-31"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted</span><span class="ch">\n</span><span class="st">Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb357-32"><a href="#cb357-32"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb357-33"><a href="#cb357-33"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb357-34"><a href="#cb357-34"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-4</span>, <span class="dt">to =</span>  <span class="dv">4</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb357-35"><a href="#cb357-35"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span>  <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-288-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="rias-random-intercepts-and-slopes" class="section level2" number="7.4">
<h2 number="7.4"><span class="header-section-number">7.4</span> RIAS = Random Intercepts AND Slopes</h2>
<div id="fit-mlm-with-all-3-versions-of-the-predictor-1" class="section level3" number="7.4.1">
<h3 number="7.4.1"><span class="header-section-number">7.4.1</span> Fit MLM with all 3 versions of the predictor</h3>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1"></a>pop_lmer_<span class="dv">2</span>_raw &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>extrav <span class="op">+</span><span class="st"> </span>(extrav<span class="op">|</span>class),</span>
<span id="cb358-2"><a href="#cb358-2"></a>                           <span class="dt">data =</span> data_pop,</span>
<span id="cb358-3"><a href="#cb358-3"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb358-4"><a href="#cb358-4"></a></span>
<span id="cb358-5"><a href="#cb358-5"></a>pop_lmer_<span class="dv">2</span>_cen &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>extravG <span class="op">+</span><span class="st"> </span>(extravG<span class="op">|</span>class),</span>
<span id="cb358-6"><a href="#cb358-6"></a>                           <span class="dt">data =</span> data_pop,</span>
<span id="cb358-7"><a href="#cb358-7"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb358-8"><a href="#cb358-8"></a></span>
<span id="cb358-9"><a href="#cb358-9"></a>pop_lmer_<span class="dv">2</span>_std &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(popular <span class="op">~</span><span class="st"> </span>extravZ <span class="op">+</span><span class="st"> </span>(extravZ<span class="op">|</span>class),</span>
<span id="cb358-10"><a href="#cb358-10"></a>                           <span class="dt">data =</span> data_pop,</span>
<span id="cb358-11"><a href="#cb358-11"></a>                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(pop_lmer_<span class="dv">2</span>_raw, </span>
<span id="cb359-2"><a href="#cb359-2"></a>                     pop_lmer_<span class="dv">2</span>_cen, </span>
<span id="cb359-3"><a href="#cb359-3"></a>                     pop_lmer_<span class="dv">2</span>_std),</span>
<span id="cb359-4"><a href="#cb359-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Raw&quot;</span>, </span>
<span id="cb359-5"><a href="#cb359-5"></a>                                       <span class="st">&quot;Centered&quot;</span>, </span>
<span id="cb359-6"><a href="#cb359-6"></a>                                       <span class="st">&quot;Standardized&quot;</span>),</span>
<span id="cb359-7"><a href="#cb359-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM - RIAS: Effect of Grand-Mean Centering and Standardizing&quot;</span>,</span>
<span id="cb359-8"><a href="#cb359-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb359-9"><a href="#cb359-9"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM - RIAS: Effect of Grand-Mean Centering and Standardizing
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Raw
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Centered
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Standardized
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.46 (0.20)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.03 (0.10)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.03 (0.10)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extravG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.49 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
extravZ
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.62 (0.03)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5782.69
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5782.69
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5782.69
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5816.29
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5816.29
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5816.29
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2885.34
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2885.34
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2885.34
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2000
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: class
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
<td style="padding-left: 5px;padding-right: 5px;">
100
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.95
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.88
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.88
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) extrav
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.26
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class extravG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) extravG
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.13
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: class extravZ
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.04
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: class (Intercept) extravZ
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.17
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="rmdimportant">
<p>
** MLM - Random Intercepts AND Slopes**
</p>
<ol style="list-style-type: decimal">
<li>
Grand-Mean Centering a Predictor
</li>
</ol>
<ul>
<li>
Different than when using the Raw Predictor:
<ul>
<li>
fixed intercept
</li>
<li>
random estimates, i.e. variance and covariance components, includin the residual variance
</li>
</ul>
</li>
<li>
Same as when using the Raw Predictor:
<ul>
<li>
fixed estimates or slopes for all predictors (main effects and interactions)<br />
</li>
<li>
model fit statistics, including AIC, BIC, and the Log Loikelihood (-2LL or deviance)
</li>
</ul>
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>
Standardize a Predictor
</li>
</ol>
<ul>
<li>
Different than when using the Raw Predictor:
<ul>
<li>
fixed intercept (same as if using the grand-mean centered predictor)<br />
</li>
<li>
fixed estimate (slope) for that variable
</li>
<li>
random estimates, i.e. variance and covariance components, includin the residual variance
</li>
</ul>
</li>
<li>
Stays the SAME:
<ul>
<li>
model fit statistics, including AIC, BIC, and the Log Loikelihood (-2LL or deviance)
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="investigating-a-mlm-ri-model-1" class="section level3" number="7.4.2">
<h3 number="7.4.2"><span class="header-section-number">7.4.2</span> Investigating a MLM-RI Model</h3>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1"></a><span class="co"># pop_lmer_2_raw %&gt;% </span></span>
<span id="cb360-2"><a href="#cb360-2"></a><span class="co">#   broom::tidy()</span></span></code></pre></div>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1"></a><span class="co"># pop_lmer_2_raw %&gt;% </span></span>
<span id="cb361-2"><a href="#cb361-2"></a><span class="co">#   broom::glance()</span></span></code></pre></div>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1"></a><span class="co"># pop_lmer_2_raw %&gt;% </span></span>
<span id="cb362-2"><a href="#cb362-2"></a><span class="co">#   broom::augment() %&gt;% </span></span>
<span id="cb362-3"><a href="#cb362-3"></a><span class="co">#   head()                  # onle line per observation (2000 students)</span></span></code></pre></div>
<div id="fixed-effects-intercept-and-slope-1" class="section level4" number="7.4.2.1">
<h4 number="7.4.2.1"><span class="header-section-number">7.4.2.1</span> Fixed Effects: intercept and slope</h4>
<p>There is only ONE fixed intercept and ONE fixed slope.</p>
<p>The <code>fixef()</code> function extracts the estimates of the fixed effects.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1"></a><span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw) </span></code></pre></div>
<pre><code>(Intercept)      extrav 
  2.4613520   0.4929015 </code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1"></a><span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]</span></code></pre></div>
<pre><code>[1] 2.461352</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1"></a><span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;extrav&quot;</span>]]</span></code></pre></div>
<pre><code>[1] 0.4929015</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb369-2"><a href="#cb369-2"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb369-3"><a href="#cb369-3"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb369-4"><a href="#cb369-4"></a>      <span class="dt">y =</span> popular,</span>
<span id="cb369-5"><a href="#cb369-5"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb369-6"><a href="#cb369-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb369-7"><a href="#cb369-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,</span>
<span id="cb369-8"><a href="#cb369-8"></a>              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb369-9"><a href="#cb369-9"></a>              <span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb369-10"><a href="#cb369-10"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb369-11"><a href="#cb369-11"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;extrav&quot;</span>]],</span>
<span id="cb369-12"><a href="#cb369-12"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb369-13"><a href="#cb369-13"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb369-14"><a href="#cb369-14"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb369-15"><a href="#cb369-15"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb369-16"><a href="#cb369-16"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb369-17"><a href="#cb369-17"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">5.215</span>,</span>
<span id="cb369-18"><a href="#cb369-18"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb369-19"><a href="#cb369-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RIAS: Extroversion = raw score&quot;</span>,</span>
<span id="cb369-20"><a href="#cb369-20"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are OLS regression ran independently on each class&quot;</span>,</span>
<span id="cb369-21"><a href="#cb369-21"></a>       <span class="dt">x =</span> <span class="st">&quot;Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb369-22"><a href="#cb369-22"></a>       <span class="dt">y =</span> <span class="st">&quot;Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb369-23"><a href="#cb369-23"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb369-24"><a href="#cb369-24"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb369-25"><a href="#cb369-25"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb369-26"><a href="#cb369-26"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-298-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="random-effects-intercepts-1" class="section level4" number="7.4.2.2">
<h4 number="7.4.2.2"><span class="header-section-number">7.4.2.2</span> Random Effects: intercepts</h4>
<p>There is a different random intercept AND random slope for EACH CLASS. These tell how far each class’s average is off of the grand average AND how far each class’s slope is off of the grand average sope.</p>
<p>The <code>ranef()</code> function extracts the random effects from a fitted model object</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1"></a><span class="kw">ranef</span>(pop_lmer_<span class="dv">2</span>_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb370-2"><a href="#cb370-2"></a><span class="st">  </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>List of 1
 $ class:&#39;data.frame&#39;:  100 obs. of  2 variables:
  ..$ (Intercept): num [1:100] 0.341 -1.18 -0.627 1.079 -0.191 ...
  ..$ extrav     : num [1:100] -0.0272 0.0974 0.0565 -0.0988 0.0208 ...
  ..- attr(*, &quot;postVar&quot;)= num [1:2, 1:2, 1:100] 0.21332 -0.02975 -0.02975 0.00499 0.20574 ...
 - attr(*, &quot;class&quot;)= chr &quot;ranef.mer&quot;</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1"></a><span class="kw">ranef</span>(pop_lmer_<span class="dv">2</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb372-2"><a href="#cb372-2"></a><span class="st">  </span><span class="kw">head</span>()                  <span class="co"># onle line per group (100 classes)</span></span></code></pre></div>
<pre><code>  (Intercept)      extrav
1   0.3412826 -0.02721226
2  -1.1800459  0.09737587
3  -0.6269008  0.05654230
4   1.0791254 -0.09877051
5  -0.1910515  0.02083157
6  -0.9833398  0.08370183</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1"></a><span class="kw">ranef</span>(pop_lmer_<span class="dv">2</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb374-2"><a href="#cb374-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Random_Intercepts =</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb374-3"><a href="#cb374-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Random_Intercepts)) <span class="op">+</span></span>
<span id="cb374-4"><a href="#cb374-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-301-1.png" width="288" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1"></a><span class="kw">ranef</span>(pop_lmer_<span class="dv">2</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb375-2"><a href="#cb375-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(extrav)) <span class="op">+</span></span>
<span id="cb375-3"><a href="#cb375-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-302-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="predictions-1" class="section level4" number="7.4.2.3">
<h4 number="7.4.2.3"><span class="header-section-number">7.4.2.3</span> Predictions</h4>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1"></a><span class="kw">predict</span>(pop_lmer_<span class="dv">2</span>_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb376-2"><a href="#cb376-2"></a><span class="st">  </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code> Named num [1:2000] 5.13 6.06 4.67 4.2 5.13 ...
 - attr(*, &quot;names&quot;)= chr [1:2000] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1"></a><span class="kw">predict</span>(pop_lmer_<span class="dv">2</span>_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb378-2"><a href="#cb378-2"></a><span class="st">  </span><span class="kw">head</span>()                  <span class="co"># onle value per observation (2000 students)</span></span></code></pre></div>
<pre><code>       1        2        3        4        5        6 
5.131081 6.062459 4.665391 4.199702 5.131081 4.665391 </code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb380-2"><a href="#cb380-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(pop_lmer_<span class="dv">2</span>_raw)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb380-3"><a href="#cb380-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb380-4"><a href="#cb380-4"></a>             <span class="dt">y =</span> pred,</span>
<span id="cb380-5"><a href="#cb380-5"></a>             <span class="dt">group =</span> class)) <span class="op">+</span></span>
<span id="cb380-6"><a href="#cb380-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb380-7"><a href="#cb380-7"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb380-8"><a href="#cb380-8"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;extrav&quot;</span>]],</span>
<span id="cb380-9"><a href="#cb380-9"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb380-10"><a href="#cb380-10"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb380-11"><a href="#cb380-11"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb380-12"><a href="#cb380-12"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb380-13"><a href="#cb380-13"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb380-14"><a href="#cb380-14"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">5.215</span>,</span>
<span id="cb380-15"><a href="#cb380-15"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb380-16"><a href="#cb380-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RIAS: Extroversion = raw score&quot;</span>,</span>
<span id="cb380-17"><a href="#cb380-17"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are group-wise predictions, one per class&quot;</span>,</span>
<span id="cb380-18"><a href="#cb380-18"></a>       <span class="dt">x =</span> <span class="st">&quot;Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb380-19"><a href="#cb380-19"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted</span><span class="ch">\n</span><span class="st">Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb380-20"><a href="#cb380-20"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb380-21"><a href="#cb380-21"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb380-22"><a href="#cb380-22"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb380-23"><a href="#cb380-23"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-305-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="combined-effects-1" class="section level4" number="7.4.2.4">
<h4 number="7.4.2.4"><span class="header-section-number">7.4.2.4</span> Combined Effects</h4>
<p>The <code>coef()</code> function computes the sum of the random and fixed effects coefficients for each explanatory variable for each level of each grouping factor.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1"></a><span class="kw">coef</span>(pop_lmer_<span class="dv">1</span>_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-2"><a href="#cb381-2"></a><span class="st">  </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>List of 1
 $ class:&#39;data.frame&#39;:  100 obs. of  2 variables:
  ..$ (Intercept): num [1:100] 2.71 1.79 2.18 3.08 2.44 ...
  ..$ extrav     : num [1:100] 0.486 0.486 0.486 0.486 0.486 ...
 - attr(*, &quot;class&quot;)= chr &quot;coef.mer&quot;</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1"></a><span class="kw">coef</span>(pop_lmer_<span class="dv">1</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb383-2"><a href="#cb383-2"></a><span class="st">  </span><span class="kw">head</span>()                  <span class="co"># onle line per group (100 classes)</span></span></code></pre></div>
<pre><code>  (Intercept)    extrav
1    2.707702 0.4862002
2    1.789073 0.4862002
3    2.178056 0.4862002
4    3.083195 0.4862002
5    2.443266 0.4862002
6    1.937824 0.4862002</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb385-2"><a href="#cb385-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(pop_lmer_<span class="dv">2</span>_raw)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb385-3"><a href="#cb385-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb385-4"><a href="#cb385-4"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extrav,</span>
<span id="cb385-5"><a href="#cb385-5"></a>      <span class="dt">y =</span> pred,</span>
<span id="cb385-6"><a href="#cb385-6"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb385-7"><a href="#cb385-7"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, </span>
<span id="cb385-8"><a href="#cb385-8"></a>                <span class="dt">xmax =</span> <span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb385-9"><a href="#cb385-9"></a>                <span class="dt">ymin =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">-</span><span class="st"> </span><span class="fl">4.5</span>,</span>
<span id="cb385-10"><a href="#cb385-10"></a>                <span class="dt">ymax =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">+</span><span class="st"> </span><span class="fl">4.5</span>),</span>
<span id="cb385-11"><a href="#cb385-11"></a>            <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb385-12"><a href="#cb385-12"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></span>
<span id="cb385-13"><a href="#cb385-13"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">data =</span> <span class="kw">coef</span>(pop_lmer_<span class="dv">2</span>_raw)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Intercept =</span> <span class="st">&quot;(Intercept)&quot;</span>),</span>
<span id="cb385-14"><a href="#cb385-14"></a>              <span class="kw">aes</span>(<span class="dt">intercept =</span> Intercept,</span>
<span id="cb385-15"><a href="#cb385-15"></a>                  <span class="dt">slope     =</span> extrav),</span>
<span id="cb385-16"><a href="#cb385-16"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb385-17"><a href="#cb385-17"></a>              <span class="dt">size =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb385-18"><a href="#cb385-18"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb385-19"><a href="#cb385-19"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb385-20"><a href="#cb385-20"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;extrav&quot;</span>]],</span>
<span id="cb385-21"><a href="#cb385-21"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb385-22"><a href="#cb385-22"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb385-23"><a href="#cb385-23"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb385-24"><a href="#cb385-24"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb385-25"><a href="#cb385-25"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb385-26"><a href="#cb385-26"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">5.215</span>,</span>
<span id="cb385-27"><a href="#cb385-27"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb385-28"><a href="#cb385-28"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RIAS: Extroversion = raw score&quot;</span>,</span>
<span id="cb385-29"><a href="#cb385-29"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are group-wise predictions, one per class EXTRAPOLATED OUT&quot;</span>,</span>
<span id="cb385-30"><a href="#cb385-30"></a>       <span class="dt">x =</span> <span class="st">&quot;Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb385-31"><a href="#cb385-31"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted</span><span class="ch">\n</span><span class="st">Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb385-32"><a href="#cb385-32"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb385-33"><a href="#cb385-33"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb385-34"><a href="#cb385-34"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb385-35"><a href="#cb385-35"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-308-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="comapre-the-centered-version-1" class="section level3" number="7.4.3">
<h3 number="7.4.3"><span class="header-section-number">7.4.3</span> Comapre the Centered Version</h3>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb386-2"><a href="#cb386-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(pop_lmer_<span class="dv">2</span>_cen)) <span class="op">%&gt;%</span></span>
<span id="cb386-3"><a href="#cb386-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb386-4"><a href="#cb386-4"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extravG,</span>
<span id="cb386-5"><a href="#cb386-5"></a>      <span class="dt">y =</span> pred,</span>
<span id="cb386-6"><a href="#cb386-6"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb386-7"><a href="#cb386-7"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="fl">-5.215</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, </span>
<span id="cb386-8"><a href="#cb386-8"></a>                <span class="dt">xmax =</span> <span class="fl">-5.215</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb386-9"><a href="#cb386-9"></a>                <span class="dt">ymin =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">-</span><span class="st"> </span><span class="fl">4.5</span>,</span>
<span id="cb386-10"><a href="#cb386-10"></a>                <span class="dt">ymax =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_raw)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">+</span><span class="st"> </span><span class="fl">4.5</span>),</span>
<span id="cb386-11"><a href="#cb386-11"></a>            <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb386-12"><a href="#cb386-12"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></span>
<span id="cb386-13"><a href="#cb386-13"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, </span>
<span id="cb386-14"><a href="#cb386-14"></a>                <span class="dt">xmax =</span> <span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb386-15"><a href="#cb386-15"></a>                <span class="dt">ymin =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">-</span><span class="st"> </span><span class="fl">2.5</span>,</span>
<span id="cb386-16"><a href="#cb386-16"></a>                <span class="dt">ymax =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">+</span><span class="st"> </span><span class="fl">2.5</span>),</span>
<span id="cb386-17"><a href="#cb386-17"></a>            <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb386-18"><a href="#cb386-18"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></span>
<span id="cb386-19"><a href="#cb386-19"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">data =</span> <span class="kw">coef</span>(pop_lmer_<span class="dv">2</span>_cen)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Intercept =</span> <span class="st">&quot;(Intercept)&quot;</span>),</span>
<span id="cb386-20"><a href="#cb386-20"></a>              <span class="kw">aes</span>(<span class="dt">intercept =</span> Intercept,</span>
<span id="cb386-21"><a href="#cb386-21"></a>                  <span class="dt">slope     =</span> extravG),</span>
<span id="cb386-22"><a href="#cb386-22"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb386-23"><a href="#cb386-23"></a>              <span class="dt">size =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb386-24"><a href="#cb386-24"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb386-25"><a href="#cb386-25"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb386-26"><a href="#cb386-26"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_cen)[[<span class="st">&quot;extravG&quot;</span>]],</span>
<span id="cb386-27"><a href="#cb386-27"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb386-28"><a href="#cb386-28"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb386-29"><a href="#cb386-29"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb386-30"><a href="#cb386-30"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">-5.215</span>,</span>
<span id="cb386-31"><a href="#cb386-31"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb386-32"><a href="#cb386-32"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb386-33"><a href="#cb386-33"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb386-34"><a href="#cb386-34"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RIAS: Extroversion = grand-mean centered&quot;</span>,</span>
<span id="cb386-35"><a href="#cb386-35"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are group-wise predictions, one per class EXTRAPOLATED OUT&quot;</span>,</span>
<span id="cb386-36"><a href="#cb386-36"></a>       <span class="dt">x =</span> <span class="st">&quot;GRAND-MEAN CENTERED Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb386-37"><a href="#cb386-37"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted</span><span class="ch">\n</span><span class="st">Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb386-38"><a href="#cb386-38"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb386-39"><a href="#cb386-39"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb386-40"><a href="#cb386-40"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-4</span>, <span class="dt">to =</span>  <span class="dv">4</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb386-41"><a href="#cb386-41"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span>  <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-309-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="comapre-the-standardized-version-1" class="section level3" number="7.4.4">
<h3 number="7.4.4"><span class="header-section-number">7.4.4</span> Comapre the Standardized Version</h3>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1"></a>data_pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb387-2"><a href="#cb387-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(pop_lmer_<span class="dv">2</span>_std)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb387-3"><a href="#cb387-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb387-4"><a href="#cb387-4"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> extravZ,</span>
<span id="cb387-5"><a href="#cb387-5"></a>      <span class="dt">y =</span> pred,</span>
<span id="cb387-6"><a href="#cb387-6"></a>      <span class="dt">group =</span> class) <span class="op">+</span></span>
<span id="cb387-7"><a href="#cb387-7"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="dv">0</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, </span>
<span id="cb387-8"><a href="#cb387-8"></a>                <span class="dt">xmax =</span> <span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb387-9"><a href="#cb387-9"></a>                <span class="dt">ymin =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">-</span><span class="st"> </span><span class="fl">2.5</span>,</span>
<span id="cb387-10"><a href="#cb387-10"></a>                <span class="dt">ymax =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_cen)[[<span class="st">&quot;(Intercept)&quot;</span>]]<span class="op">+</span><span class="st"> </span><span class="fl">2.5</span>),</span>
<span id="cb387-11"><a href="#cb387-11"></a>            <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb387-12"><a href="#cb387-12"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></span>
<span id="cb387-13"><a href="#cb387-13"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">data =</span> <span class="kw">coef</span>(pop_lmer_<span class="dv">2</span>_std)<span class="op">$</span>class <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Intercept =</span> <span class="st">&quot;(Intercept)&quot;</span>),</span>
<span id="cb387-14"><a href="#cb387-14"></a>              <span class="kw">aes</span>(<span class="dt">intercept =</span> Intercept,</span>
<span id="cb387-15"><a href="#cb387-15"></a>                  <span class="dt">slope     =</span> extravZ),</span>
<span id="cb387-16"><a href="#cb387-16"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb387-17"><a href="#cb387-17"></a>              <span class="dt">size =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb387-18"><a href="#cb387-18"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb387-19"><a href="#cb387-19"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_std)[[<span class="st">&quot;(Intercept)&quot;</span>]],</span>
<span id="cb387-20"><a href="#cb387-20"></a>              <span class="dt">slope     =</span> <span class="kw">fixef</span>(pop_lmer_<span class="dv">2</span>_std)[[<span class="st">&quot;extravZ&quot;</span>]],</span>
<span id="cb387-21"><a href="#cb387-21"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>,</span>
<span id="cb387-22"><a href="#cb387-22"></a>              <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb387-23"><a href="#cb387-23"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb387-24"><a href="#cb387-24"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb387-25"><a href="#cb387-25"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb387-26"><a href="#cb387-26"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">-5.215</span>,</span>
<span id="cb387-27"><a href="#cb387-27"></a>             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb387-28"><a href="#cb387-28"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MLM-RIAS: Extroversion = standardized&quot;</span>,</span>
<span id="cb387-29"><a href="#cb387-29"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Thin black lines are group-wise predictions, one per class EXTRAPOLATED OUT&quot;</span>,</span>
<span id="cb387-30"><a href="#cb387-30"></a>       <span class="dt">x =</span> <span class="st">&quot;STANDARDIZED Student&#39;s Extroversion, as rated by their teacher&quot;</span>,</span>
<span id="cb387-31"><a href="#cb387-31"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted</span><span class="ch">\n</span><span class="st">Student&#39;s Populartity, mean rating by their peers&quot;</span>) <span class="op">+</span></span>
<span id="cb387-32"><a href="#cb387-32"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb387-33"><a href="#cb387-33"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb387-34"><a href="#cb387-34"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-4</span>, <span class="dt">to =</span>  <span class="dv">4</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb387-35"><a href="#cb387-35"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span>  <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-310-1.png" width="576" style="display: block; margin: auto;" /></p>
<!--chapter:end:08-example_hox3_popular2.Rmd-->
</div>
</div>
</div>
<div id="effect-size-variance-explained" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Effect Size: Variance Explained</h1>
<blockquote>
<p>Note that these versions of <span class="math inline">\(R^2\)</span> are becoming more common, but are not entirely agreed upon or standard. You will not be able to calculate them directly in standard software. Instead, you need to calculate the components and program the calculation. Importantly, <strong>if</strong> you choose to report one or both of them, you should not only <strong>identify which one you are using</strong>, but provide some <strong>brief interpretation</strong> and a <strong>citation</strong> of the article.</p>
<p><em>The Analysis Factor</em>, <a href="https://www.theanalysisfactor.com/r-squared-for-mixed-effects-models/">R-Squared for Mixed Effects Models</a>, by Kim Love</p>
</blockquote>
<div class="rmdlink">
<p>
Marginal vs. Conditional <span class="math inline"><span class="math inline">\(R^2\)</span></span>:
</p>
<p>
<strong>A general and simple method for obtaining R2 from generalized linear mixed‐effects models</strong>
</p>
<ul>
<li>
<a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.2041-210x.2012.00261.x">2012: Journal Article</a>
</li>
</ul>
<p>
Authors: Shinichi Nakagawa and Holger Schielzeth
</p>
</div>
<div class="rmdlink">
<p>
Somewhat technical, but good figures:
</p>
<p>
<strong>Quantifying Explained Variance in Multilevel Models: An Integrative Framework for Defining R-Squared Measures</strong>
</p>
<ul>
<li>
<a href="https://pdfs.semanticscholar.org/2472/c8aa3a50f8388f7ebb3f6ce6e5c6746e8b0f.pdf">2019: manuscript, Psychological Methods</a>
</li>
</ul>
<p>
Authors: Jason D. Rights and Sonya K. Sterba, <em>Vanderbilt University</em>
</p>
</div>
<div id="mlm-or-lmm" class="section level2" number="8.1">
<h2 number="8.1"><span class="header-section-number">8.1</span> MLM or LMM</h2>
<p>Multilevel Model or Linear Multilevel Models</p>
<div class="rmdlink">
<p>
Social and Behavioral Science Focus:
</p>
<p>
<strong>R-squared measures in Multilevel Modeling: The undesirable property of negative R-squared values</strong>
</p>
<ul>
<li>
<a href="http://arno.uvt.nl/show.cgi?fid=146739">2018: First Year Paper, Research Master in Social and Behavioral Science</a>
</li>
</ul>
<p>
Student: Edoardo Costantini Supervisor: prof. dr. M.A.L.M. van Assen
</p>
</div>
<div class="rmdlink">
<p>
Education Focus:
</p>
<p>
<strong>Effect size measures for multilevel models: definition, interpretation, and TIMSS example</strong>
</p>
<ul>
<li>
<a href="https://link.springer.com/article/10.1186/s40536-018-0061-2">2018: Manuscript, Large-sclae ASsessments in Educaiton</a>
</li>
</ul>
<p>
Author: Julie Lorah
</p>
</div>
<div class="rmdlink">
<p>
Psychology Focus:
</p>
<p>
<strong>Effect Size Measures for Multilevel Models in Clinical Child and Adolescent Research: New R-Squared Methods and Recommendations</strong>
</p>
<ul>
<li>
<a href="https://www.tandfonline.com/doi/full/10.1080/15374416.2018.1528550?scroll=top&amp;needAccess=true">2018: manuscript, Journal of Clinical Child &amp; Adolescent Psychology</a>
</li>
</ul>
<p>
Authors: Jason D. Rights and David A. Cole
</p>
<p>
<a href="https://cdn.vanderbilt.edu/vu-my/wp-content/uploads/sites/2149/2016/07/29193821/OnlineAppendix_Rights.Sterba_MBR.ID_.18-106.pdf">Online Appendix: <code>r2MLMcomp</code></a>
</p>
<p>
<a href="https://my.vanderbilt.edu/jasonrights/software/">Software - R functions</a>
</p>
<ul>
<li>
<p>
<a href="https://my.vanderbilt.edu/jasonrights/software/r2MLM"><code>r2MLM</code></a> computes and outputs R-squared measures and analytic decompositions of variance for multilevel models
</p>
</li>
<li>
<p>
<a href="https://my.vanderbilt.edu/jasonrights/software/r2MLMcomp"><code>r2MLMcomp</code></a> computes R-squared differences between pairs of multilevel models under comparison
</p>
</li>
<li>
<p>
<code>r2MLM3</code> computes all measures relevant for a three-level model and provides a barchart graphic
</p>
</li>
</ul>
</div>
</div>
<div id="glmm" class="section level2" number="8.2">
<h2 number="8.2"><span class="header-section-number">8.2</span> GLMM</h2>
<p>Generalized Linear Multilevel Models</p>
<div class="rmdlink">
<p>
Ecology Focus: for MLM/LMM and GLMM
</p>
<p>
<strong>R squared for mixed models</strong>
</p>
<ul>
<li>
<a href="https://ecologyforacrowdedplanet.wordpress.com/2013/02/26/r-squared-for-mixed-models/">2013: Blogpost by Phil Martin</a>
</li>
</ul>
<p>
<strong>R squared for mixed models – the easy way</strong>
</p>
<ul>
<li>
<a href="https://ecologyforacrowdedplanet.wordpress.com/2013/08/27/r-squared-in-mixed-models-the-easy-way/">2013: Blogplot by Phil Martin</a>
</li>
</ul>
<p>
<span class="citation"><span class="citation">Nakagawa and Schielzeth (<a href="#ref-nakagawa2013" role="doc-biblioref">2013</a>)</span></span>
</p>
</div>
<p><a href="https://stats.stackexchange.com/questions/111150/calculating-r2-in-mixed-models-using-nakagawa-schielzeths-2013-r2glmm-me" class="uri">https://stats.stackexchange.com/questions/111150/calculating-r2-in-mixed-models-using-nakagawa-schielzeths-2013-r2glmm-me</a></p>
<p>I am answering by pasting Douglas Bates’s reply in the R-Sig-ME mailing list, on 17 Dec 2014 on the question of <strong>how to calculate an <span class="math inline">\(R^2\)</span> statistic for generalized linear mixed models</strong>, which I believe is required reading for anyone interested in such a thing. Bates is the original author of the <code>lme4</code> package for <span class="math inline">\(R\)</span> and co-author of <code>nlme</code>, as well as co-author of a well-known book on mixed models, and CV will benefit from having the text in an answer, rather than just a link to it.</p>
<blockquote>
<p>I must admit to getting a little twitchy when people speak of the “<span class="math inline">\(R^2\)</span> for GLMMs”. <span class="math inline">\(R^2\)</span> for a linear model is well-defined and has many desirable properties. For other models one can define different quantities that reflect some but not all of these properties. But this is not calculating an <span class="math inline">\(R^2\)</span> in the sense of obtaining a number having all the properties that the <span class="math inline">\(R^2\)</span> for linear models does. Usually there are several different ways that such a quantity could be defined. Especially for GLMs and GLMMs before you can define “proportion of response variance explained” you first need to define what you mean by “response variance”. The whole point of GLMs and GLMMs is that a simple sum of squares of deviations does not meaningfully reflect the variability in the response because the variance of an individual response depends on its mean.</p>
<p>Confusion about what constitutes <span class="math inline">\(R^2\)</span> or degrees of freedom of any of the other quantities associated with linear models as applied to other models comes from confusing the formula with the concept. Although formulas are derived from models the derivation often involves quite sophisticated mathematics. To avoid a potentially confusing derivation and just “cut to the chase” it is easier to present the formulas. But the formula is not the concept. <strong>Generalizing a formula is not equivalent to generalizing the concept.</strong> And those formulas are almost never used in practice, especially for generalized linear models, analysis of variance and random effects. I have a “meta-theorem” that the only quantity actually calculated according to the formulas given in introductory texts is the sample mean.</p>
<p>It may seem that <strong>I am being a grumpy old man about this, and perhaps I am, but the danger is that people expect an “<span class="math inline">\(R^2\)</span>-like” quantity </strong>to have all the properties of an <span class="math inline">\(R^2\)</span> for linear models. It can’t. There is no way to generalize all the properties to a much more complicated model like a GLMM.</p>
<p>I was once on the committee reviewing a thesis proposal for Ph.D. candidacy. The proposal was to examine I think 9 different formulas that could be considered ways of computing an <span class="math inline">\(R^2\)</span> for a nonlinear regression model to decide which one was “best”. Of course, this would be done through a simulation study with only a couple of different models and only a few different sets of parameter values for each. My suggestion that this was an entirely meaningless exercise was not greeted warmly.</p>
</blockquote>
<!--chapter:end:09-rsqured.Rmd-->
</div>
</div>
<div id="sjplot-package" class="section level1" number="9">
<h1 number="9"><span class="header-section-number">9</span> sjPlot Package</h1>
<p><img src="images/header_sjPlot.PNG" /></p>
<div class="rmdlink">
<p>
<a href="http://www.danielluedecke.de/">Daniel Lüdecke</a> is German researcher that has put together several GREAT packages, including <code>sjPlot</code> which we will detail here. Documentation can be found at: <a href="http://www.strengejacke.de/sjPlot/index.html" class="uri">http://www.strengejacke.de/sjPlot/index.html</a>
</p>
</div>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb388-2"><a href="#cb388-2"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb388-3"><a href="#cb388-3"></a></span>
<span id="cb388-4"><a href="#cb388-4"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed modelsts models</span></span>
<span id="cb388-5"><a href="#cb388-5"></a></span>
<span id="cb388-6"><a href="#cb388-6"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span>
<span id="cb388-7"><a href="#cb388-7"></a></span>
<span id="cb388-8"><a href="#cb388-8"></a><span class="kw">library</span>(sjPlot)       <span class="co"># Quick predicitive and diagnostic plots </span></span></code></pre></div>
<p>Read the SPSS data in with the <code>haven</code> package and prepare it (see previous chapter).</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1"></a>data_raw &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_sav</span>(<span class="st">&quot;http://www.mlminr.com/data-sets/Achieve.sav?attredirects=0&quot;</span>)</span>
<span id="cb389-2"><a href="#cb389-2"></a></span>
<span id="cb389-3"><a href="#cb389-3"></a>data_achieve_center_scale &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-4"><a href="#cb389-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(id, region, corp, school, class), factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-5"><a href="#cb389-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">gender =</span> gender <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-6"><a href="#cb389-6"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-7"><a href="#cb389-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">classize =</span> classize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-8"><a href="#cb389-8"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;12-17&quot;</span>, <span class="st">&quot;18-21&quot;</span>, </span>
<span id="cb389-9"><a href="#cb389-9"></a>                                    <span class="st">&quot;22-26&quot;</span>, <span class="st">&quot;&gt;26&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-10"><a href="#cb389-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, region, corp, school, class,           <span class="co"># Identifiers</span></span>
<span id="cb389-11"><a href="#cb389-11"></a>                gender, age, geread, gevocab,              <span class="co"># Pupil-level vars</span></span>
<span id="cb389-12"><a href="#cb389-12"></a>                classize,                                  <span class="co"># Class-Level vars</span></span>
<span id="cb389-13"><a href="#cb389-13"></a>                senroll, ses) <span class="op">%&gt;%</span><span class="st">                          </span><span class="co"># School-level vars</span></span>
<span id="cb389-14"><a href="#cb389-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">gevocab_c =</span> gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.4938</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-15"><a href="#cb389-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_c     =</span> age     <span class="op">-</span><span class="st"> </span><span class="fl">107.5290</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-16"><a href="#cb389-16"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">senroll_c =</span> senroll <span class="op">-</span><span class="st"> </span><span class="fl">533.4148</span>) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb389-17"><a href="#cb389-17"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">senroll_ch =</span> senroll_c <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st">        </span><span class="co"># centered AND divided by one hundred</span></span>
<span id="cb389-18"><a href="#cb389-18"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ses_t      =</span> ses <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)                   <span class="co"># JUST divide by ten</span></span></code></pre></div>
<p>Fit the final model (see previous chapter)</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1"></a>fit_read_11re_s &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab_c<span class="op">*</span>age_c <span class="op">+</span><span class="st"> </span>gevocab_c<span class="op">*</span>ses_t <span class="op">+</span><span class="st">   </span><span class="co"># 2 2-way interactions</span></span>
<span id="cb390-2"><a href="#cb390-2"></a><span class="st">                                      </span>(gevocab_c <span class="op">|</span><span class="st"> </span>school),  </span>
<span id="cb390-3"><a href="#cb390-3"></a>                             <span class="dt">data   =</span> data_achieve_center_scale,</span>
<span id="cb390-4"><a href="#cb390-4"></a>                             <span class="dt">REML   =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb391-2"><a href="#cb391-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb391-3"><a href="#cb391-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb391-4"><a href="#cb391-4"></a></span>
<span id="cb391-5"><a href="#cb391-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_read_11re_s),</span>
<span id="cb391-6"><a href="#cb391-6"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Final&quot;</span>), </span>
<span id="cb391-7"><a href="#cb391-7"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Final Model&quot;</span>,</span>
<span id="cb391-8"><a href="#cb391-8"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb391-9"><a href="#cb391-9"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Final Model
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Final
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.94 (0.11)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab_c
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.67 (0.05)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age_c
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.00 (0.00)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
ses_t
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.06 (0.01)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab_c:age_c
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01 (0.00)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gevocab_c:ses_t
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02 (0.01)<sup>**</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
42976.51
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
43048.93
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-21478.26
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10320
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: school
</td>
<td style="padding-left: 5px;padding-right: 5px;">
160
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.08
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: school gevocab_c
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: school (Intercept) gevocab_c
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.66
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Now we will show some of the things the <code>sjPlot</code> package can do!</p>
<div id="plotting-coefficients" class="section level2" number="9.1">
<h2 number="9.1"><span class="header-section-number">9.1</span> Plotting Coefficients</h2>
<p>Select <code>terms</code> that should be plotted. All other term are removed from the output.</p>
<p>Note that the term names must match the names of the model’s coefficients. For factors, this means that the variable name is suffixed with the related factor level, and each category counts as one term. E.g. <code>rm.terms = "t_name [2,3]"</code> would remove the terms <code>t_name2</code> and <code>t_name3</code> (assuming that the variable t_name is categorical and has at least the factor levels 2 and 3).</p>
<p>Another example for the iris-dataset: <code>terms = "Species"</code> would not work, instead you would write <code>terms = "Species [versicolor, virginica]"</code> to remove these two levels, or <code>terms = "Speciesversicolor"</code> if you just want to remove the level versicolor from the plot.</p>
<div id="fixed-effects" class="section level3" number="9.1.1">
<h3 number="9.1.1"><span class="header-section-number">9.1.1</span> Fixed Effects</h3>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb392-2"><a href="#cb392-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;est&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-324-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb393-2"><a href="#cb393-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;est&quot;</span>,</span>
<span id="cb393-3"><a href="#cb393-3"></a>                   <span class="dt">show.values =</span> <span class="ot">TRUE</span>)  <span class="co"># Logical, whether values should be plotted or not.</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-325-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb394-2"><a href="#cb394-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;std&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-326-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Determines in which way estimates are sorted in the plot with the option: <code>sort.est =</code></p>
<ul>
<li>If <code>NULL</code> (default), no sorting is done and estimates are sorted in the same order as they appear in the model formula.<br />
</li>
<li>If <code>TRUE</code>, estimates are sorted in descending order, with highest estimate at the top.<br />
</li>
<li>If <code>sort.est = "sort.all"</code>, estimates are re-sorted for each coefficient (only applies if <code>type = "re"</code> and <code>grid = FALSE</code>), i.e. the estimates of the random effects for each predictor are sorted and plotted to an own plot.<br />
</li>
<li>If <code>type = "re"</code>, specify a predictor’s / coefficient’s name to sort estimates according to this random effect.</li>
</ul>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb395-2"><a href="#cb395-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;std&quot;</span>,</span>
<span id="cb395-3"><a href="#cb395-3"></a>                   <span class="dt">sort.est =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-327-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb396-2"><a href="#cb396-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;std&quot;</span>,</span>
<span id="cb396-3"><a href="#cb396-3"></a>                   <span class="dt">sort.est =</span> <span class="ot">TRUE</span>,</span>
<span id="cb396-4"><a href="#cb396-4"></a>                   <span class="dt">show.values =</span> <span class="ot">TRUE</span>)  <span class="co"># Logical, whether values should be plotted or not.</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-328-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Plots standardized beta values, however, standardization follows <span class="citation">Gelman (<a href="#ref-gelman2008" role="doc-biblioref">2008</a>)</span> suggestion, rescaling the estimates by dividing them by two standard deviations instead of just one. Resulting coefficients are then directly comparable for untransformed <strong>binary predictors</strong>.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb397-2"><a href="#cb397-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;std2&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-329-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="random-effects" class="section level3" number="9.1.2">
<h3 number="9.1.2"><span class="header-section-number">9.1.2</span> Random Effects</h3>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb398-2"><a href="#cb398-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;re&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-330-1.png" width="288" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb399-2"><a href="#cb399-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;re&quot;</span>,</span>
<span id="cb399-3"><a href="#cb399-3"></a>                   <span class="dt">grid =</span> <span class="ot">FALSE</span>,</span>
<span id="cb399-4"><a href="#cb399-4"></a>                   <span class="dt">sort.est =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>[[1]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-331-1.png" width="288" style="display: block; margin: auto;" /></p>
<pre><code>
[[2]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-331-2.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="plotting-marginal-effects" class="section level2" number="9.2">
<h2 number="9.2"><span class="header-section-number">9.2</span> Plotting Marginal Effects</h2>
<p>Here <code>terms</code> indicates for which terms marginal effects should be displayed. At least one term is required to calculate effects, maximum length is three terms, where the second and third term indicate the groups, i.e. predictions of first term are grouped by the levels of the second (and third) term.</p>
<p><code>terms</code> may also indicate higher order terms (e.g. interaction terms).</p>
<p>Indicating levels in square brackets allows for selecting only specific groups. Term name and levels in brackets must be separated by a whitespace character, e.g. <code>terms = c("age", "education [1,3]")</code>.</p>
<p>It is also possible to specify a range of numeric values for the predictions with a colon, for instance <code>terms = c("education [1,3]", "age [30:50]")</code>.</p>
<p>Furthermore, it is possible to specify a function name. Values for predictions will then be transformed, e.g. <code>terms = "income [exp]"</code>. This is useful when model predictors were transformed for fitting the model and should be <strong>back-transformed</strong> to the original scale for predictions.</p>
<p>Finally, using pretty for numeric variables (e.g. <code>terms = "age [pretty]"</code>) calculates a pretty range of values for the term, roughly of proportional length to the term’s value range. For more details, see the documentation for the <code>ggpredict</code> package.</p>
<div id="predicted-values" class="section level3" number="9.2.1">
<h3 number="9.2.1"><span class="header-section-number">9.2.1</span> Predicted Values</h3>
<p>Based on (i.e. is a wrapper for): <code>ggeffects::ggpredict()</code></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb402-2"><a href="#cb402-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>,</span>
<span id="cb402-3"><a href="#cb402-3"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab_c&quot;</span>, <span class="st">&quot;ses_t&quot;</span>, <span class="st">&quot;age_c&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-332-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The <code>pred.type =</code> option only applies for Marginal Effects plots with <strong>mixed effects models</strong>. Indicates whether predicted values should be <strong>conditioned on random effects</strong> (<code>pred.type = "re"</code>) or fixed effects only (<code>pred.type = "fe"</code>, the default). For details, see documentation of the type-argument in <code>ggpredict()</code> function.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb403-2"><a href="#cb403-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>,</span>
<span id="cb403-3"><a href="#cb403-3"></a>                   <span class="dt">pred.type =</span> <span class="st">&quot;re&quot;</span>,</span>
<span id="cb403-4"><a href="#cb403-4"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab_c&quot;</span>, <span class="st">&quot;ses_t&quot;</span>, <span class="st">&quot;age_c&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-333-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="effect-plots" class="section level3" number="9.2.2">
<h3 number="9.2.2"><span class="header-section-number">9.2.2</span> Effect Plots</h3>
<p>Based on (i.e. is a wrapper for): <code>ggeffects::ggeffect()</code></p>
<p>Similar to <code>type = "pred"</code>, however, discrete predictors are held constant at their proportions (not reference level). See the <code>ggeffect</code> package documentation for details.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb404-2"><a href="#cb404-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;eff&quot;</span>,</span>
<span id="cb404-3"><a href="#cb404-3"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab_c&quot;</span>, <span class="st">&quot;ses_t&quot;</span>, <span class="st">&quot;age_c&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-334-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="interaction-plots" class="section level3" number="9.2.3">
<h3 number="9.2.3"><span class="header-section-number">9.2.3</span> Interaction Plots</h3>
<p>A shortcut for marginal effects plots, where <em>interaction terms are automatically detected</em> and used as terms-argument.</p>
<p>Furthermore, if the moderator variable (the second - and third - term in an interaction) is continuous, <code>type = "int"</code> automatically chooses useful values based on the mdrt.values-argument, which are passed to terms. Then, <code>ggpredict</code> is called.</p>
<p><code>type = "int"</code> plots the interaction term that appears:</p>
<ul>
<li><strong>first</strong> in the formula along the x-axis, while the</li>
<li><strong>second</strong> (and possibly third) variable in an interaction is used as grouping factor(s) (moderating variable).</li>
</ul>
<p>Use <code>type = "pred"</code> or <code>type = "eff"</code> and specify a certain order in the terms-argument to indicate which variable(s) should be used as moderator.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb405-2"><a href="#cb405-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;int&quot;</span>)</span></code></pre></div>
<pre><code>[[1]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-335-1.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>
[[2]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-335-2.png" width="576" style="display: block; margin: auto;" /></p>
<p>The <code>mdrt.values =</code> option indicates which values of the <strong>moderator variable</strong> should be used when plotting interaction terms (i.e. <code>type = "int"</code>).</p>
<ul>
<li><p><code>minmax</code> (default) minimum and maximum values (lower and upper bounds) of the moderator are used to plot the interaction between independent variable and moderator(s).</p></li>
<li><p><code>meansd</code> uses the mean value of the moderator as well as one standard deviation below and above mean value to plot the effect of the moderator on the independent variable (following the convention suggested by Cohen and Cohen and popularized by Aiken and West (1991), i.e. using the mean, the value one standard deviation above, and the value one standard deviation below the mean as values of the moderator, see Grace-Martin K: 3 Tips to Make Interpreting Moderation Effects Easier).</p></li>
<li><p><code>zeromax</code> is similar to the <code>minmax</code> option, however, <span class="math inline">\(0\)</span> is always used as minimum value for the moderator. This may be useful for predictors that don’t have an empirical zero-value, but absence of moderation should be simulated by using <span class="math inline">\(0\)</span> as minimum.</p></li>
<li><p><code>quart</code> calculates and uses the quartiles (lower, median and upper) of the moderator value.</p></li>
<li><p><code>all</code> uses all values of the moderator variable.</p></li>
</ul>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb408-2"><a href="#cb408-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;int&quot;</span>,</span>
<span id="cb408-3"><a href="#cb408-3"></a>                   <span class="dt">mdrt.values =</span> <span class="st">&quot;meansd&quot;</span>)</span></code></pre></div>
<pre><code>[[1]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-336-1.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>
[[2]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-336-2.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="model-diagnostics" class="section level2" number="9.3">
<h2 number="9.3"><span class="header-section-number">9.3</span> Model Diagnostics</h2>
<p>Note: For mixed models, the diagnostic plots like linear relationship or check for Homoscedasticity, do not take the uncertainty of random effects into account, but is only based on the fixed effects part of the model.</p>
<div id="slope-of-coefficentes" class="section level3" number="9.3.1">
<h3 number="9.3.1"><span class="header-section-number">9.3.1</span> Slope of Coefficentes</h3>
<p>Slope of coefficients for each single predictor, against the response (linear relationship between each model term and response).</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb411-2"><a href="#cb411-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;slope&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-337-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="residuals" class="section level3" number="9.3.2">
<h3 number="9.3.2"><span class="header-section-number">9.3.2</span> Residuals</h3>
<p>Slope of coefficients for each single predictor, against the residuals (linear relationship between each model term and residuals).</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb412-2"><a href="#cb412-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;resid&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-338-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="diagnostics" class="section level3" number="9.3.3">
<h3 number="9.3.3"><span class="header-section-number">9.3.3</span> Diagnostics</h3>
<p>Check model assumptions.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_read_11re_s,</span>
<span id="cb413-2"><a href="#cb413-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;diag&quot;</span>)</span></code></pre></div>
<pre><code>[[1]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-339-1.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>
[[2]]
[[2]]$school</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-339-2.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>

[[3]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-339-3.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>
[[4]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-339-4.png" width="576" style="display: block; margin: auto;" /></p>
<!--chapter:end:10-sjPlot.Rmd-->
</div>
</div>
</div>
<div id="mlm-longitudinal-autism" class="section level1" number="10">
<h1 number="10"><span class="header-section-number">10</span> MLM, Longitudinal: Autism</h1>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb418-2"><a href="#cb418-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking general tabulations</span></span>
<span id="cb418-3"><a href="#cb418-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptive</span></span>
<span id="cb418-4"><a href="#cb418-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb418-5"><a href="#cb418-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb418-6"><a href="#cb418-6"></a><span class="kw">library</span>(performance)</span>
<span id="cb418-7"><a href="#cb418-7"></a><span class="kw">library</span>(sjstats)      <span class="co"># ICC calculations</span></span>
<span id="cb418-8"><a href="#cb418-8"></a></span>
<span id="cb418-9"><a href="#cb418-9"></a><span class="kw">library</span>(sjPlot)       <span class="co"># Quick predictive and diagnostic plots </span></span>
<span id="cb418-10"><a href="#cb418-10"></a><span class="kw">library</span>(effects)      <span class="co"># Estimated Marginal Means</span></span>
<span id="cb418-11"><a href="#cb418-11"></a></span>
<span id="cb418-12"><a href="#cb418-12"></a><span class="kw">library</span>(VIM)          <span class="co"># Visualization and Imputation of Missing Values </span></span>
<span id="cb418-13"><a href="#cb418-13"></a><span class="kw">library</span>(naniar)       <span class="co"># Summaries and Visualizations for Missing Data</span></span>
<span id="cb418-14"><a href="#cb418-14"></a></span>
<span id="cb418-15"><a href="#cb418-15"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb418-16"><a href="#cb418-16"></a><span class="kw">library</span>(optimx)</span>
<span id="cb418-17"><a href="#cb418-17"></a><span class="kw">library</span>(interactions)</span>
<span id="cb418-18"><a href="#cb418-18"></a><span class="kw">library</span>(ggResidpanel)</span>
<span id="cb418-19"><a href="#cb418-19"></a></span>
<span id="cb418-20"><a href="#cb418-20"></a><span class="kw">library</span>(HLMdiag)      <span class="co"># package with the dataset</span></span></code></pre></div>
<div id="background-4" class="section level2" number="10.1">
<h2 number="10.1"><span class="header-section-number">10.1</span> Background</h2>
<p>The source: <a href="http://www-personal.umich.edu/~kwelch/" class="uri">http://www-personal.umich.edu/~kwelch/</a></p>
<p>This data was collected by researchers at the University of Michigan <span class="citation">(Anderson et al. <a href="#ref-anderson2007" role="doc-biblioref">2007</a>, [@anderson2009])</span> as part of a prospective longitudinal study of 214 children. The children were divided into three diagnostic groups (<code>bestest2</code>) when they were 2 years old: Autism (<code>autism</code>), Pervasive Developmental Disorder (<code>pdd</code>), and non-spectrum children (none in this sample). The study was designed to collect information on each child at approximately 2, 3, 5, 9, and 13 years of age, although not all children were measured for each age. One of the study objectives was to assess the relative influence of the initial diagnostic category, language proficiency at age 2, and other covariates on the developmental trajectories of the socialization (<code>vsae</code>) of these children.</p>
<p>Study participants were children who had had consecutive referrals to one of two autism clinics before the age of 3 years. Social development was assessed at each age using the Vineland Adaptive Behavior Interview survey form, a parent-reported measure of socialization. <strong>VSAE</strong> (Vineland Socialization Age Equivalent), was a combined score that included assessments of interpersonal relationships, play/leisure time activities, and coping skills. Initial language development was assessed using the Sequenced Inventory of Communication Development (SICD) scale; children were placed into one of three groups (<code>sicdegp</code>) based on their initial SICD scores on the expressive language subscale at age 2.</p>
<ul>
<li><p><code>childid</code> Child’s identification number for this study</p></li>
<li><p><code>sicdegp</code> Sequenced Inventory of Communication Development group <em>(an assessment of expressive language development)</em> - a factor. Levels are <code>low</code>, <code>med</code>, and <code>high</code></p></li>
<li><p><code>age2</code> Age (in years) centered around age 2 (age at diagnosis)</p></li>
<li><p><code>vsae</code> Vineland Socialization Age Equivalent, Parent-reported measure of socialization, including measures of:</p>
<ul>
<li>interpersonal relationships</li>
<li>play/leisure time activities</li>
<li>coping skills</li>
</ul></li>
<li><p><code>gender</code> Child’s gender - a factor. Levels are <code>male</code> and <code>female</code></p></li>
<li><p><code>race</code> Child’s race - a factor. Levels are <code>white</code> and <code>nonwhite</code></p></li>
<li><p><code>bestest2</code> Diagnosis at age 2 - a factor. Levels are <code>autism</code> and <code>pdd</code> (pervasive developmental disorder)</p></li>
</ul>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1"></a><span class="kw">data</span>(autism, <span class="dt">package =</span> <span class="st">&quot;HLMdiag&quot;</span>)   <span class="co"># make the dataset &#39;active&#39; from this package</span></span></code></pre></div>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(autism)             <span class="co"># first look at the dataset and its varaibles</span></span></code></pre></div>
<pre><code>Rows: 604
Columns: 7
$ childid  &lt;int&gt; 1, 1, 1, 1, 1, 10, 10, 10, 10, 100, 100, 100, 100, 101, 10...
$ sicdegp  &lt;fct&gt; high, high, high, high, high, low, low, low, low, high, hi...
$ age2     &lt;dbl&gt; 0, 1, 3, 7, 11, 0, 1, 7, 11, 0, 1, 3, 7, 0, 1, 7, 11, 0, 1...
$ vsae     &lt;int&gt; 6, 7, 18, 25, 27, 9, 11, 18, 39, 15, 24, 37, 135, 8, 24, 7...
$ gender   &lt;fct&gt; male, male, male, male, male, male, male, male, male, male...
$ race     &lt;fct&gt; white, white, white, white, white, white, white, white, wh...
$ bestest2 &lt;fct&gt; pdd, pdd, pdd, pdd, pdd, autism, autism, autism, autism, p...</code></pre>
<div id="long-format" class="section level3" number="10.1.1">
<h3 number="10.1.1"><span class="header-section-number">10.1.1</span> Long Format</h3>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1"></a>data_long &lt;-<span class="st"> </span>autism <span class="op">%&gt;%</span><span class="st">                                    </span><span class="co"># save the dataset as a new name</span></span>
<span id="cb422-2"><a href="#cb422-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">childid =</span> childid <span class="op">%&gt;%</span><span class="st"> </span>factor) <span class="op">%&gt;%</span><span class="st">          </span><span class="co"># declare grouping var a factor</span></span>
<span id="cb422-3"><a href="#cb422-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age =</span> <span class="dv">2</span> <span class="op">+</span><span class="st"> </span>age2) <span class="op">%&gt;%</span><span class="st">                        </span><span class="co"># create the original age variable (unequally spaced)</span></span>
<span id="cb422-4"><a href="#cb422-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">obs =</span> age <span class="op">%&gt;%</span><span class="st"> </span>factor <span class="op">%&gt;%</span><span class="st"> </span>as.numeric) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># Observation Number = 1, 2, 3, 4, 5 (equally spaced)</span></span>
<span id="cb422-5"><a href="#cb422-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(childid,                                   <span class="co"># choose variables and order to keep</span></span>
<span id="cb422-6"><a href="#cb422-6"></a>                gender, race, bestest2, sicdegp, </span>
<span id="cb422-7"><a href="#cb422-7"></a>                obs, age, age2, vsae) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb422-8"><a href="#cb422-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(childid, age2)                            <span class="co"># sort observations</span></span></code></pre></div>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb423-2"><a href="#cb423-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>(<span class="dt">top =</span> <span class="dv">11</span>, <span class="dt">bottom =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>    childid gender     race bestest2 sicdegp obs age age2 vsae
1         1   male    white      pdd    high   1   2    0    6
2         1   male    white      pdd    high   2   3    1    7
3         1   male    white      pdd    high   3   5    3   18
4         1   male    white      pdd    high   4   9    7   25
5         1   male    white      pdd    high   5  13   11   27
6         2   male    white   autism     low   1   2    0    6
7         2   male    white   autism     low   2   3    1    7
8         2   male    white   autism     low   3   5    3    7
9         2   male    white   autism     low   4   9    7    8
10        2   male    white   autism     low   5  13   11   14
11        3   male nonwhite      pdd    high   1   2    0   17
...    &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt; ... ...  ...  ...
599     211   male nonwhite   autism    high   1   2    0   15
600     212   male    white   autism     med   1   2    0    7
601     212   male    white   autism     med   2   3    1   21
602     212   male    white   autism     med   3   5    3   29
603     212   male    white   autism     med   4   9    7   72
604     212   male    white   autism     med   5  13   11  147</code></pre>
</div>
<div id="wide-format" class="section level3" number="10.1.2">
<h3 number="10.1.2"><span class="header-section-number">10.1.2</span> Wide Format</h3>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1"></a>data_wide &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st">                            </span><span class="co"># save the dataset as a new name</span></span>
<span id="cb425-2"><a href="#cb425-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>age2, <span class="op">-</span>obs) <span class="op">%&gt;%</span><span class="st">                      </span><span class="co"># delete (by deselecting) this variable </span></span>
<span id="cb425-3"><a href="#cb425-3"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from  =</span> age,               <span class="co"># repeated indicator</span></span>
<span id="cb425-4"><a href="#cb425-4"></a>                     <span class="dt">values_from =</span> vsae,              <span class="co"># variable repeated</span></span>
<span id="cb425-5"><a href="#cb425-5"></a>                     <span class="dt">names_prefix =</span> <span class="st">&quot;vsae_&quot;</span>) <span class="op">%&gt;%</span><span class="st">      </span><span class="co"># prefix in from of the </span></span>
<span id="cb425-6"><a href="#cb425-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(childid)                             <span class="co"># sort observations</span></span>
<span id="cb425-7"><a href="#cb425-7"></a></span>
<span id="cb425-8"><a href="#cb425-8"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(data_wide)</span></code></pre></div>
<pre><code>Rows: 155
Columns: 10
$ childid  &lt;fct&gt; 1, 2, 3, 4, 6, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 2...
$ gender   &lt;fct&gt; male, male, male, male, male, male, male, male, male, male...
$ race     &lt;fct&gt; white, white, nonwhite, nonwhite, white, nonwhite, white, ...
$ bestest2 &lt;fct&gt; pdd, autism, pdd, autism, autism, autism, pdd, autism, aut...
$ sicdegp  &lt;fct&gt; high, low, high, high, low, low, med, low, med, low, med, ...
$ vsae_2   &lt;int&gt; 6, 6, 17, 12, 6, 9, 12, 9, 7, 6, 12, 13, 7, 5, 10, 17, 11,...
$ vsae_3   &lt;int&gt; 7, 7, 18, 14, 12, 12, 21, 11, 10, 10, 19, 8, 6, 10, 6, 27,...
$ vsae_5   &lt;int&gt; 18, 7, 12, 38, NA, 14, NA, NA, 8, 12, 14, 29, NA, 29, NA, ...
$ vsae_9   &lt;int&gt; 25, 8, 18, 114, 12, NA, 66, 18, NA, NA, 28, 24, 39, 32, NA...
$ vsae_13  &lt;int&gt; 27, 14, 24, NA, 45, NA, 68, 39, NA, NA, 68, 44, 24, 67, NA...</code></pre>
<p>Notice the missing values, displayed as <code>NA</code>.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb427-2"><a href="#cb427-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>()</span></code></pre></div>
<pre><code>  childid gender     race bestest2 sicdegp vsae_2 vsae_3 vsae_5 vsae_9 vsae_13
1       1   male    white      pdd    high      6      7     18     25      27
2       2   male    white   autism     low      6      7      7      8      14
3       3   male nonwhite      pdd    high     17     18     12     18      24
4       4   male nonwhite   autism    high     12     14     38    114    &lt;NA&gt;
5    &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt;    ...    ...    ...    ...     ...
6     209   male    white   autism     med      2      4   &lt;NA&gt;     12      32
7     210   male    white   autism     low      4     25   &lt;NA&gt;    130    &lt;NA&gt;
8     211   male nonwhite   autism    high     15   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;
9     212   male    white   autism     med      7     21     29     72     147</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-3" class="section level2" number="10.2">
<h2 number="10.2"><span class="header-section-number">10.2</span> Exploratory Data Analysis</h2>
<div id="demographic-summary" class="section level3" number="10.2.1">
<h3 number="10.2.1"><span class="header-section-number">10.2.1</span> Demographic Summary</h3>
<div id="using-the-wide-formatted-dataset" class="section level4" number="10.2.1.1">
<h4 number="10.2.1.1"><span class="header-section-number">10.2.1.1</span> Using the WIDE formatted dataset</h4>
<p>Each person’s data is only stored on a single line</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb429-2"><a href="#cb429-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(<span class="st">&quot;Initial Language Development&quot;</span> =<span class="st"> </span>sicdegp) <span class="op">%&gt;%</span><span class="st">     </span><span class="co"># how split into columns</span></span>
<span id="cb429-3"><a href="#cb429-3"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Diagnosis&quot;</span> =<span class="st"> </span>bestest2, </span>
<span id="cb429-4"><a href="#cb429-4"></a>                    <span class="st">&quot;Gender&quot;</span>    =<span class="st"> </span>gender, </span>
<span id="cb429-5"><a href="#cb429-5"></a>                    <span class="st">&quot;Race&quot;</span>      =<span class="st"> </span>race,  </span>
<span id="cb429-6"><a href="#cb429-6"></a>                    <span class="dt">digits =</span> <span class="dv">2</span>,</span>
<span id="cb429-7"><a href="#cb429-7"></a>                    <span class="dt">na.rm  =</span> <span class="ot">FALSE</span>,  </span>
<span id="cb429-8"><a href="#cb429-8"></a>                    <span class="dt">total  =</span> <span class="ot">TRUE</span>,</span>
<span id="cb429-9"><a href="#cb429-9"></a>                    <span class="dt">test   =</span> <span class="ot">TRUE</span>,               <span class="co"># compare the groups</span></span>
<span id="cb429-10"><a href="#cb429-10"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)           </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>low</th>
<th>med</th>
<th>high</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 155</td>
<td>n = 49</td>
<td>n = 65</td>
<td>n = 41</td>
<td></td>
</tr>
<tr class="even">
<td>Diagnosis</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0.018</td>
</tr>
<tr class="odd">
<td>autism</td>
<td>100 (64.5%)</td>
<td>38 (77.6%)</td>
<td>42 (64.6%)</td>
<td>20 (48.8%)</td>
<td></td>
</tr>
<tr class="even">
<td>pdd</td>
<td>55 (35.5%)</td>
<td>11 (22.4%)</td>
<td>23 (35.4%)</td>
<td>21 (51.2%)</td>
<td></td>
</tr>
<tr class="odd">
<td>NA</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td></td>
</tr>
<tr class="even">
<td>Gender</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0.706</td>
</tr>
<tr class="odd">
<td>male</td>
<td>134 (86.5%)</td>
<td>44 (89.8%)</td>
<td>55 (84.6%)</td>
<td>35 (85.4%)</td>
<td></td>
</tr>
<tr class="even">
<td>female</td>
<td>21 (13.5%)</td>
<td>5 (10.2%)</td>
<td>10 (15.4%)</td>
<td>6 (14.6%)</td>
<td></td>
</tr>
<tr class="odd">
<td>NA</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td></td>
</tr>
<tr class="even">
<td>Race</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0.944</td>
</tr>
<tr class="odd">
<td>white</td>
<td>101 (65.2%)</td>
<td>31 (63.3%)</td>
<td>43 (66.2%)</td>
<td>27 (65.9%)</td>
<td></td>
</tr>
<tr class="even">
<td>nonwhite</td>
<td>54 (34.8%)</td>
<td>18 (36.7%)</td>
<td>22 (33.8%)</td>
<td>14 (34.1%)</td>
<td></td>
</tr>
<tr class="odd">
<td>NA</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="using-the-long-formatted-dataset" class="section level4" number="10.2.1.2">
<h4 number="10.2.1.2"><span class="header-section-number">10.2.1.2</span> Using the LONG formatted dataset</h4>
<p>Each person’s data is stored on multiple lines, one for each time point. To ensure the summary table is correct, you must choose a single time point per person.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1"></a><span class="co"># Note: One person is missing Age 2</span></span>
<span id="cb430-2"><a href="#cb430-2"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb430-3"><a href="#cb430-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(age <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st">                                      </span><span class="co"># restrict to one-line per person</span></span>
<span id="cb430-4"><a href="#cb430-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(<span class="st">&quot;Initial Language Development&quot;</span> =<span class="st"> </span>sicdegp) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># how split into columns</span></span>
<span id="cb430-5"><a href="#cb430-5"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Diagnosis&quot;</span> =<span class="st"> </span>bestest2, </span>
<span id="cb430-6"><a href="#cb430-6"></a>                    <span class="st">&quot;Gender&quot;</span>    =<span class="st"> </span>gender, </span>
<span id="cb430-7"><a href="#cb430-7"></a>                    <span class="st">&quot;Race&quot;</span>      =<span class="st"> </span>race, </span>
<span id="cb430-8"><a href="#cb430-8"></a>                    <span class="dt">digits =</span> <span class="dv">2</span>,</span>
<span id="cb430-9"><a href="#cb430-9"></a>                    <span class="dt">na.rm  =</span> <span class="ot">FALSE</span>,</span>
<span id="cb430-10"><a href="#cb430-10"></a>                    <span class="dt">total  =</span> <span class="ot">TRUE</span>,</span>
<span id="cb430-11"><a href="#cb430-11"></a>                    <span class="dt">test   =</span> <span class="ot">TRUE</span>,               <span class="co"># compare the groups</span></span>
<span id="cb430-12"><a href="#cb430-12"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)           </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>low</th>
<th>med</th>
<th>high</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 154</td>
<td>n = 49</td>
<td>n = 65</td>
<td>n = 40</td>
<td></td>
</tr>
<tr class="even">
<td>Diagnosis</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0.025</td>
</tr>
<tr class="odd">
<td>autism</td>
<td>100 (64.9%)</td>
<td>38 (77.6%)</td>
<td>42 (64.6%)</td>
<td>20 (50%)</td>
<td></td>
</tr>
<tr class="even">
<td>pdd</td>
<td>54 (35.1%)</td>
<td>11 (22.4%)</td>
<td>23 (35.4%)</td>
<td>20 (50%)</td>
<td></td>
</tr>
<tr class="odd">
<td>NA</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td></td>
</tr>
<tr class="even">
<td>Gender</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0.714</td>
</tr>
<tr class="odd">
<td>male</td>
<td>134 (87%)</td>
<td>44 (89.8%)</td>
<td>55 (84.6%)</td>
<td>35 (87.5%)</td>
<td></td>
</tr>
<tr class="even">
<td>female</td>
<td>20 (13%)</td>
<td>5 (10.2%)</td>
<td>10 (15.4%)</td>
<td>5 (12.5%)</td>
<td></td>
</tr>
<tr class="odd">
<td>NA</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td></td>
</tr>
<tr class="even">
<td>Race</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0.95</td>
</tr>
<tr class="odd">
<td>white</td>
<td>100 (64.9%)</td>
<td>31 (63.3%)</td>
<td>43 (66.2%)</td>
<td>26 (65%)</td>
<td></td>
</tr>
<tr class="even">
<td>nonwhite</td>
<td>54 (35.1%)</td>
<td>18 (36.7%)</td>
<td>22 (33.8%)</td>
<td>14 (35%)</td>
<td></td>
</tr>
<tr class="odd">
<td>NA</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="baseline-summary" class="section level3" number="10.2.2">
<h3 number="10.2.2"><span class="header-section-number">10.2.2</span> Baseline Summary</h3>
<div id="using-the-wide-formatted-dataset-1" class="section level4" number="10.2.2.1">
<h4 number="10.2.2.1"><span class="header-section-number">10.2.2.1</span> Using the WIDE formatted dataset</h4>
<p>Each person’s data is only stored on a single line</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1"></a>data_wide <span class="op">%&gt;%</span></span>
<span id="cb431-2"><a href="#cb431-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(<span class="st">&quot;Initial Language Development&quot;</span> =<span class="st"> </span>sicdegp) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># how split into columns</span></span>
<span id="cb431-3"><a href="#cb431-3"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(vsae_<span class="dv">2</span>,</span>
<span id="cb431-4"><a href="#cb431-4"></a>                    <span class="dt">digits =</span> <span class="dv">2</span>,</span>
<span id="cb431-5"><a href="#cb431-5"></a>                    <span class="dt">na.rm  =</span> <span class="ot">FALSE</span>,</span>
<span id="cb431-6"><a href="#cb431-6"></a>                    <span class="dt">total  =</span> <span class="ot">TRUE</span>,</span>
<span id="cb431-7"><a href="#cb431-7"></a>                    <span class="dt">test   =</span> <span class="ot">TRUE</span>,               <span class="co"># compare the groups</span></span>
<span id="cb431-8"><a href="#cb431-8"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>low</th>
<th>med</th>
<th>high</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 155</td>
<td>n = 49</td>
<td>n = 65</td>
<td>n = 41</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_2</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>9.16 (3.84)</td>
<td>7.06 (2.73)</td>
<td>8.74 (3.51)</td>
<td>12.40 (3.43)</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="using-the-long-formatted-dataset-1" class="section level4" number="10.2.2.2">
<h4 number="10.2.2.2"><span class="header-section-number">10.2.2.2</span> Using the LONG formatted dataset</h4>
<p>Each person’s data is stored on multiple lines, one for each time point. To ensure the summary table is correct, you must choose a single time point per person.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb432-2"><a href="#cb432-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(age <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb432-3"><a href="#cb432-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(<span class="st">&quot;Initial Language Development&quot;</span> =<span class="st"> </span>sicdegp) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># how split into columns</span></span>
<span id="cb432-4"><a href="#cb432-4"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(vsae, </span>
<span id="cb432-5"><a href="#cb432-5"></a>                    <span class="dt">test =</span> <span class="ot">TRUE</span>,</span>
<span id="cb432-6"><a href="#cb432-6"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>low</th>
<th>med</th>
<th>high</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 49</td>
<td>n = 65</td>
<td>n = 40</td>
<td></td>
</tr>
<tr class="even">
<td>vsae</td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>7.1 (2.7)</td>
<td>8.7 (3.5)</td>
<td>12.4 (3.4)</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="missing-data-attrition" class="section level3" number="10.2.3">
<h3 number="10.2.3"><span class="header-section-number">10.2.3</span> Missing Data &amp; Attrition</h3>
<div id="vim-package" class="section level4" number="10.2.3.1">
<h4 number="10.2.3.1"><span class="header-section-number">10.2.3.1</span> <code>VIM</code> package</h4>
<p>Plot the amount of missing vlaues and the amount of each patter of missing values.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb433-2"><a href="#cb433-2"></a><span class="st">  </span>VIM<span class="op">::</span><span class="kw">aggr</span>(<span class="dt">numbers =</span> <span class="ot">TRUE</span>,   <span class="co"># shows the number to the far right</span></span>
<span id="cb433-3"><a href="#cb433-3"></a>            <span class="dt">prop    =</span> <span class="ot">FALSE</span>)  <span class="co"># shows counts instead of proportions</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-351-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="naniar-package" class="section level4" number="10.2.3.2">
<h4 number="10.2.3.2"><span class="header-section-number">10.2.3.2</span> <code>naniar</code> package</h4>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb434-2"><a href="#cb434-2"></a><span class="st">  </span>naniar<span class="op">::</span><span class="kw">vis_miss</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-352-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb435-2"><a href="#cb435-2"></a><span class="st">  </span>naniar<span class="op">::</span><span class="kw">gg_miss_var</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-353-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb436-2"><a href="#cb436-2"></a><span class="st">  </span>naniar<span class="op">::</span><span class="kw">gg_miss_var</span>(<span class="dt">show_pct =</span> <span class="ot">TRUE</span>,     <span class="co"># x-axis is PERCENT, not count</span></span>
<span id="cb436-3"><a href="#cb436-3"></a>                      <span class="dt">facet =</span> sicdegp) <span class="op">+</span><span class="st">   </span><span class="co"># create seperate panels</span></span>
<span id="cb436-4"><a href="#cb436-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()                               <span class="co"># add ggplot layers as normal</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-354-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb437-2"><a href="#cb437-2"></a><span class="st">  </span>naniar<span class="op">::</span><span class="kw">gg_miss_upset</span>() </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-355-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb438-2"><a href="#cb438-2"></a><span class="st">  </span>naniar<span class="op">::</span><span class="kw">gg_miss_upset</span>(<span class="dt">sets =</span> <span class="kw">c</span>(<span class="st">&quot;vsae_13_NA&quot;</span>,</span>
<span id="cb438-3"><a href="#cb438-3"></a>                                 <span class="st">&quot;vsae_9_NA&quot;</span>,</span>
<span id="cb438-4"><a href="#cb438-4"></a>                                 <span class="st">&quot;vsae_5_NA&quot;</span>,</span>
<span id="cb438-5"><a href="#cb438-5"></a>                                 <span class="st">&quot;vsae_3_NA&quot;</span>,</span>
<span id="cb438-6"><a href="#cb438-6"></a>                                 <span class="st">&quot;vsae_2_NA&quot;</span>),</span>
<span id="cb438-7"><a href="#cb438-7"></a>                        <span class="dt">keep.order =</span> <span class="ot">TRUE</span>) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-356-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="means-across-time" class="section level3" number="10.2.4">
<h3 number="10.2.4"><span class="header-section-number">10.2.4</span> Means Across Time</h3>
<div id="using-the-wide-formatted-dataset-2" class="section level4" number="10.2.4.1">
<h4 number="10.2.4.1"><span class="header-section-number">10.2.4.1</span> Using the WIDE formatted dataset</h4>
<blockquote>
<p>Default = COMPLETE CASES ONLY!!!</p>
</blockquote>
<p>Note - the sample size at each time point is the same, but subjects are only included if they have data at every time point (total n = 41)</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1"></a>data_wide <span class="op">%&gt;%</span></span>
<span id="cb439-2"><a href="#cb439-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(<span class="st">&quot;Initial Language Development&quot;</span> =<span class="st"> </span>sicdegp) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># how split into columns</span></span>
<span id="cb439-3"><a href="#cb439-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;vsae_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb439-4"><a href="#cb439-4"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="dt">digits =</span> <span class="dv">2</span>,</span>
<span id="cb439-5"><a href="#cb439-5"></a>                    <span class="dt">total  =</span> <span class="ot">TRUE</span>,</span>
<span id="cb439-6"><a href="#cb439-6"></a>                    <span class="dt">test   =</span> <span class="ot">TRUE</span>,               <span class="co"># compare the groups</span></span>
<span id="cb439-7"><a href="#cb439-7"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>low</th>
<th>med</th>
<th>high</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 41</td>
<td>n = 10</td>
<td>n = 17</td>
<td>n = 14</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_2</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0.003</td>
</tr>
<tr class="odd">
<td></td>
<td>9.80 (4.39)</td>
<td>6.60 (2.88)</td>
<td>9.47 (4.12)</td>
<td>12.50 (4.09)</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>14.54 (6.89)</td>
<td>8.00 (2.11)</td>
<td>14.29 (6.08)</td>
<td>19.50 (6.15)</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_5</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>23.00 (14.84)</td>
<td>12.50 (5.54)</td>
<td>20.18 (8.57)</td>
<td>33.93 (18.50)</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_9</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>36.68 (26.29)</td>
<td>12.30 (8.07)</td>
<td>34.41 (22.54)</td>
<td>56.86 (23.54)</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_13</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0.009</td>
</tr>
<tr class="odd">
<td></td>
<td>57.07 (47.83)</td>
<td>22.40 (24.45)</td>
<td>57.82 (50.33)</td>
<td>80.93 (44.38)</td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Specify All data:</p>
</blockquote>
<p>note - that the smaple sizes will be different for each time point (total n = 155)</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1"></a>data_wide <span class="op">%&gt;%</span></span>
<span id="cb440-2"><a href="#cb440-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(<span class="st">&quot;Initial Language Development&quot;</span> =<span class="st"> </span>sicdegp) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># how split into columns</span></span>
<span id="cb440-3"><a href="#cb440-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;vsae_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb440-4"><a href="#cb440-4"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="dt">digits =</span> <span class="dv">2</span>,</span>
<span id="cb440-5"><a href="#cb440-5"></a>                    <span class="dt">na.rm  =</span> <span class="ot">FALSE</span>,</span>
<span id="cb440-6"><a href="#cb440-6"></a>                    <span class="dt">total  =</span> <span class="ot">TRUE</span>,</span>
<span id="cb440-7"><a href="#cb440-7"></a>                    <span class="dt">test   =</span> <span class="ot">TRUE</span>,               <span class="co"># compare the groups</span></span>
<span id="cb440-8"><a href="#cb440-8"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>low</th>
<th>med</th>
<th>high</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 155</td>
<td>n = 49</td>
<td>n = 65</td>
<td>n = 41</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_2</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>9.16 (3.84)</td>
<td>7.06 (2.73)</td>
<td>8.74 (3.51)</td>
<td>12.40 (3.43)</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>15.12 (7.81)</td>
<td>12.02 (6.33)</td>
<td>13.68 (5.42)</td>
<td>21.24 (9.38)</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_5</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>21.48 (13.32)</td>
<td>15.03 (7.92)</td>
<td>17.69 (8.00)</td>
<td>33.92 (15.78)</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_9</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>39.55 (32.62)</td>
<td>25.56 (28.42)</td>
<td>32.12 (23.40)</td>
<td>64.14 (34.59)</td>
<td></td>
</tr>
<tr class="even">
<td>vsae_13</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>&lt;.001</td>
</tr>
<tr class="odd">
<td></td>
<td>59.49 (47.96)</td>
<td>37.11 (35.54)</td>
<td>56.17 (47.91)</td>
<td>88.69 (46.34)</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="using-the-long-formatted-dataset-2" class="section level4" number="10.2.4.2">
<h4 number="10.2.4.2"><span class="header-section-number">10.2.4.2</span> Using the LONG formatted dataset</h4>
<p>Each person’s data is stored on multiple lines, one for each time point.</p>
<blockquote>
<p>FOR ALL DATA!</p>
</blockquote>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1"></a>data_sum_all &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb441-2"><a href="#cb441-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(sicdegp, age2) <span class="op">%&gt;%</span><span class="st">                     </span><span class="co"># specify the groups</span></span>
<span id="cb441-3"><a href="#cb441-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">vsae_n    =</span> <span class="kw">n</span>(),                      <span class="co"># count of valid scores</span></span>
<span id="cb441-4"><a href="#cb441-4"></a>                   <span class="dt">vsae_mean =</span> <span class="kw">mean</span>(vsae),               <span class="co"># mean score</span></span>
<span id="cb441-5"><a href="#cb441-5"></a>                   <span class="dt">vsae_sd   =</span> <span class="kw">sd</span>(vsae),                 <span class="co"># standard deviation of scores</span></span>
<span id="cb441-6"><a href="#cb441-6"></a>                   <span class="dt">vsae_sem  =</span> vsae_sd <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(vsae_n))   <span class="co"># stadard error for the mean of scores</span></span>
<span id="cb441-7"><a href="#cb441-7"></a></span>
<span id="cb441-8"><a href="#cb441-8"></a>data_sum_all</span></code></pre></div>
<pre><code># A tibble: 15 x 6
# Groups:   sicdegp [3]
   sicdegp  age2 vsae_n vsae_mean vsae_sd vsae_sem
   &lt;fct&gt;   &lt;dbl&gt;  &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1 low         0     49      7.06    2.73    0.389
 2 low         1     46     12.0     6.33    0.934
 3 low         3     29     15.0     7.92    1.47 
 4 low         7     36     25.6    28.4     4.74 
 5 low        11     28     37.1    35.5     6.72 
 6 med         0     65      8.74    3.51    0.436
 7 med         1     62     13.7     5.42    0.688
 8 med         3     36     17.7     8.00    1.33 
 9 med         7     48     32.1    23.4     3.38 
10 med        11     40     56.2    47.9     7.58 
11 high        0     40     12.4     3.43    0.542
12 high        1     38     21.2     9.38    1.52 
13 high        3     26     33.9    15.8     3.09 
14 high        7     35     64.1    34.6     5.85 
15 high       11     26     88.7    46.3     9.09 </code></pre>
<blockquote>
<p>FOR COMPLETE CASES ONLY!!!</p>
</blockquote>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1"></a>data_sum_cc &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb443-2"><a href="#cb443-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(childid) <span class="op">%&gt;%</span><span class="st">        </span><span class="co"># group-by child</span></span>
<span id="cb443-3"><a href="#cb443-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">child_vsae_n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># count the number of valid VSAE scores</span></span>
<span id="cb443-4"><a href="#cb443-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(child_vsae_n <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st">     </span><span class="co"># restrict to only thoes children with 5 valid scores</span></span>
<span id="cb443-5"><a href="#cb443-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(sicdegp, age2) <span class="op">%&gt;%</span><span class="st">              </span><span class="co"># specify the groups</span></span>
<span id="cb443-6"><a href="#cb443-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">vsae_n    =</span> <span class="kw">n</span>(),                      <span class="co"># count of valid scores</span></span>
<span id="cb443-7"><a href="#cb443-7"></a>                   <span class="dt">vsae_mean =</span> <span class="kw">mean</span>(vsae),               <span class="co"># mean score</span></span>
<span id="cb443-8"><a href="#cb443-8"></a>                   <span class="dt">vsae_sd   =</span> <span class="kw">sd</span>(vsae),                 <span class="co"># standard deviation of scores</span></span>
<span id="cb443-9"><a href="#cb443-9"></a>                   <span class="dt">vsae_sem  =</span> vsae_sd <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(vsae_n))   <span class="co"># stadard error for the mean of scores</span></span>
<span id="cb443-10"><a href="#cb443-10"></a></span>
<span id="cb443-11"><a href="#cb443-11"></a>data_sum_cc</span></code></pre></div>
<pre><code># A tibble: 15 x 6
# Groups:   sicdegp [3]
   sicdegp  age2 vsae_n vsae_mean vsae_sd vsae_sem
   &lt;fct&gt;   &lt;dbl&gt;  &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1 low         0     10      6.6     2.88    0.909
 2 low         1     10      8       2.11    0.667
 3 low         3     10     12.5     5.54    1.75 
 4 low         7     10     12.3     8.07    2.55 
 5 low        11     10     22.4    24.4     7.73 
 6 med         0     17      9.47    4.12    1.00 
 7 med         1     17     14.3     6.08    1.47 
 8 med         3     17     20.2     8.57    2.08 
 9 med         7     17     34.4    22.5     5.47 
10 med        11     17     57.8    50.3    12.2  
11 high        0     14     12.5     4.09    1.09 
12 high        1     14     19.5     6.15    1.64 
13 high        3     14     33.9    18.5     4.94 
14 high        7     14     56.9    23.5     6.29 
15 high       11     14     80.9    44.4    11.9  </code></pre>
</div>
</div>
<div id="person-profile-plots" class="section level3" number="10.2.5">
<h3 number="10.2.5"><span class="header-section-number">10.2.5</span> Person Profile Plots</h3>
<p>Use the data in LONG format</p>
<div id="unequally-spaced" class="section level4" number="10.2.5.1">
<h4 number="10.2.5.1"><span class="header-section-number">10.2.5.1</span> Unequally Spaced</h4>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb445-2"><a href="#cb445-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sicdegp =</span> <span class="kw">fct_recode</span>(sicdegp,</span>
<span id="cb445-3"><a href="#cb445-3"></a>                                     <span class="st">&quot;Low Communication&quot;</span> =<span class="st"> &quot;low&quot;</span>,</span>
<span id="cb445-4"><a href="#cb445-4"></a>                                     <span class="st">&quot;Medium Communication&quot;</span> =<span class="st"> &quot;med&quot;</span>,</span>
<span id="cb445-5"><a href="#cb445-5"></a>                                     <span class="st">&quot;High Communication&quot;</span> =<span class="st"> &quot;high&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb445-6"><a href="#cb445-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb445-7"><a href="#cb445-7"></a>             <span class="dt">y =</span> vsae)) <span class="op">+</span></span>
<span id="cb445-8"><a href="#cb445-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb445-9"><a href="#cb445-9"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> childid),</span>
<span id="cb445-10"><a href="#cb445-10"></a>            <span class="dt">alpha =</span> <span class="fl">.5</span>,</span>
<span id="cb445-11"><a href="#cb445-11"></a>            <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb445-12"><a href="#cb445-12"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>sicdegp)  <span class="op">+</span></span>
<span id="cb445-13"><a href="#cb445-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb445-14"><a href="#cb445-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>)) <span class="op">+</span></span>
<span id="cb445-15"><a href="#cb445-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age of Child, Years&quot;</span>,</span>
<span id="cb445-16"><a href="#cb445-16"></a>       <span class="dt">y =</span> <span class="st">&quot;Vineland Socialization Age Equivalent&quot;</span>,</span>
<span id="cb445-17"><a href="#cb445-17"></a>       <span class="dt">color =</span> <span class="st">&quot;Sequenced Inventory of Communication Development&quot;</span>) <span class="op">+</span></span>
<span id="cb445-18"><a href="#cb445-18"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Flexible&quot;</span>),</span>
<span id="cb445-19"><a href="#cb445-19"></a>              <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb445-20"><a href="#cb445-20"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,) <span class="op">+</span></span>
<span id="cb445-21"><a href="#cb445-21"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Linear&quot;</span>),</span>
<span id="cb445-22"><a href="#cb445-22"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb445-23"><a href="#cb445-23"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb445-24"><a href="#cb445-24"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Smoother Type: &quot;</span>,</span>
<span id="cb445-25"><a href="#cb445-25"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;Flexible&quot;</span> =<span class="st"> &quot;blue&quot;</span>, </span>
<span id="cb445-26"><a href="#cb445-26"></a>                                <span class="st">&quot;Linear&quot;</span>    =<span class="st"> &quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb445-27"><a href="#cb445-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb445-28"><a href="#cb445-28"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-361-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="equally-spaced" class="section level4" number="10.2.5.2">
<h4 number="10.2.5.2"><span class="header-section-number">10.2.5.2</span> Equally Spaced</h4>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-2"><a href="#cb446-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sicdegp =</span> <span class="kw">fct_recode</span>(sicdegp,</span>
<span id="cb446-3"><a href="#cb446-3"></a>                                     <span class="st">&quot;Low Communication&quot;</span> =<span class="st"> &quot;low&quot;</span>,</span>
<span id="cb446-4"><a href="#cb446-4"></a>                                     <span class="st">&quot;Medium Communication&quot;</span> =<span class="st"> &quot;med&quot;</span>,</span>
<span id="cb446-5"><a href="#cb446-5"></a>                                     <span class="st">&quot;High Communication&quot;</span> =<span class="st"> &quot;high&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-6"><a href="#cb446-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> obs,</span>
<span id="cb446-7"><a href="#cb446-7"></a>             <span class="dt">y =</span> vsae)) <span class="op">+</span></span>
<span id="cb446-8"><a href="#cb446-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb446-9"><a href="#cb446-9"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> childid),</span>
<span id="cb446-10"><a href="#cb446-10"></a>            <span class="dt">alpha =</span> <span class="fl">.5</span>,</span>
<span id="cb446-11"><a href="#cb446-11"></a>            <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb446-12"><a href="#cb446-12"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>sicdegp)  <span class="op">+</span></span>
<span id="cb446-13"><a href="#cb446-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb446-14"><a href="#cb446-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Observation Number&quot;</span>,</span>
<span id="cb446-15"><a href="#cb446-15"></a>       <span class="dt">y =</span> <span class="st">&quot;Vineland Socialization Age Equivalent&quot;</span>,</span>
<span id="cb446-16"><a href="#cb446-16"></a>       <span class="dt">color =</span> <span class="st">&quot;Sequenced Inventory of Communication Development&quot;</span>) <span class="op">+</span></span>
<span id="cb446-17"><a href="#cb446-17"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Flexible&quot;</span>),</span>
<span id="cb446-18"><a href="#cb446-18"></a>              <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb446-19"><a href="#cb446-19"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,) <span class="op">+</span></span>
<span id="cb446-20"><a href="#cb446-20"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Linear&quot;</span>),</span>
<span id="cb446-21"><a href="#cb446-21"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb446-22"><a href="#cb446-22"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb446-23"><a href="#cb446-23"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Smoother Type: &quot;</span>,</span>
<span id="cb446-24"><a href="#cb446-24"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;Flexible&quot;</span> =<span class="st"> &quot;blue&quot;</span>, </span>
<span id="cb446-25"><a href="#cb446-25"></a>                                <span class="st">&quot;Linear&quot;</span>    =<span class="st"> &quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb446-26"><a href="#cb446-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb446-27"><a href="#cb446-27"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-362-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="side-by-side-boxplots" class="section level3" number="10.2.6">
<h3 number="10.2.6"><span class="header-section-number">10.2.6</span> Side-by-side Boxplots</h3>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb447-2"><a href="#cb447-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sicdegp,</span>
<span id="cb447-3"><a href="#cb447-3"></a>             <span class="dt">y =</span> vsae,</span>
<span id="cb447-4"><a href="#cb447-4"></a>             <span class="dt">fill =</span> sicdegp)) <span class="op">+</span></span>
<span id="cb447-5"><a href="#cb447-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb447-6"><a href="#cb447-6"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb447-7"><a href="#cb447-7"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>age, </span>
<span id="cb447-8"><a href="#cb447-8"></a>             <span class="dt">labeller =</span> <span class="st">&quot;label_both&quot;</span>) <span class="op">+</span></span>
<span id="cb447-9"><a href="#cb447-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb447-10"><a href="#cb447-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Initial Language Development</span><span class="ch">\n</span><span class="st">Sequenced Inventory of Communication Development (SICD) at Age 2&quot;</span>,</span>
<span id="cb447-11"><a href="#cb447-11"></a>       <span class="dt">y =</span> <span class="st">&quot;Parent-Reported Measure of Socialization</span><span class="ch">\n</span><span class="st">Vineland Socialization Age Equivalent&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-363-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="means-plots" class="section level3" number="10.2.7">
<h3 number="10.2.7"><span class="header-section-number">10.2.7</span> Means Plots</h3>
<div id="default-stat_summary" class="section level4" number="10.2.7.1">
<h4 number="10.2.7.1"><span class="header-section-number">10.2.7.1</span> Default <code>stat_summary</code></h4>
<p>It is nice that the <code>stat_summary()</code> layer computes the standard error for the mean for you using the data in LONG format</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb448-2"><a href="#cb448-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb448-3"><a href="#cb448-3"></a>             <span class="dt">y =</span> vsae,</span>
<span id="cb448-4"><a href="#cb448-4"></a>             <span class="dt">color =</span> sicdegp)) <span class="op">+</span></span>
<span id="cb448-5"><a href="#cb448-5"></a><span class="st">  </span><span class="kw">stat_summary</span>() <span class="op">+</span><span class="st">                       </span><span class="co"># default: points at MEAN and extend vertically 1 standard error for the mean</span></span>
<span id="cb448-6"><a href="#cb448-6"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>,             <span class="co"># plot the means</span></span>
<span id="cb448-7"><a href="#cb448-7"></a>               <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span><span class="st">          </span><span class="co"># ...and connect with lines</span></span>
<span id="cb448-8"><a href="#cb448-8"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb448-9"><a href="#cb448-9"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>)) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-364-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb449-2"><a href="#cb449-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> obs,</span>
<span id="cb449-3"><a href="#cb449-3"></a>             <span class="dt">y =</span> vsae,</span>
<span id="cb449-4"><a href="#cb449-4"></a>             <span class="dt">color =</span> sicdegp)) <span class="op">+</span></span>
<span id="cb449-5"><a href="#cb449-5"></a><span class="st">  </span><span class="kw">stat_summary</span>() <span class="op">+</span><span class="st">                       </span><span class="co"># default: points at MEAN and extend vertically 1 standard error for the mean</span></span>
<span id="cb449-6"><a href="#cb449-6"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>,           <span class="co"># plot the means</span></span>
<span id="cb449-7"><a href="#cb449-7"></a>               <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span><span class="st">          </span><span class="co"># ...and connect with lines</span></span>
<span id="cb449-8"><a href="#cb449-8"></a><span class="st">  </span><span class="kw">theme_bw</span>() </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-365-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="manually-summarized" class="section level4" number="10.2.7.2">
<h4 number="10.2.7.2"><span class="header-section-number">10.2.7.2</span> Manually Summarized</h4>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1"></a>data_sum_all <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb450-2"><a href="#cb450-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age =</span> age2 <span class="op">+</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb450-3"><a href="#cb450-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb450-4"><a href="#cb450-4"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb450-5"><a href="#cb450-5"></a>      <span class="dt">y =</span> vsae_mean,</span>
<span id="cb450-6"><a href="#cb450-6"></a>      <span class="dt">color =</span> sicdegp) <span class="op">+</span></span>
<span id="cb450-7"><a href="#cb450-7"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> vsae_mean <span class="op">-</span><span class="st"> </span>vsae_sem,   <span class="co"># mean +/- one SE for the mean</span></span>
<span id="cb450-8"><a href="#cb450-8"></a>                    <span class="dt">ymax =</span> vsae_mean <span class="op">+</span><span class="st"> </span>vsae_sem),</span>
<span id="cb450-9"><a href="#cb450-9"></a>                <span class="dt">width =</span> <span class="fl">.25</span>) <span class="op">+</span></span>
<span id="cb450-10"><a href="#cb450-10"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> sicdegp),</span>
<span id="cb450-11"><a href="#cb450-11"></a>             <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb450-12"><a href="#cb450-12"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> sicdegp)) <span class="op">+</span></span>
<span id="cb450-13"><a href="#cb450-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb450-14"><a href="#cb450-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>)) <span class="op">+</span></span>
<span id="cb450-15"><a href="#cb450-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age of Child, Years&quot;</span>,</span>
<span id="cb450-16"><a href="#cb450-16"></a>       <span class="dt">y =</span> <span class="st">&quot;Vineland Socialization Age Equivalent&quot;</span>,</span>
<span id="cb450-17"><a href="#cb450-17"></a>       <span class="dt">color =</span> <span class="st">&quot;Sequenced Inventory of Communication Development:&quot;</span>,</span>
<span id="cb450-18"><a href="#cb450-18"></a>       <span class="dt">shape =</span> <span class="st">&quot;Sequenced Inventory of Communication Development:&quot;</span>,</span>
<span id="cb450-19"><a href="#cb450-19"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Sequenced Inventory of Communication Development:&quot;</span>) <span class="op">+</span></span>
<span id="cb450-20"><a href="#cb450-20"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb450-21"><a href="#cb450-21"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-366-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="model-1-full-model-with-loaded-mean-structure" class="section level2" number="10.3">
<h2 number="10.3"><span class="header-section-number">10.3</span> Model 1: Full model with ‘loaded’ mean structure</h2>
<p>Take top-down approach: Quadratic regression model, describing <code>vsae</code> as a function of <code>age2</code></p>
<blockquote>
<p>Each child has a unique parabolic trajectory over time, with coefficients that vary randomly around fixed-effects defining a mean growth curve for each SICD group. Since there is no <code>age</code> = 0 in our data, we will use the <code>age2</code> variables, which is <code>age</code> -2, so that intercept has meaning (mean at baseline age).</p>
</blockquote>
<blockquote>
<p><code>I()</code> denotes an internal calculated variable</p>
</blockquote>
<ul>
<li><p>Fixed-effects</p>
<ul>
<li><code>I(age-2)</code> age</li>
<li><code>I((age-2)^2)</code> quadratic age or age-squared,</li>
<li><code>sicdegp</code> SICD group (reference group = low)</li>
<li>SICD group x age/age-squared interactions</li>
</ul></li>
<li><p>Random-effects</p>
<ul>
<li>intercept</li>
<li>age and age-squared</li>
</ul></li>
</ul>
<div id="fit-the-model-10" class="section level3" number="10.3.1">
<h3 number="10.3.1"><span class="header-section-number">10.3.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1"></a>fit_lmer_<span class="dv">1</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(vsae <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>)<span class="op">*</span>sicdegp <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(<span class="kw">I</span>(age<span class="dv">-2</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>sicdegp <span class="op">+</span><span class="st"> </span></span>
<span id="cb451-2"><a href="#cb451-2"></a><span class="st">                                  </span>(<span class="kw">I</span>(age<span class="dv">-2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-2</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">|</span><span class="st"> </span>childid), </span>
<span id="cb451-3"><a href="#cb451-3"></a>                                <span class="dt">data =</span> data_long,</span>
<span id="cb451-4"><a href="#cb451-4"></a>                                <span class="dt">REML =</span> <span class="ot">TRUE</span>,</span>
<span id="cb451-5"><a href="#cb451-5"></a>                                <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>,    <span class="co"># get it to converge</span></span>
<span id="cb451-6"><a href="#cb451-6"></a>                                                 <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb451-7"><a href="#cb451-7"></a>                                                 <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,</span>
<span id="cb451-8"><a href="#cb451-8"></a>                                                                <span class="dt">starttests =</span> <span class="ot">FALSE</span>,</span>
<span id="cb451-9"><a href="#cb451-9"></a>                                                                <span class="dt">kkt =</span> <span class="ot">FALSE</span>)))</span></code></pre></div>
</div>
<div id="table-of-prameter-estimates" class="section level3" number="10.3.2">
<h3 number="10.3.2"><span class="header-section-number">10.3.2</span> Table of Prameter Estimates</h3>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(fit_lmer_<span class="dv">1</span>_re,</span>
<span id="cb452-2"><a href="#cb452-2"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Full Model&quot;</span>,</span>
<span id="cb452-3"><a href="#cb452-3"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb452-4"><a href="#cb452-4"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Full Model
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
8.40 (0.75)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.28 (0.74)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sicdegpmed
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.26 (0.99)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sicdegphigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.39 (1.11)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
I(age - 2)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.07 (0.08)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 2:sicdegpmed
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.43 (0.98)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 2:sicdegphigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.31 (1.08)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sicdegpmed:I(age - 2)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.00 (0.11)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sicdegphigh:I(age - 2)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.14 (0.12)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4586.50
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4656.96
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2277.25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
604
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: childid
</td>
<td style="padding-left: 5px;padding-right: 5px;">
155
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: childid (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.27
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: childid I(age - 2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
14.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: childid I((age - 2)^2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.16
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: childid (Intercept) I(age - 2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.13
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: childid (Intercept) I((age - 2)^2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.41
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: childid I(age - 2) I((age - 2)^2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.61
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
37.20
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="plot-of-the-estimated-marginal-means" class="section level3" number="10.3.3">
<h3 number="10.3.3"><span class="header-section-number">10.3.3</span> Plot of the Estimated Marginal Means</h3>
<p>Note: the <span class="math inline">\(x-axis\)</span> is the <code>age</code> variable back on its original scale</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_lmer_<span class="dv">1</span>_re, <span class="co"># model name</span></span>
<span id="cb453-2"><a href="#cb453-2"></a>                            <span class="dt">pred =</span> age,            <span class="co"># x-axis variable (must be continuous)</span></span>
<span id="cb453-3"><a href="#cb453-3"></a>                            <span class="dt">modx =</span> sicdegp,        <span class="co"># seperate lines</span></span>
<span id="cb453-4"><a href="#cb453-4"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st">     </span><span class="co"># shaded bands</span></span>
<span id="cb453-5"><a href="#cb453-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/unnamed-chunk-369-1.png" alt="Model 1: Loaded Means Structure" width="576" />
<p class="caption">
(#fig:unnamed-chunk-369)Model 1: Loaded Means Structure
</p>
</div>
</div>
</div>
<div id="model-2a-drop-random-intercepts" class="section level2" number="10.4">
<h2 number="10.4"><span class="header-section-number">10.4</span> Model 2A: Drop Random Intercepts</h2>
<p>Note: There seems to be relatively little variation in baseline measurements of VSAE across individuals in the same SICD group, so the variation at age 2 can be attributed to random error, rather than between-subject variation.</p>
<p>This indicates we may want to try removing the random intercepts, while retaining the same fixed- and other random-effects.</p>
<p>This new model implies that children have common initial VSAE value at age 2, given their SICD group.</p>
<div id="fit-the-model-11" class="section level3" number="10.4.1">
<h3 number="10.4.1"><span class="header-section-number">10.4.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1"></a>fit_lmer_2a_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(vsae <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>)<span class="op">*</span>sicdegp <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-2</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>sicdegp <span class="op">+</span><span class="st"> </span></span>
<span id="cb454-2"><a href="#cb454-2"></a><span class="st">                                   </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-2</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">|</span><span class="st"> </span>childid), </span>
<span id="cb454-3"><a href="#cb454-3"></a>                                 <span class="dt">data =</span> data_long,</span>
<span id="cb454-4"><a href="#cb454-4"></a>                                 <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
<div id="assess-the-signifcance" class="section level3" number="10.4.2">
<h3 number="10.4.2"><span class="header-section-number">10.4.2</span> Assess the Signifcance</h3>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1"></a><span class="kw">anova</span>(fit_lmer_<span class="dv">1</span>_re, fit_lmer_2a_re, <span class="dt">refit =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_lmer_2a_re: vsae ~ I(age - 2) * sicdegp + I((age - 2)^2) * sicdegp + (0 + 
fit_lmer_2a_re:     I(age - 2) + I((age - 2)^2) | childid)
fit_lmer_1_re: vsae ~ I(age - 2) * sicdegp + I(I(age - 2)^2) * sicdegp + (I(age - 
fit_lmer_1_re:     2) + I((age - 2)^2) | childid)
               npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
fit_lmer_2a_re   13 4587.0 4644.2 -2280.5   4561.0                       
fit_lmer_1_re    16 4586.5 4657.0 -2277.2   4554.5 6.4643  3    0.09108 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The more complicated model (including random intercepts) does NOT fit better, thus the random intercepts may be removed from the model. Model 2a is better than Model 1</p>
</div>
</div>
<div id="model-2b-drop-random-quadratic-slope" class="section level2" number="10.5">
<h2 number="10.5"><span class="header-section-number">10.5</span> Model 2B: Drop Random Quadratic Slope</h2>
<p>We should formally test the necessity of quadratic age random-effect.</p>
<p>Comparison of nested models with REML-based LRT using a 50:50 mixture χ2-distribution with 1 and 2 df Difference of 2 covariance parameters</p>
<div id="fit-the-model-12" class="section level3" number="10.5.1">
<h3 number="10.5.1"><span class="header-section-number">10.5.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1"></a>fit_lmer_2b_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(vsae <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>)<span class="op">*</span>sicdegp <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-2</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>sicdegp <span class="op">+</span><span class="st"> </span></span>
<span id="cb457-2"><a href="#cb457-2"></a><span class="st">                                   </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>)  <span class="op">|</span><span class="st"> </span>childid), </span>
<span id="cb457-3"><a href="#cb457-3"></a>                                 <span class="dt">REML =</span> <span class="ot">TRUE</span>, </span>
<span id="cb457-4"><a href="#cb457-4"></a>                                 <span class="dt">data =</span> data_long)</span></code></pre></div>
</div>
<div id="assess-the-signifcance-1" class="section level3" number="10.5.2">
<h3 number="10.5.2"><span class="header-section-number">10.5.2</span> Assess the Signifcance</h3>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1"></a><span class="kw">anova</span>(fit_lmer_2a_re, fit_lmer_2b_re, <span class="dt">refit =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_lmer_2b_re: vsae ~ I(age - 2) * sicdegp + I((age - 2)^2) * sicdegp + (0 + 
fit_lmer_2b_re:     I(age - 2) | childid)
fit_lmer_2a_re: vsae ~ I(age - 2) * sicdegp + I((age - 2)^2) * sicdegp + (0 + 
fit_lmer_2a_re:     I(age - 2) + I((age - 2)^2) | childid)
               npar    AIC    BIC  logLik deviance Chisq Df Pr(&gt;Chisq)    
fit_lmer_2b_re   11 4669.3 4717.7 -2323.7   4647.3                        
fit_lmer_2a_re   13 4587.0 4644.2 -2280.5   4561.0 86.34  2  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The more complicated model <em>(including random intercepts)</em> <strong>DOES</strong> fit better, thus the random slopes for both the linear AND the quadratic effect of age should be retained in the model. Model 2a is better than model 2b</p>
</div>
</div>
<div id="model-3-drop-quadratic-time-fixed-effect" class="section level2" number="10.6">
<h2 number="10.6"><span class="header-section-number">10.6</span> Model 3: Drop Quadratic Time Fixed Effect</h2>
<p>Fit the previous ‘best’ model via ML, not REML to compare nested model that differe in terms of fixed effects only</p>
<div id="fit-the-models" class="section level3" number="10.6.1">
<h3 number="10.6.1"><span class="header-section-number">10.6.1</span> Fit the Models</h3>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1"></a>fit_lmer_2a_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(vsae <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>)<span class="op">*</span>sicdegp <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-2</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>sicdegp <span class="op">+</span><span class="st"> </span></span>
<span id="cb460-2"><a href="#cb460-2"></a><span class="st">                                   </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-2</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">|</span><span class="st"> </span>childid),  </span>
<span id="cb460-3"><a href="#cb460-3"></a>                                 <span class="dt">data =</span> data_long, </span>
<span id="cb460-4"><a href="#cb460-4"></a>                                 <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb460-5"><a href="#cb460-5"></a></span>
<span id="cb460-6"><a href="#cb460-6"></a>fit_lmer_<span class="dv">3</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(vsae <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>)<span class="op">*</span>sicdegp  <span class="op">+</span><span class="st"> </span></span>
<span id="cb460-7"><a href="#cb460-7"></a><span class="st">                                  </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-2</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">|</span><span class="st"> </span>childid), </span>
<span id="cb460-8"><a href="#cb460-8"></a>                                <span class="dt">data =</span> data_long, </span>
<span id="cb460-9"><a href="#cb460-9"></a>                                <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="assess-the-signifcance-2" class="section level3" number="10.6.2">
<h3 number="10.6.2"><span class="header-section-number">10.6.2</span> Assess the Signifcance</h3>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1"></a><span class="kw">anova</span>(fit_lmer_2a_ml, fit_lmer_<span class="dv">3</span>_ml)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_lmer_3_ml: vsae ~ I(age - 2) * sicdegp + (0 + I(age - 2) + I((age - 2)^2) | 
fit_lmer_3_ml:     childid)
fit_lmer_2a_ml: vsae ~ I(age - 2) * sicdegp + I((age - 2)^2) * sicdegp + (0 + 
fit_lmer_2a_ml:     I(age - 2) + I((age - 2)^2) | childid)
               npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
fit_lmer_3_ml    10 4584.4 4628.5 -2282.2   4564.4                       
fit_lmer_2a_ml   13 4582.1 4639.3 -2278.0   4556.1 8.3704  3    0.03895 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The more complicated model <em>(including fixed interaction between quadratic time and SICD group)</em> <strong>DOES</strong> fit better, thus the higher level interaction should be retained in the model. Model 2a is better than model 3.</p>
</div>
</div>
<div id="final-model-3" class="section level2" number="10.7">
<h2 number="10.7"><span class="header-section-number">10.7</span> Final Model</h2>
<div id="table-of-parameter-esitmates" class="section level3" number="10.7.1">
<h3 number="10.7.1"><span class="header-section-number">10.7.1</span> Table of Parameter Esitmates</h3>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(fit_lmer_2a_re,</span>
<span id="cb463-2"><a href="#cb463-2"></a>                <span class="dt">caption            =</span> <span class="st">&quot;MLM: Final Model&quot;</span>,</span>
<span id="cb463-3"><a href="#cb463-3"></a>                <span class="dt">caption.above      =</span> <span class="ot">TRUE</span>,</span>
<span id="cb463-4"><a href="#cb463-4"></a>                <span class="dt">single.row         =</span> <span class="ot">TRUE</span>,</span>
<span id="cb463-5"><a href="#cb463-5"></a>                <span class="dt">digits             =</span> <span class="dv">4</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Final Model
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
8.4085 (0.7370)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.2694 (0.7399)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sicdegpmed
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.2644 (0.9741)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sicdegphigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.3646 (1.0907)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
(age - 2)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0721 (0.0790)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 2:sicdegpmed
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.4290 (0.9808)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 2:sicdegphigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.3259 (1.0760)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sicdegpmed:(age - 2)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0007 (0.1038)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sicdegphigh:(age - 2)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.1335 (0.1138)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4586.9689
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4644.2154
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2280.4845
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
604
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: childid
</td>
<td style="padding-left: 5px;padding-right: 5px;">
155
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: childid I(age - 2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
13.9915
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: childid I((age - 2)^2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.1338
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: childid I(age - 2) I((age - 2)^2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.4436
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
37.9869
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="interpretation-of-fixed-effects" class="section level3" number="10.7.2">
<h3 number="10.7.2"><span class="header-section-number">10.7.2</span> Interpretation of Fixed Effects</h3>
<div id="reference-group-low-sicd-group" class="section level4" number="10.7.2.1">
<h4 number="10.7.2.1"><span class="header-section-number">10.7.2.1</span> Reference Group: <code>low</code> SICD group</h4>
<ul>
<li><p><span class="math inline">\(\gamma_{0}\)</span> = 8.408 is the estimated marginal mean VSAE score for children in the <code>low</code> SICD, at 2 years of age</p></li>
<li><p><span class="math inline">\(\gamma_{a}\)</span> = 2.269 and <span class="math inline">\(\gamma_{a^2}\)</span> = 0.072 are the fixed effects for age and age-squared on VSAE for children in the <code>low</code> SICD group (change over time)</p></li>
</ul>
<p>Thus the equation for the estimated marginal mean VASE trajectory for the <code>low</code> SICD group is:</p>
<p><span class="math display">\[
\begin{align*}
VASE =&amp; \gamma_{0} + 
        \gamma_{a}   (AGE - 2) + 
        \gamma_{a^2} (AGE - 2)^2 \\
     =&amp; 8.408 + 
        2.269 (AGE - 2)  + 
        0.072 (AGE - 2)^2 \\ 
\end{align*}
\]</span></p>
</div>
<div id="first-comparison-group-medium-sicd-group" class="section level4" number="10.7.2.2">
<h4 number="10.7.2.2"><span class="header-section-number">10.7.2.2</span> First Comparison Group: <code>medium</code> SICD group</h4>
<ul>
<li><p><span class="math inline">\(\gamma_{med}\)</span> = 1.264 is the DIFFERENCE in the estimated marginal mean VSAE score for children in the <code>medium</code> vs. the <code>low</code> SICD, at 2 years of age</p></li>
<li><p><span class="math inline">\(\gamma_{med:\;a}\)</span> = 0.429 and <span class="math inline">\(\gamma_{med:\;a^2}\)</span> = 0.001 are the DIFFERENCE in the fixed effects for age and age-squared on VSAE for children in the <code>medium</code> vs. the <code>low</code> SICD group</p></li>
</ul>
<p>Thus the equation for the estimated marginal mean VASE trajectory for the <code>medium</code> SICD group is:</p>
<p><span class="math display">\[
\begin{align*}
VASE =&amp; (\gamma_{0}   + \gamma_{med}) + 
        (\gamma_{a}   + \gamma_{med:\;a})  (AGE - 2) + 
        (\gamma_{a^2} + \gamma_{med:\;a^2})(AGE - 2)^2 \\
     =&amp; (8.408 + 
         1.264) + 
        (2.269 + 
         0.429)  (AGE - 2) + 
        (0.072 + 
         0.001)(AGE - 2)^2 \\
     =&amp; 9.673 + 
        2.698  (AGE - 2) + 
        0.073 (AGE - 2)^2 \\
\end{align*}
\]</span></p>
</div>
<div id="second-comparison-group-high-sicd-group" class="section level4" number="10.7.2.3">
<h4 number="10.7.2.3"><span class="header-section-number">10.7.2.3</span> Second Comparison Group: <code>high</code> SICD group</h4>
<ul>
<li><p><span class="math inline">\(\gamma_{hi}\)</span> = 5.365 is the DIFFERENCE in the estimated marginal mean VSAE score for children in the <code>high</code> vs. the <code>low</code> SICD, at 2 years of age</p></li>
<li><p><span class="math inline">\(\gamma_{hi:\;a}\)</span> = 3.326 and <span class="math inline">\(\gamma_{hi:\;a^2}\)</span> = 0.133 are the DIFFERENCE in the fixed effects for age and age-squared on VSAE for children in the <code>high</code> vs. the <code>low</code> SICD group</p></li>
</ul>
<p>Thus the equation for the estimated marginal mean VASE trajectory for the <code>high</code> SICD group is:</p>
<p><span class="math display">\[
\begin{align*}
VASE =&amp; (\gamma_{0}   + \gamma_{hi}) + 
        (\gamma_{a}   + \gamma_{hi:\;a})  (AGE - 2) + 
        (\gamma_{a^2} + \gamma_{hi:\;a^2})(AGE - 2)^2 \\
     =&amp; (8.408 + 
         5.365) + 
        (2.269 + 
         3.326)  (AGE - 2) + 
        (0.072 + 
         0.133)(AGE - 2)^2 \\
     =&amp; 13.773 + 
        5.595  (AGE - 2) + 
        0.206 (AGE - 2)^2 \\
\end{align*}
\]</span></p>
</div>
</div>
<div id="interpretation-of-random-effects" class="section level3" number="10.7.3">
<h3 number="10.7.3"><span class="header-section-number">10.7.3</span> Interpretation of Random Effects</h3>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_lmer_2a_re)<span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-2"><a href="#cb464-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),</span>
<span id="cb464-3"><a href="#cb464-3"></a>        <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code> Groups   Name           Variance Std.Dev. Corr 
 childid  I(age - 2)     13.991   3.741         
          I((age - 2)^2)  0.134   0.366    -0.32
 Residual                37.987   6.163         </code></pre>
<p><strong>Here a group of observations = a CHILD</strong></p>
<div id="residual-varaince" class="section level4" number="10.7.3.1">
<h4 number="10.7.3.1"><span class="header-section-number">10.7.3.1</span> Residual Varaince</h4>
<p><strong>Within-child-variance</strong></p>
<ul>
<li><span class="math inline">\(e_{ti}\)</span> the residuals associated with observation at time <span class="math inline">\(t\)</span> on child <span class="math inline">\(i\)</span></li>
</ul>
<p><span class="math display">\[
\sigma^2 = \sigma^2_e 
         = VAR[e_{ti}] 
         = 37.987
\]</span></p>
</div>
<div id="variance-components" class="section level4" number="10.7.3.2">
<h4 number="10.7.3.2"><span class="header-section-number">10.7.3.2</span> 2 Variance Components</h4>
<p><strong>Between-children slope variances</strong></p>
<p>Random LINEAR effect of age variance</p>
<ul>
<li><span class="math inline">\(u_{1i}\)</span> the DIFFERENCE between child <span class="math inline">\(i\)</span>’s specific linear component for age and the fixed linear component for age, given their SICD group</li>
</ul>
<p><span class="math display">\[
\tau_{11} = \sigma^2_{u1} 
          = VAR[u_{1i}] 
          = 13.99
\]</span></p>
<p>Random QUADRATIC effect of age variance</p>
<ul>
<li><span class="math inline">\(u_{2i}\)</span> the DIFFERENCE between child <span class="math inline">\(i\)</span>’s specific quadratic component for age and the fixed quadratic component for age, given their SICD group</li>
</ul>
<p><span class="math display">\[
\tau_{22} = \sigma^2_{u2} 
          = VAR[u_{2i}] 
          = 0.13
\]</span></p>
</div>
<div id="covariance-or-correlation-components" class="section level4" number="10.7.3.3">
<h4 number="10.7.3.3"><span class="header-section-number">10.7.3.3</span> 1 Covariance (or correlation) Components</h4>
<p><strong>Slope-slope covariance</strong></p>
<p>Random LINEAR and Quadratic effect of age covariance:</p>
<p><span class="math display">\[
\tau_{12} = \sigma^2_{u12} 
          = COV[u_{1i}, u_{2i}] 
          = -0.44
\]</span>
<span class="math display">\[
Correlation(u_{1i}, u_{2i}) = -0.324
\]</span></p>
</div>
</div>
<div id="assumption-checking" class="section level3" number="10.7.4">
<h3 number="10.7.4"><span class="header-section-number">10.7.4</span> Assumption Checking</h3>
<p>The residuals are:</p>
<ul>
<li><p>Assumed to be normally, independently, and identically distributed (conditional on other random-effects)</p></li>
<li><p>Assumed independent of random-effects</p></li>
</ul>
<p><span class="math display">\[
e_{ti}  \sim  N(0, \sigma^2)
\]</span></p>
<div id="the-ggresidpanel-package" class="section level4" number="10.7.4.1">
<h4 number="10.7.4.1"><span class="header-section-number">10.7.4.1</span> The <code>ggResidpanel</code> package</h4>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1"></a>ggResidpanel<span class="op">::</span><span class="kw">resid_panel</span>(fit_lmer_2a_re)  <span class="co"># default = pearson residuals</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-387-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="manually-with-hlmdiag-and-ggplot2" class="section level4" number="10.7.4.2">
<h4 number="10.7.4.2"><span class="header-section-number">10.7.4.2</span> Manually with <code>HLMdiag</code> and <code>ggplot2</code></h4>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb467-2"><a href="#cb467-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">resid =</span> HLMdiag<span class="op">::</span><span class="kw">HLMresid</span>(fit_lmer_2a_re, </span>
<span id="cb467-3"><a href="#cb467-3"></a>                  <span class="dt">level =</span> <span class="dv">1</span>,</span>
<span id="cb467-4"><a href="#cb467-4"></a>                  <span class="dt">standardized =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb467-5"><a href="#cb467-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> resid)) <span class="op">+</span></span>
<span id="cb467-6"><a href="#cb467-6"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">40</span>,</span>
<span id="cb467-7"><a href="#cb467-7"></a>                 <span class="dt">color =</span> <span class="st">&quot;gray20&quot;</span>,</span>
<span id="cb467-8"><a href="#cb467-8"></a>                 <span class="dt">alpha =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb467-9"><a href="#cb467-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb467-10"><a href="#cb467-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">main =</span> <span class="st">&quot;Histogram&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-388-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1"></a>fit_lmer_2a_re <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb468-2"><a href="#cb468-2"></a><span class="st">  </span><span class="kw">ranef</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb468-3"><a href="#cb468-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb468-4"><a href="#cb468-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> condval)) <span class="op">+</span></span>
<span id="cb468-5"><a href="#cb468-5"></a><span class="st">  </span><span class="kw">geom_qq</span>() <span class="op">+</span></span>
<span id="cb468-6"><a href="#cb468-6"></a><span class="st">  </span><span class="kw">geom_qq_line</span>() <span class="op">+</span></span>
<span id="cb468-7"><a href="#cb468-7"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>term, <span class="dt">scale =</span> <span class="st">&quot;free_y&quot;</span>)<span class="op">+</span></span>
<span id="cb468-8"><a href="#cb468-8"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb468-9"><a href="#cb468-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">main =</span> <span class="st">&quot;Random Slopes&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-389-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb469-2"><a href="#cb469-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(fit_lmer_2a_re)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb469-3"><a href="#cb469-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">resid =</span> HLMdiag<span class="op">::</span><span class="kw">HLMresid</span>(fit_lmer_2a_re, </span>
<span id="cb469-4"><a href="#cb469-4"></a>                  <span class="dt">level =</span> <span class="dv">1</span>,</span>
<span id="cb469-5"><a href="#cb469-5"></a>                  <span class="dt">standardized =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb469-6"><a href="#cb469-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> fit,</span>
<span id="cb469-7"><a href="#cb469-7"></a>             <span class="dt">y =</span> resid)) <span class="op">+</span></span>
<span id="cb469-8"><a href="#cb469-8"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb469-9"><a href="#cb469-9"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb469-10"><a href="#cb469-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span></span>
<span id="cb469-11"><a href="#cb469-11"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb469-12"><a href="#cb469-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">main =</span> <span class="st">&quot;Residual Plot&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-390-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb470-2"><a href="#cb470-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">resid =</span> HLMdiag<span class="op">::</span><span class="kw">HLMresid</span>(fit_lmer_2a_re, </span>
<span id="cb470-3"><a href="#cb470-3"></a>                  <span class="dt">level =</span> <span class="dv">1</span>,</span>
<span id="cb470-4"><a href="#cb470-4"></a>                  <span class="dt">standardized =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb470-5"><a href="#cb470-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> resid)) <span class="op">+</span></span>
<span id="cb470-6"><a href="#cb470-6"></a><span class="st">  </span><span class="kw">geom_qq</span>()<span class="op">+</span></span>
<span id="cb470-7"><a href="#cb470-7"></a><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></span>
<span id="cb470-8"><a href="#cb470-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-391-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="the-sjplot-package" class="section level4" number="10.7.4.3">
<h4 number="10.7.4.3"><span class="header-section-number">10.7.4.3</span> The <code>sjPlot</code> package</h4>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_lmer_2a_re, </span>
<span id="cb471-2"><a href="#cb471-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;diag&quot;</span>)</span></code></pre></div>
<pre><code>[[1]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-392-1.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>
[[2]]
[[2]]$childid</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-392-2.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>

[[3]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-392-3.png" width="576" style="display: block; margin: auto;" /></p>
<pre><code>
[[4]]</code></pre>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-392-4.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="plot-of-the-estimated-marginal-means-1" class="section level3" number="10.7.5">
<h3 number="10.7.5"><span class="header-section-number">10.7.5</span> Plot of the Estimated Marginal Means</h3>
<div id="quick-and-default" class="section level4" number="10.7.5.1">
<h4 number="10.7.5.1"><span class="header-section-number">10.7.5.1</span> Quick and Default</h4>
<p>Note: the <span class="math inline">\(x-axis\)</span> is the <code>age</code> variable, back on its original scale</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_lmer_2a_re, <span class="co"># model name</span></span>
<span id="cb476-2"><a href="#cb476-2"></a>                            <span class="dt">pred =</span> age,            <span class="co"># x-axis variable (must be continuous)</span></span>
<span id="cb476-3"><a href="#cb476-3"></a>                            <span class="dt">modx =</span> sicdegp,        <span class="co"># seperate lines</span></span>
<span id="cb476-4"><a href="#cb476-4"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st">     </span><span class="co"># shaded bands</span></span>
<span id="cb476-5"><a href="#cb476-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/unnamed-chunk-393-1.png" alt="Final Model (2a)" width="576" />
<p class="caption">
(#fig:unnamed-chunk-393)Final Model (2a)
</p>
</div>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_lmer_2a_re, <span class="co"># model name</span></span>
<span id="cb477-2"><a href="#cb477-2"></a>                            <span class="dt">pred =</span> age,             <span class="co"># x-axis variable (must be continuous)</span></span>
<span id="cb477-3"><a href="#cb477-3"></a>                            <span class="dt">modx =</span> sicdegp,         <span class="co"># separate lines</span></span>
<span id="cb477-4"><a href="#cb477-4"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>,</span>
<span id="cb477-5"><a href="#cb477-5"></a>                            <span class="dt">x.label =</span> <span class="st">&quot;Age of Child, in years&quot;</span>,</span>
<span id="cb477-6"><a href="#cb477-6"></a>                            <span class="dt">y.label =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Vineland Socialization Age Equivalent&quot;</span>,</span>
<span id="cb477-7"><a href="#cb477-7"></a>                            <span class="dt">legend.main =</span> <span class="st">&quot;Initial Communication (SICD)&quot;</span>,</span>
<span id="cb477-8"><a href="#cb477-8"></a>                            <span class="dt">modx.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;High&quot;</span>),</span>
<span id="cb477-9"><a href="#cb477-9"></a>                            <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb477-10"><a href="#cb477-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>)) <span class="op">+</span></span>
<span id="cb477-11"><a href="#cb477-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">120</span>, <span class="dt">by =</span> <span class="dv">20</span>)) <span class="op">+</span></span>
<span id="cb477-12"><a href="#cb477-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb477-13"><a href="#cb477-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb477-14"><a href="#cb477-14"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb477-15"><a href="#cb477-15"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb477-16"><a href="#cb477-16"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-394-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="more-customized---color" class="section level4" number="10.7.5.2">
<h4 number="10.7.5.2"><span class="header-section-number">10.7.5.2</span> More Customized - Color</h4>
<p>This version would look better on a poster or in a slide presentation.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>,<span class="st">&quot;sicdegp&quot;</span>),  <span class="co"># variables involved in interactions</span></span>
<span id="cb478-2"><a href="#cb478-2"></a>                <span class="dt">mod =</span> fit_lmer_2a_re,</span>
<span id="cb478-3"><a href="#cb478-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age2 =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">13</span>, <span class="dt">by =</span> <span class="fl">.1</span>))) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># add more values to smooth out the prediction lines and ribbons</span></span>
<span id="cb478-4"><a href="#cb478-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb478-5"><a href="#cb478-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sicdegp =</span> <span class="kw">factor</span>(sicdegp,</span>
<span id="cb478-6"><a href="#cb478-6"></a>                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;med&quot;</span>, <span class="st">&quot;low&quot;</span>),</span>
<span id="cb478-7"><a href="#cb478-7"></a>                                 <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb478-8"><a href="#cb478-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb478-9"><a href="#cb478-9"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb478-10"><a href="#cb478-10"></a>             <span class="dt">group =</span> sicdegp)) <span class="op">+</span></span>
<span id="cb478-11"><a href="#cb478-11"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,        <span class="co"># 95% Confidence Intervals</span></span>
<span id="cb478-12"><a href="#cb478-12"></a>                  <span class="dt">ymax =</span> upper,</span>
<span id="cb478-13"><a href="#cb478-13"></a>                  <span class="dt">fill =</span> sicdegp),</span>
<span id="cb478-14"><a href="#cb478-14"></a>              <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb478-15"><a href="#cb478-15"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> sicdegp,</span>
<span id="cb478-16"><a href="#cb478-16"></a>                <span class="dt">color =</span> sicdegp),</span>
<span id="cb478-17"><a href="#cb478-17"></a>            <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb478-18"><a href="#cb478-18"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>)) <span class="op">+</span><span class="st">                  </span><span class="co"># mark values that were actually measured</span></span>
<span id="cb478-19"><a href="#cb478-19"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">120</span>, <span class="dt">by =</span> <span class="dv">20</span>)) <span class="op">+</span></span>
<span id="cb478-20"><a href="#cb478-20"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>)) <span class="op">+</span></span>
<span id="cb478-21"><a href="#cb478-21"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb478-22"><a href="#cb478-22"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb478-23"><a href="#cb478-23"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb478-24"><a href="#cb478-24"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb478-25"><a href="#cb478-25"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">2.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb478-26"><a href="#cb478-26"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age of Child, in years&quot;</span>,</span>
<span id="cb478-27"><a href="#cb478-27"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Vineland Socialization Age Equivalent&quot;</span>,</span>
<span id="cb478-28"><a href="#cb478-28"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Initial Communication (SICD)&quot;</span>,</span>
<span id="cb478-29"><a href="#cb478-29"></a>       <span class="dt">fill     =</span> <span class="st">&quot;Initial Communication (SICD)&quot;</span>,</span>
<span id="cb478-30"><a href="#cb478-30"></a>       <span class="dt">color    =</span> <span class="st">&quot;Initial Communication (SICD)&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-395-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="more-customized---black-and-white" class="section level4" number="10.7.5.3">
<h4 number="10.7.5.3"><span class="header-section-number">10.7.5.3</span> More Customized - Black and White</h4>
<p>This version would be better for a publication.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>,<span class="st">&quot;sicdegp&quot;</span>),</span>
<span id="cb479-2"><a href="#cb479-2"></a>                <span class="dt">mod =</span> fit_lmer_2a_re,</span>
<span id="cb479-3"><a href="#cb479-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age2 =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">13</span>, <span class="dt">by =</span> <span class="fl">.1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb479-4"><a href="#cb479-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb479-5"><a href="#cb479-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sicdegp =</span> <span class="kw">factor</span>(sicdegp,</span>
<span id="cb479-6"><a href="#cb479-6"></a>                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;med&quot;</span>, <span class="st">&quot;low&quot;</span>),</span>
<span id="cb479-7"><a href="#cb479-7"></a>                                 <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb479-8"><a href="#cb479-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb479-9"><a href="#cb479-9"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb479-10"><a href="#cb479-10"></a>             <span class="dt">group =</span> sicdegp)) <span class="op">+</span></span>
<span id="cb479-11"><a href="#cb479-11"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,</span>
<span id="cb479-12"><a href="#cb479-12"></a>                  <span class="dt">ymax =</span> upper,</span>
<span id="cb479-13"><a href="#cb479-13"></a>                  <span class="dt">fill =</span> sicdegp),</span>
<span id="cb479-14"><a href="#cb479-14"></a>              <span class="dt">alpha =</span> <span class="fl">.4</span>) <span class="op">+</span></span>
<span id="cb479-15"><a href="#cb479-15"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> sicdegp),</span>
<span id="cb479-16"><a href="#cb479-16"></a>            <span class="dt">size =</span> <span class="fl">.7</span>) <span class="op">+</span></span>
<span id="cb479-17"><a href="#cb479-17"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>)) <span class="op">+</span></span>
<span id="cb479-18"><a href="#cb479-18"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">120</span>, <span class="dt">by =</span> <span class="dv">20</span>)) <span class="op">+</span></span>
<span id="cb479-19"><a href="#cb479-19"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>)) <span class="op">+</span></span>
<span id="cb479-20"><a href="#cb479-20"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray10&quot;</span>, <span class="st">&quot;gray40&quot;</span>, <span class="st">&quot;gray60&quot;</span>)) <span class="op">+</span></span>
<span id="cb479-21"><a href="#cb479-21"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb479-22"><a href="#cb479-22"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb479-23"><a href="#cb479-23"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb479-24"><a href="#cb479-24"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb479-25"><a href="#cb479-25"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb479-26"><a href="#cb479-26"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age of Child, in years&quot;</span>,</span>
<span id="cb479-27"><a href="#cb479-27"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Vineland Socialization Age Equivalent&quot;</span>,</span>
<span id="cb479-28"><a href="#cb479-28"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Initial Communication (SICD)&quot;</span>,</span>
<span id="cb479-29"><a href="#cb479-29"></a>       <span class="dt">fill     =</span> <span class="st">&quot;Initial Communication (SICD)&quot;</span>,</span>
<span id="cb479-30"><a href="#cb479-30"></a>       <span class="dt">color    =</span> <span class="st">&quot;Initial Communication (SICD)&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-396-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="blups-vs.-fixed-effects" class="section level3" number="10.7.6">
<h3 number="10.7.6"><span class="header-section-number">10.7.6</span> Blups vs. Fixed Effects</h3>
<p><strong>BLUP</strong> = Best Linear Unbiased Predictor</p>
<p>A BLUP is the specific prediction for an individual supject, showin by black lines below. This includes the fixed effects as well as the specific random effects for a given individual.</p>
<p>Comparatively, the blue lines below display the predictions for fixed effects only.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb480-2"><a href="#cb480-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sicdegp =</span> <span class="kw">fct_recode</span>(sicdegp,</span>
<span id="cb480-3"><a href="#cb480-3"></a>                                     <span class="st">&quot;Low Communication&quot;</span> =<span class="st"> &quot;low&quot;</span>,</span>
<span id="cb480-4"><a href="#cb480-4"></a>                                     <span class="st">&quot;Medium Communication&quot;</span> =<span class="st"> &quot;med&quot;</span>,</span>
<span id="cb480-5"><a href="#cb480-5"></a>                                     <span class="st">&quot;High Communication&quot;</span> =<span class="st"> &quot;high&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb480-6"><a href="#cb480-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_fixed =</span> <span class="kw">predict</span>(fit_lmer_2a_re, <span class="dt">re.form =</span> <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># fixed effects only</span></span>
<span id="cb480-7"><a href="#cb480-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_wrand =</span> <span class="kw">predict</span>(fit_lmer_2a_re)) <span class="op">%&gt;%</span><span class="st">               </span><span class="co"># fixed and random effects together</span></span>
<span id="cb480-8"><a href="#cb480-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb480-9"><a href="#cb480-9"></a>             <span class="dt">y =</span> vsae)) <span class="op">+</span></span>
<span id="cb480-10"><a href="#cb480-10"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred_wrand,           <span class="co"># BLUP = fixed and random effects together</span></span>
<span id="cb480-11"><a href="#cb480-11"></a>                <span class="dt">group =</span> childid,</span>
<span id="cb480-12"><a href="#cb480-12"></a>                <span class="dt">color =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb480-13"><a href="#cb480-13"></a>                <span class="dt">size  =</span> <span class="st">&quot;BLUP&quot;</span>)) <span class="op">+</span></span>
<span id="cb480-14"><a href="#cb480-14"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred_fixed,           <span class="co"># fixed effects only</span></span>
<span id="cb480-15"><a href="#cb480-15"></a>                <span class="dt">group =</span> sicdegp,</span>
<span id="cb480-16"><a href="#cb480-16"></a>                <span class="dt">color =</span> <span class="st">&quot;Fixed&quot;</span>,</span>
<span id="cb480-17"><a href="#cb480-17"></a>                <span class="dt">size  =</span> <span class="st">&quot;Fixed&quot;</span>)) <span class="op">+</span></span>
<span id="cb480-18"><a href="#cb480-18"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Model: &quot;</span>,</span>
<span id="cb480-19"><a href="#cb480-19"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>  =<span class="st"> &quot;black&quot;</span>,</span>
<span id="cb480-20"><a href="#cb480-20"></a>                                <span class="st">&quot;Fixed&quot;</span> =<span class="st"> &quot;blue&quot;</span>)) <span class="op">+</span></span>
<span id="cb480-21"><a href="#cb480-21"></a><span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Model: &quot;</span>,</span>
<span id="cb480-22"><a href="#cb480-22"></a>                    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>  =<span class="st"> </span><span class="fl">.5</span>,</span>
<span id="cb480-23"><a href="#cb480-23"></a>                               <span class="st">&quot;Fixed&quot;</span> =<span class="st"> </span><span class="fl">1.5</span>)) <span class="op">+</span></span>
<span id="cb480-24"><a href="#cb480-24"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>sicdegp) <span class="op">+</span></span>
<span id="cb480-25"><a href="#cb480-25"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb480-26"><a href="#cb480-26"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>)) <span class="op">+</span></span>
<span id="cb480-27"><a href="#cb480-27"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age, in years&quot;</span>,</span>
<span id="cb480-28"><a href="#cb480-28"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Vineland Socialization Age Equivalent&quot;</span>) <span class="op">+</span></span>
<span id="cb480-29"><a href="#cb480-29"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb480-30"><a href="#cb480-30"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-397-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb481-2"><a href="#cb481-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_fixed =</span> <span class="kw">predict</span>(fit_lmer_2a_re, <span class="dt">re.form =</span> <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb481-3"><a href="#cb481-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_wrand =</span> <span class="kw">predict</span>(fit_lmer_2a_re)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb481-4"><a href="#cb481-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(childid <span class="op">%in%</span><span class="st"> </span><span class="kw">sample</span>(<span class="kw">levels</span>(data_long<span class="op">$</span>childid), <span class="dv">25</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># 25 randomly sampled children</span></span>
<span id="cb481-5"><a href="#cb481-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb481-6"><a href="#cb481-6"></a>             <span class="dt">y =</span> vsae)) <span class="op">+</span></span>
<span id="cb481-7"><a href="#cb481-7"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> sicdegp),</span>
<span id="cb481-8"><a href="#cb481-8"></a>             <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb481-9"><a href="#cb481-9"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred_wrand,</span>
<span id="cb481-10"><a href="#cb481-10"></a>                <span class="dt">linetype =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb481-11"><a href="#cb481-11"></a>                <span class="dt">size     =</span> <span class="st">&quot;BLUP&quot;</span>),</span>
<span id="cb481-12"><a href="#cb481-12"></a>            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb481-13"><a href="#cb481-13"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred_fixed,</span>
<span id="cb481-14"><a href="#cb481-14"></a>                <span class="dt">color =</span> sicdegp,</span>
<span id="cb481-15"><a href="#cb481-15"></a>                <span class="dt">linetype =</span> <span class="st">&quot;Fixed&quot;</span>,</span>
<span id="cb481-16"><a href="#cb481-16"></a>                <span class="dt">size     =</span> <span class="st">&quot;Fixed&quot;</span>)) <span class="op">+</span></span>
<span id="cb481-17"><a href="#cb481-17"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Model: &quot;</span>,</span>
<span id="cb481-18"><a href="#cb481-18"></a>                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>  =<span class="st"> &quot;longdash&quot;</span>,</span>
<span id="cb481-19"><a href="#cb481-19"></a>                                   <span class="st">&quot;Fixed&quot;</span> =<span class="st"> &quot;solid&quot;</span>)) <span class="op">+</span></span>
<span id="cb481-20"><a href="#cb481-20"></a><span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Model: &quot;</span>,</span>
<span id="cb481-21"><a href="#cb481-21"></a>                    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>  =<span class="st"> </span><span class="fl">.5</span>,</span>
<span id="cb481-22"><a href="#cb481-22"></a>                               <span class="st">&quot;Fixed&quot;</span> =<span class="st"> </span><span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb481-23"><a href="#cb481-23"></a><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>childid, <span class="dt">labeller =</span> <span class="st">&quot;label_both&quot;</span>) <span class="op">+</span></span>
<span id="cb481-24"><a href="#cb481-24"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb481-25"><a href="#cb481-25"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>)) <span class="op">+</span></span>
<span id="cb481-26"><a href="#cb481-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb481-27"><a href="#cb481-27"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb481-28"><a href="#cb481-28"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age, in years&quot;</span>,</span>
<span id="cb481-29"><a href="#cb481-29"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Vineland Socialization Age Equivalent&quot;</span>,</span>
<span id="cb481-30"><a href="#cb481-30"></a>       <span class="dt">color =</span> <span class="st">&quot;Communication:&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-398-1.png" width="768" style="display: block; margin: auto;" /></p>
<!--chapter:end:11-example_autism.Rmd-->
</div>
</div>
</div>
<div id="mlm-longitudinal-hedeker-gibbons---depression" class="section level1" number="11">
<h1 number="11"><span class="header-section-number">11</span> MLM, Longitudinal: Hedeker &amp; Gibbons - Depression</h1>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb482-2"><a href="#cb482-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb482-3"><a href="#cb482-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb482-4"><a href="#cb482-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb482-5"><a href="#cb482-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb482-6"><a href="#cb482-6"></a><span class="kw">library</span>(sjstats)      <span class="co"># ICC calculationsv</span></span>
<span id="cb482-7"><a href="#cb482-7"></a><span class="kw">library</span>(effects)      <span class="co"># Estimated Marginal Means</span></span>
<span id="cb482-8"><a href="#cb482-8"></a><span class="kw">library</span>(VIM)          <span class="co"># Visualization and Imputation of Missing Values </span></span>
<span id="cb482-9"><a href="#cb482-9"></a><span class="kw">library</span>(naniar)       <span class="co"># Summaries and Visualisations for Missing Data</span></span>
<span id="cb482-10"><a href="#cb482-10"></a><span class="kw">library</span>(corrplot)     <span class="co"># Vizualize correlation matrix</span></span>
<span id="cb482-11"><a href="#cb482-11"></a></span>
<span id="cb482-12"><a href="#cb482-12"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb482-13"><a href="#cb482-13"></a><span class="kw">library</span>(optimx)</span>
<span id="cb482-14"><a href="#cb482-14"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span></code></pre></div>
<div id="background-5" class="section level2" number="11.1">
<h2 number="11.1"><span class="header-section-number">11.1</span> Background</h2>
<p>Starting in chapter 4, <span class="citation">(Hedeker and Gibbons <a href="#ref-hedeker2006" role="doc-biblioref">2006</a>)</span> details analysis of a psychiatric study described by <span class="citation">(Reisby et al. <a href="#ref-reisby1977" role="doc-biblioref">1977</a>)</span>. This study focuses on the relationship between Imipramine (IMI) and Desipramine (DMI) plasma levels and clinical response in 66 depressed inpatients (37 endogenous and 29 non-endogenous).</p>
<blockquote>
<p>Note: The IMI and DMI measures were only taken in the later weeks, but are not used here.</p>
</blockquote>
<p>Dependent or outcome variable:</p>
<ul>
<li><code>hamd</code> Hamilton Depression Scores (HD)</li>
</ul>
<p>Independent or predictor variables:</p>
<ul>
<li><p><code>endog</code> Pre-study Depression Diagnosis</p>
<ul>
<li>endogenous<br />
</li>
<li>non-endogenous/reactive</li>
</ul></li>
<li><p>IMI (imipramine) drug-plasma levels (µg/l)</p>
<ul>
<li>antidepressant given 225 mg/day, weeks 3-6</li>
</ul></li>
<li><p>DMI (desipramine) drug-plasma levels (µg/l)</p>
<ul>
<li>metabolite of imipramine</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1"></a>data_raw &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_spss</span>(<span class="st">&quot;http://www.uic.edu/~hedeker/riesby.sav&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># read from the webpage </span></span>
<span id="cb483-2"><a href="#cb483-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>intrcpt, <span class="op">-</span>endweek)                                         <span class="co"># de-select or delete some variables </span></span></code></pre></div>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1"></a>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb484-2"><a href="#cb484-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>(<span class="dt">top =</span> <span class="dv">11</span>, <span class="dt">bottom =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>    id hamd week endog
1  101   26    0     0
2  101   22    1     0
3  101   18    2     0
4  101    7    3     0
5  101    4    4     0
6  101    3    5     0
7  103   33    0     0
8  103   24    1     0
9  103   15    2     0
10 103   24    3     0
11 103   15    4     0
12 ...  ...  ...   ...
13 360   28    4     1
14 360   33    5     1
15 361   30    0     1
16 361   22    1     1
17 361   11    2     1
18 361    8    3     1
19 361    7    4     1
20 361   19    5     1</code></pre>
<div id="long-format-1" class="section level3" number="11.1.1">
<h3 number="11.1.1"><span class="header-section-number">11.1.1</span> Long Format</h3>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1"></a>data_long &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st">                                        </span><span class="co"># save the dataset as a new name</span></span>
<span id="cb486-2"><a href="#cb486-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(hamd)) <span class="op">%&gt;%</span><span class="st">                                </span><span class="co"># remove NA or missing scores</span></span>
<span id="cb486-3"><a href="#cb486-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">factor</span>(id)) <span class="op">%&gt;%</span><span class="st">                             </span><span class="co"># declare grouping var a factor</span></span>
<span id="cb486-4"><a href="#cb486-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">endog =</span> endog <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb486-5"><a href="#cb486-5"></a><span class="st">                  </span><span class="kw">factor</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb486-6"><a href="#cb486-6"></a><span class="st">                  </span>forcats<span class="op">::</span><span class="kw">fct_recode</span>(<span class="st">&quot;Reactive&quot;</span> =<span class="st"> &quot;0&quot;</span>,</span>
<span id="cb486-7"><a href="#cb486-7"></a>                                      <span class="st">&quot;Endogenous&quot;</span> =<span class="st"> &quot;1&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb486-8"><a href="#cb486-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, endog, week, hamd) <span class="op">%&gt;%</span><span class="st">                       </span><span class="co"># select the order of variables to include</span></span>
<span id="cb486-9"><a href="#cb486-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(id, week)                                       <span class="co"># sort observations </span></span></code></pre></div>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb487-2"><a href="#cb487-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>(<span class="dt">top =</span> <span class="dv">11</span>, <span class="dt">bottom =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>     id      endog week hamd
1   101   Reactive    0   26
2   101   Reactive    1   22
3   101   Reactive    2   18
4   101   Reactive    3    7
5   101   Reactive    4    4
6   101   Reactive    5    3
7   103   Reactive    0   33
8   103   Reactive    1   24
9   103   Reactive    2   15
10  103   Reactive    3   24
11  103   Reactive    4   15
12 &lt;NA&gt;       &lt;NA&gt;  ...  ...
13  609 Endogenous    2   22
14  609 Endogenous    3   14
15  609 Endogenous    4   15
16  609 Endogenous    5    2
17  610 Endogenous    0   34
18  610 Endogenous    2   33
19  610 Endogenous    3   23
20  610 Endogenous    5   11</code></pre>
</div>
<div id="wide-format-1" class="section level3" number="11.1.2">
<h3 number="11.1.2"><span class="header-section-number">11.1.2</span> Wide Format</h3>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1"></a>data_wide &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st">     </span><span class="co"># save the dataset as a new name</span></span>
<span id="cb489-2"><a href="#cb489-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> week,</span>
<span id="cb489-3"><a href="#cb489-3"></a>                     <span class="dt">names_prefix =</span> <span class="st">&quot;hamd_&quot;</span>,</span>
<span id="cb489-4"><a href="#cb489-4"></a>                     <span class="dt">values_from =</span> hamd)</span></code></pre></div>
<p>Notice the missing values, displayed as <code>NA</code>.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb490-2"><a href="#cb490-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>()</span></code></pre></div>
<pre><code>    id      endog hamd_0 hamd_1 hamd_2 hamd_3 hamd_4 hamd_5
1  101   Reactive     26     22     18      7      4      3
2  103   Reactive     33     24     15     24     15     13
3  104 Endogenous     29     22     18     13     19      0
4  105   Reactive     22     12     16     16     13      9
5 &lt;NA&gt;       &lt;NA&gt;    ...    ...    ...    ...    ...    ...
6  607 Endogenous     30     39     30     27     20      4
7  608   Reactive     24     19     14     12      3      4
8  609 Endogenous   &lt;NA&gt;     25     22     14     15      2
9  610 Endogenous     34   &lt;NA&gt;     33     23   &lt;NA&gt;     11</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-4" class="section level2" number="11.2">
<h2 number="11.2"><span class="header-section-number">11.2</span> Exploratory Data Analysis</h2>
<div id="diagnosis-group" class="section level3" number="11.2.1">
<h3 number="11.2.1"><span class="header-section-number">11.2.1</span> Diagnosis Group</h3>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb492-2"><a href="#cb492-2"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Depression Type&quot;</span> =<span class="st"> </span>endog,</span>
<span id="cb492-3"><a href="#cb492-3"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>Mean/Count (SD/%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 66</td>
</tr>
<tr class="even">
<td>Depression Type</td>
<td></td>
</tr>
<tr class="odd">
<td>Reactive</td>
<td>29 (43.9%)</td>
</tr>
<tr class="even">
<td>Endogenous</td>
<td>37 (56.1%)</td>
</tr>
</tbody>
</table>
</div>
<div id="missing-data-attrition-1" class="section level3" number="11.2.2">
<h3 number="11.2.2"><span class="header-section-number">11.2.2</span> Missing Data &amp; Attrition</h3>
<div id="sample-size" class="section level4" number="11.2.2.1">
<h4 number="11.2.2.1"><span class="header-section-number">11.2.2.1</span> Sample Size</h4>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb493-2"><a href="#cb493-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(week) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb493-3"><a href="#cb493-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 2
   week     n
  &lt;dbl&gt; &lt;int&gt;
1     0    61
2     1    63
3     2    65
4     3    65
5     4    63
6     5    58</code></pre>
<p>Plot the amount of missing vlaues and the amount of each patter of missing values.</p>
</div>
<div id="vim-package-1" class="section level4" number="11.2.2.2">
<h4 number="11.2.2.2"><span class="header-section-number">11.2.2.2</span> <code>VIM</code> package</h4>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb495-2"><a href="#cb495-2"></a><span class="st">  </span>VIM<span class="op">::</span><span class="kw">aggr</span>(<span class="dt">numbers =</span> <span class="ot">TRUE</span>,   <span class="co"># shows the number to the far right</span></span>
<span id="cb495-3"><a href="#cb495-3"></a>            <span class="dt">prop =</span> <span class="ot">FALSE</span>)     <span class="co"># shows counts instead of proportions</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-409-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="naniar-package-1" class="section level4" number="11.2.2.3">
<h4 number="11.2.2.3"><span class="header-section-number">11.2.2.3</span> <code>naniar</code> package</h4>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb496-2"><a href="#cb496-2"></a><span class="st">  </span>naniar<span class="op">::</span><span class="kw">gg_miss_upset</span>(<span class="dt">sets =</span> <span class="kw">c</span>(<span class="st">&quot;hamd_5_NA&quot;</span>,</span>
<span id="cb496-3"><a href="#cb496-3"></a>                                 <span class="st">&quot;hamd_4_NA&quot;</span>,</span>
<span id="cb496-4"><a href="#cb496-4"></a>                                 <span class="st">&quot;hamd_3_NA&quot;</span>,</span>
<span id="cb496-5"><a href="#cb496-5"></a>                                 <span class="st">&quot;hamd_2_NA&quot;</span>,</span>
<span id="cb496-6"><a href="#cb496-6"></a>                                 <span class="st">&quot;hamd_1_NA&quot;</span>,</span>
<span id="cb496-7"><a href="#cb496-7"></a>                                 <span class="st">&quot;hamd_0_NA&quot;</span>),</span>
<span id="cb496-8"><a href="#cb496-8"></a>                        <span class="dt">keep.order =</span> <span class="ot">TRUE</span>) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-410-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="depression-over-time-by-group" class="section level3" number="11.2.3">
<h3 number="11.2.3"><span class="header-section-number">11.2.3</span> Depression Over Time, by Group</h3>
<div id="table-of-means" class="section level4" number="11.2.3.1">
<h4 number="11.2.3.1"><span class="header-section-number">11.2.3.1</span> Table of Means</h4>
<blockquote>
<p>Default = COMPLETE CASES ONLY!!!</p>
</blockquote>
<p>Note - the sample size at each time point is the same, but subjects are only included if they have data at every time point</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1"></a>data_wide <span class="op">%&gt;%</span><span class="st">          </span></span>
<span id="cb497-2"><a href="#cb497-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(endog) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb497-3"><a href="#cb497-3"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Baseline&quot;</span> =<span class="st"> </span>hamd_<span class="dv">0</span>,</span>
<span id="cb497-4"><a href="#cb497-4"></a>                    <span class="st">&quot;Week 1&quot;</span> =<span class="st"> </span>hamd_<span class="dv">1</span>,</span>
<span id="cb497-5"><a href="#cb497-5"></a>                    <span class="st">&quot;Week 2&quot;</span> =<span class="st"> </span>hamd_<span class="dv">2</span>,</span>
<span id="cb497-6"><a href="#cb497-6"></a>                    <span class="st">&quot;Week 3&quot;</span> =<span class="st"> </span>hamd_<span class="dv">3</span>,</span>
<span id="cb497-7"><a href="#cb497-7"></a>                    <span class="st">&quot;Week 4&quot;</span> =<span class="st"> </span>hamd_<span class="dv">4</span>,</span>
<span id="cb497-8"><a href="#cb497-8"></a>                    <span class="st">&quot;Week 5&quot;</span> =<span class="st"> </span>hamd_<span class="dv">5</span>,</span>
<span id="cb497-9"><a href="#cb497-9"></a>                    <span class="dt">total =</span> <span class="ot">TRUE</span>,</span>
<span id="cb497-10"><a href="#cb497-10"></a>                    <span class="dt">test =</span> <span class="ot">TRUE</span>,</span>
<span id="cb497-11"><a href="#cb497-11"></a>                    <span class="dt">na.rm =</span> <span class="ot">TRUE</span>,              <span class="co"># default: COMPLETE CASES ONLY!!!!!</span></span>
<span id="cb497-12"><a href="#cb497-12"></a>                    <span class="dt">digits =</span> <span class="dv">2</span>,</span>
<span id="cb497-13"><a href="#cb497-13"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>,</span>
<span id="cb497-14"><a href="#cb497-14"></a>                    <span class="dt">caption =</span> <span class="st">&quot;Hamilton Depression Scores Across Time, by Depression Type for Participants with 6 Complete Weeks&quot;</span>)           </span></code></pre></div>
<table>
<caption>(#tab:unnamed-chunk-411)Hamilton Depression Scores Across Time, by Depression Type for Participants with 6 Complete Weeks</caption>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>Reactive</th>
<th>Endogenous</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 46</td>
<td>n = 25</td>
<td>n = 21</td>
<td></td>
</tr>
<tr class="even">
<td>Baseline</td>
<td></td>
<td></td>
<td></td>
<td>0.186</td>
</tr>
<tr class="odd">
<td></td>
<td>23.15 (4.41)</td>
<td>22.36 (3.90)</td>
<td>24.10 (4.87)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 1</td>
<td></td>
<td></td>
<td></td>
<td>0.007</td>
</tr>
<tr class="odd">
<td></td>
<td>21.83 (4.92)</td>
<td>20.08 (3.68)</td>
<td>23.90 (5.47)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 2</td>
<td></td>
<td></td>
<td></td>
<td>0.292</td>
</tr>
<tr class="odd">
<td></td>
<td>18.07 (5.17)</td>
<td>17.32 (4.34)</td>
<td>18.95 (6.01)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 3</td>
<td></td>
<td></td>
<td></td>
<td>0.398</td>
</tr>
<tr class="odd">
<td></td>
<td>16.61 (6.31)</td>
<td>15.88 (5.84)</td>
<td>17.48 (6.86)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 4</td>
<td></td>
<td></td>
<td></td>
<td>0.507</td>
</tr>
<tr class="odd">
<td></td>
<td>13.46 (6.78)</td>
<td>12.84 (6.68)</td>
<td>14.19 (6.98)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 5</td>
<td></td>
<td></td>
<td></td>
<td>0.468</td>
</tr>
<tr class="odd">
<td></td>
<td>12.15 (7.57)</td>
<td>11.40 (6.54)</td>
<td>13.05 (8.73)</td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Specify All data:</p>
</blockquote>
<p>note - that the smaple sizes will be different for each time point</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1"></a>data_wide <span class="op">%&gt;%</span><span class="st">                </span></span>
<span id="cb498-2"><a href="#cb498-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(endog) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb498-3"><a href="#cb498-3"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Baseline&quot;</span> =<span class="st"> </span>hamd_<span class="dv">0</span>,</span>
<span id="cb498-4"><a href="#cb498-4"></a>                    <span class="st">&quot;Week 1&quot;</span> =<span class="st"> </span>hamd_<span class="dv">1</span>,</span>
<span id="cb498-5"><a href="#cb498-5"></a>                    <span class="st">&quot;Week 2&quot;</span> =<span class="st"> </span>hamd_<span class="dv">2</span>,</span>
<span id="cb498-6"><a href="#cb498-6"></a>                    <span class="st">&quot;Week 3&quot;</span> =<span class="st"> </span>hamd_<span class="dv">3</span>,</span>
<span id="cb498-7"><a href="#cb498-7"></a>                    <span class="st">&quot;Week 4&quot;</span> =<span class="st"> </span>hamd_<span class="dv">4</span>,</span>
<span id="cb498-8"><a href="#cb498-8"></a>                    <span class="st">&quot;Week 5&quot;</span> =<span class="st"> </span>hamd_<span class="dv">5</span>,</span>
<span id="cb498-9"><a href="#cb498-9"></a>                    <span class="dt">total =</span> <span class="ot">TRUE</span>,</span>
<span id="cb498-10"><a href="#cb498-10"></a>                    <span class="dt">test =</span> <span class="ot">TRUE</span>,</span>
<span id="cb498-11"><a href="#cb498-11"></a>                    <span class="dt">na.rm =</span> <span class="ot">FALSE</span>,              <span class="co"># default: COMPLETE CASES ONLY!!!!!</span></span>
<span id="cb498-12"><a href="#cb498-12"></a>                    <span class="dt">digits =</span> <span class="dv">2</span>,</span>
<span id="cb498-13"><a href="#cb498-13"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>,</span>
<span id="cb498-14"><a href="#cb498-14"></a>                    <span class="dt">caption =</span> <span class="st">&quot;Hamilton Depression Scores Across Time, by Depression Type for All Participants&quot;</span>)  </span></code></pre></div>
<table>
<caption>(#tab:unnamed-chunk-412)Hamilton Depression Scores Across Time, by Depression Type for All Participants</caption>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>Reactive</th>
<th>Endogenous</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 66</td>
<td>n = 29</td>
<td>n = 37</td>
<td></td>
</tr>
<tr class="even">
<td>Baseline</td>
<td></td>
<td></td>
<td></td>
<td>0.301</td>
</tr>
<tr class="odd">
<td></td>
<td>23.44 (4.53)</td>
<td>22.79 (4.12)</td>
<td>24.00 (4.85)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 1</td>
<td></td>
<td></td>
<td></td>
<td>0.033</td>
</tr>
<tr class="odd">
<td></td>
<td>21.84 (4.70)</td>
<td>20.48 (3.83)</td>
<td>23.00 (5.10)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 2</td>
<td></td>
<td></td>
<td></td>
<td>0.095</td>
</tr>
<tr class="odd">
<td></td>
<td>18.31 (5.49)</td>
<td>17.00 (4.35)</td>
<td>19.30 (6.08)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 3</td>
<td></td>
<td></td>
<td></td>
<td>0.23</td>
</tr>
<tr class="odd">
<td></td>
<td>16.42 (6.42)</td>
<td>15.34 (6.17)</td>
<td>17.28 (6.56)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 4</td>
<td></td>
<td></td>
<td></td>
<td>0.298</td>
</tr>
<tr class="odd">
<td></td>
<td>13.62 (6.97)</td>
<td>12.62 (6.72)</td>
<td>14.47 (7.17)</td>
<td></td>
</tr>
<tr class="even">
<td>Week 5</td>
<td></td>
<td></td>
<td></td>
<td>0.48</td>
</tr>
<tr class="odd">
<td></td>
<td>11.95 (7.22)</td>
<td>11.22 (6.34)</td>
<td>12.58 (7.96)</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="using-the-long-formatted-dataset-3" class="section level4" number="11.2.3.2">
<h4 number="11.2.3.2"><span class="header-section-number">11.2.3.2</span> Using the LONG formatted dataset</h4>
<p>Each person’s data is stored on multiple lines, one for each time point.</p>
<blockquote>
<p>FOR ALL DATA!</p>
</blockquote>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1"></a>data_sum_all &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb499-2"><a href="#cb499-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(endog, week) <span class="op">%&gt;%</span><span class="st">                       </span><span class="co"># specify the groups</span></span>
<span id="cb499-3"><a href="#cb499-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">hamd_n    =</span> <span class="kw">n</span>(),                      <span class="co"># count of valid scores</span></span>
<span id="cb499-4"><a href="#cb499-4"></a>                   <span class="dt">hamd_mean =</span> <span class="kw">mean</span>(hamd),               <span class="co"># mean score</span></span>
<span id="cb499-5"><a href="#cb499-5"></a>                   <span class="dt">hamd_sd   =</span> <span class="kw">sd</span>(hamd),                 <span class="co"># standard deviation of scores</span></span>
<span id="cb499-6"><a href="#cb499-6"></a>                   <span class="dt">hamd_sem  =</span> hamd_sd <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(hamd_n))   <span class="co"># stadard error for the mean of scores</span></span>
<span id="cb499-7"><a href="#cb499-7"></a></span>
<span id="cb499-8"><a href="#cb499-8"></a>data_sum_all</span></code></pre></div>
<pre><code># A tibble: 12 x 6
# Groups:   endog [2]
   endog       week hamd_n hamd_mean hamd_sd hamd_sem
   &lt;fct&gt;      &lt;dbl&gt;  &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1 Reactive       0     28      22.8    4.12    0.779
 2 Reactive       1     29      20.5    3.83    0.712
 3 Reactive       2     28      17      4.35    0.821
 4 Reactive       3     29      15.3    6.17    1.15 
 5 Reactive       4     29      12.6    6.72    1.25 
 6 Reactive       5     27      11.2    6.34    1.22 
 7 Endogenous     0     33      24      4.85    0.844
 8 Endogenous     1     34      23      5.10    0.874
 9 Endogenous     2     37      19.3    6.08    1.00 
10 Endogenous     3     36      17.3    6.56    1.09 
11 Endogenous     4     34      14.5    7.17    1.23 
12 Endogenous     5     31      12.6    7.96    1.43 </code></pre>
<blockquote>
<p>FOR COMPLETE CASES ONLY!!!</p>
</blockquote>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1"></a>data_sum_cc &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-2"><a href="#cb501-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st">               </span><span class="co"># group-by participant</span></span>
<span id="cb501-3"><a href="#cb501-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">person_vsae_n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># count the number of valid VSAE scores</span></span>
<span id="cb501-4"><a href="#cb501-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(person_vsae_n <span class="op">==</span><span class="st"> </span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st">     </span><span class="co"># restrict to only thoes children with 5 valid scores</span></span>
<span id="cb501-5"><a href="#cb501-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(endog, week) <span class="op">%&gt;%</span><span class="st">                </span><span class="co"># specify the groups</span></span>
<span id="cb501-6"><a href="#cb501-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">hamd_n    =</span> <span class="kw">n</span>(),                      <span class="co"># count of valid scores</span></span>
<span id="cb501-7"><a href="#cb501-7"></a>                   <span class="dt">hamd_mean =</span> <span class="kw">mean</span>(hamd),               <span class="co"># mean score</span></span>
<span id="cb501-8"><a href="#cb501-8"></a>                   <span class="dt">hamd_sd   =</span> <span class="kw">sd</span>(hamd),                 <span class="co"># standard deviation of scores</span></span>
<span id="cb501-9"><a href="#cb501-9"></a>                   <span class="dt">hamd_sem  =</span> hamd_sd <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(hamd_n))   <span class="co"># stadard error for the mean of scores</span></span>
<span id="cb501-10"><a href="#cb501-10"></a></span>
<span id="cb501-11"><a href="#cb501-11"></a>data_sum_cc</span></code></pre></div>
<pre><code># A tibble: 12 x 6
# Groups:   endog [2]
   endog       week hamd_n hamd_mean hamd_sd hamd_sem
   &lt;fct&gt;      &lt;dbl&gt;  &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1 Reactive       0     25      22.4    3.90    0.781
 2 Reactive       1     25      20.1    3.68    0.737
 3 Reactive       2     25      17.3    4.34    0.867
 4 Reactive       3     25      15.9    5.84    1.17 
 5 Reactive       4     25      12.8    6.68    1.34 
 6 Reactive       5     25      11.4    6.54    1.31 
 7 Endogenous     0     21      24.1    4.87    1.06 
 8 Endogenous     1     21      23.9    5.47    1.19 
 9 Endogenous     2     21      19.0    6.01    1.31 
10 Endogenous     3     21      17.5    6.86    1.50 
11 Endogenous     4     21      14.2    6.98    1.52 
12 Endogenous     5     21      13.0    8.73    1.90 </code></pre>
</div>
<div id="person-profile-plot-or-spaghetti-plot" class="section level4" number="11.2.3.3">
<h4 number="11.2.3.3"><span class="header-section-number">11.2.3.3</span> Person-Profile Plot or Spaghetti Plot</h4>
<p>Use the data in LONG format.</p>
<p>A scatterplot of all observations of depression scores over time, joining the dots of each individual’s data.</p>
<blockquote>
<p>NOTE: Not all lines have a point for every week!</p>
</blockquote>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb503-2"><a href="#cb503-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb503-3"><a href="#cb503-3"></a>             <span class="dt">y =</span> hamd)) <span class="op">+</span></span>
<span id="cb503-4"><a href="#cb503-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb503-5"><a href="#cb503-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))   <span class="co"># join points that belong to the same &quot;id&quot;</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-415-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb504-2"><a href="#cb504-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb504-3"><a href="#cb504-3"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb504-4"><a href="#cb504-4"></a>             <span class="dt">color =</span> endog)) <span class="op">+</span><span class="st">    </span><span class="co"># color points and lines by the &quot;endog&quot; variable</span></span>
<span id="cb504-5"><a href="#cb504-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-416-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb505-2"><a href="#cb505-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb505-3"><a href="#cb505-3"></a>             <span class="dt">y =</span> hamd)) <span class="op">+</span></span>
<span id="cb505-4"><a href="#cb505-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb505-5"><a href="#cb505-5"></a><span class="st">  </span><span class="kw">facet_grid</span>( <span class="op">~</span><span class="st"> </span>endog)            <span class="co"># side-by-side panels by the &quot;endog&quot; variable</span></span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-417-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb506-2"><a href="#cb506-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(),</span>
<span id="cb506-3"><a href="#cb506-3"></a>             <span class="dt">y =</span> hamd)) <span class="op">+</span></span>
<span id="cb506-4"><a href="#cb506-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">                   </span><span class="co"># compare center and spread</span></span>
<span id="cb506-5"><a href="#cb506-5"></a><span class="st">  </span><span class="kw">facet_grid</span>( <span class="op">~</span><span class="st"> </span>endog)           </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-418-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb507-2"><a href="#cb507-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(),</span>
<span id="cb507-3"><a href="#cb507-3"></a>             <span class="dt">y =</span> hamd)) <span class="op">+</span></span>
<span id="cb507-4"><a href="#cb507-4"></a><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span><span class="st">                   </span><span class="co"># similar to boxplots to show distribution</span></span>
<span id="cb507-5"><a href="#cb507-5"></a><span class="st">  </span><span class="kw">stat_summary</span>() <span class="op">+</span></span>
<span id="cb507-6"><a href="#cb507-6"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="st">&quot;endog&quot;</span>),</span>
<span id="cb507-7"><a href="#cb507-7"></a>               <span class="dt">fun =</span> mean,</span>
<span id="cb507-8"><a href="#cb507-8"></a>               <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span></span>
<span id="cb507-9"><a href="#cb507-9"></a><span class="st">  </span><span class="kw">facet_grid</span>( <span class="op">~</span><span class="st"> </span>endog)           </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-419-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb508-2"><a href="#cb508-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb508-3"><a href="#cb508-3"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb508-4"><a href="#cb508-4"></a>             <span class="dt">color =</span> endog)) <span class="op">+</span></span>
<span id="cb508-5"><a href="#cb508-5"></a><span class="st">  </span><span class="kw">stat_summary</span>() <span class="op">+</span></span>
<span id="cb508-6"><a href="#cb508-6"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">group =</span> endog,</span>
<span id="cb508-7"><a href="#cb508-7"></a>                   <span class="dt">linetype =</span> endog),</span>
<span id="cb508-8"><a href="#cb508-8"></a>               <span class="dt">fun =</span> mean,</span>
<span id="cb508-9"><a href="#cb508-9"></a>               <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span></span>
<span id="cb508-10"><a href="#cb508-10"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>)) <span class="op">+</span></span>
<span id="cb508-11"><a href="#cb508-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb508-12"><a href="#cb508-12"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-420-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb509-2"><a href="#cb509-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb509-3"><a href="#cb509-3"></a>             <span class="dt">y =</span> hamd)) <span class="op">+</span></span>
<span id="cb509-4"><a href="#cb509-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb509-5"><a href="#cb509-5"></a><span class="st">  </span><span class="kw">facet_grid</span>( <span class="op">~</span><span class="st"> </span>endog) <span class="op">+</span></span>
<span id="cb509-6"><a href="#cb509-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st">                     </span><span class="co"># DEFAULTS: method = &quot;loess&quot;, se = TRUE, color = &quot;blue&quot;</span></span>
<span id="cb509-7"><a href="#cb509-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb509-8"><a href="#cb509-8"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,</span>
<span id="cb509-9"><a href="#cb509-9"></a>              <span class="dt">color =</span> <span class="st">&quot;hot pink&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-421-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb510-2"><a href="#cb510-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb510-3"><a href="#cb510-3"></a>             <span class="dt">y =</span> hamd)) <span class="op">+</span></span>
<span id="cb510-4"><a href="#cb510-4"></a><span class="st">  </span><span class="kw">facet_grid</span>( <span class="op">~</span><span class="st"> </span>endog) <span class="op">+</span></span>
<span id="cb510-5"><a href="#cb510-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Flexible&quot;</span>),</span>
<span id="cb510-6"><a href="#cb510-6"></a>              <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb510-7"><a href="#cb510-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,) <span class="op">+</span></span>
<span id="cb510-8"><a href="#cb510-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Linear&quot;</span>),</span>
<span id="cb510-9"><a href="#cb510-9"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb510-10"><a href="#cb510-10"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb510-11"><a href="#cb510-11"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Smoother Type: &quot;</span>,</span>
<span id="cb510-12"><a href="#cb510-12"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;Flexible&quot;</span> =<span class="st"> &quot;blue&quot;</span>, </span>
<span id="cb510-13"><a href="#cb510-13"></a>                                <span class="st">&quot;Linear&quot;</span>   =<span class="st"> &quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb510-14"><a href="#cb510-14"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb510-15"><a href="#cb510-15"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-422-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb511-2"><a href="#cb511-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb511-3"><a href="#cb511-3"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb511-4"><a href="#cb511-4"></a>             <span class="dt">group =</span> endog,</span>
<span id="cb511-5"><a href="#cb511-5"></a>             <span class="dt">linetype =</span> endog)) <span class="op">+</span></span>
<span id="cb511-6"><a href="#cb511-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb511-7"><a href="#cb511-7"></a>              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb511-8"><a href="#cb511-8"></a>              <span class="dt">alpha =</span> <span class="fl">.25</span>) <span class="op">+</span></span>
<span id="cb511-9"><a href="#cb511-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb511-10"><a href="#cb511-10"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>)) <span class="op">+</span></span>
<span id="cb511-11"><a href="#cb511-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb511-12"><a href="#cb511-12"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb511-13"><a href="#cb511-13"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb511-14"><a href="#cb511-14"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb511-15"><a href="#cb511-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Weeks After Baseline&quot;</span>,</span>
<span id="cb511-16"><a href="#cb511-16"></a>       <span class="dt">y =</span> <span class="st">&quot;Hamilton Depression Scale&quot;</span>,</span>
<span id="cb511-17"><a href="#cb511-17"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Type of Depression&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-423-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb512-2"><a href="#cb512-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb512-3"><a href="#cb512-3"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb512-4"><a href="#cb512-4"></a>             <span class="dt">group =</span> endog,</span>
<span id="cb512-5"><a href="#cb512-5"></a>             <span class="dt">linetype =</span> endog)) <span class="op">+</span></span>
<span id="cb512-6"><a href="#cb512-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb512-7"><a href="#cb512-7"></a>              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb512-8"><a href="#cb512-8"></a>              <span class="dt">alpha =</span> <span class="fl">.25</span>) <span class="op">+</span></span>
<span id="cb512-9"><a href="#cb512-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb512-10"><a href="#cb512-10"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>)) <span class="op">+</span></span>
<span id="cb512-11"><a href="#cb512-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb512-12"><a href="#cb512-12"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb512-13"><a href="#cb512-13"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb512-14"><a href="#cb512-14"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb512-15"><a href="#cb512-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Weeks After Baseline&quot;</span>,</span>
<span id="cb512-16"><a href="#cb512-16"></a>       <span class="dt">y =</span> <span class="st">&quot;Hamilton Depression Scale&quot;</span>,</span>
<span id="cb512-17"><a href="#cb512-17"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Type of Depression&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-424-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="patterns-in-the-outcome-over-time" class="section level2" number="11.3">
<h2 number="11.3"><span class="header-section-number">11.3</span> Patterns in the Outcome Over Time</h2>
<div id="variance-covariance" class="section level3" number="11.3.1">
<h3 number="11.3.1"><span class="header-section-number">11.3.1</span> Variance-Covariance</h3>
<div id="full-matrix" class="section level4" number="11.3.1.1">
<h4 number="11.3.1.1"><span class="header-section-number">11.3.1.1</span> Full Matrix</h4>
<ul>
<li><p>Variances are down the diagonal</p>
<ul>
<li>Increasing variance over time violates the ANOVA assumption of <em>homogeity of variance</em></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb513-2"><a href="#cb513-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;hamd_&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># just the outcome(s)</span></span>
<span id="cb513-3"><a href="#cb513-3"></a><span class="st">  </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)  <span class="op">%&gt;%</span><span class="st">           </span><span class="co"># covariance matrix, LIST-wise deletion</span></span>
<span id="cb513-4"><a href="#cb513-4"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>       hamd_0 hamd_1 hamd_2 hamd_3 hamd_4 hamd_5
hamd_0 19.421 10.716  9.523 12.350  9.062  7.376
hamd_1 10.716 24.236 12.545 15.930 11.592  8.471
hamd_2  9.523 12.545 26.773 23.848 23.858 20.657
hamd_3 12.350 15.930 23.848 39.755 33.316 29.728
hamd_4  9.062 11.592 23.858 33.316 45.943 37.107
hamd_5  7.376  8.471 20.657 29.728 37.107 57.332</code></pre>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb515-2"><a href="#cb515-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;hamd_&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># just the outcome(s)</span></span>
<span id="cb515-3"><a href="#cb515-3"></a><span class="st">  </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)  <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># covariance matrix, PAIR-wise deletion</span></span>
<span id="cb515-4"><a href="#cb515-4"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>       hamd_0 hamd_1 hamd_2 hamd_3 hamd_4 hamd_5
hamd_0 20.551 10.115 10.139 10.086  7.191  6.278
hamd_1 10.115 22.071 12.277 12.550 10.264  7.720
hamd_2 10.139 12.277 30.091 25.126 24.626 18.384
hamd_3 10.086 12.550 25.126 41.153 37.339 23.992
hamd_4  7.191 10.264 24.626 37.339 48.594 30.513
hamd_5  6.278  7.720 18.384 23.992 30.513 52.120</code></pre>
</div>
<div id="just-variances" class="section level4" number="11.3.1.2">
<h4 number="11.3.1.2"><span class="header-section-number">11.3.1.2</span> Just Variances</h4>
<p>Notice the variance in scores increases over time, which is seen in the side-by-side boxplots.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb517-2"><a href="#cb517-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;hamd_&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># just the outcome(s)</span></span>
<span id="cb517-3"><a href="#cb517-3"></a><span class="st">  </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)  <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># covariance matrix, PAIR-wise deletion</span></span>
<span id="cb517-4"><a href="#cb517-4"></a><span class="st">  </span><span class="kw">diag</span>()                                   <span class="co">#  extracts just the variances</span></span></code></pre></div>
<pre><code>  hamd_0   hamd_1   hamd_2   hamd_3   hamd_4   hamd_5 
20.55082 22.07117 30.09135 41.15288 48.59447 52.12008 </code></pre>
</div>
</div>
<div id="correlation" class="section level3" number="11.3.2">
<h3 number="11.3.2"><span class="header-section-number">11.3.2</span> Correlation</h3>
<div id="full-matrix-1" class="section level4" number="11.3.2.1">
<h4 number="11.3.2.1"><span class="header-section-number">11.3.2.1</span> Full Matrix</h4>
<p>Pairwise relationships are easier to eye-ball magnitude when presented as correlations, rather than covariances, due to the relative scale.</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb519-2"><a href="#cb519-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;hamd_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># just the outcome(s)</span></span>
<span id="cb519-3"><a href="#cb519-3"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>) <span class="op">%&gt;%</span><span class="st">           </span><span class="co"># correlation matrix - LIST-wise deletion</span></span>
<span id="cb519-4"><a href="#cb519-4"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">2</span>)                                </span></code></pre></div>
<pre><code>       hamd_0 hamd_1 hamd_2 hamd_3 hamd_4 hamd_5
hamd_0   1.00   0.49   0.42   0.44   0.30   0.22
hamd_1   0.49   1.00   0.49   0.51   0.35   0.23
hamd_2   0.42   0.49   1.00   0.73   0.68   0.53
hamd_3   0.44   0.51   0.73   1.00   0.78   0.62
hamd_4   0.30   0.35   0.68   0.78   1.00   0.72
hamd_5   0.22   0.23   0.53   0.62   0.72   1.00</code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb521-2"><a href="#cb521-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;hamd_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># just the outcome(s)</span></span>
<span id="cb521-3"><a href="#cb521-3"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># correlation matrix - PAIR-wise deletion</span></span>
<span id="cb521-4"><a href="#cb521-4"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">2</span>)                                </span></code></pre></div>
<pre><code>       hamd_0 hamd_1 hamd_2 hamd_3 hamd_4 hamd_5
hamd_0   1.00   0.49   0.41   0.33   0.23   0.18
hamd_1   0.49   1.00   0.49   0.41   0.31   0.22
hamd_2   0.41   0.49   1.00   0.74   0.67   0.46
hamd_3   0.33   0.41   0.74   1.00   0.82   0.57
hamd_4   0.23   0.31   0.67   0.82   1.00   0.65
hamd_5   0.18   0.22   0.46   0.57   0.65   1.00</code></pre>
</div>
<div id="visualization" class="section level4" number="11.3.2.2">
<h4 number="11.3.2.2"><span class="header-section-number">11.3.2.2</span> Visualization</h4>
<p>Looking for patterns is always easier with a plot. All RM or mixed ANOVA assume sphericity or compound symmetry, meaning that all the correlations in the matrix would be the same. This is not the case for these data. Instead we see a classic pattern of corralary decay. Measures taken close in time, say 1 week apart, exhibit the highest degree of correlation. The farther apart in time that two measures are taken, the less correlated they are. Note that the adjacent measures become more highly correlated, too. This can be due to attrition; later time points having a smaller sample size.</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb523-2"><a href="#cb523-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;hamd_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># just the outcome(s)</span></span>
<span id="cb523-3"><a href="#cb523-3"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># correlation matrix</span></span>
<span id="cb523-4"><a href="#cb523-4"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>(<span class="dt">upper =</span> <span class="st">&quot;ellipse&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-430-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="for-each-group" class="section level3" number="11.3.3">
<h3 number="11.3.3"><span class="header-section-number">11.3.3</span> For Each Group</h3>
<p>It can be a good ideal to investigate if the groups exhibit a similar pattern in correlation.</p>
<blockquote>
<p>Reactive Depression</p>
</blockquote>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb524-2"><a href="#cb524-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(endog <span class="op">==</span><span class="st"> &quot;Reactive&quot;</span>) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># filter observations for the REACTIVE group</span></span>
<span id="cb524-3"><a href="#cb524-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;hamd_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb524-4"><a href="#cb524-4"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>) <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb524-5"><a href="#cb524-5"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>(<span class="dt">upper =</span> <span class="st">&quot;ellipse&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-431-1.png" width="576" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Endogenous Depression</p>
</blockquote>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb525-2"><a href="#cb525-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(endog <span class="op">==</span><span class="st"> &quot;Endogenous&quot;</span>) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># filter observations for the Endogenous group</span></span>
<span id="cb525-3"><a href="#cb525-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;hamd_&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb525-4"><a href="#cb525-4"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>) <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb525-5"><a href="#cb525-5"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>(<span class="dt">upper =</span> <span class="st">&quot;ellipse&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-432-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mlm---null-or-emptly-models" class="section level2" number="11.4">
<h2 number="11.4"><span class="header-section-number">11.4</span> MLM - Null or Emptly Models</h2>
<div id="fit-the-model-13" class="section level3" number="11.4.1">
<h3 number="11.4.1"><span class="header-section-number">11.4.1</span> Fit the model</h3>
<blockquote>
<p>Random Intercepts, with Fixed Intercept and Time Slope (i.e. Trend)….@hedeker2006 section 4.3.5, starting on page 55</p>
</blockquote>
<p>Since this situation deals with longitudinal data, it is more appropriate to start off including the time variable in the null model as a fixed effect only.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1"></a>fit_lmer_week_RI_reml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(hamd <span class="op">~</span><span class="st"> </span>week <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id), </span>
<span id="cb526-2"><a href="#cb526-2"></a>                                        <span class="dt">data =</span> data_long,</span>
<span id="cb526-3"><a href="#cb526-3"></a>                                        <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
<div id="table-of-parameter-estimates" class="section level3" number="11.4.2">
<h3 number="11.4.2"><span class="header-section-number">11.4.2</span> Table of Parameter Estimates</h3>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(fit_lmer_week_RI_reml, </span>
<span id="cb527-2"><a href="#cb527-2"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb527-3"><a href="#cb527-3"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM: Random Intercepts Null Model fit w/REML&quot;</span>,</span>
<span id="cb527-4"><a href="#cb527-4"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb527-5"><a href="#cb527-5"></a>                <span class="dt">custom.note =</span> <span class="st">&quot;Reproduction of Hedeker&#39;s table 4.3 on page 55, except using REML here instead of ML&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Random Intercepts Null Model fit w/REML
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.55 (0.64)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.38 (0.14)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2294.73
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2310.43
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1143.36
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
66
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
16.45
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
19.10
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
Reproduction of Hedeker’s table 4.3 on page 55, except using REML here instead of ML
</td>
</tr>
</tfoot>
</table>
<p>On average, patients start off with HDRS scores of 23.55 and then change by -2.38 points each week. This weekly improvement of about 2 points a week is statistically significant via the Wald test.</p>
</div>
<div id="estimated-marginal-means-plot" class="section level3" number="11.4.3">
<h3 number="11.4.3"><span class="header-section-number">11.4.3</span> Estimated Marginal Means Plot</h3>
<blockquote>
<p>Multilevel model on page 55 <span class="citation">(Hedeker and Gibbons <a href="#ref-hedeker2006" role="doc-biblioref">2006</a>)</span></p>
</blockquote>
<p><span class="math display">\[
\hat{y} = 23.552 + 
          -2.376 week
\]</span></p>
<p>The fastest way to plot a model is to use the <code>sjPlot::plot_model()</code> function.</p>
<blockquote>
<p>Note: you can’t use <code>interactions::interact_plot()</code> since there is only one predictor (i.e. independent variable) in this model.</p>
</blockquote>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_lmer_week_RI_reml,</span>
<span id="cb528-2"><a href="#cb528-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>,</span>
<span id="cb528-3"><a href="#cb528-3"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;week&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-434-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="estimated-marginal-means-and-emperical-bayes-plots" class="section level3" number="11.4.4">
<h3 number="11.4.4"><span class="header-section-number">11.4.4</span> Estimated Marginal Means and Emperical Bayes Plots</h3>
<p>With a bit more code we can plot not only the <strong>marginal model</strong> (fixed effects only), but add the Best Linear Unbiased Predictions (<strong>BLUP</strong>s) or person-specific specific models (both fixed and random effects).</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-2"><a href="#cb529-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_fixed =</span> <span class="kw">predict</span>(fit_lmer_week_RI_reml, <span class="dt">re.form =</span> <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># fixed effects only</span></span>
<span id="cb529-3"><a href="#cb529-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_wrand =</span> <span class="kw">predict</span>(fit_lmer_week_RI_reml)) <span class="op">%&gt;%</span><span class="st">               </span><span class="co"># fixed and random effects together</span></span>
<span id="cb529-4"><a href="#cb529-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb529-5"><a href="#cb529-5"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb529-6"><a href="#cb529-6"></a>             <span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb529-7"><a href="#cb529-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_wrand,</span>
<span id="cb529-8"><a href="#cb529-8"></a>                <span class="dt">color    =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb529-9"><a href="#cb529-9"></a>                <span class="dt">size     =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb529-10"><a href="#cb529-10"></a>                <span class="dt">linetype =</span> <span class="st">&quot;BLUP&quot;</span>)) <span class="op">+</span></span>
<span id="cb529-11"><a href="#cb529-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_fixed,</span>
<span id="cb529-12"><a href="#cb529-12"></a>                <span class="dt">color    =</span> <span class="st">&quot;Marginal&quot;</span>,</span>
<span id="cb529-13"><a href="#cb529-13"></a>                <span class="dt">size     =</span> <span class="st">&quot;Marginal&quot;</span>,</span>
<span id="cb529-14"><a href="#cb529-14"></a>                <span class="dt">linetype =</span> <span class="st">&quot;Marginal&quot;</span>)) <span class="op">+</span></span>
<span id="cb529-15"><a href="#cb529-15"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb529-16"><a href="#cb529-16"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name   =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb529-17"><a href="#cb529-17"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>     =<span class="st"> &quot;gray50&quot;</span>,</span>
<span id="cb529-18"><a href="#cb529-18"></a>                                <span class="st">&quot;Marginal&quot;</span> =<span class="st"> &quot;blue&quot;</span>))  <span class="op">+</span></span>
<span id="cb529-19"><a href="#cb529-19"></a><span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">name    =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb529-20"><a href="#cb529-20"></a>                    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>      =<span class="st"> </span><span class="fl">.5</span>,</span>
<span id="cb529-21"><a href="#cb529-21"></a>                               <span class="st">&quot;Marginal&quot;</span> =<span class="st"> </span><span class="fl">1.25</span>))  <span class="op">+</span></span>
<span id="cb529-22"><a href="#cb529-22"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">name   =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb529-23"><a href="#cb529-23"></a>                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>     =<span class="st"> &quot;longdash&quot;</span>,</span>
<span id="cb529-24"><a href="#cb529-24"></a>                                   <span class="st">&quot;Marginal&quot;</span> =<span class="st"> &quot;solid&quot;</span>))  <span class="op">+</span></span>
<span id="cb529-25"><a href="#cb529-25"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb529-26"><a href="#cb529-26"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">-0.1</span>),</span>
<span id="cb529-27"><a href="#cb529-27"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb529-28"><a href="#cb529-28"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb529-29"><a href="#cb529-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Weeks Since Baseline&quot;</span>,</span>
<span id="cb529-30"><a href="#cb529-30"></a>       <span class="dt">y =</span> <span class="st">&quot;Hamilton Depression Scores&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-435-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Notice that in this model, all the BLUPs are parallel. That is because we are only letting the intercept vary from person-to-person while keeping the effect of time (slope) constant.</p>
<blockquote>
<p>Reproduce Table 4.4 on page 55 <span class="citation">(Hedeker and Gibbons <a href="#ref-hedeker2006" role="doc-biblioref">2006</a>)</span></p>
</blockquote>
<p>One way to judge a model is to compare the estimated means to the observed means to see how accuratedly they are represented by the model. This excellent fit of the estimated marginal means to the observed data supports the hypothesis that the change in depression across time is LINEAR.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1"></a>obs &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-2"><a href="#cb530-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(week) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-3"><a href="#cb530-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">observed =</span> <span class="kw">mean</span>(hamd, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) </span>
<span id="cb530-4"><a href="#cb530-4"></a></span>
<span id="cb530-5"><a href="#cb530-5"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb530-6"><a href="#cb530-6"></a>                <span class="dt">mod =</span> fit_lmer_week_RI_reml,</span>
<span id="cb530-7"><a href="#cb530-7"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">week =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-8"><a href="#cb530-8"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-9"><a href="#cb530-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">estimated =</span> fit) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-10"><a href="#cb530-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(obs, <span class="dt">by =</span> <span class="st">&quot;week&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-11"><a href="#cb530-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(week, observed, estimated) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-12"><a href="#cb530-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">diff =</span> observed <span class="op">-</span><span class="st"> </span>estimated) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-13"><a href="#cb530-13"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Observed and Estimated Means&quot;</span>)</span></code></pre></div>
<table style="width:53%;">
<caption>Observed and Estimated Means</caption>
<colgroup>
<col width="9%" />
<col width="15%" />
<col width="16%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">week</th>
<th align="center">observed</th>
<th align="center">estimated</th>
<th align="center">diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">23</td>
<td align="center">24</td>
<td align="center">-0.11</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">22</td>
<td align="center">21</td>
<td align="center">0.67</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">18</td>
<td align="center">19</td>
<td align="center">-0.49</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">16</td>
<td align="center">16</td>
<td align="center">-0.01</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">14</td>
<td align="center">14</td>
<td align="center">-0.43</td>
</tr>
<tr class="even">
<td align="center">5</td>
<td align="center">12</td>
<td align="center">12</td>
<td align="center">0.27</td>
</tr>
</tbody>
</table>
</div>
<div id="intra-individual-correlation-icc" class="section level3" number="11.4.5">
<h3 number="11.4.5"><span class="header-section-number">11.4.5</span> Intra-individual Correlation (ICC)</h3>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1"></a>performance<span class="op">::</span><span class="kw">icc</span>(fit_lmer_week_RI_reml)</span></code></pre></div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.463
  Conditional ICC: 0.319</code></pre>
<p><strong>Interpretation</strong> Just less than a third (<span class="math inline">\(\rho_c = .32\)</span>) in baseline depression is explained by person-to-person differences. Thus, subjects display considerable heterogeneity in depression levels.</p>
<p>This value of .46is an oversimplification of the correlation matrix above and may be thought of as the expected correlation between two randomly drawn weeks for any given person.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1"></a>performance<span class="op">::</span><span class="kw">r2</span>(fit_lmer_week_RI_reml)</span></code></pre></div>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.629
     Marginal R2: 0.310</code></pre>
<p><strong>Interpretation</strong> Linear growth accounts for 31% of the variance in Hamilton Depression Scores across the six weeks. Linear growth <strong>AND</strong> person-to-person differences account for a total 63% of this variance.</p>
<blockquote>
<p>Note: The marginal <span class="math inline">\(R^2\)</span> considers only the variance of the fixed effects, while the conditional <span class="math inline">\(R^2\)</span> takes both the fixed and random effects into account. The random effect variances are actually the mean random effect variances, thus the <span class="math inline">\(R^2\)</span> value is also appropriate for mixed models with random slopes or nested random effects (see Johnson 2014).</p>
</blockquote>
</div>
<div id="compare-to-the-single-level-null-no-random-effects" class="section level3" number="11.4.6">
<h3 number="11.4.6"><span class="header-section-number">11.4.6</span> Compare to the Single-Level Null: No Random Effects</h3>
<blockquote>
<p>Simple Linear Regression, <span class="citation">(Hedeker and Gibbons <a href="#ref-hedeker2006" role="doc-biblioref">2006</a>)</span></p>
</blockquote>
<p>To compare, fit the single level regression model</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1"></a>fit_lm_week_ml &lt;-<span class="st"> </span><span class="kw">lm</span>(hamd <span class="op">~</span><span class="st"> </span>week,</span>
<span id="cb535-2"><a href="#cb535-2"></a>                     <span class="dt">data =</span> data_long)</span></code></pre></div>
<div id="table-of-parameter-estimates-1" class="section level4" number="11.4.6.1">
<h4 number="11.4.6.1"><span class="header-section-number">11.4.6.1</span> Table of Parameter Estimates</h4>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lm_week_ml, fit_lmer_week_RI_reml),</span>
<span id="cb536-2"><a href="#cb536-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Single-Level&quot;</span>, <span class="st">&quot;Multilevel&quot;</span>),</span>
<span id="cb536-3"><a href="#cb536-3"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb536-4"><a href="#cb536-4"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM: Longitudinal Null Models&quot;</span>,</span>
<span id="cb536-5"><a href="#cb536-5"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb536-6"><a href="#cb536-6"></a>                <span class="dt">custom.note =</span> <span class="st">&quot;The singel-level model treats are observations as being independent and unrelated to each other, even if they were made on the same person.&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Longitudinal Null Models
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Single-Level
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Multilevel
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.60 (0.55)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.55 (0.64)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.41 (0.18)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.38 (0.14)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.32
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Adj. R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.32
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2294.73
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2310.43
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1143.36
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
66
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
16.45
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
19.10
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
The singel-level model treats are observations as being independent and unrelated to each other, even if they were made on the same person.
</td>
</tr>
</tfoot>
</table>
<p>For the multilevel model, the Wald tests indicated the fixed intercept is significant <em>(no surprised that the depressions scores are not zero at baseline)</em>. More of note is the significance of the fixed effect of time. This signifies that depression scores are declining over time. On average, patients are improving (Hamilton Depression Scores get smaller) across time, by an average of 2.4’ish points a week.</p>
</div>
<div id="residual-variance" class="section level4" number="11.4.6.2">
<h4 number="11.4.6.2"><span class="header-section-number">11.4.6.2</span> Residual Variance</h4>
<p>Note, the fixed estimates are very similar for the two models, but the standard errors are different. Additionally, whereas the single-level regression lumps all remaining variance together (<span class="math inline">\(\sigma^2\)</span>), the multilevel model seperates it into within-subjects (<span class="math inline">\(\sigma^2_{u0}\)</span> or <span class="math inline">\(\tau_{00}\)</span>) and between-subjects variance (<span class="math inline">\(\sigma^2_{e}\)</span> or <span class="math inline">\(\sigma^2\)</span>).</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1"></a><span class="kw">sigma</span>(fit_lm_week_ml)<span class="op">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 35.3997</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_lmer_week_RI_reml) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># in longitudinal data, a group of observations = a participant or person</span></span>
<span id="cb539-2"><a href="#cb539-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>))</span></code></pre></div>
<pre><code> Groups   Name        Variance Std.Dev.
 id       (Intercept) 16.446   4.0554  
 Residual             19.099   4.3703  </code></pre>
<blockquote>
<p>“One statistician’s error term is another’s career!”</p>
<p><span class="citation">(Hedeker and Gibbons <a href="#ref-hedeker2006" role="doc-biblioref">2006</a>)</span>, page 56</p>
</blockquote>
</div>
</div>
</div>
<div id="mlm-add-random-slope-for-time-i.e.-trend" class="section level2" number="11.5">
<h2 number="11.5"><span class="header-section-number">11.5</span> MLM: Add Random Slope for Time (i.e. Trend)</h2>
<div id="fit-the-model-14" class="section level3" number="11.5.1">
<h3 number="11.5.1"><span class="header-section-number">11.5.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1"></a>fit_lmer_week_RIAS_reml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(hamd <span class="op">~</span><span class="st"> </span>week <span class="op">+</span><span class="st"> </span>(week<span class="op">|</span>id), <span class="co">#     MLM-RIAS</span></span>
<span id="cb541-2"><a href="#cb541-2"></a>                                          <span class="dt">data =</span> data_long,</span>
<span id="cb541-3"><a href="#cb541-3"></a>                                          <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
<div id="table-of-prameter-estimates-1" class="section level3" number="11.5.2">
<h3 number="11.5.2"><span class="header-section-number">11.5.2</span> Table of Prameter Estimates</h3>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lmer_week_RI_reml, </span>
<span id="cb542-2"><a href="#cb542-2"></a>                     fit_lmer_week_RIAS_reml),</span>
<span id="cb542-3"><a href="#cb542-3"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb542-4"><a href="#cb542-4"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Random Intercepts&quot;</span>,</span>
<span id="cb542-5"><a href="#cb542-5"></a>                                       <span class="st">&quot; And Random Slopes&quot;</span>),</span>
<span id="cb542-6"><a href="#cb542-6"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM: Null models fit w/REML&quot;</span>,</span>
<span id="cb542-7"><a href="#cb542-7"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb542-8"><a href="#cb542-8"></a>                <span class="dt">custom.note =</span> <span class="st">&quot;Hedeker table 4.4 on page 55 and table 4.5 on page 58, except using REML here instead of ML&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Null models fit w/REML
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Random Intercepts
</th>
<th style="padding-left: 5px;padding-right: 5px;">
And Random Slopes
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.55 (0.64)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.58 (0.55)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.38 (0.14)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.38 (0.21)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2294.73
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2231.92
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2310.43
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2255.48
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1143.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1109.96
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
66
</td>
<td style="padding-left: 5px;padding-right: 5px;">
66
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
16.45
</td>
<td style="padding-left: 5px;padding-right: 5px;">
12.94
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
19.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
12.21
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.13
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id (Intercept) week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.48
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
Hedeker table 4.4 on page 55 and table 4.5 on page 58, except using REML here instead of ML
</td>
</tr>
</tfoot>
</table>
<p>Visually, we can see that the unexplained or residual variance is less (12.21 vs 19.10) for the model that includes person-specific slopes (trajectories over time).</p>
<p>Note: the negative covariance between random intercepts and random slopes (<span class="math inline">\(\sigma_{u01} = \tau_{01} = -1.48\)</span>):</p>
<blockquote>
<p>“This suggests that patients who are initially more depressed (i.e. greater intercepts) improve at a greater rate (i.e. more pronounced negative slopes). An alternative explainatio, though,is that of a floor effect due to the HDRS rating scale. Simply put, patients with less depressed intitial scores have a more limited range of lower scores than those with higher initial scores.”</p>
<p><span class="citation">(Hedeker and Gibbons <a href="#ref-hedeker2006" role="doc-biblioref">2006</a>)</span>, page 58</p>
</blockquote>
</div>
<div id="likelihood-ratio-test" class="section level3" number="11.5.3">
<h3 number="11.5.3"><span class="header-section-number">11.5.3</span> Likelihood Ratio Test</h3>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1"></a><span class="kw">anova</span>(fit_lmer_week_RI_reml, fit_lmer_week_RIAS_reml, </span>
<span id="cb543-2"><a href="#cb543-2"></a>      <span class="dt">model.names =</span> <span class="kw">c</span>(<span class="st">&quot;RI&quot;</span>, <span class="st">&quot;RIAS&quot;</span>),</span>
<span id="cb543-3"><a href="#cb543-3"></a>      <span class="dt">refit =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb543-4"><a href="#cb543-4"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;LRT: Assess Significance of Random Slopes&quot;</span>)</span></code></pre></div>
<table>
<caption>LRT: Assess Significance of Random Slopes</caption>
<colgroup>
<col width="14%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="14%" />
<col width="10%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">npar</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>RI</strong></td>
<td align="center">4</td>
<td align="center">2295</td>
<td align="center">2310</td>
<td align="center">-1143</td>
<td align="center">2287</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>RIAS</strong></td>
<td align="center">6</td>
<td align="center">2232</td>
<td align="center">2255</td>
<td align="center">-1110</td>
<td align="center">2220</td>
<td align="center">67</td>
<td align="center">2</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Including the random slope for time significantly improved the model fit via the formal <strong>Likelihood Ratio Test</strong>. This rejects the assumption of compound symmetry.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(fit_lmer_week_RI_reml, </span>
<span id="cb544-2"><a href="#cb544-2"></a>                                 fit_lmer_week_RIAS_reml,</span>
<span id="cb544-3"><a href="#cb544-3"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model                   |            Type |     AIC |     BIC | R2_conditional | R2_marginal |  ICC | RMSE |       BF | Performance_Score
-----------------------------------------------------------------------------------------------------------------------------------------
fit_lmer_week_RIAS_reml | lmerModLmerTest | 2231.92 | 2255.48 |           0.77 |        0.30 | 0.67 | 2.99 | 8.58e+11 |            85.71%
fit_lmer_week_RI_reml   | lmerModLmerTest | 2294.73 | 2310.43 |           0.63 |        0.31 | 0.46 | 4.03 |     1.00 |            14.29%

Model fit_lmer_week_RIAS_reml (of class lmerModLmerTest) performed best with an overall performance score of 85.71%.</code></pre>
</div>
<div id="estimated-marginal-means-plot-1" class="section level3" number="11.5.4">
<h3 number="11.5.4"><span class="header-section-number">11.5.4</span> Estimated Marginal Means Plot</h3>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_lmer_week_RIAS_reml,</span>
<span id="cb546-2"><a href="#cb546-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>,</span>
<span id="cb546-3"><a href="#cb546-3"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;week&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-445-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Adding the random slopes didn’t change the estimates for the fixed effects much.</p>
</div>
<div id="estimated-marginal-means-and-emperical-bayes-plots-1" class="section level3" number="11.5.5">
<h3 number="11.5.5"><span class="header-section-number">11.5.5</span> Estimated Marginal Means and Emperical Bayes Plots</h3>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb547-2"><a href="#cb547-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_fixed =</span> <span class="kw">predict</span>(fit_lmer_week_RIAS_reml, <span class="dt">re.form =</span> <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># fixed effects only</span></span>
<span id="cb547-3"><a href="#cb547-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_wrand =</span> <span class="kw">predict</span>(fit_lmer_week_RIAS_reml)) <span class="op">%&gt;%</span><span class="st">               </span><span class="co"># fixed and random effects together</span></span>
<span id="cb547-4"><a href="#cb547-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb547-5"><a href="#cb547-5"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb547-6"><a href="#cb547-6"></a>             <span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb547-7"><a href="#cb547-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_wrand,</span>
<span id="cb547-8"><a href="#cb547-8"></a>                <span class="dt">color    =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb547-9"><a href="#cb547-9"></a>                <span class="dt">size     =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb547-10"><a href="#cb547-10"></a>                <span class="dt">linetype =</span> <span class="st">&quot;BLUP&quot;</span>)) <span class="op">+</span></span>
<span id="cb547-11"><a href="#cb547-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_fixed,</span>
<span id="cb547-12"><a href="#cb547-12"></a>                <span class="dt">color    =</span> <span class="st">&quot;Marginal&quot;</span>,</span>
<span id="cb547-13"><a href="#cb547-13"></a>                <span class="dt">size     =</span> <span class="st">&quot;Marginal&quot;</span>,</span>
<span id="cb547-14"><a href="#cb547-14"></a>                <span class="dt">linetype =</span> <span class="st">&quot;Marginal&quot;</span>)) <span class="op">+</span></span>
<span id="cb547-15"><a href="#cb547-15"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb547-16"><a href="#cb547-16"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name   =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb547-17"><a href="#cb547-17"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>     =<span class="st"> &quot;gray50&quot;</span>,</span>
<span id="cb547-18"><a href="#cb547-18"></a>                                <span class="st">&quot;Marginal&quot;</span> =<span class="st"> &quot;blue&quot;</span>))  <span class="op">+</span></span>
<span id="cb547-19"><a href="#cb547-19"></a><span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">name    =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb547-20"><a href="#cb547-20"></a>                    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>      =<span class="st"> </span><span class="fl">.5</span>,</span>
<span id="cb547-21"><a href="#cb547-21"></a>                                <span class="st">&quot;Marginal&quot;</span> =<span class="st"> </span><span class="fl">1.25</span>))  <span class="op">+</span></span>
<span id="cb547-22"><a href="#cb547-22"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">name   =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb547-23"><a href="#cb547-23"></a>                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>     =<span class="st"> &quot;longdash&quot;</span>,</span>
<span id="cb547-24"><a href="#cb547-24"></a>                                   <span class="st">&quot;Marginal&quot;</span> =<span class="st"> &quot;solid&quot;</span>))  <span class="op">+</span></span>
<span id="cb547-25"><a href="#cb547-25"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb547-26"><a href="#cb547-26"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">-0.1</span>),</span>
<span id="cb547-27"><a href="#cb547-27"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb547-28"><a href="#cb547-28"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb547-29"><a href="#cb547-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Weeks Since Baseline&quot;</span>,</span>
<span id="cb547-30"><a href="#cb547-30"></a>       <span class="dt">y =</span> <span class="st">&quot;Hamilton Depression Scores&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-446-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>BLUPs are also refered to as <strong>Empirical Bayes Estimates</strong> and may be extracted from a model fit. In this cases there will be a specific intercept (<code>(Intercept)</code>) and time slope (<code>week</code>) for each individual or person (<code>id</code>).</p>
<div id="fixed-effects-1" class="section level4" number="11.5.5.1">
<h4 number="11.5.5.1"><span class="header-section-number">11.5.5.1</span> Fixed Effects</h4>
<p>Marginal Model = within-subject effects</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1"></a><span class="kw">fixef</span>(fit_lmer_week_RIAS_reml)</span></code></pre></div>
<pre><code>(Intercept)        week 
  23.577044   -2.377047 </code></pre>
</div>
<div id="random-effects-1" class="section level4" number="11.5.5.2">
<h4 number="11.5.5.2"><span class="header-section-number">11.5.5.2</span> Random Effects</h4>
<p>between-subjects effects</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1"></a><span class="kw">ranef</span>(fit_lmer_week_RIAS_reml)<span class="op">$</span>id <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb550-2"><a href="#cb550-2"></a><span class="st">  </span><span class="kw">head</span>()                                 <span class="co"># only the first 6 participants</span></span></code></pre></div>
<pre><code>    (Intercept)       week
101   1.0572022 -2.1151378
103   3.6707900 -0.4832479
104   2.6727551 -1.5008819
105  -3.0413391  0.2264496
106   0.3154240  1.0254750
107  -0.6148994 -0.4297385</code></pre>
</div>
<div id="blups-or-empirical-bayes-estimates" class="section level4" number="11.5.5.3">
<h4 number="11.5.5.3"><span class="header-section-number">11.5.5.3</span> BLUPs or Empirical Bayes Estimates</h4>
<p>fixed effects + random effects</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1"></a><span class="kw">coef</span>(fit_lmer_week_RIAS_reml)<span class="op">$</span>id <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb552-2"><a href="#cb552-2"></a><span class="st">  </span><span class="kw">head</span>()                                 <span class="co"># only the first 6 participants</span></span></code></pre></div>
<pre><code>    (Intercept)      week
101    24.63425 -4.492185
103    27.24783 -2.860295
104    26.24980 -3.877929
105    20.53571 -2.150598
106    23.89247 -1.351572
107    22.96214 -2.806786</code></pre>
<p>We can create a scatterplot of these to see the correlation between them.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1"></a><span class="kw">coef</span>(fit_lmer_week_RIAS_reml)<span class="op">$</span>id <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb554-2"><a href="#cb554-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb554-3"><a href="#cb554-3"></a>             <span class="dt">y =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb554-4"><a href="#cb554-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb554-5"><a href="#cb554-5"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">fixef</span>(fit_lmer_week_RIAS_reml)[<span class="st">&quot;(Intercept)&quot;</span>],</span>
<span id="cb554-6"><a href="#cb554-6"></a>             <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb554-7"><a href="#cb554-7"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">fixef</span>(fit_lmer_week_RIAS_reml)[<span class="st">&quot;week&quot;</span>],</span>
<span id="cb554-8"><a href="#cb554-8"></a>             <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb554-9"><a href="#cb554-9"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb554-10"><a href="#cb554-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Hedeker&#39;s Figure 4.4 on page 59&quot;</span>,</span>
<span id="cb554-11"><a href="#cb554-11"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Reisby data: Estimated random effects&quot;</span>,</span>
<span id="cb554-12"><a href="#cb554-12"></a>       <span class="dt">x =</span> <span class="st">&quot;Week Change in Depression (SLOPE)&quot;</span>,</span>
<span id="cb554-13"><a href="#cb554-13"></a>       <span class="dt">y =</span> <span class="st">&quot;Baseline Depression Level (INTERCEPT)&quot;</span>) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-450-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="mlm-coding-of-time" class="section level2" number="11.6">
<h2 number="11.6"><span class="header-section-number">11.6</span> MLM: Coding of Time</h2>
<p>So far we have used the variable <code>week</code> to denote time as weeks since baseline = <code>week</code> <span class="math inline">\(\in 0, 1, 2, 3, 4, 5\)</span>.</p>
<p>But We could CENTER week at the middle of the study (week = 2.5).</p>
<div id="fit-the-model-15" class="section level3" number="11.6.1">
<h3 number="11.6.1"><span class="header-section-number">11.6.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1"></a>fit_lmer_week_RIAS_reml_wc &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(hamd <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(week<span class="fl">-2.5</span>) <span class="op">+</span><span class="st"> </span>(<span class="kw">I</span>(week<span class="fl">-2.5</span>)<span class="op">|</span>id), <span class="co">#     MLM-RIAS</span></span>
<span id="cb555-2"><a href="#cb555-2"></a>                                             <span class="dt">data =</span> data_long,</span>
<span id="cb555-3"><a href="#cb555-3"></a>                                             <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
<div id="table-of-parameter-estimates-2" class="section level3" number="11.6.2">
<h3 number="11.6.2"><span class="header-section-number">11.6.2</span> Table of Parameter Estimates</h3>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lmer_week_RIAS_reml, </span>
<span id="cb556-2"><a href="#cb556-2"></a>                     fit_lmer_week_RIAS_reml_wc),</span>
<span id="cb556-3"><a href="#cb556-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Random Intercepts&quot;</span>,</span>
<span id="cb556-4"><a href="#cb556-4"></a>                                       <span class="st">&quot; And Random Slopes&quot;</span>),</span>
<span id="cb556-5"><a href="#cb556-5"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb556-6"><a href="#cb556-6"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM: Null models fit w/REML&quot;</span>,</span>
<span id="cb556-7"><a href="#cb556-7"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb556-8"><a href="#cb556-8"></a>                <span class="dt">custom.note =</span> <span class="st">&quot;Hedeker table table 4.5 on page 58 and table 4.6 on page 61, except using REML here instead of ML&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: Null models fit w/REML
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Random Intercepts
</th>
<th style="padding-left: 5px;padding-right: 5px;">
And Random Slopes
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.58 (0.55)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
17.63 (0.56)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.38 (0.21)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
week - 2.5
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.38 (0.21)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2231.92
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2231.92
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2255.48
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2255.48
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1109.96
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1109.96
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
66
</td>
<td style="padding-left: 5px;padding-right: 5px;">
66
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
12.94
</td>
<td style="padding-left: 5px;padding-right: 5px;">
18.85
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.13
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id (Intercept) week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.48
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
12.21
</td>
<td style="padding-left: 5px;padding-right: 5px;">
12.21
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id I(week - 2.5)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.13
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id (Intercept) I(week - 2.5)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.84
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
Hedeker table table 4.5 on page 58 and table 4.6 on page 61, except using REML here instead of ML
</td>
</tr>
</tfoot>
</table>
<ul>
<li><p>Unchanged</p>
<ul>
<li>model fit: AIC, BIC, -2LL, residual variance<br />
</li>
<li>fixed effect of week<br />
</li>
<li>variance for random intercepts</li>
</ul></li>
<li><p>Changed</p>
<ul>
<li>fixed intercept<br />
</li>
<li>variance for random slopes<br />
</li>
<li>covariance between random intercepts and random slopes</li>
</ul></li>
</ul>
</div>
<div id="estimated-marginal-means-and-emperical-bayes-plots-2" class="section level3" number="11.6.3">
<h3 number="11.6.3"><span class="header-section-number">11.6.3</span> Estimated Marginal Means and Emperical Bayes Plots</h3>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-2"><a href="#cb557-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_fixed =</span> <span class="kw">predict</span>(fit_lmer_week_RIAS_reml_wc, <span class="dt">re.form =</span> <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># fixed effects only</span></span>
<span id="cb557-3"><a href="#cb557-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_wrand =</span> <span class="kw">predict</span>(fit_lmer_week_RIAS_reml_wc)) <span class="op">%&gt;%</span><span class="st">               </span><span class="co"># fixed and random effects together</span></span>
<span id="cb557-4"><a href="#cb557-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb557-5"><a href="#cb557-5"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb557-6"><a href="#cb557-6"></a>             <span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb557-7"><a href="#cb557-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_wrand,</span>
<span id="cb557-8"><a href="#cb557-8"></a>                <span class="dt">color    =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb557-9"><a href="#cb557-9"></a>                <span class="dt">size     =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb557-10"><a href="#cb557-10"></a>                <span class="dt">linetype =</span> <span class="st">&quot;BLUP&quot;</span>)) <span class="op">+</span></span>
<span id="cb557-11"><a href="#cb557-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_fixed,</span>
<span id="cb557-12"><a href="#cb557-12"></a>                <span class="dt">color    =</span> <span class="st">&quot;Marginal&quot;</span>,</span>
<span id="cb557-13"><a href="#cb557-13"></a>                <span class="dt">size     =</span> <span class="st">&quot;Marginal&quot;</span>,</span>
<span id="cb557-14"><a href="#cb557-14"></a>                <span class="dt">linetype =</span> <span class="st">&quot;Marginal&quot;</span>)) <span class="op">+</span></span>
<span id="cb557-15"><a href="#cb557-15"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb557-16"><a href="#cb557-16"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name   =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb557-17"><a href="#cb557-17"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>     =<span class="st"> &quot;gray50&quot;</span>,</span>
<span id="cb557-18"><a href="#cb557-18"></a>                                <span class="st">&quot;Marginal&quot;</span> =<span class="st"> &quot;blue&quot;</span>))  <span class="op">+</span></span>
<span id="cb557-19"><a href="#cb557-19"></a><span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">name    =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb557-20"><a href="#cb557-20"></a>                    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>      =<span class="st"> </span><span class="fl">.5</span>,</span>
<span id="cb557-21"><a href="#cb557-21"></a>                                <span class="st">&quot;Marginal&quot;</span> =<span class="st"> </span><span class="fl">1.25</span>))  <span class="op">+</span></span>
<span id="cb557-22"><a href="#cb557-22"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">name   =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb557-23"><a href="#cb557-23"></a>                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>     =<span class="st"> &quot;longdash&quot;</span>,</span>
<span id="cb557-24"><a href="#cb557-24"></a>                                   <span class="st">&quot;Marginal&quot;</span> =<span class="st"> &quot;solid&quot;</span>))  <span class="op">+</span></span>
<span id="cb557-25"><a href="#cb557-25"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb557-26"><a href="#cb557-26"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">-0.1</span>),</span>
<span id="cb557-27"><a href="#cb557-27"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb557-28"><a href="#cb557-28"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb557-29"><a href="#cb557-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Weeks Centered at Mid-study&quot;</span>,</span>
<span id="cb557-30"><a href="#cb557-30"></a>       <span class="dt">y =</span> <span class="st">&quot;Hamilton Depression Scores&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-452-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Again, centering time doesn’t change the interpretation at all, since there are no interactions.</strong></p>
</div>
</div>
<div id="mlm-effect-of-diagnosis-on-time-trends-fixed-interaction" class="section level2" number="11.7">
<h2 number="11.7"><span class="header-section-number">11.7</span> MLM: Effect of DIagnosis on Time Trends (Fixed Interaction)</h2>
<p>The researcher specifically wants to know if the trajectory over time differs for the two types of depression. This translates into a fixed effects interaction between time and group.</p>
<blockquote>
<p>Start by comapring random intercepts only (RI) to a random intercetps and slopes (RIAS) model.</p>
</blockquote>
<div id="fit-the-models-1" class="section level3" number="11.7.1">
<h3 number="11.7.1"><span class="header-section-number">11.7.1</span> Fit the Models</h3>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1"></a>fit_lmer_week_RIAS_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(hamd <span class="op">~</span><span class="st"> </span>week <span class="op">+</span><span class="st"> </span>(week<span class="op">|</span>id), </span>
<span id="cb558-2"><a href="#cb558-2"></a>                                        <span class="dt">data =</span> data_long,</span>
<span id="cb558-3"><a href="#cb558-3"></a>                                        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb558-4"><a href="#cb558-4"></a></span>
<span id="cb558-5"><a href="#cb558-5"></a>fit_lmer_wkdx_RIAS_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(hamd <span class="op">~</span><span class="st"> </span>week<span class="op">*</span>endog <span class="op">+</span><span class="st"> </span>(week<span class="op">|</span>id), </span>
<span id="cb558-6"><a href="#cb558-6"></a>                                        <span class="dt">data =</span> data_long,</span>
<span id="cb558-7"><a href="#cb558-7"></a>                                        <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="estimated-marginal-meanse-plot" class="section level3" number="11.7.2">
<h3 number="11.7.2"><span class="header-section-number">11.7.2</span> Estimated Marginal Meanse Plot</h3>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_lmer_wkdx_RIAS_ml,</span>
<span id="cb559-2"><a href="#cb559-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>,</span>
<span id="cb559-3"><a href="#cb559-3"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;week&quot;</span>, <span class="st">&quot;endog&quot;</span>),</span>
<span id="cb559-4"><a href="#cb559-4"></a>                   <span class="dt">title =</span> <span class="st">&quot;Hedeker&#39;s Table 4.7 on page 64&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-454-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(fit_lmer_wkdx_RIAS_ml,</span>
<span id="cb560-2"><a href="#cb560-2"></a>                            <span class="dt">pred =</span> week,</span>
<span id="cb560-3"><a href="#cb560-3"></a>                            <span class="dt">modx =</span> endog,</span>
<span id="cb560-4"><a href="#cb560-4"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>,</span>
<span id="cb560-5"><a href="#cb560-5"></a>                   <span class="dt">main.title =</span> <span class="st">&quot;Hedeker&#39;s Table 4.7 on page 64&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-455-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="likelihood-ratio-test-1" class="section level3" number="11.7.3">
<h3 number="11.7.3"><span class="header-section-number">11.7.3</span> Likelihood Ratio Test</h3>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1"></a><span class="kw">anova</span>(fit_lmer_week_RIAS_ml, </span>
<span id="cb561-2"><a href="#cb561-2"></a>      fit_lmer_wkdx_RIAS_ml, </span>
<span id="cb561-3"><a href="#cb561-3"></a>      <span class="dt">model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Just Time&quot;</span>, </span>
<span id="cb561-4"><a href="#cb561-4"></a>                      <span class="st">&quot;Time X Dx&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb561-5"><a href="#cb561-5"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;LRT: Assess Significance of Diagnosis Moderation of Trend&quot;</span>)</span></code></pre></div>
<table>
<caption>LRT: Assess Significance of Diagnosis Moderation of Trend</caption>
<colgroup>
<col width="19%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="6%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">npar</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Just Time</strong></td>
<td align="center">6</td>
<td align="center">2231</td>
<td align="center">2255</td>
<td align="center">-1110</td>
<td align="center">2219</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>Time X Dx</strong></td>
<td align="center">8</td>
<td align="center">2231</td>
<td align="center">2262</td>
<td align="center">-1107</td>
<td align="center">2215</td>
<td align="center">4.1</td>
<td align="center">2</td>
<td align="center">0.13</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(fit_lmer_week_RIAS_ml, </span>
<span id="cb562-2"><a href="#cb562-2"></a>                                 fit_lmer_wkdx_RIAS_ml,</span>
<span id="cb562-3"><a href="#cb562-3"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model                 |            Type |     AIC |     BIC | R2_conditional | R2_marginal |  ICC | RMSE |   BF | Performance_Score
-----------------------------------------------------------------------------------------------------------------------------------
fit_lmer_week_RIAS_ml | lmerModLmerTest | 2231.04 | 2254.60 |           0.77 |        0.30 | 0.66 | 3.00 | 1.00 |            57.14%
fit_lmer_wkdx_RIAS_ml | lmerModLmerTest | 2230.93 | 2262.34 |           0.77 |        0.32 | 0.66 | 3.00 | 0.02 |            42.86%

Model fit_lmer_week_RIAS_ml (of class lmerModLmerTest) performed best with an overall performance score of 57.14%.</code></pre>
<p>The more complicated model (including the moderating effect of diagnosis) is <strong>NOT</strong> supported.</p>
</div>
</div>
<div id="mlm-quadratic-trend" class="section level2" number="11.8">
<h2 number="11.8"><span class="header-section-number">11.8</span> MLM: Quadratic Trend</h2>
<div id="fit-the-model-16" class="section level3" number="11.8.1">
<h3 number="11.8.1"><span class="header-section-number">11.8.1</span> Fit the Model</h3>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1"></a>fit_lmer_quad_RIAS_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(hamd <span class="op">~</span><span class="st"> </span>week <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(week<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(week <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(week<span class="op">^</span><span class="dv">2</span>)<span class="op">|</span>id), </span>
<span id="cb564-2"><a href="#cb564-2"></a>                                        <span class="dt">data =</span> data_long,</span>
<span id="cb564-3"><a href="#cb564-3"></a>                                        <span class="dt">REML =</span> <span class="ot">FALSE</span>,</span>
<span id="cb564-4"><a href="#cb564-4"></a>                                        <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>,    <span class="co"># get it to converge</span></span>
<span id="cb564-5"><a href="#cb564-5"></a>                                                 <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb564-6"><a href="#cb564-6"></a>                                                 <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,</span>
<span id="cb564-7"><a href="#cb564-7"></a>                                                                <span class="dt">starttests =</span> <span class="ot">FALSE</span>,</span>
<span id="cb564-8"><a href="#cb564-8"></a>                                                                <span class="dt">kkt =</span> <span class="ot">FALSE</span>))) </span></code></pre></div>
</div>
<div id="table-of-parameter-estimates-3" class="section level3" number="11.8.2">
<h3 number="11.8.2"><span class="header-section-number">11.8.2</span> Table of Parameter Estimates</h3>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lmer_week_RIAS_ml,</span>
<span id="cb565-2"><a href="#cb565-2"></a>                     fit_lmer_quad_RIAS_ml),</span>
<span id="cb565-3"><a href="#cb565-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Linear Trend&quot;</span>,</span>
<span id="cb565-4"><a href="#cb565-4"></a>                                       <span class="st">&quot;QUadratic Trend&quot;</span>),</span>
<span id="cb565-5"><a href="#cb565-5"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb565-6"><a href="#cb565-6"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM: RIAS models fit w/ML&quot;</span>,</span>
<span id="cb565-7"><a href="#cb565-7"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb565-8"><a href="#cb565-8"></a>                <span class="dt">custom.note =</span> <span class="st">&quot;Hedeker table 4.5 on page 58 and table 5.1 on page 84&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM: RIAS models fit w/ML
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Linear Trend
</th>
<th style="padding-left: 5px;padding-right: 5px;">
QUadratic Trend
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.58 (0.55)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.76 (0.55)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.38 (0.21)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.63 (0.48)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
week^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05 (0.09)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2231.04
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2227.65
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2254.60
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2266.92
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1109.52
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1103.82
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
<td style="padding-left: 5px;padding-right: 5px;">
375
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
66
</td>
<td style="padding-left: 5px;padding-right: 5px;">
66
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
12.63
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.44
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.08
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.64
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id (Intercept) week
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.42
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.92
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
12.22
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.52
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id I(week^2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.19
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id (Intercept) I(week^2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.11
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id week I(week^2)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.94
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
Hedeker table 4.5 on page 58 and table 5.1 on page 84
</td>
</tr>
</tfoot>
</table>
</div>
<div id="likelihood-ratio-test-2" class="section level3" number="11.8.3">
<h3 number="11.8.3"><span class="header-section-number">11.8.3</span> Likelihood Ratio Test</h3>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1"></a><span class="kw">anova</span>(fit_lmer_week_RIAS_ml, fit_lmer_quad_RIAS_ml)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_lmer_week_RIAS_ml: hamd ~ week + (week | id)
fit_lmer_quad_RIAS_ml: hamd ~ week + I(week^2) + (week + I(week^2) | id)
                      npar    AIC    BIC  logLik deviance Chisq Df Pr(&gt;Chisq)  
fit_lmer_week_RIAS_ml    6 2231.0 2254.6 -1109.5   2219.0                      
fit_lmer_quad_RIAS_ml   10 2227.7 2266.9 -1103.8   2207.7 11.39  4    0.02252 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(fit_lmer_week_RIAS_ml, </span>
<span id="cb568-2"><a href="#cb568-2"></a>                                 fit_lmer_quad_RIAS_ml,</span>
<span id="cb568-3"><a href="#cb568-3"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model                 |            Type |     AIC |     BIC | R2_conditional | R2_marginal |  ICC | RMSE |       BF | Performance_Score
---------------------------------------------------------------------------------------------------------------------------------------
fit_lmer_quad_RIAS_ml | lmerModLmerTest | 2227.65 | 2266.92 |           0.80 |        0.31 | 0.71 | 2.66 | 2.00e-03 |            71.43%
fit_lmer_week_RIAS_ml | lmerModLmerTest | 2231.04 | 2254.60 |           0.77 |        0.30 | 0.66 | 3.00 |     1.00 |            28.57%

Model fit_lmer_quad_RIAS_ml (of class lmerModLmerTest) performed best with an overall performance score of 71.43%.</code></pre>
<p>Even though the Wald test did not find the quadratic fixed time trend to be significant at the population level (marginal), the LRT and Bayes Factor both find that including the quadratic terms improves the model’s fit.</p>
</div>
<div id="estimated-marginal-means-plot-2" class="section level3" number="11.8.4">
<h3 number="11.8.4"><span class="header-section-number">11.8.4</span> Estimated Marginal Means Plot</h3>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1"></a><span class="kw">fixef</span>(fit_lmer_quad_RIAS_ml)</span></code></pre></div>
<pre><code>(Intercept)        week   I(week^2) 
23.76024938 -2.63257557  0.05148119 </code></pre>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_lmer_quad_RIAS_ml,</span>
<span id="cb572-2"><a href="#cb572-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>,</span>
<span id="cb572-3"><a href="#cb572-3"></a>                   <span class="dt">terms =</span> <span class="st">&quot;week&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-462-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>At the population level, the curviture is very slight.</p>
</div>
<div id="blups-or-emperical-bayes-estimates" class="section level3" number="11.8.5">
<h3 number="11.8.5"><span class="header-section-number">11.8.5</span> BLUPs or Emperical Bayes Estimates</h3>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1"></a><span class="kw">coef</span>(fit_lmer_quad_RIAS_ml)<span class="op">$</span>id</span></code></pre></div>
<pre><code>    (Intercept)        week    I(week^2)
101    25.16569 -5.28321274  0.150799049
103    27.50746 -3.43492685  0.119894308
104    25.99802 -3.09403220 -0.176873997
105    21.01143 -2.95260319  0.164660643
106    23.64346 -0.74433940 -0.141869978
107    22.70272 -1.98456348 -0.179103137
108    22.40954 -4.72427493  0.316018469
113    22.70934 -0.40480496 -0.023812535
114    21.71498 -4.51594078  0.305503405
115    21.54597 -2.55734711  0.139467470
117    20.68538 -3.87700334  0.196725944
118    25.37072 -2.57668879 -0.047612261
120    21.54365 -2.02855401  0.175310324
121    22.58018 -1.75376282 -0.038804046
123    19.25421 -2.87312661  0.017543317
302    21.58631 -3.89089089  0.294415194
303    22.46073 -3.40753283  0.044347316
304    24.67540 -0.37917632 -0.166163633
305    21.27401 -3.68029688 -0.010284413
308    23.09149 -2.47011655  0.005956911
309    22.90664 -1.55838154 -0.062498266
310    23.05813 -5.82989567  0.392498759
311    21.32624 -1.62725289  0.056408411
312    20.97725 -0.80436212 -0.285841299
313    21.61301 -4.45108720  0.355814736
315    25.23222 -4.58344175  0.080216390
316    27.75571 -1.45599536  0.069629194
318    20.56470 -0.29406697 -0.235307410
319    22.38191 -4.51711797  0.466348190
322    24.93395  1.26790727 -0.042515811
327    19.82906 -3.17595912  0.466784077
328    23.74556  1.29272214 -0.129017385
331    21.92610 -1.83149657 -0.074415014
333    23.11844 -0.64673127 -0.127986350
334    27.19415 -6.33066088  0.497611422
335    22.72436 -2.57422751  0.010287828
337    25.62004 -2.06605958 -0.118351131
338    22.89845 -0.54280182 -0.095536471
339    24.27806 -4.99289850  0.444971598
344    22.43029 -4.34889939  0.557803994
345    27.22531 -1.03851064 -0.044992804
346    24.66105 -2.09385875  0.138720593
347    20.11424 -3.85553990  0.239871885
348    23.42449 -4.05934442  0.152401836
349    20.49506 -3.30476511  0.269602454
350    23.29831 -3.86555456  0.351771642
351    27.85602 -2.54762666 -0.174397992
352    21.86126 -2.47215571  0.305549622
353    25.44900 -1.25790306 -0.261971169
354    26.94737  0.07804000 -0.289825237
355    24.47061 -2.72958018 -0.141017727
357    25.37351 -0.82942934 -0.114172172
360    24.04647  1.73527093 -0.131111740
361    25.48490 -7.37197958  0.953495090
501    27.83194 -1.46847900 -0.003541479
502    22.99363 -4.51402588  0.038610537
504    20.80202 -2.67923396  0.167676114
505    20.96546 -6.31343010  0.490342913
507    26.25982  0.08284416 -0.277546432
603    25.55712 -3.23921265  0.099755025
604    26.04325 -6.06911890  0.284969099
606    24.47426 -3.73161731 -0.178377098
607    31.08954  1.15554696 -1.091094936
608    23.46558 -4.87963362  0.180136220
609    25.91657 -2.23143606 -0.347100179
610    30.62473 -0.54535315 -0.593019408</code></pre>
<p>For Illustration, two cases have been hand selected: <code>id</code> = 115 and 610.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1"></a>fun_<span class="dv">115</span> &lt;-<span class="st"> </span><span class="cf">function</span>(week){</span>
<span id="cb575-2"><a href="#cb575-2"></a>  <span class="kw">coef</span>(fit_lmer_quad_RIAS_ml)<span class="op">$</span>id[<span class="st">&quot;115&quot;</span>, <span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span></span>
<span id="cb575-3"><a href="#cb575-3"></a><span class="st">  </span><span class="kw">coef</span>(fit_lmer_quad_RIAS_ml)<span class="op">$</span>id[<span class="st">&quot;115&quot;</span>, <span class="st">&quot;week&quot;</span>] <span class="op">*</span><span class="st"> </span>week <span class="op">+</span></span>
<span id="cb575-4"><a href="#cb575-4"></a><span class="st">  </span><span class="kw">coef</span>(fit_lmer_quad_RIAS_ml)<span class="op">$</span>id[<span class="st">&quot;115&quot;</span>, <span class="st">&quot;I(week^2)&quot;</span>] <span class="op">*</span><span class="st"> </span>week<span class="op">^</span><span class="dv">2</span></span>
<span id="cb575-5"><a href="#cb575-5"></a>}</span>
<span id="cb575-6"><a href="#cb575-6"></a></span>
<span id="cb575-7"><a href="#cb575-7"></a></span>
<span id="cb575-8"><a href="#cb575-8"></a>fun_<span class="dv">610</span> &lt;-<span class="st"> </span><span class="cf">function</span>(week){</span>
<span id="cb575-9"><a href="#cb575-9"></a>  <span class="kw">coef</span>(fit_lmer_quad_RIAS_ml)<span class="op">$</span>id[<span class="st">&quot;610&quot;</span>, <span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span></span>
<span id="cb575-10"><a href="#cb575-10"></a><span class="st">  </span><span class="kw">coef</span>(fit_lmer_quad_RIAS_ml)<span class="op">$</span>id[<span class="st">&quot;610&quot;</span>, <span class="st">&quot;week&quot;</span>] <span class="op">*</span><span class="st"> </span>week <span class="op">+</span></span>
<span id="cb575-11"><a href="#cb575-11"></a><span class="st">  </span><span class="kw">coef</span>(fit_lmer_quad_RIAS_ml)<span class="op">$</span>id[<span class="st">&quot;610&quot;</span>, <span class="st">&quot;I(week^2)&quot;</span>] <span class="op">*</span><span class="st"> </span>week<span class="op">^</span><span class="dv">2</span></span>
<span id="cb575-12"><a href="#cb575-12"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb576-2"><a href="#cb576-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_fixed =</span> <span class="kw">predict</span>(fit_lmer_quad_RIAS_ml, <span class="dt">re.form =</span> <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># fixed effects only</span></span>
<span id="cb576-3"><a href="#cb576-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_wrand =</span> <span class="kw">predict</span>(fit_lmer_quad_RIAS_ml)) <span class="op">%&gt;%</span><span class="st">               </span><span class="co"># fixed and random effects together</span></span>
<span id="cb576-4"><a href="#cb576-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb576-5"><a href="#cb576-5"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb576-6"><a href="#cb576-6"></a>             <span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb576-7"><a href="#cb576-7"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> fun_<span class="dv">115</span>) <span class="op">+</span><span class="st">          </span><span class="co"># add cure for ID = 115</span></span>
<span id="cb576-8"><a href="#cb576-8"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> fun_<span class="dv">610</span>) <span class="op">+</span><span class="st">          </span><span class="co"># add cure for ID = 610</span></span>
<span id="cb576-9"><a href="#cb576-9"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_fixed),</span>
<span id="cb576-10"><a href="#cb576-10"></a>                <span class="dt">color    =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb576-11"><a href="#cb576-11"></a>                <span class="dt">size     =</span> <span class="fl">1.25</span>)  <span class="op">+</span></span>
<span id="cb576-12"><a href="#cb576-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb576-13"><a href="#cb576-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb576-14"><a href="#cb576-14"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">-0.1</span>),</span>
<span id="cb576-15"><a href="#cb576-15"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb576-16"><a href="#cb576-16"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb576-17"><a href="#cb576-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Weeks Since Baseline&quot;</span>,</span>
<span id="cb576-18"><a href="#cb576-18"></a>       <span class="dt">y =</span> <span class="st">&quot;Hamilton Depression Scores&quot;</span>,</span>
<span id="cb576-19"><a href="#cb576-19"></a>       <span class="dt">title =</span> <span class="st">&quot;Similar to Hedeker&#39;s Figure 5.3 on page 84&quot;</span>,</span>
<span id="cb576-20"><a href="#cb576-20"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Marginal Mean show in thicker blue</span><span class="ch">\n</span><span class="st">BLUPs for two of the participant in thinner black&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/unnamed-chunk-465-1.png" alt="Two Example BLUPS for two different participants" width="576" />
<p class="caption">
(#fig:unnamed-chunk-465)Two Example BLUPS for two different participants
</p>
</div>
<p>These two individuals have quite different curvitures and illustrated how this type of curvatures in person-specific trajectories may end up cancelling each other out to arive at a fairly linear marginal model.</p>
</div>
<div id="estimated-marginal-means-and-emperical-bayes-plots-3" class="section level3" number="11.8.6">
<h3 number="11.8.6"><span class="header-section-number">11.8.6</span> Estimated Marginal Means and Emperical Bayes Plots</h3>
<p>Note: although the BLUPs are shown for all participants, the predictions are just connects and are therefore slightly jagged and now smoother like the lines on the plot above.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb577-2"><a href="#cb577-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_fixed =</span> <span class="kw">predict</span>(fit_lmer_quad_RIAS_ml, <span class="dt">re.form =</span> <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># fixed effects only</span></span>
<span id="cb577-3"><a href="#cb577-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">pred_wrand =</span> <span class="kw">predict</span>(fit_lmer_quad_RIAS_ml)) <span class="op">%&gt;%</span><span class="st">               </span><span class="co"># fixed and random effects together</span></span>
<span id="cb577-4"><a href="#cb577-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> week,</span>
<span id="cb577-5"><a href="#cb577-5"></a>             <span class="dt">y =</span> hamd,</span>
<span id="cb577-6"><a href="#cb577-6"></a>             <span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb577-7"><a href="#cb577-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_wrand,</span>
<span id="cb577-8"><a href="#cb577-8"></a>                <span class="dt">color    =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb577-9"><a href="#cb577-9"></a>                <span class="dt">size     =</span> <span class="st">&quot;BLUP&quot;</span>,</span>
<span id="cb577-10"><a href="#cb577-10"></a>                <span class="dt">linetype =</span> <span class="st">&quot;BLUP&quot;</span>)) <span class="op">+</span></span>
<span id="cb577-11"><a href="#cb577-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y        =</span> pred_fixed,</span>
<span id="cb577-12"><a href="#cb577-12"></a>                <span class="dt">color    =</span> <span class="st">&quot;Marginal&quot;</span>,</span>
<span id="cb577-13"><a href="#cb577-13"></a>                <span class="dt">size     =</span> <span class="st">&quot;Marginal&quot;</span>,</span>
<span id="cb577-14"><a href="#cb577-14"></a>                <span class="dt">linetype =</span> <span class="st">&quot;Marginal&quot;</span>)) <span class="op">+</span></span>
<span id="cb577-15"><a href="#cb577-15"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb577-16"><a href="#cb577-16"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name   =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb577-17"><a href="#cb577-17"></a>                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>     =<span class="st"> &quot;gray50&quot;</span>,</span>
<span id="cb577-18"><a href="#cb577-18"></a>                                <span class="st">&quot;Marginal&quot;</span> =<span class="st"> &quot;blue&quot;</span>))  <span class="op">+</span></span>
<span id="cb577-19"><a href="#cb577-19"></a><span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">name    =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb577-20"><a href="#cb577-20"></a>                    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>      =<span class="st"> </span><span class="fl">.5</span>,</span>
<span id="cb577-21"><a href="#cb577-21"></a>                                <span class="st">&quot;Marginal&quot;</span> =<span class="st"> </span><span class="fl">1.25</span>))  <span class="op">+</span></span>
<span id="cb577-22"><a href="#cb577-22"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">name   =</span> <span class="st">&quot;Type of Prediction&quot;</span>,</span>
<span id="cb577-23"><a href="#cb577-23"></a>                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;BLUP&quot;</span>     =<span class="st"> &quot;longdash&quot;</span>,</span>
<span id="cb577-24"><a href="#cb577-24"></a>                                   <span class="st">&quot;Marginal&quot;</span> =<span class="st"> &quot;solid&quot;</span>))  <span class="op">+</span></span>
<span id="cb577-25"><a href="#cb577-25"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb577-26"><a href="#cb577-26"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">-0.1</span>),</span>
<span id="cb577-27"><a href="#cb577-27"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb577-28"><a href="#cb577-28"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb577-29"><a href="#cb577-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Weeks Since Baseline&quot;</span>,</span>
<span id="cb577-30"><a href="#cb577-30"></a>       <span class="dt">y =</span> <span class="st">&quot;Hamilton Depression Scores&quot;</span>,</span>
<span id="cb577-31"><a href="#cb577-31"></a>       <span class="dt">title =</span> <span class="st">&quot;Hedeker&#39;s Figure 5.4 on page 85&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/unnamed-chunk-466-1.png" alt="EStimated curvilinear trends" width="576" />
<p class="caption">
(#fig:unnamed-chunk-466)EStimated curvilinear trends
</p>
</div>
<p>At the person-level, the curviture is very diverse (heterogeneous). Some individuals have accelerating downward tend while other have accelerating upward trends.</p>
<p>The improvement that the curvi-linear model provides in describing change across time is perhaps modest.</p>
<!--chapter:end:12-example_hedeker4_reisby.Rmd-->
</div>
</div>
</div>
<div id="mlm-longitudinal-hox-ch-5---student-gpa" class="section level1" number="12">
<h1 number="12"><span class="header-section-number">12</span> MLM, Longitudinal: Hox ch 5 - student GPA</h1>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb578-2"><a href="#cb578-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb578-3"><a href="#cb578-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice Table1() descriptives</span></span>
<span id="cb578-4"><a href="#cb578-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb578-5"><a href="#cb578-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb578-6"><a href="#cb578-6"></a><span class="kw">library</span>(sjstats)      <span class="co"># ICC calculations</span></span>
<span id="cb578-7"><a href="#cb578-7"></a><span class="kw">library</span>(sjPlot)       <span class="co"># Visualization for Models</span></span>
<span id="cb578-8"><a href="#cb578-8"></a><span class="kw">library</span>(effects)      <span class="co"># Effect displays for Models</span></span>
<span id="cb578-9"><a href="#cb578-9"></a></span>
<span id="cb578-10"><a href="#cb578-10"></a><span class="kw">library</span>(lme4)         <span class="co"># non-linear mixed-effects models</span></span>
<span id="cb578-11"><a href="#cb578-11"></a></span>
<span id="cb578-12"><a href="#cb578-12"></a><span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span></span></code></pre></div>
<div id="background-6" class="section level2" number="12.1">
<h2 number="12.1"><span class="header-section-number">12.1</span> Background</h2>
<div class="rmdlink">
<p>
The text <strong>“Multilevel Analysis: Techniques and Applications, Third Edition”</strong> <span class="citation"><span class="citation">(Hox, Moerbeek, and Van de Schoot <a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span></span> has a companion <a href="https://multilevel-analysis.sites.uu.nl/">website</a> which includes links to all the data files used throughout the book (housed on the <a href="https://github.com/MultiLevelAnalysis">book’s GitHub repository</a>).
</p>
</div>
<p>The following example is used through out <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>’s chapater 5.</p>
<p>The GPA for 200 college students were followed for 6 consecutive semesters (simulated). Job status was also measured as number of hours worked for the same size occations. Time-invariant covariates are the student’s gender and high school GPA. The variable <code>admitted</code> will not be used.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1"></a>data_raw &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_sav</span>(<span class="st">&quot;https://github.com/MultiLevelAnalysis/Datasets-third-edition-Multilevel-book/raw/master/chapter%205/GPA2/gpa2long.sav&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb579-2"><a href="#cb579-2"></a><span class="st">  </span>haven<span class="op">::</span><span class="kw">as_factor</span>()             <span class="co"># retain the labels from SPSS --&gt; factor</span></span>
<span id="cb579-3"><a href="#cb579-3"></a></span>
<span id="cb579-4"><a href="#cb579-4"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(data_raw) </span></code></pre></div>
<pre><code>Rows: 1,200
Columns: 7
$ student  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4...
$ occas    &lt;fct&gt; year 1 semester 1, year 1 semester 2, year 2 semester 1, y...
$ gpa      &lt;dbl&gt; 2.3, 2.1, 3.0, 3.0, 3.0, 3.3, 2.2, 2.5, 2.6, 2.6, 3.0, 2.8...
$ job      &lt;fct&gt; 2 hours, 2 hours, 2 hours, 2 hours, 2 hours, 2 hours, 2 ho...
$ sex      &lt;fct&gt; female, female, female, female, female, female, male, male...
$ highgpa  &lt;dbl&gt; 2.8, 2.8, 2.8, 2.8, 2.8, 2.8, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5...
$ admitted &lt;fct&gt; yes, yes, yes, yes, yes, yes, no, no, no, no, no, no, yes,...</code></pre>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1"></a>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb581-2"><a href="#cb581-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(occas, job) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb581-3"><a href="#cb581-3"></a><span class="st">  </span><span class="kw">table</span>(<span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>                   job
occas               no job 1 hour 2 hours 3 hours 4 or more hours &lt;NA&gt;
  year 1 semester 1      0      0     172      28               0    0
  year 1 semester 2      0      0     169      31               0    0
  year 2 semester 1      0      7     159      34               0    0
  year 2 semester 2      0      5     169      26               0    0
  year 3 semester 1      0     18     150      32               0    0
  year 3 semester 2      0     22     148      30               0    0
  &lt;NA&gt;                   0      0       0       0               0    0</code></pre>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="#cb583-1"></a>data_long &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb583-2"><a href="#cb583-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">student =</span> <span class="kw">factor</span>(student)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb583-3"><a href="#cb583-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sem =</span> <span class="kw">case_when</span>(occas <span class="op">==</span><span class="st"> &quot;year 1 semester 1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb583-4"><a href="#cb583-4"></a>                                occas <span class="op">==</span><span class="st"> &quot;year 1 semester 2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb583-5"><a href="#cb583-5"></a>                                occas <span class="op">==</span><span class="st"> &quot;year 2 semester 1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb583-6"><a href="#cb583-6"></a>                                occas <span class="op">==</span><span class="st"> &quot;year 2 semester 2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,</span>
<span id="cb583-7"><a href="#cb583-7"></a>                                occas <span class="op">==</span><span class="st"> &quot;year 3 semester 1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb583-8"><a href="#cb583-8"></a>                                occas <span class="op">==</span><span class="st"> &quot;year 3 semester 2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb583-9"><a href="#cb583-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">job =</span> <span class="kw">fct_drop</span>(job)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb583-10"><a href="#cb583-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">hrs =</span> <span class="kw">case_when</span>(job <span class="op">==</span><span class="st"> &quot;no job&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb583-11"><a href="#cb583-11"></a>                                job <span class="op">==</span><span class="st"> &quot;1 hour&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb583-12"><a href="#cb583-12"></a>                                job <span class="op">==</span><span class="st"> &quot;2 hours&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb583-13"><a href="#cb583-13"></a>                                job <span class="op">==</span><span class="st"> &quot;3 hours&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb583-14"><a href="#cb583-14"></a>                                job <span class="op">==</span><span class="st"> &quot;4 or more hours&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb583-15"><a href="#cb583-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(student, sex, highgpa, sem, job, hrs, gpa) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb583-16"><a href="#cb583-16"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(student, sem)</span>
<span id="cb583-17"><a href="#cb583-17"></a></span>
<span id="cb583-18"><a href="#cb583-18"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_long, <span class="dt">top =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>   student    sex highgpa sem     job hrs gpa
1        1 female     2.8   1 2 hours   2 2.3
2        1 female     2.8   2 2 hours   2 2.1
3        1 female     2.8   3 2 hours   2   3
4        1 female     2.8   4 2 hours   2   3
5        1 female     2.8   5 2 hours   2   3
6        1 female     2.8   6 2 hours   2 3.3
7        2   male     2.5   1 2 hours   2 2.2
8        2   male     2.5   2 3 hours   3 2.5
9        2   male     2.5   3 2 hours   2 2.6
10       2   male     2.5   4 2 hours   2 2.6
11    &lt;NA&gt;   &lt;NA&gt;     ... ...    &lt;NA&gt; ... ...
12     200   male     3.4   3 2 hours   2 3.4
13     200   male     3.4   4 2 hours   2 3.5
14     200   male     3.4   5  1 hour   1 3.3
15     200   male     3.4   6  1 hour   1 3.4</code></pre>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1"></a>data_wide &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb585-2"><a href="#cb585-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> sem,</span>
<span id="cb585-3"><a href="#cb585-3"></a>                     <span class="dt">values_from =</span> <span class="kw">c</span>(job, hrs, gpa),</span>
<span id="cb585-4"><a href="#cb585-4"></a>                     <span class="dt">names_sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb585-5"><a href="#cb585-5"></a></span>
<span id="cb585-6"><a href="#cb585-6"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_wide)</span></code></pre></div>
<pre><code>  student    sex highgpa   job_1   job_2   job_3   job_4   job_5   job_6 hrs_1
1       1 female     2.8 2 hours 2 hours 2 hours 2 hours 2 hours 2 hours     2
2       2   male     2.5 2 hours 3 hours 2 hours 2 hours 2 hours 2 hours     2
3       3 female     2.5 2 hours 2 hours 2 hours 3 hours 2 hours 2 hours     2
4       4   male     3.8 3 hours 2 hours 2 hours 2 hours 2 hours 2 hours     3
5    &lt;NA&gt;   &lt;NA&gt;     ...    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   ...
6     197 female     2.1 2 hours 2 hours 3 hours 2 hours 2 hours 2 hours     2
7     198   male       4 2 hours 2 hours 2 hours 2 hours  1 hour 2 hours     2
8     199 female     2.3 2 hours 2 hours 3 hours 2 hours 2 hours 3 hours     2
9     200   male     3.4 2 hours 2 hours 2 hours 2 hours  1 hour  1 hour     2
  hrs_2 hrs_3 hrs_4 hrs_5 hrs_6 gpa_1 gpa_2 gpa_3 gpa_4 gpa_5 gpa_6
1     2     2     2     2     2   2.3   2.1     3     3     3   3.3
2     3     2     2     2     2   2.2   2.5   2.6   2.6     3   2.8
3     2     2     3     2     2   2.4   2.9     3   2.8   3.3   3.4
4     2     2     2     2     2   2.5   2.7   2.4   2.7   2.9   2.7
5   ...   ...   ...   ...   ...   ...   ...   ...   ...   ...   ...
6     2     3     2     2     2   2.9   2.5   2.8   3.2   3.3   3.8
7     2     2     2     1     2   2.5   2.9     3   3.2   3.3   3.4
8     2     3     2     2     3   2.6   2.3   2.7   2.7   2.8   2.8
9     2     2     2     1     1   2.8   3.2   3.4   3.5   3.3   3.4</code></pre>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb587-2"><a href="#cb587-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb587-3"><a href="#cb587-3"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;High School GPA&quot;</span> =<span class="st"> </span>highgpa, </span>
<span id="cb587-4"><a href="#cb587-4"></a>                    <span class="st">&quot;Initial College GPA&quot;</span> =<span class="st"> </span>gpa_<span class="dv">1</span>, </span>
<span id="cb587-5"><a href="#cb587-5"></a>                    <span class="st">&quot;Initial Job&quot;</span> =<span class="st"> </span>job_<span class="dv">1</span>, </span>
<span id="cb587-6"><a href="#cb587-6"></a>                    <span class="st">&quot;Initial Hrs&quot;</span> =<span class="st"> </span>hrs_<span class="dv">1</span>,</span>
<span id="cb587-7"><a href="#cb587-7"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>,</span>
<span id="cb587-8"><a href="#cb587-8"></a>                    <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb587-9"><a href="#cb587-9"></a>                    <span class="dt">total =</span> <span class="ot">TRUE</span>,</span>
<span id="cb587-10"><a href="#cb587-10"></a>                    <span class="dt">test =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>male</th>
<th>female</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 200</td>
<td>n = 95</td>
<td>n = 105</td>
<td></td>
</tr>
<tr class="even">
<td>High School GPA</td>
<td></td>
<td></td>
<td></td>
<td>0.31</td>
</tr>
<tr class="odd">
<td></td>
<td>2.987 (0.596)</td>
<td>3.033 (0.592)</td>
<td>2.947 (0.600)</td>
<td></td>
</tr>
<tr class="even">
<td>Initial College GPA</td>
<td></td>
<td></td>
<td></td>
<td>0.094</td>
</tr>
<tr class="odd">
<td></td>
<td>2.594 (0.312)</td>
<td>2.555 (0.314)</td>
<td>2.629 (0.307)</td>
<td></td>
</tr>
<tr class="even">
<td>Initial Job</td>
<td></td>
<td></td>
<td></td>
<td>0.192</td>
</tr>
<tr class="odd">
<td>1 hour</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td></td>
</tr>
<tr class="even">
<td>2 hours</td>
<td>172 (86%)</td>
<td>78 (82.1%)</td>
<td>94 (89.5%)</td>
<td></td>
</tr>
<tr class="odd">
<td>3 hours</td>
<td>28 (14%)</td>
<td>17 (17.9%)</td>
<td>11 (10.5%)</td>
<td></td>
</tr>
<tr class="even">
<td>Initial Hrs</td>
<td></td>
<td></td>
<td></td>
<td>0.132</td>
</tr>
<tr class="odd">
<td></td>
<td>2.140 (0.348)</td>
<td>2.179 (0.385)</td>
<td>2.105 (0.308)</td>
<td></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb588-2"><a href="#cb588-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb588-3"><a href="#cb588-3"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(gpa_<span class="dv">1</span>, gpa_<span class="dv">2</span>, gpa_<span class="dv">3</span>, gpa_<span class="dv">4</span>, gpa_<span class="dv">5</span>, gpa_<span class="dv">6</span>,</span>
<span id="cb588-4"><a href="#cb588-4"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>,</span>
<span id="cb588-5"><a href="#cb588-5"></a>                    <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb588-6"><a href="#cb588-6"></a>                    <span class="dt">total =</span> <span class="ot">TRUE</span>,</span>
<span id="cb588-7"><a href="#cb588-7"></a>                    <span class="dt">test =</span> <span class="ot">TRUE</span>,</span>
<span id="cb588-8"><a href="#cb588-8"></a>                    <span class="dt">caption =</span> <span class="st">&quot;Hox Table 5.2 (page 77) GPA means at six occations, for male and female students&quot;</span>,</span>
<span id="cb588-9"><a href="#cb588-9"></a>                    <span class="dt">caption.above =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table>
<caption>(#tab:unnamed-chunk-474)Hox Table 5.2 (page 77) GPA means at six occations, for male and female students</caption>
<thead>
<tr class="header">
<th></th>
<th>Total</th>
<th>male</th>
<th>female</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 200</td>
<td>n = 95</td>
<td>n = 105</td>
</tr>
<tr class="even">
<td>gpa_1</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>2.594 (0.312)</td>
<td>2.555 (0.314)</td>
<td>2.629 (0.307)</td>
</tr>
<tr class="even">
<td>gpa_2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>2.716 (0.336)</td>
<td>2.666 (0.318)</td>
<td>2.760 (0.348)</td>
</tr>
<tr class="even">
<td>gpa_3</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>2.810 (0.354)</td>
<td>2.742 (0.363)</td>
<td>2.871 (0.335)</td>
</tr>
<tr class="even">
<td>gpa_4</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>2.918 (0.355)</td>
<td>2.818 (0.351)</td>
<td>3.009 (0.335)</td>
</tr>
<tr class="even">
<td>gpa_5</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>3.019 (0.358)</td>
<td>2.915 (0.359)</td>
<td>3.113 (0.332)</td>
</tr>
<tr class="even">
<td>gpa_6</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>3.134 (0.377)</td>
<td>3.028 (0.375)</td>
<td>3.230 (0.354)</td>
</tr>
</tbody>
</table>
</div>
<div id="mlm" class="section level2" number="12.2">
<h2 number="12.2"><span class="header-section-number">12.2</span> MLM</h2>
<div id="null-models-and-icc" class="section level3" number="12.2.1">
<h3 number="12.2.1"><span class="header-section-number">12.2.1</span> Null Models and ICC</h3>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1"></a>fit_lmer_<span class="dv">0</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student),</span>
<span id="cb589-2"><a href="#cb589-2"></a>                                <span class="dt">data =</span> data_long,</span>
<span id="cb589-3"><a href="#cb589-3"></a>                                <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1"></a>performance<span class="op">::</span><span class="kw">icc</span>(fit_lmer_<span class="dv">0</span>_re)</span></code></pre></div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.369
  Conditional ICC: 0.369</code></pre>
<p>Over a third of the variance in the 6 GPA measures is variance between individuals, and about two-thirds is variance within individuals across time, <span class="math inline">\(\rho = .369\)</span>.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1"></a>fit_lmer_<span class="dv">1</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student),</span>
<span id="cb592-2"><a href="#cb592-2"></a>                                <span class="dt">data =</span> data_long,</span>
<span id="cb592-3"><a href="#cb592-3"></a>                                <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="#cb593-1"></a>performance<span class="op">::</span><span class="kw">icc</span>(fit_lmer_<span class="dv">1</span>_re)</span></code></pre></div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.523
  Conditional ICC: 0.412</code></pre>
<p>After accounting for the linear change in GPA over semesters, about half of the remaining variance in GPA scores is attribuTable person-to-person difference.</p>
<blockquote>
<p>Another way to say it, is about half of the variance in initial GPAs is due to student-to-student differences.</p>
</blockquote>
</div>
<div id="fixed-effects-2" class="section level3" number="12.2.2">
<h3 number="12.2.2"><span class="header-section-number">12.2.2</span> Fixed Effects</h3>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1"></a>fit_lmer_<span class="dv">0</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student),</span>
<span id="cb595-2"><a href="#cb595-2"></a>                                <span class="dt">data =</span> data_long,</span>
<span id="cb595-3"><a href="#cb595-3"></a>                                <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb595-4"><a href="#cb595-4"></a></span>
<span id="cb595-5"><a href="#cb595-5"></a>fit_lmer_<span class="dv">1</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student),</span>
<span id="cb595-6"><a href="#cb595-6"></a>                                <span class="dt">data =</span> data_long,</span>
<span id="cb595-7"><a href="#cb595-7"></a>                                <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb595-8"><a href="#cb595-8"></a></span>
<span id="cb595-9"><a href="#cb595-9"></a></span>
<span id="cb595-10"><a href="#cb595-10"></a>fit_lmer_<span class="dv">2</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>hrs <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student),</span>
<span id="cb595-11"><a href="#cb595-11"></a>                                <span class="dt">data =</span> data_long,</span>
<span id="cb595-12"><a href="#cb595-12"></a>                                <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb595-13"><a href="#cb595-13"></a></span>
<span id="cb595-14"><a href="#cb595-14"></a></span>
<span id="cb595-15"><a href="#cb595-15"></a>fit_lmer_<span class="dv">3</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>hrs <span class="op">+</span><span class="st"> </span>highgpa <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student),</span>
<span id="cb595-16"><a href="#cb595-16"></a>                                <span class="dt">data =</span> data_long,</span>
<span id="cb595-17"><a href="#cb595-17"></a>                                <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lmer_<span class="dv">0</span>_ml, fit_lmer_<span class="dv">1</span>_ml, fit_lmer_<span class="dv">2</span>_ml, fit_lmer_<span class="dv">3</span>_ml))</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Statistical models
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 2
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 3
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 4
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.87<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.60<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.97<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.64<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.02)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.02)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.04)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.10)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sem - 1
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.00)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.00)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.00)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hrs
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.17<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.17<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.02)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.02)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
highgpa
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.08<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.03)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexfemale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.15<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.03)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
919.46
</td>
<td style="padding-left: 5px;padding-right: 5px;">
401.65
</td>
<td style="padding-left: 5px;padding-right: 5px;">
318.40
</td>
<td style="padding-left: 5px;padding-right: 5px;">
296.76
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
934.73
</td>
<td style="padding-left: 5px;padding-right: 5px;">
422.01
</td>
<td style="padding-left: 5px;padding-right: 5px;">
343.85
</td>
<td style="padding-left: 5px;padding-right: 5px;">
332.39
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-456.73
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-196.82
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-154.20
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-141.38
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: student
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: student (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.06
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.06
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.05
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.04
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.06
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.06
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.06
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lmer_<span class="dv">0</span>_ml, fit_lmer_<span class="dv">1</span>_ml, fit_lmer_<span class="dv">2</span>_ml, fit_lmer_<span class="dv">3</span>_ml),</span>
<span id="cb597-2"><a href="#cb597-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M1: Null&quot;</span>,</span>
<span id="cb597-3"><a href="#cb597-3"></a>                                       <span class="st">&quot;M2: Occ&quot;</span>,</span>
<span id="cb597-4"><a href="#cb597-4"></a>                                       <span class="st">&quot;M3: Job&quot;</span>,</span>
<span id="cb597-5"><a href="#cb597-5"></a>                                       <span class="st">&quot;M4: GPA, Sex&quot;</span>),</span>
<span id="cb597-6"><a href="#cb597-6"></a>                <span class="dt">custom.coef.map =</span> <span class="kw">list</span>(<span class="st">&quot;(Intercept)&quot;</span> =<span class="st"> &quot;(Intercept)&quot;</span>,</span>
<span id="cb597-7"><a href="#cb597-7"></a>                                       <span class="st">&quot;I(sem - 1)&quot;</span> =<span class="st"> &quot;Semester&quot;</span>,</span>
<span id="cb597-8"><a href="#cb597-8"></a>                                       <span class="st">&quot;hrs&quot;</span> =<span class="st"> &quot;Hours Working&quot;</span>,</span>
<span id="cb597-9"><a href="#cb597-9"></a>                                       <span class="st">&quot;highgpa&quot;</span> =<span class="st"> &quot;High School GPA&quot;</span>,</span>
<span id="cb597-10"><a href="#cb597-10"></a>                                       <span class="st">&quot;sexfemale&quot;</span> =<span class="st"> &quot;Female vs. Male&quot;</span>),</span>
<span id="cb597-11"><a href="#cb597-11"></a>                <span class="dt">groups =</span> <span class="kw">list</span>(<span class="st">&quot;Level 1 Main Effects, Occasion-Specific&quot;</span> =<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb597-12"><a href="#cb597-12"></a>                              <span class="st">&quot;Level 2 Main Effects,  Person-Specific&quot;</span> =<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">5</span>),</span>
<span id="cb597-13"><a href="#cb597-13"></a>                <span class="dt">custom.note =</span> <span class="st">&quot;%stars. </span><span class="ch">\n</span><span class="st">Note: Intercept refers to population mean for a Male who is not working during their first semester&quot;</span>,</span>
<span id="cb597-14"><a href="#cb597-14"></a>                <span class="dt">caption =</span> <span class="st">&quot;Hox Table 5.3 (page 78) Results of Multilevel Anlaysis of GPA, Fixed Effects&quot;</span>,</span>
<span id="cb597-15"><a href="#cb597-15"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb597-16"><a href="#cb597-16"></a>                <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Hox Table 5.3 (page 78) Results of Multilevel Anlaysis of GPA, Fixed Effects
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M1: Null
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M2: Occ
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M3: Job
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M4: GPA, Sex
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.865<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.599<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.970<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.641<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.019)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.022)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.044)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.098)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Level 1 Main Effects, Occasion-Specific
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     Semester
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.106<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.102<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.102<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.004)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.004)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.004)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     Hours Working
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.171<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.172<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.018)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.018)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Level 2 Main Effects, Person-Specific
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     High School GPA
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.085<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.028)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     Female vs. Male
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.147<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.033)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
919.456
</td>
<td style="padding-left: 5px;padding-right: 5px;">
401.649
</td>
<td style="padding-left: 5px;padding-right: 5px;">
318.399
</td>
<td style="padding-left: 5px;padding-right: 5px;">
296.760
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
934.726
</td>
<td style="padding-left: 5px;padding-right: 5px;">
422.009
</td>
<td style="padding-left: 5px;padding-right: 5px;">
343.849
</td>
<td style="padding-left: 5px;padding-right: 5px;">
332.390
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-456.728
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-196.825
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-154.200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-141.380
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: student
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: student (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.057
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.063
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.052
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.045
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.098
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.058
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.055
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.055
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05.
Note: Intercept refers to population mean for a Male who is not working during their first semester
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1"></a><span class="kw">anova</span>(fit_lmer_<span class="dv">0</span>_ml, fit_lmer_<span class="dv">1</span>_ml, fit_lmer_<span class="dv">2</span>_ml, fit_lmer_<span class="dv">3</span>_ml)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_lmer_0_ml: gpa ~ 1 + (1 | student)
fit_lmer_1_ml: gpa ~ I(sem - 1) + (1 | student)
fit_lmer_2_ml: gpa ~ I(sem - 1) + hrs + (1 | student)
fit_lmer_3_ml: gpa ~ I(sem - 1) + hrs + highgpa + sex + (1 | student)
              npar    AIC    BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    
fit_lmer_0_ml    3 919.46 934.73 -456.73   913.46                          
fit_lmer_1_ml    4 401.65 422.01 -196.82   393.65 519.807  1  &lt; 2.2e-16 ***
fit_lmer_2_ml    5 318.40 343.85 -154.20   308.40  85.250  1  &lt; 2.2e-16 ***
fit_lmer_3_ml    7 296.76 332.39 -141.38   282.76  25.639  2  2.707e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="variance-explained-by-linear-time-at-level-one" class="section level3" number="12.2.3">
<h3 number="12.2.3"><span class="header-section-number">12.2.3</span> Variance Explained by linear TIME at Level ONE</h3>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_lmer_<span class="dv">0</span>_ml)  <span class="co"># baseline</span></span></code></pre></div>
<pre><code> Groups   Name        Std.Dev.
 student  (Intercept) 0.23826 
 Residual             0.31239 </code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_lmer_<span class="dv">1</span>_ml)  <span class="co"># model to compare</span></span></code></pre></div>
<pre><code> Groups   Name        Std.Dev.
 student  (Intercept) 0.25172 
 Residual             0.24090 </code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_lmer_<span class="dv">0</span>_ml) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># baseline</span></span>
<span id="cb604-2"><a href="#cb604-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),</span>
<span id="cb604-3"><a href="#cb604-3"></a>        <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code> Groups   Name        Variance Std.Dev.
 student  (Intercept) 0.0568   0.238   
 Residual             0.0976   0.312   </code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1"></a>lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_lmer_<span class="dv">1</span>_ml) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># model to compare</span></span>
<span id="cb606-2"><a href="#cb606-2"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),</span>
<span id="cb606-3"><a href="#cb606-3"></a>        <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code> Groups   Name        Variance Std.Dev.
 student  (Intercept) 0.0634   0.252   
 Residual             0.0580   0.241   </code></pre>
<div id="raudenbush-and-bryk-2" class="section level4" number="12.2.3.1">
<h4 number="12.2.3.1"><span class="header-section-number">12.2.3.1</span> Raudenbush and Bryk</h4>
<ul>
<li>Explained variance is a proportion of first-level variance only</li>
<li>A good option when the multilevel sampling process is is close to two-stage simple random sampling</li>
</ul>
<div class="genericEq">
<p>
<strong>Raudenbush and Bryk Approximate Formula - Level 1 </strong> <em>approximate</em> <span class="math display"><span class="math display">\[
approx \;R^2_1 = \frac{\sigma^2_{e-BL} - \sigma^2_{e-MC}}
             {\sigma^2_{e-BL} }
\tag{Hox 4.8}
\]</span></span>
</p>
</div>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1"></a>(<span class="fl">0.098</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.058</span>) <span class="op">/</span><span class="st"> </span><span class="fl">0.098</span></span></code></pre></div>
<pre><code>[1] 0.4081633</code></pre>
</div>
<div id="snijders-and-bosker-2" class="section level4" number="12.2.3.2">
<h4 number="12.2.3.2"><span class="header-section-number">12.2.3.2</span> Snijders and Bosker</h4>
<div class="genericEq">
<p>
<strong>Snijders and Bosker Formula - Level 1 </strong>
</p>
<p>
Random Intercepts Models Only, <em>address potential negative <span class="math inline"><span class="math inline">\(R^2\)</span></span> issue</em> <span class="math display"><span class="math display">\[
R^2_1 = 1 - \frac{\sigma^2_{e-MC} + \sigma^2_{u0-MC}}
                 {\sigma^2_{e-BL} + \sigma^2_{u0-BL}}
\]</span></span>
</p>
</div>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">0.058</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.063</span>)<span class="op">/</span>(<span class="fl">0.098</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.057</span>)</span></code></pre></div>
<pre><code>[1] 0.2193548</code></pre>
</div>
</div>
<div id="variance-explained-by-linear-time-at-level-two" class="section level3" number="12.2.4">
<h3 number="12.2.4"><span class="header-section-number">12.2.4</span> Variance Explained by linear TIME at Level TWO</h3>
<div id="raudenbush-and-bryk-3" class="section level4" number="12.2.4.1">
<h4 number="12.2.4.1"><span class="header-section-number">12.2.4.1</span> Raudenbush and Bryk</h4>
<div class="genericEq">
<p>
<strong>Raudenbush and Bryk Approximate Formula - Level 2 </strong> <span class="math display"><span class="math display">\[
approx \; R^2_s = \frac{\sigma^2_{u0-BL} - \sigma^2_{u0-MC}}
             {\sigma^2_{u0-BL} }
\tag{Hox 4.9}
\]</span></span>
</p>
</div>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1"></a>(<span class="fl">0.057</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.063</span>)<span class="op">/</span><span class="st"> </span><span class="fl">0.057</span></span></code></pre></div>
<pre><code>[1] -0.1052632</code></pre>
<p>YIKES! Negative Variance explained!</p>
</div>
<div id="snijders-and-bosker-3" class="section level4" number="12.2.4.2">
<h4 number="12.2.4.2"><span class="header-section-number">12.2.4.2</span> Snijders and Bosker</h4>
<div class="genericEq">
<p>
<strong>Snijders and Bosker Formula Extended - Level 2 </strong> <span class="math display"><span class="math display">\[
R^2_2 = 1 - \frac{\frac{\sigma^2_{e-MC}}{B} + \sigma^2_{u0-MC}}
                 {\frac{\sigma^2_{e-BL}}{B} + \sigma^2_{u0-BL}}
\]</span></span>
</p>
<p>
<span class="math inline"><span class="math inline">\(B\)</span></span> is the average size of the Level 2 units. Technically, you should use the <em>harmonic mean</em>, but unless the clusters differ greatly in size, it doesn’t make a huge difference.
</p>
</div>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="#cb614-1"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">0.058</span><span class="op">/</span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.063</span>) <span class="op">/</span><span class="st"> </span>(<span class="fl">0.098</span><span class="op">/</span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.057</span>)</span></code></pre></div>
<pre><code>[1] 0.009090909</code></pre>
<p>Reason: The intercept only model overestimates the variance at the occasion level and underestimates the variance at the subject level (see chapter 4 of <span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="#ref-hox2017" role="doc-biblioref">2017</a>)</span>)</p>
</div>
</div>
<div id="random-effects-2" class="section level3" number="12.2.5">
<h3 number="12.2.5"><span class="header-section-number">12.2.5</span> Random Effects</h3>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1"></a>fit_lmer_<span class="dv">3</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>hrs <span class="op">+</span><span class="st"> </span>highgpa <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span></span>
<span id="cb616-2"><a href="#cb616-2"></a><span class="st">                                  </span>(<span class="dv">1</span><span class="op">|</span>student),</span>
<span id="cb616-3"><a href="#cb616-3"></a>                            <span class="dt">data =</span> data_long,</span>
<span id="cb616-4"><a href="#cb616-4"></a>                            <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span>
<span id="cb616-5"><a href="#cb616-5"></a></span>
<span id="cb616-6"><a href="#cb616-6"></a></span>
<span id="cb616-7"><a href="#cb616-7"></a>fit_lmer_<span class="dv">4</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>hrs <span class="op">+</span><span class="st"> </span>highgpa <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span></span>
<span id="cb616-8"><a href="#cb616-8"></a><span class="st">                                  </span>(<span class="kw">I</span>(sem<span class="dv">-1</span>)<span class="op">|</span>student),</span>
<span id="cb616-9"><a href="#cb616-9"></a>                            <span class="dt">data =</span> data_long,</span>
<span id="cb616-10"><a href="#cb616-10"></a>                            <span class="dt">REML =</span> <span class="ot">TRUE</span>,</span>
<span id="cb616-11"><a href="#cb616-11"></a>                            <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1"></a><span class="kw">anova</span>(fit_lmer_<span class="dv">3</span>_re, fit_lmer_<span class="dv">4</span>_re, <span class="dt">refit =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_lmer_3_re: gpa ~ I(sem - 1) + hrs + highgpa + sex + (1 | student)
fit_lmer_4_re: gpa ~ I(sem - 1) + hrs + highgpa + sex + (I(sem - 1) | student)
              npar    AIC    BIC  logLik deviance Chisq Df Pr(&gt;Chisq)    
fit_lmer_3_re    7 328.84 364.47 -157.42   314.84                        
fit_lmer_4_re    9 219.93 265.75 -100.97   201.94 112.9  2  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="cross-level-interaction" class="section level3" number="12.2.6">
<h3 number="12.2.6"><span class="header-section-number">12.2.6</span> Cross-Level Interaction</h3>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1"></a>fit_lmer_<span class="dv">4</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>hrs <span class="op">+</span><span class="st"> </span>highgpa <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span></span>
<span id="cb619-2"><a href="#cb619-2"></a><span class="st">                                  </span>(<span class="kw">I</span>(sem<span class="dv">-1</span>)<span class="op">|</span>student),</span>
<span id="cb619-3"><a href="#cb619-3"></a>                            <span class="dt">data =</span> data_long,</span>
<span id="cb619-4"><a href="#cb619-4"></a>                            <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb619-5"><a href="#cb619-5"></a></span>
<span id="cb619-6"><a href="#cb619-6"></a>fit_lmer_<span class="dv">4</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>hrs <span class="op">+</span><span class="st"> </span>highgpa <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span></span>
<span id="cb619-7"><a href="#cb619-7"></a><span class="st">                                  </span>(<span class="kw">I</span>(sem<span class="dv">-1</span>)<span class="op">|</span>student),</span>
<span id="cb619-8"><a href="#cb619-8"></a>                            <span class="dt">data =</span> data_long,</span>
<span id="cb619-9"><a href="#cb619-9"></a>                            <span class="dt">REML =</span> <span class="ot">TRUE</span>,</span>
<span id="cb619-10"><a href="#cb619-10"></a>                            <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>))</span>
<span id="cb619-11"><a href="#cb619-11"></a></span>
<span id="cb619-12"><a href="#cb619-12"></a>fit_lmer_<span class="dv">5</span>_ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>hrs <span class="op">+</span><span class="st"> </span>highgpa <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(sem<span class="dv">-1</span>)<span class="op">:</span>sex <span class="op">+</span><span class="st"> </span></span>
<span id="cb619-13"><a href="#cb619-13"></a><span class="st">                                  </span>(<span class="kw">I</span>(sem<span class="dv">-1</span>)<span class="op">|</span>student),</span>
<span id="cb619-14"><a href="#cb619-14"></a>                            <span class="dt">data =</span> data_long,</span>
<span id="cb619-15"><a href="#cb619-15"></a>                            <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb619-16"><a href="#cb619-16"></a></span>
<span id="cb619-17"><a href="#cb619-17"></a>fit_lmer_<span class="dv">5</span>_re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(sem<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>hrs <span class="op">+</span><span class="st"> </span>highgpa <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(sem<span class="dv">-1</span>)<span class="op">:</span>sex <span class="op">+</span><span class="st"> </span></span>
<span id="cb619-18"><a href="#cb619-18"></a><span class="st">                                  </span>(<span class="kw">I</span>(sem<span class="dv">-1</span>)<span class="op">|</span>student),</span>
<span id="cb619-19"><a href="#cb619-19"></a>                            <span class="dt">data =</span> data_long,</span>
<span id="cb619-20"><a href="#cb619-20"></a>                            <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="#cb620-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lmer_<span class="dv">4</span>_re, fit_lmer_<span class="dv">5</span>_re),</span>
<span id="cb620-2"><a href="#cb620-2"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Statistical models
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 2
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.56 (0.09)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.58 (0.09)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sem - 1
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10 (0.01)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.01)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
hrs
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.13 (0.02)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.13 (0.02)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
highgpa
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.09 (0.03)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexfemale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.12 (0.03)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.08 (0.03)<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sem - 1:sexfemale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.03 (0.01)<sup>**</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
219.93
</td>
<td style="padding-left: 5px;padding-right: 5px;">
182.97
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
265.75
</td>
<td style="padding-left: 5px;padding-right: 5px;">
233.87
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-100.97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-81.49
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: student
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: student (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.04
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.04
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: student I(sem - 1)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: student (Intercept) I(sem - 1)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.00
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.00
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.04
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.04
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lmer_<span class="dv">4</span>_re, fit_lmer_<span class="dv">5</span>_re),</span>
<span id="cb621-2"><a href="#cb621-2"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb621-3"><a href="#cb621-3"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;M5: Occ Rand&quot;</span>,</span>
<span id="cb621-4"><a href="#cb621-4"></a>                                       <span class="st">&quot;M6: Xlevel Int&quot;</span>),</span>
<span id="cb621-5"><a href="#cb621-5"></a>                <span class="dt">custom.coef.map =</span> <span class="kw">list</span>(<span class="st">&quot;(Intercept)&quot;</span> =<span class="st"> &quot;(Intercept)&quot;</span>,</span>
<span id="cb621-6"><a href="#cb621-6"></a>                                       <span class="st">&quot;I(sem - 1)&quot;</span> =<span class="st"> &quot;Semester&quot;</span>,</span>
<span id="cb621-7"><a href="#cb621-7"></a>                                       <span class="st">&quot;hrs&quot;</span> =<span class="st"> &quot;Hours Working&quot;</span>,</span>
<span id="cb621-8"><a href="#cb621-8"></a>                                       <span class="st">&quot;sexfemale&quot;</span> =<span class="st"> &quot;Sex: Female vs. Male&quot;</span>,</span>
<span id="cb621-9"><a href="#cb621-9"></a>                                       <span class="st">&quot;highgpa&quot;</span> =<span class="st"> &quot;High School GPA&quot;</span>,</span>
<span id="cb621-10"><a href="#cb621-10"></a>                                       <span class="st">&quot;I(sem - 1):sexfemale&quot;</span> =<span class="st"> &quot;Semester X Sex&quot;</span>),</span>
<span id="cb621-11"><a href="#cb621-11"></a>                <span class="dt">groups =</span> <span class="kw">list</span>(<span class="st">&quot;Level 1 Main Effects, Occasion-Specific&quot;</span> =<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb621-12"><a href="#cb621-12"></a>                              <span class="st">&quot;Level 2 Main Effects,  Person-Specific&quot;</span> =<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">5</span>,</span>
<span id="cb621-13"><a href="#cb621-13"></a>                              <span class="st">&quot;Cross Level Interaction&quot;</span> =<span class="st"> </span><span class="dv">6</span>),</span>
<span id="cb621-14"><a href="#cb621-14"></a>                <span class="dt">custom.note =</span> <span class="st">&quot;%stars. </span><span class="ch">\n</span><span class="st">Note: Intercept refers to population mean for a Male who is not working during their first semester&quot;</span>,</span>
<span id="cb621-15"><a href="#cb621-15"></a>                <span class="dt">caption =</span> <span class="st">&quot;Hox Table 5.4 (page 80) Results of Multilevel Anlaysis of GPA, Varying Effects for Occation&quot;</span>,</span>
<span id="cb621-16"><a href="#cb621-16"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb621-17"><a href="#cb621-17"></a>                <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Hox Table 5.4 (page 80) Results of Multilevel Anlaysis of GPA, Varying Effects for Occation
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M5: Occ Rand
</th>
<th style="padding-left: 5px;padding-right: 5px;">
M6: Xlevel Int
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.557 (0.093)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.581 (0.092)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Level 1 Main Effects, Occasion-Specific
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     Semester
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.103 (0.006)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.088 (0.008)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     Hours Working
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.131 (0.017)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.132 (0.017)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Level 2 Main Effects, Person-Specific
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     Sex: Female vs. Male
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.116 (0.032)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.076 (0.035)<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     High School GPA
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.089 (0.026)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.089 (0.026)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cross Level Interaction
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
     Semester X Sex
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.030 (0.011)<sup>**</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
219.935
</td>
<td style="padding-left: 5px;padding-right: 5px;">
182.971
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
265.746
</td>
<td style="padding-left: 5px;padding-right: 5px;">
233.872
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-100.967
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-81.486
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1200
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: student
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
<td style="padding-left: 5px;padding-right: 5px;">
200
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: student (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.039
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.038
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: student I(sem - 1)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.004
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.004
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Cov: student (Intercept) I(sem - 1)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.003
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.002
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.042
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.042
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05.
Note: Intercept refers to population mean for a Male who is not working during their first semester
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1"></a><span class="kw">anova</span>(fit_lmer_<span class="dv">4</span>_ml, fit_lmer_<span class="dv">5</span>_ml)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_lmer_4_ml: gpa ~ I(sem - 1) + hrs + highgpa + sex + (I(sem - 1) | student)
fit_lmer_5_ml: gpa ~ I(sem - 1) + hrs + highgpa + sex + I(sem - 1):sex + (I(sem - 
fit_lmer_5_ml:     1) | student)
              npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)   
fit_lmer_4_ml    9 188.12 233.93 -85.059   170.12                        
fit_lmer_5_ml   10 182.97 233.87 -81.486   162.97 7.1464  1   0.007511 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="visualize-the-model-3" class="section level3" number="12.2.7">
<h3 number="12.2.7"><span class="header-section-number">12.2.7</span> Visualize the Model</h3>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_lmer_<span class="dv">5</span>_re,</span>
<span id="cb624-2"><a href="#cb624-2"></a>                            <span class="dt">pred =</span> sem,</span>
<span id="cb624-3"><a href="#cb624-3"></a>                            <span class="dt">modx =</span> sex,</span>
<span id="cb624-4"><a href="#cb624-4"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="eBook_multilevel_files/figure-html/unnamed-chunk-501-1.png" alt="Hox Figure 5.4 (page 82) Multilevel model (M6) comapring linear increase in GPA over semester, but student's sex." width="576" />
<p class="caption">
(#fig:unnamed-chunk-501)Hox Figure 5.4 (page 82) Multilevel model (M6) comapring linear increase in GPA over semester, but student’s sex.
</p>
</div>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_lmer_<span class="dv">5</span>_re,</span>
<span id="cb625-2"><a href="#cb625-2"></a>                            <span class="dt">pred =</span> sem,</span>
<span id="cb625-3"><a href="#cb625-3"></a>                            <span class="dt">modx =</span> sex,</span>
<span id="cb625-4"><a href="#cb625-4"></a>                            <span class="dt">mod2 =</span> hrs,</span>
<span id="cb625-5"><a href="#cb625-5"></a>                            <span class="dt">mod2.values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb625-6"><a href="#cb625-6"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-502-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="#cb626-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> fit_lmer_<span class="dv">5</span>_re,</span>
<span id="cb626-2"><a href="#cb626-2"></a>                            <span class="dt">pred =</span> sem,</span>
<span id="cb626-3"><a href="#cb626-3"></a>                            <span class="dt">modx =</span> sex,</span>
<span id="cb626-4"><a href="#cb626-4"></a>                            <span class="dt">mod2 =</span> highgpa,</span>
<span id="cb626-5"><a href="#cb626-5"></a>                            <span class="dt">mod2.values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb626-6"><a href="#cb626-6"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-503-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="effect-sizes" class="section level3" number="12.2.8">
<h3 number="12.2.8"><span class="header-section-number">12.2.8</span> Effect Sizes</h3>
<div id="standardized-parameters" class="section level4" number="12.2.8.1">
<h4 number="12.2.8.1"><span class="header-section-number">12.2.8.1</span> Standardized Parameters</h4>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1"></a>effectsize<span class="op">::</span><span class="kw">standardize_parameters</span>(fit_lmer_<span class="dv">5</span>_re)</span></code></pre></div>
<pre><code>Parameter            | Coefficient (std.) |      1e+02% CI
----------------------------------------------------------
(Intercept)          |               0.18 | [ 0.02,  0.34]
I(sem - 1)           |               0.38 | [ 0.31,  0.45]
hrs                  |              -0.14 | [-0.18, -0.11]
highgpa              |               0.13 | [ 0.06,  0.21]
sexfemale            |               0.51 | [ 0.29,  0.73]
I(sem - 1):sexfemale |               0.13 | [ 0.04,  0.22]

# Standardization method: Refit</code></pre>
</div>
<div id="r-squared-type-measures" class="section level4" number="12.2.8.2">
<h4 number="12.2.8.2"><span class="header-section-number">12.2.8.2</span> R-squared type measures</h4>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1"></a>performance<span class="op">::</span><span class="kw">r2</span>(fit_lmer_<span class="dv">5</span>_re, <span class="dt">by_group =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Explained Variance by Level

Level   |    R2
---------------
Level 1 | 0.020
student | 0.348</code></pre>
</div>
</div>
<div id="significance" class="section level3" number="12.2.9">
<h3 number="12.2.9"><span class="header-section-number">12.2.9</span> Significance</h3>
<div id="fixed-effects-3" class="section level4" number="12.2.9.1">
<h4 number="12.2.9.1"><span class="header-section-number">12.2.9.1</span> Fixed Effects</h4>
<blockquote>
<p>The Likelyhood Ratio Test (Deviance Difference Test) is best for establishing significance of fixed effects.</p>
</blockquote>
<p>Wald-tests</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1"></a><span class="kw">summary</span>(fit_lmer_<span class="dv">5</span>_re)</span></code></pre></div>
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite&#39;s
  method [lmerModLmerTest]
Formula: gpa ~ I(sem - 1) + hrs + highgpa + sex + I(sem - 1):sex + (I(sem -  
    1) | student)
   Data: data_long

     AIC      BIC   logLik deviance df.resid 
   183.0    233.9    -81.5    163.0     1190 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.0044 -0.5268 -0.0138  0.5290  3.3513 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 student  (Intercept) 0.037811 0.19445       
          I(sem - 1)  0.003614 0.06012  -0.19
 Residual             0.041555 0.20385       
Number of obs: 1200, groups:  student, 200

Fixed effects:
                       Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)           2.581e+00  9.239e-02  2.965e+02  27.938  &lt; 2e-16 ***
I(sem - 1)            8.783e-02  7.951e-03  1.987e+02  11.046  &lt; 2e-16 ***
hrs                  -1.321e-01  1.723e-02  1.042e+03  -7.670 3.93e-14 ***
highgpa               8.850e-02  2.627e-02  1.976e+02   3.369 0.000907 ***
sexfemale             7.551e-02  3.465e-02  2.003e+02   2.179 0.030499 *  
I(sem - 1):sexfemale  2.956e-02  1.096e-02  1.977e+02   2.698 0.007581 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) I(s-1) hrs    highgp sexfml
I(sem - 1)  -0.140                            
hrs         -0.428  0.054                     
highgpa     -0.871  0.001  0.022              
sexfemale   -0.265  0.312  0.030  0.066       
I(sm-1):sxf  0.088 -0.724 -0.008  0.000 -0.430</code></pre>
<p>F-test with Satterthwaite adjusted degrees of freedom</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="#cb633-1"></a><span class="kw">anova</span>(fit_lmer_<span class="dv">5</span>_re)</span></code></pre></div>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                Sum Sq Mean Sq NumDF   DenDF  F value    Pr(&gt;F)    
I(sem - 1)     14.5023 14.5023     1  199.46 348.9910 &lt; 2.2e-16 ***
hrs             2.4447  2.4447     1 1041.66  58.8305 3.933e-14 ***
highgpa         0.4716  0.4716     1  197.63  11.3493 0.0009074 ***
sex             0.1973  0.1973     1  200.28   4.7481 0.0304985 *  
I(sem - 1):sex  0.3025  0.3025     1  197.72   7.2787 0.0075806 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="random-effects-3" class="section level4" number="12.2.9.2">
<h4 number="12.2.9.2"><span class="header-section-number">12.2.9.2</span> Random Effects</h4>
<p>Likelyhood Ratio Tests (Deviance Difference Test), by single term deletion</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1"></a>lmerTest<span class="op">::</span><span class="kw">ranova</span>(fit_lmer_<span class="dv">5</span>_re)</span></code></pre></div>
<pre><code>ANOVA-like table for random-effects: Single term deletions

Model:
gpa ~ I(sem - 1) + hrs + highgpa + sex + (I(sem - 1) | student) + 
    I(sem - 1):sex
                                     npar   logLik    AIC    LRT Df Pr(&gt;Chisq)
&lt;none&gt;                                 10  -81.486 182.97                     
I(sem - 1) in (I(sem - 1) | student)    8 -134.321 284.64 105.67  2  &lt; 2.2e-16
                                        
&lt;none&gt;                                  
I(sem - 1) in (I(sem - 1) | student) ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<!--chapter:end:13-longitudinal_gpa.Rmd-->
</div>
</div>
</div>
</div>
<div id="mlm-longitudinal-rct---exercise-and-diet" class="section level1" number="13">
<h1 number="13"><span class="header-section-number">13</span> MLM, Longitudinal: RCT - Exercise and Diet</h1>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="#cb637-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb637-2"><a href="#cb637-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb637-3"><a href="#cb637-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb637-4"><a href="#cb637-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb637-5"><a href="#cb637-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb637-6"><a href="#cb637-6"></a><span class="kw">library</span>(performance) <span class="co"># ICC calculations</span></span>
<span id="cb637-7"><a href="#cb637-7"></a><span class="kw">library</span>(interactions)</span>
<span id="cb637-8"><a href="#cb637-8"></a><span class="kw">library</span>(sjPlot)       <span class="co"># Visualization for Models</span></span>
<span id="cb637-9"><a href="#cb637-9"></a><span class="kw">library</span>(effects)      <span class="co"># Effec displays for Models</span></span>
<span id="cb637-10"><a href="#cb637-10"></a></span>
<span id="cb637-11"><a href="#cb637-11"></a><span class="kw">library</span>(lme4)         <span class="co"># non-linear mixed-effects models</span></span></code></pre></div>
<div id="the-dataset" class="section level2" number="13.1">
<h2 number="13.1"><span class="header-section-number">13.1</span> The dataset</h2>
<p>This comes from a <strong>Randomized Controled Trial</strong>.</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="#cb638-1"></a>data_raw &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/CEHS-research/data/master/MLM/exercise_diet.txt&quot;</span>,</span>
<span id="cb638-2"><a href="#cb638-2"></a>                  <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb638-3"><a href="#cb638-3"></a>                  <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="#cb639-1"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(data_raw)</span></code></pre></div>
<pre><code>Rows: 120
Columns: 5
$ id       &lt;int&gt; 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5...
$ exertype &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
$ diet     &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
$ pulse    &lt;int&gt; 90, 92, 93, 93, 90, 92, 93, 93, 97, 97, 94, 94, 80, 82, 83...
$ time     &lt;int&gt; 0, 228, 296, 639, 0, 56, 434, 538, 0, 150, 295, 541, 0, 12...</code></pre>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="#cb641-1"></a>data_long &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb641-2"><a href="#cb641-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> id <span class="op">%&gt;%</span><span class="st"> </span>factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb641-3"><a href="#cb641-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">exertype =</span> exertype <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb641-4"><a href="#cb641-4"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb641-5"><a href="#cb641-5"></a>                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;At Rest&quot;</span>,</span>
<span id="cb641-6"><a href="#cb641-6"></a>                                    <span class="st">&quot;Leisurely Walking&quot;</span>,</span>
<span id="cb641-7"><a href="#cb641-7"></a>                                    <span class="st">&quot;Moderate Running&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb641-8"><a href="#cb641-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">diet =</span> diet <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb641-9"><a href="#cb641-9"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,</span>
<span id="cb641-10"><a href="#cb641-10"></a>                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;low-fat&quot;</span>,</span>
<span id="cb641-11"><a href="#cb641-11"></a>                                    <span class="st">&quot;non-fat&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb641-12"><a href="#cb641-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time_min =</span> time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>)</span></code></pre></div>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb642-2"><a href="#cb642-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>(<span class="dt">top =</span> <span class="dv">10</span>, <span class="dt">bottom =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb642-3"><a href="#cb642-3"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Raw Data&quot;</span>)</span></code></pre></div>
<table style="width:97%;">
<caption>Raw Data</caption>
<colgroup>
<col width="13%" />
<col width="6%" />
<col width="26%" />
<col width="13%" />
<col width="11%" />
<col width="9%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">id</th>
<th align="center">exertype</th>
<th align="center">diet</th>
<th align="center">pulse</th>
<th align="center">time</th>
<th align="center">time_min</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>1</strong></td>
<td align="center">1</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">90</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>2</strong></td>
<td align="center">1</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">92</td>
<td align="center">228</td>
<td align="center">3.8</td>
</tr>
<tr class="odd">
<td align="center"><strong>3</strong></td>
<td align="center">1</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">93</td>
<td align="center">296</td>
<td align="center">4.93</td>
</tr>
<tr class="even">
<td align="center"><strong>4</strong></td>
<td align="center">1</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">93</td>
<td align="center">639</td>
<td align="center">10.65</td>
</tr>
<tr class="odd">
<td align="center"><strong>5</strong></td>
<td align="center">2</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">90</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>6</strong></td>
<td align="center">2</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">92</td>
<td align="center">56</td>
<td align="center">0.93</td>
</tr>
<tr class="odd">
<td align="center"><strong>7</strong></td>
<td align="center">2</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">93</td>
<td align="center">434</td>
<td align="center">7.23</td>
</tr>
<tr class="even">
<td align="center"><strong>8</strong></td>
<td align="center">2</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">93</td>
<td align="center">538</td>
<td align="center">8.97</td>
</tr>
<tr class="odd">
<td align="center"><strong>9</strong></td>
<td align="center">3</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">97</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>10</strong></td>
<td align="center">3</td>
<td align="center">At Rest</td>
<td align="center">low-fat</td>
<td align="center">97</td>
<td align="center">150</td>
<td align="center">2.5</td>
</tr>
<tr class="odd">
<td align="center"><strong>…</strong></td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
<tr class="even">
<td align="center"><strong>111</strong></td>
<td align="center">28</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">140</td>
<td align="center">263</td>
<td align="center">4.38</td>
</tr>
<tr class="odd">
<td align="center"><strong>112</strong></td>
<td align="center">28</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">143</td>
<td align="center">588</td>
<td align="center">9.8</td>
</tr>
<tr class="even">
<td align="center"><strong>113</strong></td>
<td align="center">29</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">94</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>114</strong></td>
<td align="center">29</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">135</td>
<td align="center">164</td>
<td align="center">2.73</td>
</tr>
<tr class="even">
<td align="center"><strong>115</strong></td>
<td align="center">29</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">130</td>
<td align="center">353</td>
<td align="center">5.88</td>
</tr>
<tr class="odd">
<td align="center"><strong>116</strong></td>
<td align="center">29</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">137</td>
<td align="center">560</td>
<td align="center">9.33</td>
</tr>
<tr class="even">
<td align="center"><strong>117</strong></td>
<td align="center">30</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">99</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>118</strong></td>
<td align="center">30</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">111</td>
<td align="center">114</td>
<td align="center">1.9</td>
</tr>
<tr class="even">
<td align="center"><strong>119</strong></td>
<td align="center">30</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">140</td>
<td align="center">362</td>
<td align="center">6.03</td>
</tr>
<tr class="odd">
<td align="center"><strong>120</strong></td>
<td align="center">30</td>
<td align="center">Moderate Running</td>
<td align="center">non-fat</td>
<td align="center">148</td>
<td align="center">501</td>
<td align="center">8.35</td>
</tr>
</tbody>
</table>
</div>
<div id="exploratory-data-analysis-5" class="section level2" number="13.2">
<h2 number="13.2"><span class="header-section-number">13.2</span> Exploratory Data Analysis</h2>
<div id="participant-summary" class="section level3" number="13.2.1">
<h3 number="13.2.1"><span class="header-section-number">13.2.1</span> Participant Summary</h3>
<p>In this experiment, both exercise (<code>exertype</code>) and diet (<code>diet</code>) were randomized at the subject level to create a 2x3 = 6 combinations each with exactly 5 participants.</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="#cb643-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb643-2"><a href="#cb643-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(time <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb643-3"><a href="#cb643-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(exertype) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb643-4"><a href="#cb643-4"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(<span class="st">&quot;Diet, randomized&quot;</span> =<span class="st"> </span>diet, </span>
<span id="cb643-5"><a href="#cb643-5"></a>                    <span class="dt">caption =</span> <span class="st">&quot;Participants&quot;</span>,</span>
<span id="cb643-6"><a href="#cb643-6"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<caption>(#tab:unnamed-chunk-514)Participants</caption>
<thead>
<tr class="header">
<th></th>
<th>At Rest</th>
<th>Leisurely Walking</th>
<th>Moderate Running</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 10</td>
<td>n = 10</td>
<td>n = 10</td>
</tr>
<tr class="even">
<td>Diet, randomized</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>low-fat</td>
<td>5 (50%)</td>
<td>5 (50%)</td>
<td>5 (50%)</td>
</tr>
<tr class="even">
<td>non-fat</td>
<td>5 (50%)</td>
<td>5 (50%)</td>
<td>5 (50%)</td>
</tr>
</tbody>
</table>
</div>
<div id="baseline-summary-1" class="section level3" number="13.2.2">
<h3 number="13.2.2"><span class="header-section-number">13.2.2</span> Baseline Summary</h3>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="#cb644-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb644-2"><a href="#cb644-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(time <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb644-3"><a href="#cb644-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(exertype, diet) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb644-4"><a href="#cb644-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(pulse)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb644-5"><a href="#cb644-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb644-6"><a href="#cb644-6"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> diet,</span>
<span id="cb644-7"><a href="#cb644-7"></a>                     <span class="dt">values_from =</span> mean) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb644-8"><a href="#cb644-8"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Baseline Pulse, Means&quot;</span>)</span></code></pre></div>
<table style="width:56%;">
<caption>Baseline Pulse, Means</caption>
<colgroup>
<col width="27%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">exertype</th>
<th align="center">low-fat</th>
<th align="center">non-fat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">At Rest</td>
<td align="center">90</td>
<td align="center">92</td>
</tr>
<tr class="even">
<td align="center">Leisurely Walking</td>
<td align="center">91</td>
<td align="center">96</td>
</tr>
<tr class="odd">
<td align="center">Moderate Running</td>
<td align="center">94</td>
<td align="center">98</td>
</tr>
</tbody>
</table>
</div>
<div id="raw-trajectories---person-profile-plot" class="section level3" number="13.2.3">
<h3 number="13.2.3"><span class="header-section-number">13.2.3</span> Raw Trajectories - Person Profile Plot</h3>
<div id="connect-the-dots" class="section level4" number="13.2.3.1">
<h4 number="13.2.3.1"><span class="header-section-number">13.2.3.1</span> Connect the dots</h4>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="#cb645-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb645-2"><a href="#cb645-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time_min,</span>
<span id="cb645-3"><a href="#cb645-3"></a>             <span class="dt">y =</span> pulse)) <span class="op">+</span></span>
<span id="cb645-4"><a href="#cb645-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb645-5"><a href="#cb645-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb645-6"><a href="#cb645-6"></a><span class="st">  </span><span class="kw">facet_grid</span>(diet <span class="op">~</span><span class="st"> </span>exertype) <span class="op">+</span></span>
<span id="cb645-7"><a href="#cb645-7"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-516-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="loess---moving-average-smoothers" class="section level4" number="13.2.3.2">
<h4 number="13.2.3.2"><span class="header-section-number">13.2.3.2</span> Loess - Moving Average Smoothers</h4>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="#cb646-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb646-2"><a href="#cb646-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time_min,</span>
<span id="cb646-3"><a href="#cb646-3"></a>             <span class="dt">y =</span> pulse,</span>
<span id="cb646-4"><a href="#cb646-4"></a>             <span class="dt">color =</span> diet)) <span class="op">+</span></span>
<span id="cb646-5"><a href="#cb646-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb646-6"><a href="#cb646-6"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>exertype) <span class="op">+</span></span>
<span id="cb646-7"><a href="#cb646-7"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb646-8"><a href="#cb646-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb646-9"><a href="#cb646-9"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,</span>
<span id="cb646-10"><a href="#cb646-10"></a>              <span class="dt">size =</span> <span class="dv">2</span>,</span>
<span id="cb646-11"><a href="#cb646-11"></a>              <span class="dt">span =</span> <span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb646-12"><a href="#cb646-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.08</span>, <span class="fl">0.85</span>),</span>
<span id="cb646-13"><a href="#cb646-13"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb646-14"><a href="#cb646-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Raw Pulse Trajectories&quot;</span>,</span>
<span id="cb646-15"><a href="#cb646-15"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;By Exercise and Diet Groupings&quot;</span>,</span>
<span id="cb646-16"><a href="#cb646-16"></a>       <span class="dt">x =</span> <span class="st">&quot;Time (Minutes Post-Baseline)&quot;</span>,</span>
<span id="cb646-17"><a href="#cb646-17"></a>       <span class="dt">y =</span> <span class="st">&quot;Pulse (Beats per Minute)&quot;</span>,</span>
<span id="cb646-18"><a href="#cb646-18"></a>       <span class="dt">color =</span> <span class="st">&quot;Diet Plan&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-517-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="multilevel-modeling" class="section level2" number="13.3">
<h2 number="13.3"><span class="header-section-number">13.3</span> Multilevel Modeling</h2>
<div id="null-model-1" class="section level3" number="13.3.1">
<h3 number="13.3.1"><span class="header-section-number">13.3.1</span> Null Model</h3>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="#cb647-1"></a>fit_lmer_0re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(pulse <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb647-2"><a href="#cb647-2"></a>                               <span class="dt">data =</span> data_long)</span></code></pre></div>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(fit_lmer_0re, <span class="dt">single.row =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Statistical models
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
102.13 (2.54)<sup>***</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
963.89
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
972.25
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-478.95
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
120
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
30
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
165.84
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
109.39
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="icc-r-squared" class="section level3" number="13.3.2">
<h3 number="13.3.2"><span class="header-section-number">13.3.2</span> ICC &amp; R-squared</h3>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="#cb649-1"></a>performance<span class="op">::</span><span class="kw">icc</span>(fit_lmer_0re)</span></code></pre></div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.603
  Conditional ICC: 0.603</code></pre>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="#cb651-1"></a>performance<span class="op">::</span><span class="kw">r2</span>(fit_lmer_0re)</span></code></pre></div>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.603
     Marginal R2: 0.000</code></pre>
</div>
<div id="add-fixed-effects-level-specific" class="section level3" number="13.3.3">
<h3 number="13.3.3"><span class="header-section-number">13.3.3</span> Add fixed effects: level specific</h3>
<div id="fit-nested-models-3" class="section level4" number="13.3.3.1">
<h4 number="13.3.3.1"><span class="header-section-number">13.3.3.1</span> Fit nested models</h4>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1"></a><span class="co"># Null Model (random intercept only)</span></span>
<span id="cb653-2"><a href="#cb653-2"></a>fit_lmer_0ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(pulse <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb653-3"><a href="#cb653-3"></a>                               <span class="dt">data =</span> data_long,</span>
<span id="cb653-4"><a href="#cb653-4"></a>                               <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb653-5"><a href="#cb653-5"></a></span>
<span id="cb653-6"><a href="#cb653-6"></a><span class="co"># Add quadratic time</span></span>
<span id="cb653-7"><a href="#cb653-7"></a>fit_lmer_1ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(pulse <span class="op">~</span><span class="st"> </span>time_min <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time_min<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb653-8"><a href="#cb653-8"></a>                               <span class="dt">data =</span> data_long,</span>
<span id="cb653-9"><a href="#cb653-9"></a>                               <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb653-10"><a href="#cb653-10"></a></span>
<span id="cb653-11"><a href="#cb653-11"></a><span class="co"># Add main effects for 2 interventions (person-specific, i.e. level-2 factors)</span></span>
<span id="cb653-12"><a href="#cb653-12"></a>fit_lmer_2ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(pulse <span class="op">~</span><span class="st"> </span>diet <span class="op">+</span><span class="st"> </span>exertype <span class="op">+</span><span class="st"> </span>time_min <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time_min<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb653-13"><a href="#cb653-13"></a>                               <span class="dt">data =</span> data_long,</span>
<span id="cb653-14"><a href="#cb653-14"></a>                               <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb653-15"><a href="#cb653-15"></a></span>
<span id="cb653-16"><a href="#cb653-16"></a><span class="co"># Add interaction between level-2 factors</span></span>
<span id="cb653-17"><a href="#cb653-17"></a>fit_lmer_3ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(pulse <span class="op">~</span><span class="st"> </span>diet<span class="op">*</span>exertype <span class="op">+</span><span class="st"> </span>time_min <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time_min<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb653-18"><a href="#cb653-18"></a>                               <span class="dt">data =</span> data_long,</span>
<span id="cb653-19"><a href="#cb653-19"></a>                               <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb653-20"><a href="#cb653-20"></a></span>
<span id="cb653-21"><a href="#cb653-21"></a><span class="co"># Add exercise interacting with [time &amp; time-squared]</span></span>
<span id="cb653-22"><a href="#cb653-22"></a>fit_lmer_4ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(pulse <span class="op">~</span><span class="st"> </span>diet<span class="op">*</span>exertype <span class="op">+</span><span class="st"> </span>exertype<span class="op">*</span>time_min <span class="op">+</span><span class="st"> </span>exertype<span class="op">*</span><span class="kw">I</span>(time_min<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb653-23"><a href="#cb653-23"></a>                               <span class="dt">data =</span> data_long,</span>
<span id="cb653-24"><a href="#cb653-24"></a>                               <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb653-25"><a href="#cb653-25"></a></span>
<span id="cb653-26"><a href="#cb653-26"></a><span class="co"># Add diet interacting with [time &amp; time-squared]</span></span>
<span id="cb653-27"><a href="#cb653-27"></a>fit_lmer_5ml &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(pulse <span class="op">~</span><span class="st"> </span>diet<span class="op">*</span>exertype<span class="op">*</span>time_min <span class="op">+</span><span class="st"> </span>diet<span class="op">*</span>exertype<span class="op">*</span><span class="kw">I</span>(time_min<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb653-28"><a href="#cb653-28"></a>                               <span class="dt">data =</span> data_long,</span>
<span id="cb653-29"><a href="#cb653-29"></a>                               <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(fit_lmer_1ml, </span>
<span id="cb654-2"><a href="#cb654-2"></a>                     fit_lmer_2ml, </span>
<span id="cb654-3"><a href="#cb654-3"></a>                     fit_lmer_3ml, </span>
<span id="cb654-4"><a href="#cb654-4"></a>                     fit_lmer_4ml, </span>
<span id="cb654-5"><a href="#cb654-5"></a>                     fit_lmer_5ml))</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Statistical models
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 2
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 3
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 4
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 5
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
94.05<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
79.30<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
82.15<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
89.89<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
89.81<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.71)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.46)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.64)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.69)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.78)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time_min
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.57<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.58<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.44<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.24
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.37
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.65)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.64)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.64)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.62)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.87)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time_min^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.21<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.21<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.20<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.01
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.03
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.06)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.06)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.06)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.05)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.09)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
8.36<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.89
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.99
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.11
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.21)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.36)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.45)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.89)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
exertypeLeisurely Walking
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.20
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.81
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.84
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.40
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.70)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.34)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.78)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.92)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
exertypeModerate Running
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
26.43<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
19.71<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.53
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.71
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.70)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.34)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.77)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.92)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat:exertypeLeisurely Walking
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.83
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.70
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.53
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(4.73)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(4.86)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(5.50)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat:exertypeModerate Running
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
13.47<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
14.02<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.99
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(4.74)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(4.86)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(5.50)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
exertypeLeisurely Walking:time_min
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.17
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.09
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.87)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.17)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
exertypeModerate Running:time_min
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
8.19<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.77<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.90)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.20)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
exertypeLeisurely Walking:time_min^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.07
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.08
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.11)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
exertypeModerate Running:time_min^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.48<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.33<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.11)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat:time_min
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.17
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.14)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat:time_min^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.02
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.10)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat:exertypeLeisurely Walking:time_min
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.21
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.56)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat:exertypeModerate Running:time_min
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.42<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.61)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat:exertypeLeisurely Walking:time_min^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.14)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
dietnon-fat:exertypeModerate Running:time_min^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.27
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
927.70
</td>
<td style="padding-left: 5px;padding-right: 5px;">
884.96
</td>
<td style="padding-left: 5px;padding-right: 5px;">
881.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
785.34
</td>
<td style="padding-left: 5px;padding-right: 5px;">
769.23
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
941.64
</td>
<td style="padding-left: 5px;padding-right: 5px;">
907.26
</td>
<td style="padding-left: 5px;padding-right: 5px;">
908.99
</td>
<td style="padding-left: 5px;padding-right: 5px;">
824.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
824.98
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-458.85
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-434.48
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-430.56
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-378.67
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-364.62
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
120
</td>
<td style="padding-left: 5px;padding-right: 5px;">
120
</td>
<td style="padding-left: 5px;padding-right: 5px;">
120
</td>
<td style="padding-left: 5px;padding-right: 5px;">
120
</td>
<td style="padding-left: 5px;padding-right: 5px;">
120
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
30
</td>
<td style="padding-left: 5px;padding-right: 5px;">
30
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
167.58
</td>
<td style="padding-left: 5px;padding-right: 5px;">
19.46
</td>
<td style="padding-left: 5px;padding-right: 5px;">
11.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
24.13
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25.64
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
67.47
</td>
<td style="padding-left: 5px;padding-right: 5px;">
67.47
</td>
<td style="padding-left: 5px;padding-right: 5px;">
67.52
</td>
<td style="padding-left: 5px;padding-right: 5px;">
20.95
</td>
<td style="padding-left: 5px;padding-right: 5px;">
15.32
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="6">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="evaluate-model-fit-i.e.-variable-significance" class="section level4" number="13.3.3.2">
<h4 number="13.3.3.2"><span class="header-section-number">13.3.3.2</span> Evaluate Model Fit, i.e. variable significance</h4>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="#cb655-1"></a><span class="kw">anova</span>(fit_lmer_1ml, </span>
<span id="cb655-2"><a href="#cb655-2"></a>      fit_lmer_2ml, </span>
<span id="cb655-3"><a href="#cb655-3"></a>      fit_lmer_3ml, </span>
<span id="cb655-4"><a href="#cb655-4"></a>      fit_lmer_4ml, </span>
<span id="cb655-5"><a href="#cb655-5"></a>      fit_lmer_5ml)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_lmer_1ml: pulse ~ time_min + I(time_min^2) + (1 | id)
fit_lmer_2ml: pulse ~ diet + exertype + time_min + I(time_min^2) + (1 | id)
fit_lmer_3ml: pulse ~ diet * exertype + time_min + I(time_min^2) + (1 | id)
fit_lmer_4ml: pulse ~ diet * exertype + exertype * time_min + exertype * I(time_min^2) + 
fit_lmer_4ml:     (1 | id)
fit_lmer_5ml: pulse ~ diet * exertype * time_min + diet * exertype * I(time_min^2) + 
fit_lmer_5ml:     (1 | id)
             npar    AIC    BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    
fit_lmer_1ml    5 927.70 941.64 -458.85   917.70                          
fit_lmer_2ml    8 884.96 907.26 -434.48   868.96  48.742  3  1.480e-10 ***
fit_lmer_3ml   10 881.11 908.99 -430.56   861.11   7.847  2    0.01977 *  
fit_lmer_4ml   14 785.34 824.36 -378.67   757.34 103.776  4  &lt; 2.2e-16 ***
fit_lmer_5ml   20 769.23 824.98 -364.62   729.23  28.108  6  8.968e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="#cb657-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(fit_lmer_1ml, </span>
<span id="cb657-2"><a href="#cb657-2"></a>                                 fit_lmer_2ml, </span>
<span id="cb657-3"><a href="#cb657-3"></a>                                 fit_lmer_3ml, </span>
<span id="cb657-4"><a href="#cb657-4"></a>                                 fit_lmer_4ml, </span>
<span id="cb657-5"><a href="#cb657-5"></a>                                 fit_lmer_5ml,</span>
<span id="cb657-6"><a href="#cb657-6"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model        |            Type |    AIC |    BIC | R2_conditional | R2_marginal |  ICC | RMSE |       BF | Performance_Score
----------------------------------------------------------------------------------------------------------------------------
fit_lmer_5ml | lmerModLmerTest | 769.23 | 824.98 |           0.94 |        0.85 | 0.63 | 3.46 | 2.15e+25 |            93.96%
fit_lmer_4ml | lmerModLmerTest | 785.34 | 824.36 |           0.92 |        0.83 | 0.54 | 4.08 | 2.93e+25 |            90.27%
fit_lmer_2ml | lmerModLmerTest | 884.96 | 907.26 |           0.75 |        0.68 | 0.22 | 7.64 | 2.92e+07 |            21.71%
fit_lmer_3ml | lmerModLmerTest | 881.12 | 908.99 |           0.75 |        0.71 | 0.14 | 7.80 | 1.23e+07 |            19.91%
fit_lmer_1ml | lmerModLmerTest | 927.70 | 941.64 |           0.75 |        0.12 | 0.71 | 7.22 |     1.00 |            16.19%

Model fit_lmer_5ml (of class lmerModLmerTest) performed best with an overall performance score of 93.96%.</code></pre>
</div>
</div>
<div id="final-model-4" class="section level3" number="13.3.4">
<h3 number="13.3.4"><span class="header-section-number">13.3.4</span> Final Model</h3>
<p>Refit via REML</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="#cb659-1"></a>fit_lmer_5re &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(pulse <span class="op">~</span><span class="st"> </span>diet<span class="op">*</span>exertype<span class="op">*</span>time_min <span class="op">+</span><span class="st"> </span></span>
<span id="cb659-2"><a href="#cb659-2"></a><span class="st">                                 </span>diet<span class="op">*</span>exertype<span class="op">*</span><span class="kw">I</span>(time_min<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb659-3"><a href="#cb659-3"></a>                               <span class="dt">data =</span> data_long,</span>
<span id="cb659-4"><a href="#cb659-4"></a>                               <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div id="visualize" class="section level4" number="13.3.4.1">
<h4 number="13.3.4.1"><span class="header-section-number">13.3.4.1</span> Visualize</h4>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="#cb660-1"></a>sjPlot<span class="op">::</span><span class="kw">plot_model</span>(fit_lmer_5re,</span>
<span id="cb660-2"><a href="#cb660-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>,</span>
<span id="cb660-3"><a href="#cb660-3"></a>                   <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;time_min&quot;</span>, <span class="st">&quot;diet&quot;</span>, <span class="st">&quot;exertype&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-527-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="#cb661-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(fit_lmer_5re,</span>
<span id="cb661-2"><a href="#cb661-2"></a>                            <span class="dt">pred =</span> time_min,</span>
<span id="cb661-3"><a href="#cb661-3"></a>                            <span class="dt">modx =</span> diet,</span>
<span id="cb661-4"><a href="#cb661-4"></a>                            <span class="dt">mod2 =</span> exertype,</span>
<span id="cb661-5"><a href="#cb661-5"></a>                            <span class="dt">interval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-528-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="#cb662-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;diet&quot;</span>, <span class="st">&quot;exertype&quot;</span>, <span class="st">&quot;time_min&quot;</span>),</span>
<span id="cb662-2"><a href="#cb662-2"></a>                <span class="dt">mod =</span> fit_lmer_5re) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb662-3"><a href="#cb662-3"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb662-4"><a href="#cb662-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time_min,</span>
<span id="cb662-5"><a href="#cb662-5"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb662-6"><a href="#cb662-6"></a>             <span class="dt">fill =</span> diet,</span>
<span id="cb662-7"><a href="#cb662-7"></a>             <span class="dt">color =</span> diet)) <span class="op">+</span></span>
<span id="cb662-8"><a href="#cb662-8"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb662-9"><a href="#cb662-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb662-10"><a href="#cb662-10"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>exertype) <span class="op">+</span></span>
<span id="cb662-11"><a href="#cb662-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.08</span>, <span class="fl">0.85</span>),</span>
<span id="cb662-12"><a href="#cb662-12"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb662-13"><a href="#cb662-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Raw Pulse Trajectories&quot;</span>,</span>
<span id="cb662-14"><a href="#cb662-14"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;By Exercise and Diet Groupings&quot;</span>,</span>
<span id="cb662-15"><a href="#cb662-15"></a>       <span class="dt">x =</span> <span class="st">&quot;Time (Minutes Post-Baseline)&quot;</span>,</span>
<span id="cb662-16"><a href="#cb662-16"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Pulse (Beats per Minute)&quot;</span>,</span>
<span id="cb662-17"><a href="#cb662-17"></a>       <span class="dt">fill =</span> <span class="st">&quot;Diet Plan&quot;</span>,</span>
<span id="cb662-18"><a href="#cb662-18"></a>       <span class="dt">color =</span> <span class="st">&quot;Diet Plan&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-529-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="#cb663-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;diet&quot;</span>, <span class="st">&quot;exertype&quot;</span>, <span class="st">&quot;time_min&quot;</span>),</span>
<span id="cb663-2"><a href="#cb663-2"></a>                <span class="dt">mod =</span> fit_lmer_5re,</span>
<span id="cb663-3"><a href="#cb663-3"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="st">&quot;time_min&quot;</span> =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, </span>
<span id="cb663-4"><a href="#cb663-4"></a>                                                <span class="dt">to   =</span> <span class="dv">12</span>, </span>
<span id="cb663-5"><a href="#cb663-5"></a>                                                <span class="dt">by   =</span> <span class="fl">0.5</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb663-6"><a href="#cb663-6"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb663-7"><a href="#cb663-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">diet =</span> <span class="kw">fct_rev</span>(diet)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># reverse the order of the levels</span></span>
<span id="cb663-8"><a href="#cb663-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time_min,</span>
<span id="cb663-9"><a href="#cb663-9"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb663-10"><a href="#cb663-10"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> fit <span class="op">-</span><span class="st"> </span>se,</span>
<span id="cb663-11"><a href="#cb663-11"></a>                  <span class="dt">ymax =</span> fit <span class="op">+</span><span class="st"> </span>se,</span>
<span id="cb663-12"><a href="#cb663-12"></a>                  <span class="dt">fill =</span> diet),</span>
<span id="cb663-13"><a href="#cb663-13"></a>              <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb663-14"><a href="#cb663-14"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> diet),</span>
<span id="cb663-15"><a href="#cb663-15"></a>                <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb663-16"><a href="#cb663-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb663-17"><a href="#cb663-17"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>exertype) <span class="op">+</span></span>
<span id="cb663-18"><a href="#cb663-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.12</span>, <span class="fl">0.85</span>),</span>
<span id="cb663-19"><a href="#cb663-19"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb663-20"><a href="#cb663-20"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb663-21"><a href="#cb663-21"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Raw Pulse Trajectories&quot;</span>,</span>
<span id="cb663-22"><a href="#cb663-22"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;By Randomized Exercise and Diet Intervention&quot;</span>,</span>
<span id="cb663-23"><a href="#cb663-23"></a>       <span class="dt">x =</span> <span class="st">&quot;Time (Minutes Post-Baseline)&quot;</span>,</span>
<span id="cb663-24"><a href="#cb663-24"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Pulse (Beats per Minute)&quot;</span>,</span>
<span id="cb663-25"><a href="#cb663-25"></a>       <span class="dt">fill =</span> <span class="st">&quot;Diet Plan&quot;</span>,</span>
<span id="cb663-26"><a href="#cb663-26"></a>       <span class="dt">color =</span> <span class="st">&quot;Diet Plan&quot;</span>,</span>
<span id="cb663-27"><a href="#cb663-27"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Diet Plan&quot;</span>) <span class="op">+</span></span>
<span id="cb663-28"><a href="#cb663-28"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray50&quot;</span>)) <span class="op">+</span></span>
<span id="cb663-29"><a href="#cb663-29"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>)) <span class="op">+</span></span>
<span id="cb663-30"><a href="#cb663-30"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">14</span>, <span class="dt">by =</span> <span class="dv">5</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-530-1.png" width="576" style="display: block; margin: auto;" /></p>
<!--chapter:end:15-exercise_diet.Rmd-->
</div>
</div>
</div>
</div>
<div id="gee-continuous-outcome-beat-the-blues" class="section level1" number="14">
<h1 number="14"><span class="header-section-number">14</span> GEE, Continuous Outcome: Beat the Blues</h1>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="#cb664-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb664-2"><a href="#cb664-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb664-3"><a href="#cb664-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb664-4"><a href="#cb664-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb664-5"><a href="#cb664-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb664-6"><a href="#cb664-6"></a></span>
<span id="cb664-7"><a href="#cb664-7"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb664-8"><a href="#cb664-8"></a></span>
<span id="cb664-9"><a href="#cb664-9"></a><span class="kw">library</span>(corrplot)     <span class="co"># Vizualize correlation matrix</span></span>
<span id="cb664-10"><a href="#cb664-10"></a><span class="kw">library</span>(gee)          <span class="co"># Genderalized Estimation Equation Solver</span></span>
<span id="cb664-11"><a href="#cb664-11"></a><span class="kw">library</span>(geepack)      <span class="co"># Genderalized Estimation Equation Package </span></span>
<span id="cb664-12"><a href="#cb664-12"></a><span class="kw">library</span>(MuMIn)        <span class="co"># Multi-Model Inference (caluclate QIC)</span></span>
<span id="cb664-13"><a href="#cb664-13"></a></span>
<span id="cb664-14"><a href="#cb664-14"></a><span class="kw">library</span>(HSAUR)        <span class="co"># package with the dataset</span></span></code></pre></div>
<div id="prepare-and-get-to-know-the-dataset" class="section level2" number="14.1">
<h2 number="14.1"><span class="header-section-number">14.1</span> Prepare and get to know the dataset</h2>
<div id="read-in-the-data" class="section level3" number="14.1.1">
<h3 number="14.1.1"><span class="header-section-number">14.1.1</span> Read in the data</h3>
<p>This data set is in the <strong>HSAUR</strong> package. It is from a clinical trial of an interactive multimedia program called ‘Beat the Blues’. The variables are as follows:</p>
<ul>
<li><code>drug</code> did the patient take anti-depressant drugs (No or Yes)<br />
</li>
<li><code>length</code> the length of the current episode of depression, a factor with levels:
<ul>
<li>“&lt;6m” <em>less than six months</em><br />
</li>
<li>“&gt;6m” <em>more than six months</em><br />
</li>
</ul></li>
<li><code>treatment</code> treatment group, a factor with levels:
<ul>
<li>“TAU” <em>treatment as usual</em><br />
</li>
<li>“BtheB” <em>Beat the Blues</em><br />
</li>
</ul></li>
<li><code>bdi.pre</code> Beck Depression Inventory II, before treatment<br />
</li>
<li><code>bdi.2m</code> Beck Depression Inventory II, after 2 months<br />
</li>
<li><code>bdi.4m</code> Beck Depression Inventory II, after 4 months<br />
</li>
<li><code>bdi.6m</code> Beck Depression Inventory II, after 6 months<br />
</li>
<li><code>bdi.8m</code> Beck Depression Inventory II, after 8 months</li>
</ul>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="#cb665-1"></a><span class="kw">data</span>(BtheB, <span class="dt">package =</span> <span class="st">&quot;HSAUR&quot;</span>)</span>
<span id="cb665-2"><a href="#cb665-2"></a></span>
<span id="cb665-3"><a href="#cb665-3"></a>BtheB <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb665-4"><a href="#cb665-4"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>()</span></code></pre></div>
<pre><code>    drug length treatment bdi.pre bdi.2m bdi.4m bdi.6m bdi.8m
1     No    &gt;6m       TAU      29      2      2   &lt;NA&gt;   &lt;NA&gt;
2    Yes    &gt;6m     BtheB      32     16     24     17     20
3    Yes    &lt;6m       TAU      25     20   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;
4     No    &gt;6m     BtheB      21     17     16     10      9
... &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt;     ...    ...    ...    ...    ...
97   Yes    &lt;6m       TAU      28   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;
98    No    &gt;6m     BtheB      11     22      9     11     11
99    No    &lt;6m       TAU      13      5      5      0      6
100  Yes    &lt;6m       TAU      43   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;</code></pre>
</div>
<div id="tidy-up-the-dataset" class="section level3" number="14.1.2">
<h3 number="14.1.2"><span class="header-section-number">14.1.2</span> Tidy up the dataset</h3>
<p><strong>WIDE format</strong>
* One line per person
* Good for descriptive tables &amp; correlation matrices</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="#cb667-1"></a>btb_wide &lt;-<span class="st"> </span>BtheB <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb667-2"><a href="#cb667-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st">           </span><span class="co"># create a new variable to ID participants</span></span>
<span id="cb667-3"><a href="#cb667-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, treatment,                    <span class="co"># specify that ID variable is first</span></span>
<span id="cb667-4"><a href="#cb667-4"></a>                drug, length,</span>
<span id="cb667-5"><a href="#cb667-5"></a>                bdi.pre, bdi<span class="fl">.2</span>m, bdi<span class="fl">.4</span>m, bdi<span class="fl">.6</span>m, bdi<span class="fl">.8</span>m)</span></code></pre></div>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="#cb668-1"></a>btb_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb668-2"><a href="#cb668-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>(<span class="dt">top =</span> <span class="dv">10</span>, <span class="dt">bottom =</span> <span class="dv">10</span>) </span></code></pre></div>
<pre><code>     id treatment drug length bdi.pre bdi.2m bdi.4m bdi.6m bdi.8m
1     1       TAU   No    &gt;6m      29      2      2   &lt;NA&gt;   &lt;NA&gt;
2     2     BtheB  Yes    &gt;6m      32     16     24     17     20
3     3       TAU  Yes    &lt;6m      25     20   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;
4     4     BtheB   No    &gt;6m      21     17     16     10      9
5     5     BtheB  Yes    &gt;6m      26     23   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;
6     6     BtheB  Yes    &lt;6m       7      0      0      0      0
7     7       TAU  Yes    &lt;6m      17      7      7      3      7
8     8       TAU   No    &gt;6m      20     20     21     19     13
9     9     BtheB  Yes    &lt;6m      18     13     14     20     11
10   10     BtheB  Yes    &gt;6m      20      5      5      8     12
... ...      &lt;NA&gt; &lt;NA&gt;   &lt;NA&gt;     ...    ...    ...    ...    ...
91   91       TAU   No    &lt;6m      16   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;
92   92     BtheB  Yes    &lt;6m      30     26     28   &lt;NA&gt;   &lt;NA&gt;
93   93     BtheB  Yes    &lt;6m      17      8      7     12   &lt;NA&gt;
94   94     BtheB   No    &gt;6m      19      4      3      3      3
95   95     BtheB   No    &gt;6m      16     11      4      2      3
96   96     BtheB  Yes    &gt;6m      16     16     10     10      8
97   97       TAU  Yes    &lt;6m      28   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;
98   98     BtheB   No    &gt;6m      11     22      9     11     11
99   99       TAU   No    &lt;6m      13      5      5      0      6
100 100       TAU  Yes    &lt;6m      43   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;</code></pre>
</div>
<div id="restructure-to-long-format" class="section level3" number="14.1.3">
<h3 number="14.1.3"><span class="header-section-number">14.1.3</span> Restructure to long format</h3>
<p><strong>LONG FORMAT</strong>
* One line per observation
* Good for plots and modeling</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="#cb670-1"></a>btb_long &lt;-<span class="st"> </span>btb_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb670-2"><a href="#cb670-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(bdi<span class="fl">.2</span>m, bdi<span class="fl">.4</span>m, bdi<span class="fl">.6</span>m, bdi<span class="fl">.8</span>m),  <span class="co"># all existing variables (not quoted)</span></span>
<span id="cb670-3"><a href="#cb670-3"></a>                      <span class="dt">names_to =</span> <span class="st">&quot;month&quot;</span>, </span>
<span id="cb670-4"><a href="#cb670-4"></a>                      <span class="dt">names_pattern =</span> <span class="st">&quot;bdi.(.)m&quot;</span>,</span>
<span id="cb670-5"><a href="#cb670-5"></a>                      <span class="dt">values_to =</span> <span class="st">&quot;bdi&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb670-6"><a href="#cb670-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">month =</span> <span class="kw">as.numeric</span>(month)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb670-7"><a href="#cb670-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(id, bdi, treatment, month)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb670-8"><a href="#cb670-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(id, month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb670-9"><a href="#cb670-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, treatment, drug, length, bdi.pre, month, bdi)</span></code></pre></div>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="#cb671-1"></a>btb_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb671-2"><a href="#cb671-2"></a><span class="st">  </span>psych<span class="op">::</span><span class="kw">headTail</span>(<span class="dt">top =</span> <span class="dv">10</span>, <span class="dt">bottom =</span> <span class="dv">10</span>) </span></code></pre></div>
<pre><code>    id treatment drug length bdi.pre month bdi
1    1       TAU   No    &gt;6m      29     2   2
2    1       TAU   No    &gt;6m      29     4   2
3    2     BtheB  Yes    &gt;6m      32     2  16
4    2     BtheB  Yes    &gt;6m      32     4  24
5    2     BtheB  Yes    &gt;6m      32     6  17
6    2     BtheB  Yes    &gt;6m      32     8  20
7    3       TAU  Yes    &lt;6m      25     2  20
8    4     BtheB   No    &gt;6m      21     2  17
9    4     BtheB   No    &gt;6m      21     4  16
10   4     BtheB   No    &gt;6m      21     6  10
11 ...      &lt;NA&gt; &lt;NA&gt;   &lt;NA&gt;     ...   ... ...
12  96     BtheB  Yes    &gt;6m      16     6  10
13  96     BtheB  Yes    &gt;6m      16     8   8
14  98     BtheB   No    &gt;6m      11     2  22
15  98     BtheB   No    &gt;6m      11     4   9
16  98     BtheB   No    &gt;6m      11     6  11
17  98     BtheB   No    &gt;6m      11     8  11
18  99       TAU   No    &lt;6m      13     2   5
19  99       TAU   No    &lt;6m      13     4   5
20  99       TAU   No    &lt;6m      13     6   0
21  99       TAU   No    &lt;6m      13     8   6</code></pre>
</div>
<div id="visualize-person-profile-plots" class="section level3" number="14.1.4">
<h3 number="14.1.4"><span class="header-section-number">14.1.4</span> Visualize: Person-profile Plots</h3>
<p>Create spaghetti plots of the raw, observed data</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="#cb673-1"></a>btb_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb673-2"><a href="#cb673-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb673-3"><a href="#cb673-3"></a>             <span class="dt">y =</span> bdi)) <span class="op">+</span></span>
<span id="cb673-4"><a href="#cb673-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb673-5"><a href="#cb673-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id), </span>
<span id="cb673-6"><a href="#cb673-6"></a>            <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb673-7"><a href="#cb673-7"></a>            <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb673-8"><a href="#cb673-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb673-9"><a href="#cb673-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb673-10"><a href="#cb673-10"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>treatment) <span class="op">+</span></span>
<span id="cb673-11"><a href="#cb673-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BtheB - Observed Data Across Time with LM Smoother&quot;</span>,</span>
<span id="cb673-12"><a href="#cb673-12"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Seperate by Treatment&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-537-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="#cb674-1"></a>btb_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb674-2"><a href="#cb674-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb674-3"><a href="#cb674-3"></a>             <span class="dt">y =</span> bdi)) <span class="op">+</span></span>
<span id="cb674-4"><a href="#cb674-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb674-5"><a href="#cb674-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id), </span>
<span id="cb674-6"><a href="#cb674-6"></a>            <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb674-7"><a href="#cb674-7"></a>            <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb674-8"><a href="#cb674-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb674-9"><a href="#cb674-9"></a><span class="st">  </span><span class="kw">facet_grid</span>(drug<span class="op">~</span><span class="st"> </span>treatment, <span class="dt">labeller =</span> label_both) <span class="op">+</span></span>
<span id="cb674-10"><a href="#cb674-10"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb674-11"><a href="#cb674-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BtheB - Observed Data Across Time with LM Smoother&quot;</span>,</span>
<span id="cb674-12"><a href="#cb674-12"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Seperate by Treatment &amp; Antidepressant Use&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-538-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="#cb675-1"></a>btb_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb675-2"><a href="#cb675-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb675-3"><a href="#cb675-3"></a>             <span class="dt">y =</span> bdi)) <span class="op">+</span></span>
<span id="cb675-4"><a href="#cb675-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb675-5"><a href="#cb675-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id,</span>
<span id="cb675-6"><a href="#cb675-6"></a>                <span class="dt">color =</span> length), </span>
<span id="cb675-7"><a href="#cb675-7"></a>            <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb675-8"><a href="#cb675-8"></a>            <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb675-9"><a href="#cb675-9"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> length),</span>
<span id="cb675-10"><a href="#cb675-10"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb675-11"><a href="#cb675-11"></a>              <span class="dt">size =</span> <span class="fl">1.25</span>,</span>
<span id="cb675-12"><a href="#cb675-12"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb675-13"><a href="#cb675-13"></a><span class="st">  </span><span class="kw">facet_grid</span>(drug<span class="op">~</span><span class="st"> </span>treatment, <span class="dt">labeller =</span> label_both) <span class="op">+</span></span>
<span id="cb675-14"><a href="#cb675-14"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb675-15"><a href="#cb675-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BtheB - Observed Data Across Time with LM Smoother&quot;</span>,</span>
<span id="cb675-16"><a href="#cb675-16"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Seperate by Treatment, Antidepressant Use, &amp; Length of Current Episode&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-539-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="#cb676-1"></a>btb_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb676-2"><a href="#cb676-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb676-3"><a href="#cb676-3"></a>             <span class="dt">y =</span> bdi,</span>
<span id="cb676-4"><a href="#cb676-4"></a>             <span class="dt">color =</span> treatment,</span>
<span id="cb676-5"><a href="#cb676-5"></a>             <span class="dt">fill =</span> treatment)) <span class="op">+</span></span>
<span id="cb676-6"><a href="#cb676-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb676-7"><a href="#cb676-7"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb676-8"><a href="#cb676-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BtheB - Predictions from TWO Seperate Single Simple Linear Models (lm)&quot;</span>,</span>
<span id="cb676-9"><a href="#cb676-9"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Assumes Independence of Repeated Measures&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-540-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="calculate-the-observed-correlation-structure" class="section level3" number="14.1.5">
<h3 number="14.1.5"><span class="header-section-number">14.1.5</span> Calculate the Observed Correlation Structure</h3>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1"></a>bdi_corr &lt;-<span class="st"> </span>btb_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb677-2"><a href="#cb677-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;bdi&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb677-3"><a href="#cb677-3"></a><span class="st">  </span>stats<span class="op">::</span><span class="kw">cor</span>(<span class="dt">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb677-4"><a href="#cb677-4"></a></span>
<span id="cb677-5"><a href="#cb677-5"></a>bdi_corr</span></code></pre></div>
<pre><code>          bdi.pre    bdi.2m    bdi.4m    bdi.6m    bdi.8m
bdi.pre 1.0000000 0.6142207 0.5691248 0.5077286 0.3835090
bdi.2m  0.6142207 1.0000000 0.7903346 0.7849188 0.7038158
bdi.4m  0.5691248 0.7903346 1.0000000 0.8166591 0.7220149
bdi.6m  0.5077286 0.7849188 0.8166591 1.0000000 0.8107773
bdi.8m  0.3835090 0.7038158 0.7220149 0.8107773 1.0000000</code></pre>
</div>
<div id="plot-the-correlation-matrix-to-get-a-better-feel-for-the-pattern" class="section level3" number="14.1.6">
<h3 number="14.1.6"><span class="header-section-number">14.1.6</span> Plot the correlation matrix to get a better feel for the pattern</h3>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1"></a>bdi_corr <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb679-2"><a href="#cb679-2"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>(<span class="dt">upper =</span> <span class="st">&quot;ellipse&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-542-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multiple-regression-ols" class="section level2" number="14.2">
<h2 number="14.2"><span class="header-section-number">14.2</span> Multiple Regression (OLS)</h2>
<p>This ignores any correlation between repeated measures on the same individual and treats all observations as independent.</p>
<div id="fit-the-models-2" class="section level3" number="14.2.1">
<h3 number="14.2.1"><span class="header-section-number">14.2.1</span> Fit the models</h3>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="#cb680-1"></a>btb_lm_<span class="dv">1</span> &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">lm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month,</span>
<span id="cb680-2"><a href="#cb680-2"></a>                    <span class="dt">data =</span> btb_long)</span>
<span id="cb680-3"><a href="#cb680-3"></a></span>
<span id="cb680-4"><a href="#cb680-4"></a>btb_lm_<span class="dv">2</span> &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">lm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment<span class="op">*</span>month,</span>
<span id="cb680-5"><a href="#cb680-5"></a>                    <span class="dt">data =</span> btb_long)</span>
<span id="cb680-6"><a href="#cb680-6"></a></span>
<span id="cb680-7"><a href="#cb680-7"></a>btb_lm_<span class="dv">3</span> &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">lm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>drug<span class="op">*</span>month,</span>
<span id="cb680-8"><a href="#cb680-8"></a>                    <span class="dt">data =</span> btb_long)</span>
<span id="cb680-9"><a href="#cb680-9"></a></span>
<span id="cb680-10"><a href="#cb680-10"></a>btb_lm_<span class="dv">4</span> &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">lm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug<span class="op">*</span>treatment<span class="op">*</span>month,</span>
<span id="cb680-11"><a href="#cb680-11"></a>                    <span class="dt">data =</span> btb_long)</span></code></pre></div>
</div>
<div id="parameter-estimates-table" class="section level3" number="14.2.2">
<h3 number="14.2.2"><span class="header-section-number">14.2.2</span> Parameter Estimates Table</h3>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(btb_lm_<span class="dv">1</span>, btb_lm_<span class="dv">2</span>, btb_lm_<span class="dv">3</span>, btb_lm_<span class="dv">4</span>),</span>
<span id="cb681-2"><a href="#cb681-2"></a>                <span class="dt">label =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb681-3"><a href="#cb681-3"></a>                <span class="dt">caption =</span> <span class="st">&quot;OLS&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
OLS
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 2
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 3
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 4
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
7.88<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
7.77<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
7.21<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
7.33<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.78)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.03)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.30)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.57<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.57<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.57<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.56<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.05)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.05)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.05)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.05)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
length&gt;6m
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.75
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.75
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.78
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.86
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.10)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.55<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.55<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.14)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.39)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.75)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentBtheB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.35<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.13
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.36<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.31
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.10)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.36)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.10)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.13)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.96<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.93<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.82<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.60
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.23)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.34)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.31)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.40)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentBtheB:month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.05
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.56
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.47)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.63)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes:month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.32
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.02
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.47)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.73)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes:treatmentBtheB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.23
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(4.92)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes:treatmentBtheB:month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.31
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.98)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.40
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.40
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.40
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.42
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Adj. R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.38
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.40
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="plot-the-model-predictions" class="section level3" number="14.2.3">
<h3 number="14.2.3"><span class="header-section-number">14.2.3</span> Plot the model predictions</h3>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="#cb682-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;month&quot;</span>), </span>
<span id="cb682-2"><a href="#cb682-2"></a>                <span class="dt">mod =</span> btb_lm_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb682-3"><a href="#cb682-3"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb682-4"><a href="#cb682-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">treatment =</span> <span class="kw">fct_reorder2</span>(treatment, month, fit)) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb682-5"><a href="#cb682-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb682-6"><a href="#cb682-6"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb682-7"><a href="#cb682-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> treatment)) <span class="op">+</span></span>
<span id="cb682-8"><a href="#cb682-8"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,</span>
<span id="cb682-9"><a href="#cb682-9"></a>                  <span class="dt">ymax =</span> upper,</span>
<span id="cb682-10"><a href="#cb682-10"></a>                  <span class="dt">fill =</span> treatment), </span>
<span id="cb682-11"><a href="#cb682-11"></a>              <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb682-12"><a href="#cb682-12"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> fit <span class="op">-</span><span class="st"> </span>se,</span>
<span id="cb682-13"><a href="#cb682-13"></a>                  <span class="dt">ymax =</span> fit <span class="op">+</span><span class="st"> </span>se,</span>
<span id="cb682-14"><a href="#cb682-14"></a>                  <span class="dt">fill =</span> treatment), </span>
<span id="cb682-15"><a href="#cb682-15"></a>              <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb682-16"><a href="#cb682-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb682-17"><a href="#cb682-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BtheB - Predictions from a Single Linear Model (lm)&quot;</span>,</span>
<span id="cb682-18"><a href="#cb682-18"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Assumes Independence of Repeated Measures&quot;</span>) <span class="op">+</span></span>
<span id="cb682-19"><a href="#cb682-19"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb682-20"><a href="#cb682-20"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb682-21"><a href="#cb682-21"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-545-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multilevel-models-mlm" class="section level2" number="14.3">
<h2 number="14.3"><span class="header-section-number">14.3</span> Multilevel Models (MLM)</h2>
<div id="fit-the-models-3" class="section level3" number="14.3.1">
<h3 number="14.3.1"><span class="header-section-number">14.3.1</span> Fit the models</h3>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="#cb683-1"></a>btb_lmer_RI   &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id), </span>
<span id="cb683-2"><a href="#cb683-2"></a>                            <span class="dt">data =</span> btb_long, </span>
<span id="cb683-3"><a href="#cb683-3"></a>                            <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span>
<span id="cb683-4"><a href="#cb683-4"></a></span>
<span id="cb683-5"><a href="#cb683-5"></a>btb_lmer_RIAS &lt;-<span class="st"> </span>lmerTest<span class="op">::</span><span class="kw">lmer</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month <span class="op">+</span><span class="st"> </span>(month <span class="op">|</span><span class="st"> </span>id), </span>
<span id="cb683-6"><a href="#cb683-6"></a>                            <span class="dt">data =</span> btb_long, </span>
<span id="cb683-7"><a href="#cb683-7"></a>                            <span class="dt">REML =</span> <span class="ot">TRUE</span>,</span>
<span id="cb683-8"><a href="#cb683-8"></a>                            <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;Nelder_Mead&quot;</span>))</span></code></pre></div>
</div>
<div id="parameter-estimates-table-1" class="section level3" number="14.3.2">
<h3 number="14.3.2"><span class="header-section-number">14.3.2</span> Parameter Estimates Table</h3>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="#cb684-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(btb_lm_<span class="dv">1</span>, btb_lmer_RI, btb_lmer_RIAS), </span>
<span id="cb684-2"><a href="#cb684-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;OLS&quot;</span>, <span class="st">&quot;MLM-RI&quot;</span>, <span class="st">&quot;MLM-RIAS&quot;</span>),</span>
<span id="cb684-3"><a href="#cb684-3"></a>                <span class="dt">label =</span> <span class="st">&quot;mlm&quot;</span>,</span>
<span id="cb684-4"><a href="#cb684-4"></a>                <span class="dt">caption =</span> <span class="st">&quot;LM vs. MLM&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
LM vs. MLM
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
OLS
</th>
<th style="padding-left: 5px;padding-right: 5px;">
MLM-RI
</th>
<th style="padding-left: 5px;padding-right: 5px;">
MLM-RIAS
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
7.88<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.92<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.94<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.78)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.31)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.30)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.57<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.05)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
length&gt;6m
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.75
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.24
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.68)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.67)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.55<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.79
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.89
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.14)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.77)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.76)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentBtheB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.35<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.49
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.10)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.71)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.71)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.96<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.71<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.23)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.16)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.40
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Adj. R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1882.08
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1885.16
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1911.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1921.50
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-933.04
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-932.58
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
51.44
</td>
<td style="padding-left: 5px;padding-right: 5px;">
50.56
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25.27
</td>
<td style="padding-left: 5px;padding-right: 5px;">
23.87
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.23
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id (Intercept) month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.31
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="likelihood-ratio-test-3" class="section level3" number="14.3.3">
<h3 number="14.3.3"><span class="header-section-number">14.3.3</span> Likelihood Ratio Test</h3>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="#cb685-1"></a><span class="kw">anova</span>(btb_lmer_RI, </span>
<span id="cb685-2"><a href="#cb685-2"></a>      btb_lmer_RIAS, </span>
<span id="cb685-3"><a href="#cb685-3"></a>      <span class="dt">refit =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>Data: btb_long
Models:
btb_lmer_RI: bdi ~ bdi.pre + length + drug + treatment + month + (1 | id)
btb_lmer_RIAS: bdi ~ bdi.pre + length + drug + treatment + month + (month | 
btb_lmer_RIAS:     id)
              npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
btb_lmer_RI      8 1882.1 1911.2 -933.04   1866.1                     
btb_lmer_RIAS   10 1885.2 1921.5 -932.58   1865.2 0.9236  2     0.6301</code></pre>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="#cb687-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(btb_lm_<span class="dv">1</span>, </span>
<span id="cb687-2"><a href="#cb687-2"></a>                                 btb_lmer_RI, </span>
<span id="cb687-3"><a href="#cb687-3"></a>                                 btb_lmer_RIAS,</span>
<span id="cb687-4"><a href="#cb687-4"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model         |            Type |     AIC |     BIC | RMSE |       BF | Performance_Score
-----------------------------------------------------------------------------------------
btb_lmer_RI   | lmerModLmerTest | 1882.08 | 1911.16 | 4.23 | 1.61e+27 |            98.80%
btb_lmer_RIAS | lmerModLmerTest | 1885.16 | 1921.50 | 4.02 | 9.14e+24 |            72.48%
btb_lm_1      |              lm | 2011.01 | 2036.45 | 8.56 |     1.00 |             0.00%

Model btb_lmer_RI (of class lmerModLmerTest) performed best with an overall performance score of 98.80%.</code></pre>
</div>
<div id="plot-the-model-predictions-1" class="section level3" number="14.3.4">
<h3 number="14.3.4"><span class="header-section-number">14.3.4</span> Plot the model predictions</h3>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="#cb689-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;drug&quot;</span>), </span>
<span id="cb689-2"><a href="#cb689-2"></a>                <span class="dt">mod =</span> btb_lmer_RI) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb689-3"><a href="#cb689-3"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb689-4"><a href="#cb689-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">treatment =</span> <span class="kw">fct_reorder2</span>(treatment, month, fit)) <span class="op">%&gt;%</span></span>
<span id="cb689-5"><a href="#cb689-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb689-6"><a href="#cb689-6"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb689-7"><a href="#cb689-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> treatment)) <span class="op">+</span></span>
<span id="cb689-8"><a href="#cb689-8"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,</span>
<span id="cb689-9"><a href="#cb689-9"></a>                  <span class="dt">ymax =</span> upper,</span>
<span id="cb689-10"><a href="#cb689-10"></a>                  <span class="dt">fill =</span> treatment), </span>
<span id="cb689-11"><a href="#cb689-11"></a>              <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb689-12"><a href="#cb689-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb689-13"><a href="#cb689-13"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>drug, <span class="dt">labeller =</span> label_both) <span class="op">+</span></span>
<span id="cb689-14"><a href="#cb689-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BtheB - Predictions from a Multilevel Model (lmer)&quot;</span>) <span class="op">+</span></span>
<span id="cb689-15"><a href="#cb689-15"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb689-16"><a href="#cb689-16"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">-0.1</span>),</span>
<span id="cb689-17"><a href="#cb689-17"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-550-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="general-estimating-equations-gee" class="section level2" number="14.4">
<h2 number="14.4"><span class="header-section-number">14.4</span> General Estimating Equations, GEE</h2>
<div id="fit-the-models---main-effects-to-determine-correlation-structure" class="section level3" number="14.4.1">
<h3 number="14.4.1"><span class="header-section-number">14.4.1</span> Fit the models - Main effects to determine correlation structure</h3>
<p><strong>Use the <code>gee()</code> function from the <code>gee</code> package for the results to be used in a <code>texreg::knitreg()</code> tables.</strong></p>
<p>The output below each model is the ‘starting’ model assuming independence, so they will all be the same here.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1"></a>btb_gee_in &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb690-2"><a href="#cb690-2"></a>                       <span class="dt">data =</span> btb_long, </span>
<span id="cb690-3"><a href="#cb690-3"></a>                       <span class="dt">id =</span> id, </span>
<span id="cb690-4"><a href="#cb690-4"></a>                       <span class="dt">family =</span> gaussian, </span>
<span id="cb690-5"><a href="#cb690-5"></a>                       <span class="dt">corstr =</span> <span class="st">&#39;independence&#39;</span>)</span></code></pre></div>
<pre><code>   (Intercept)        bdi.pre      length&gt;6m        drugYes treatmentBtheB 
     7.8830747      0.5723729      1.7530800     -3.5460058     -3.3539662 
         month 
    -0.9608077 </code></pre>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1"></a>btb_gee_ex &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb692-2"><a href="#cb692-2"></a>                       <span class="dt">data =</span> btb_long, </span>
<span id="cb692-3"><a href="#cb692-3"></a>                       <span class="dt">id =</span> id, </span>
<span id="cb692-4"><a href="#cb692-4"></a>                       <span class="dt">family =</span> gaussian, </span>
<span id="cb692-5"><a href="#cb692-5"></a>                       <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span></code></pre></div>
<pre><code>   (Intercept)        bdi.pre      length&gt;6m        drugYes treatmentBtheB 
     7.8830747      0.5723729      1.7530800     -3.5460058     -3.3539662 
         month 
    -0.9608077 </code></pre>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1"></a><span class="co"># The AR-1 fails if any subjects have only 1 observation</span></span>
<span id="cb694-2"><a href="#cb694-2"></a><span class="co"># to use this one, we would need to remove participants with only 1 BDI</span></span>
<span id="cb694-3"><a href="#cb694-3"></a></span>
<span id="cb694-4"><a href="#cb694-4"></a><span class="co"># btb_gee_ar &lt;- gee(bdi ~ bdi.pre + length + drug + treatment + month,</span></span>
<span id="cb694-5"><a href="#cb694-5"></a><span class="co">#                  data = btb_long,</span></span>
<span id="cb694-6"><a href="#cb694-6"></a><span class="co">#                  id = id,</span></span>
<span id="cb694-7"><a href="#cb694-7"></a><span class="co">#                  family = gaussian,</span></span>
<span id="cb694-8"><a href="#cb694-8"></a><span class="co">#                  corstr = &#39;AR-M&#39;,</span></span>
<span id="cb694-9"><a href="#cb694-9"></a><span class="co">#                  Mv = 1)</span></span>
<span id="cb694-10"><a href="#cb694-10"></a></span>
<span id="cb694-11"><a href="#cb694-11"></a>btb_gee_un &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb694-12"><a href="#cb694-12"></a>                       <span class="dt">data =</span> btb_long, </span>
<span id="cb694-13"><a href="#cb694-13"></a>                       <span class="dt">id =</span> id, </span>
<span id="cb694-14"><a href="#cb694-14"></a>                       <span class="dt">family =</span> gaussian, </span>
<span id="cb694-15"><a href="#cb694-15"></a>                       <span class="dt">corstr =</span> <span class="st">&#39;unstructured&#39;</span>)</span></code></pre></div>
<pre><code>   (Intercept)        bdi.pre      length&gt;6m        drugYes treatmentBtheB 
     7.8830747      0.5723729      1.7530800     -3.5460058     -3.3539662 
         month 
    -0.9608077 </code></pre>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="#cb696-1"></a><span class="kw">summary</span>(btb_gee_in)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Independent 

Call:
gee::gee(formula = bdi ~ bdi.pre + length + drug + treatment + 
    month, id = id, data = btb_long, family = gaussian, corstr = &quot;independence&quot;)

Summary of Residuals:
         Min           1Q       Median           3Q          Max 
-24.20158432  -5.31202378   0.01101526   5.29503741  27.77789553 


Coefficients:
                 Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)     7.8830747 1.78048908  4.427477  2.19973944  3.583640
bdi.pre         0.5723729 0.05486079 10.433188  0.08853253  6.465114
length&gt;6m       1.7530800 1.10849861  1.581490  1.41954159  1.234962
drugYes        -3.5460058 1.14469086 -3.097785  1.73069664 -2.048889
treatmentBtheB -3.3539662 1.09831939 -3.053726  1.71390982 -1.956909
month          -0.9608077 0.23263437 -4.130119  0.17688635 -5.431780

Estimated Scale Parameter:  74.8854
Number of Iterations:  1

Working Correlation
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1</code></pre>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="#cb698-1"></a><span class="kw">summary</span>(btb_gee_ex)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Exchangeable 

Call:
gee::gee(formula = bdi ~ bdi.pre + length + drug + treatment + 
    month, id = id, data = btb_long, family = gaussian, corstr = &quot;exchangeable&quot;)

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-25.4478843  -6.3276726  -0.8152833   4.3622258  25.4078115 


Coefficients:
                 Estimate Naive S.E.    Naive z Robust S.E.   Robust z
(Intercept)     5.8855129 2.32380381  2.5327065  2.10712166  2.7931529
bdi.pre         0.6399964 0.08033495  7.9665999  0.07931263  8.0692874
length&gt;6m       0.2084783 1.69179766  0.1232288  1.48052530  0.1408137
drugYes        -2.7742506 1.78397557 -1.5550945  1.64824318 -1.6831561
treatmentBtheB -2.3360241 1.72621751 -1.3532617  1.66217026 -1.4054060
month          -0.7078407 0.14254124 -4.9658660  0.15394156 -4.5981134

Estimated Scale Parameter:  77.14393
Number of Iterations:  5

Working Correlation
          [,1]      [,2]      [,3]      [,4]
[1,] 1.0000000 0.6915241 0.6915241 0.6915241
[2,] 0.6915241 1.0000000 0.6915241 0.6915241
[3,] 0.6915241 0.6915241 1.0000000 0.6915241
[4,] 0.6915241 0.6915241 0.6915241 1.0000000</code></pre>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="#cb700-1"></a><span class="kw">summary</span>(btb_gee_un)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Unstructured 

Call:
gee::gee(formula = bdi ~ bdi.pre + length + drug + treatment + 
    month, id = id, data = btb_long, family = gaussian, corstr = &quot;unstructured&quot;)

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-25.1527937  -6.1091139  -0.5896205   4.7316139  25.9041542 


Coefficients:
                 Estimate Naive S.E.   Naive z Robust S.E.   Robust z
(Intercept)     6.3905215 2.28769760  2.793429  2.15668950  2.9631162
bdi.pre         0.6171798 0.07744569  7.969195  0.08081777  7.6366846
length&gt;6m       0.5834398 1.61626647  0.360980  1.46837275  0.3973377
drugYes        -2.7908835 1.69816226 -1.643473  1.63741987 -1.7044398
treatmentBtheB -2.4261698 1.64272613 -1.476917  1.65519523 -1.4657907
month          -0.7628336 0.18121518 -4.209546  0.15643591 -4.8763329

Estimated Scale Parameter:  76.40371
Number of Iterations:  5

Working Correlation
          [,1]      [,2]      [,3]      [,4]
[1,] 1.0000000 0.7069560 0.5704892 0.4714744
[2,] 0.7069560 1.0000000 0.6086188 0.4637445
[3,] 0.5704892 0.6086188 1.0000000 0.5454963
[4,] 0.4714744 0.4637445 0.5454963 1.0000000</code></pre>
</div>
<div id="parameter-estimates-table-2" class="section level3" number="14.4.2">
<h3 number="14.4.2"><span class="header-section-number">14.4.2</span> Parameter Estimates Table</h3>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="#cb702-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(btb_lm_<span class="dv">1</span>, </span>
<span id="cb702-2"><a href="#cb702-2"></a>                     btb_lmer_RI, </span>
<span id="cb702-3"><a href="#cb702-3"></a>                     btb_gee_in, </span>
<span id="cb702-4"><a href="#cb702-4"></a>                     btb_gee_ex, </span>
<span id="cb702-5"><a href="#cb702-5"></a>                     btb_gee_un),</span>
<span id="cb702-6"><a href="#cb702-6"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;OLS&quot;</span>, </span>
<span id="cb702-7"><a href="#cb702-7"></a>                                       <span class="st">&quot;MLM-RI&quot;</span>, </span>
<span id="cb702-8"><a href="#cb702-8"></a>                                       <span class="st">&quot;GEE-in&quot;</span>, </span>
<span id="cb702-9"><a href="#cb702-9"></a>                                       <span class="st">&quot;GEE-ex&quot;</span>, </span>
<span id="cb702-10"><a href="#cb702-10"></a>                                       <span class="st">&quot;GEE-un&quot;</span>),</span>
<span id="cb702-11"><a href="#cb702-11"></a>                  <span class="dt">label =</span> <span class="st">&quot;GEEs&quot;</span>,</span>
<span id="cb702-12"><a href="#cb702-12"></a>                  <span class="dt">caption =</span> <span class="st">&quot;LM, MLM, and GEE&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
LM, MLM, and GEE
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
OLS
</th>
<th style="padding-left: 5px;padding-right: 5px;">
MLM-RI
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-in
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-ex
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-un
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
7.88<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.92<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
7.88<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.89<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.39<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.78)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.31)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.20)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.16)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.57<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.57<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.62<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.05)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.09)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
length&gt;6m
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.75
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.24
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.75
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.21
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.58
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.68)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.42)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.48)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.47)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.55<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.79
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.55<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.77
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.79
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.14)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.77)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.73)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.65)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.64)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentBtheB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.35<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.36
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.35
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.34
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.43
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.10)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.71)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.71)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.66)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.66)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.96<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.71<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.96<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.71<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.76<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.23)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.18)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.16)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.40
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Adj. R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1882.08
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1911.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-933.04
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
51.44
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: Residual
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
25.27
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Scale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
74.89
</td>
<td style="padding-left: 5px;padding-right: 5px;">
77.14
</td>
<td style="padding-left: 5px;padding-right: 5px;">
76.40
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="6">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="re-fit-models" class="section level3" number="14.4.3">
<h3 number="14.4.3"><span class="header-section-number">14.4.3</span> Re-Fit Models</h3>
<p><strong>Use the <code>geeglm()</code> function from the <code>geepack</code> package for the results to be used in a <code>anova()</code> table and interaction plots.</strong></p>
<p>This function does NOT produce the same starting model output as <code>gee::gee()</code>.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="#cb703-1"></a>btb_geeglm_in &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb703-2"><a href="#cb703-2"></a>                                 <span class="dt">data =</span> btb_long, </span>
<span id="cb703-3"><a href="#cb703-3"></a>                                 <span class="dt">id =</span> id,</span>
<span id="cb703-4"><a href="#cb703-4"></a>                                 <span class="dt">wave =</span> month,</span>
<span id="cb703-5"><a href="#cb703-5"></a>                                 <span class="dt">family =</span> gaussian, </span>
<span id="cb703-6"><a href="#cb703-6"></a>                                 <span class="dt">corstr =</span> <span class="st">&#39;independence&#39;</span>)</span>
<span id="cb703-7"><a href="#cb703-7"></a></span>
<span id="cb703-8"><a href="#cb703-8"></a>btb_geeglm_ex &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb703-9"><a href="#cb703-9"></a>                                 <span class="dt">data =</span> btb_long, </span>
<span id="cb703-10"><a href="#cb703-10"></a>                                 <span class="dt">id =</span> id, </span>
<span id="cb703-11"><a href="#cb703-11"></a>                                 <span class="dt">wave =</span> month,</span>
<span id="cb703-12"><a href="#cb703-12"></a>                                 <span class="dt">family =</span> gaussian, </span>
<span id="cb703-13"><a href="#cb703-13"></a>                                 <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span>
<span id="cb703-14"><a href="#cb703-14"></a></span>
<span id="cb703-15"><a href="#cb703-15"></a></span>
<span id="cb703-16"><a href="#cb703-16"></a>btb_geeglm_ar &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb703-17"><a href="#cb703-17"></a>                                 <span class="dt">data =</span> btb_long, </span>
<span id="cb703-18"><a href="#cb703-18"></a>                                 <span class="dt">id =</span> id, </span>
<span id="cb703-19"><a href="#cb703-19"></a>                                 <span class="dt">wave =</span> month,</span>
<span id="cb703-20"><a href="#cb703-20"></a>                                 <span class="dt">family =</span> gaussian, </span>
<span id="cb703-21"><a href="#cb703-21"></a>                                 <span class="dt">corstr =</span> <span class="st">&#39;ar1&#39;</span>)</span>
<span id="cb703-22"><a href="#cb703-22"></a></span>
<span id="cb703-23"><a href="#cb703-23"></a>btb_geeglm_un &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb703-24"><a href="#cb703-24"></a>                                 <span class="dt">data =</span> btb_long, </span>
<span id="cb703-25"><a href="#cb703-25"></a>                                 <span class="dt">id =</span> id,</span>
<span id="cb703-26"><a href="#cb703-26"></a>                                 <span class="dt">wave =</span> month,</span>
<span id="cb703-27"><a href="#cb703-27"></a>                                 <span class="dt">family =</span> gaussian, </span>
<span id="cb703-28"><a href="#cb703-28"></a>                                 <span class="dt">corstr =</span> <span class="st">&#39;unstructured&#39;</span>)</span></code></pre></div>
</div>
<div id="cant-use-the-likelihood-ratio-test" class="section level3" number="14.4.4">
<h3 number="14.4.4"><span class="header-section-number">14.4.4</span> Can’t Use the Likelihood Ratio Test</h3>
<p>The <code>anova()</code> function is used to compare nested models for parameters (fixed effects), not correlation structures.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="#cb704-1"></a><span class="kw">anova</span>(btb_geeglm_in, btb_geeglm_ex)</span></code></pre></div>
<pre><code>Models are identical</code></pre>
<pre><code>NULL</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="#cb707-1"></a><span class="kw">anova</span>(btb_geeglm_in, btb_geeglm_ar)</span></code></pre></div>
<pre><code>Models are identical</code></pre>
<pre><code>NULL</code></pre>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="#cb710-1"></a><span class="kw">anova</span>(btb_geeglm_in, btb_geeglm_un)</span></code></pre></div>
<pre><code>Models are identical</code></pre>
<pre><code>NULL</code></pre>
</div>
<div id="can-use-the-performance-rmse" class="section level3" number="14.4.5">
<h3 number="14.4.5"><span class="header-section-number">14.4.5</span> Can use the Performance (RMSE)</h3>
<p>Notice how similar the values are.</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="#cb713-1"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(btb_geeglm_in,</span>
<span id="cb713-2"><a href="#cb713-2"></a>                                 btb_geeglm_ex,</span>
<span id="cb713-3"><a href="#cb713-3"></a>                                 btb_geeglm_ar,</span>
<span id="cb713-4"><a href="#cb713-4"></a>                                 btb_geeglm_un,</span>
<span id="cb713-5"><a href="#cb713-5"></a>                                 <span class="dt">rank =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># Comparison of Model Performance Indices

Model         |   Type | RMSE | Performance_Score
-------------------------------------------------
btb_geeglm_in | geeglm | 8.56 |           100.00%
btb_geeglm_ar | geeglm | 8.66 |            22.93%
btb_geeglm_un | geeglm | 8.68 |             5.15%
btb_geeglm_ex | geeglm | 8.69 |             0.00%

Model btb_geeglm_in (of class geeglm) performed best with an overall performance score of 100.00%.</code></pre>
</div>
<div id="variaous-qic-measures-of-fit" class="section level3" number="14.4.6">
<h3 number="14.4.6"><span class="header-section-number">14.4.6</span> Variaous QIC Measures of Fit</h3>
<p>References:</p>
<ul>
<li><p>Pan, W. 2001. Akaike’s information criterion in generalized estimating equations. Biometrics 57:120-125. <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.0006-341X.2001.00120.x" class="uri">https://onlinelibrary.wiley.com/doi/abs/10.1111/j.0006-341X.2001.00120.x</a></p></li>
<li><p>Burnham, K. P. and D. R. Anderson. 2002. Model selection and multimodel inference: a practical information-theoretic approach. Second edition. Springer Science and Business Media, Inc., New York.
<a href="https://cds.cern.ch/record/1608735/files/9780387953649_TOC.pdf" class="uri">https://cds.cern.ch/record/1608735/files/9780387953649_TOC.pdf</a></p></li>
</ul>
<p>The <code>QIC()</code> is one way to <strong>try</strong> to measure model fit. You can enter more than one model into a single function call.</p>
<p>QIC(I) based on independence model &lt;– suggested by Pan (Biometric, March 2001), asymptotically unbiased estimator (choose the correlation stucture that produces the smallest QIC(I), p122)</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="#cb715-1"></a>MuMIn<span class="op">::</span><span class="kw">QIC</span>(btb_geeglm_in, </span>
<span id="cb715-2"><a href="#cb715-2"></a>           btb_geeglm_ex, </span>
<span id="cb715-3"><a href="#cb715-3"></a>           btb_geeglm_ar, </span>
<span id="cb715-4"><a href="#cb715-4"></a>           btb_geeglm_un, </span>
<span id="cb715-5"><a href="#cb715-5"></a>           <span class="dt">typeR =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># default</span></span>
<span id="cb715-6"><a href="#cb715-6"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;QIC&quot;</span>)</span></code></pre></div>
<table style="width:36%;">
<caption>QIC</caption>
<colgroup>
<col width="27%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">QIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>btb_geeglm_in</strong></td>
<td align="center">307</td>
</tr>
<tr class="even">
<td align="center"><strong>btb_geeglm_ex</strong></td>
<td align="center">296</td>
</tr>
<tr class="odd">
<td align="center"><strong>btb_geeglm_ar</strong></td>
<td align="center">298</td>
</tr>
<tr class="even">
<td align="center"><strong>btb_geeglm_un</strong></td>
<td align="center">297</td>
</tr>
</tbody>
</table>
<p>QIC(R) is based on quasi-likelihood of a working correlation R model, can <strong>NOT</strong> be used to select the working correlation matrix.</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="#cb716-1"></a>MuMIn<span class="op">::</span><span class="kw">QIC</span>(btb_geeglm_in, </span>
<span id="cb716-2"><a href="#cb716-2"></a>           btb_geeglm_ex, </span>
<span id="cb716-3"><a href="#cb716-3"></a>           btb_geeglm_ar, </span>
<span id="cb716-4"><a href="#cb716-4"></a>           btb_geeglm_un, </span>
<span id="cb716-5"><a href="#cb716-5"></a>           <span class="dt">typeR =</span> <span class="ot">TRUE</span>)    <span class="co"># NOT the default</span></span></code></pre></div>
<pre><code>                   QIC
btb_geeglm_in 306.5589
btb_geeglm_ex 304.5003
btb_geeglm_ar 304.6425
btb_geeglm_un 304.4087</code></pre>
<p>QIC_U(R) approximates QIC(R), and while both are useful for variable selection, they can NOT be applied to select the working correlation matrix.</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="#cb718-1"></a>MuMIn<span class="op">::</span><span class="kw">QICu</span>(btb_geeglm_in, </span>
<span id="cb718-2"><a href="#cb718-2"></a>            btb_geeglm_ex, </span>
<span id="cb718-3"><a href="#cb718-3"></a>            btb_geeglm_ar, </span>
<span id="cb718-4"><a href="#cb718-4"></a>            btb_geeglm_un) </span></code></pre></div>
<pre><code>                  QICu
btb_geeglm_in 292.0000
btb_geeglm_ex 283.7551
btb_geeglm_ar 285.6132
btb_geeglm_un 284.1707</code></pre>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="#cb720-1"></a>MuMIn<span class="op">::</span><span class="kw">model.sel</span>(btb_geeglm_in, </span>
<span id="cb720-2"><a href="#cb720-2"></a>                 btb_geeglm_ex, </span>
<span id="cb720-3"><a href="#cb720-3"></a>                 btb_geeglm_ar, </span>
<span id="cb720-4"><a href="#cb720-4"></a>                 btb_geeglm_un, </span>
<span id="cb720-5"><a href="#cb720-5"></a>                 <span class="dt">rank =</span> <span class="st">&quot;QIC&quot;</span>)     <span class="co">#sorts the best to the TOP, uses QIC(I)</span></span></code></pre></div>
<pre><code>Model selection table 
              (Int) bdi.pre drg lng     mnt trt             family       corstr
btb_geeglm_ex 5.880  0.6402   +   + -0.7070   + gaussian(identity) exchangeable
btb_geeglm_un 6.068  0.6307   +   + -0.7061   + gaussian(identity) unstructured
btb_geeglm_ar 6.620  0.5956   +   + -0.7357   + gaussian(identity)          ar1
btb_geeglm_in 7.883  0.5724   +   + -0.9608   + gaussian(identity) independence
              qLik   QIC delta weight
btb_geeglm_ex -140 296.3  0.00  0.450
btb_geeglm_un -140 296.6  0.32  0.382
btb_geeglm_ar -140 298.3  2.00  0.165
btb_geeglm_in -140 306.6 10.30  0.003
Models ranked by QIC(x) </code></pre>
</div>
<div id="plot-the-model-predictions-2" class="section level3" number="14.4.7">
<h3 number="14.4.7"><span class="header-section-number">14.4.7</span> Plot the model predictions</h3>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="#cb722-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> btb_geeglm_ex,</span>
<span id="cb722-2"><a href="#cb722-2"></a>                            <span class="dt">pred =</span> <span class="st">&quot;month&quot;</span>,</span>
<span id="cb722-3"><a href="#cb722-3"></a>                            <span class="dt">modx =</span> <span class="st">&quot;treatment&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-563-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Do not worry about confidence intervals.</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1"></a><span class="kw">expand.grid</span>(<span class="dt">bdi.pre =</span> <span class="dv">23</span>,</span>
<span id="cb723-2"><a href="#cb723-2"></a>            <span class="dt">length =</span> <span class="st">&quot;&lt;6m&quot;</span>,</span>
<span id="cb723-3"><a href="#cb723-3"></a>            <span class="dt">drug =</span> <span class="st">&quot;No&quot;</span>,</span>
<span id="cb723-4"><a href="#cb723-4"></a>            <span class="dt">treatment =</span> <span class="kw">levels</span>(btb_long<span class="op">$</span>treatment),</span>
<span id="cb723-5"><a href="#cb723-5"></a>            <span class="dt">month =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">8</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb723-6"><a href="#cb723-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit_in =</span> <span class="kw">predict</span>(btb_geeglm_in,</span>
<span id="cb723-7"><a href="#cb723-7"></a>                                 <span class="dt">newdata =</span> .,</span>
<span id="cb723-8"><a href="#cb723-8"></a>                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb723-9"><a href="#cb723-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit_ex =</span> <span class="kw">predict</span>(btb_geeglm_ex,</span>
<span id="cb723-10"><a href="#cb723-10"></a>                                 <span class="dt">newdata =</span> .,</span>
<span id="cb723-11"><a href="#cb723-11"></a>                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb723-12"><a href="#cb723-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit_ar =</span> <span class="kw">predict</span>(btb_geeglm_ar,</span>
<span id="cb723-13"><a href="#cb723-13"></a>                                 <span class="dt">newdata =</span> .,</span>
<span id="cb723-14"><a href="#cb723-14"></a>                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb723-15"><a href="#cb723-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit_un =</span> <span class="kw">predict</span>(btb_geeglm_un,</span>
<span id="cb723-16"><a href="#cb723-16"></a>                                 <span class="dt">newdata =</span> .,</span>
<span id="cb723-17"><a href="#cb723-17"></a>                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb723-18"><a href="#cb723-18"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&quot;fit_&quot;</span>),</span>
<span id="cb723-19"><a href="#cb723-19"></a>                      <span class="dt">names_to =</span> <span class="st">&quot;covR&quot;</span>,</span>
<span id="cb723-20"><a href="#cb723-20"></a>                      <span class="dt">names_pattern =</span> <span class="st">&quot;fit_(.*)&quot;</span>,</span>
<span id="cb723-21"><a href="#cb723-21"></a>                      <span class="dt">names_ptype =</span> <span class="kw">list</span>(<span class="dt">covR =</span> <span class="st">&quot;factor()&quot;</span>),</span>
<span id="cb723-22"><a href="#cb723-22"></a>                      <span class="dt">values_to =</span> <span class="st">&quot;fit&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb723-23"><a href="#cb723-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">covR =</span> <span class="kw">factor</span>(covR, </span>
<span id="cb723-24"><a href="#cb723-24"></a>                              <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;un&quot;</span>, <span class="st">&quot;ar&quot;</span>, <span class="st">&quot;ex&quot;</span>, <span class="st">&quot;in&quot;</span>),</span>
<span id="cb723-25"><a href="#cb723-25"></a>                              <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Unstructured&quot;</span>,</span>
<span id="cb723-26"><a href="#cb723-26"></a>                                         <span class="st">&quot;Auto-Regressive&quot;</span>,</span>
<span id="cb723-27"><a href="#cb723-27"></a>                                         <span class="st">&quot;Compound Symetry&quot;</span>,</span>
<span id="cb723-28"><a href="#cb723-28"></a>                                         <span class="st">&quot;Independence&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb723-29"><a href="#cb723-29"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb723-30"><a href="#cb723-30"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb723-31"><a href="#cb723-31"></a>             <span class="dt">linetype =</span> treatment)) <span class="op">+</span></span>
<span id="cb723-32"><a href="#cb723-32"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></span>
<span id="cb723-33"><a href="#cb723-33"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb723-34"><a href="#cb723-34"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;BtheB - Predictions from four GEE models (geeglm)&quot;</span>,</span>
<span id="cb723-35"><a href="#cb723-35"></a>       <span class="dt">x =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb723-36"><a href="#cb723-36"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted BDI&quot;</span>,</span>
<span id="cb723-37"><a href="#cb723-37"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Treatment:&quot;</span>) <span class="op">+</span></span>
<span id="cb723-38"><a href="#cb723-38"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>)) <span class="op">+</span></span>
<span id="cb723-39"><a href="#cb723-39"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb723-40"><a href="#cb723-40"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>covR)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-564-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="#cb724-1"></a><span class="kw">expand.grid</span>(<span class="dt">bdi.pre =</span> <span class="dv">23</span>,</span>
<span id="cb724-2"><a href="#cb724-2"></a>            <span class="dt">length =</span> <span class="st">&quot;&lt;6m&quot;</span>,</span>
<span id="cb724-3"><a href="#cb724-3"></a>            <span class="dt">drug =</span> <span class="st">&quot;No&quot;</span>,</span>
<span id="cb724-4"><a href="#cb724-4"></a>            <span class="dt">treatment =</span> <span class="kw">levels</span>(btb_long<span class="op">$</span>treatment),</span>
<span id="cb724-5"><a href="#cb724-5"></a>            <span class="dt">month =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">8</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb724-6"><a href="#cb724-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit_in =</span> <span class="kw">predict</span>(btb_geeglm_in,</span>
<span id="cb724-7"><a href="#cb724-7"></a>                                 <span class="dt">newdata =</span> .,</span>
<span id="cb724-8"><a href="#cb724-8"></a>                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb724-9"><a href="#cb724-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit_ex =</span> <span class="kw">predict</span>(btb_geeglm_ex,</span>
<span id="cb724-10"><a href="#cb724-10"></a>                                 <span class="dt">newdata =</span> .,</span>
<span id="cb724-11"><a href="#cb724-11"></a>                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb724-12"><a href="#cb724-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit_ar =</span> <span class="kw">predict</span>(btb_geeglm_ar,</span>
<span id="cb724-13"><a href="#cb724-13"></a>                                 <span class="dt">newdata =</span> .,</span>
<span id="cb724-14"><a href="#cb724-14"></a>                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb724-15"><a href="#cb724-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit_un =</span> <span class="kw">predict</span>(btb_geeglm_un,</span>
<span id="cb724-16"><a href="#cb724-16"></a>                                 <span class="dt">newdata =</span> .,</span>
<span id="cb724-17"><a href="#cb724-17"></a>                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb724-18"><a href="#cb724-18"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&quot;fit_&quot;</span>),</span>
<span id="cb724-19"><a href="#cb724-19"></a>                      <span class="dt">names_to =</span> <span class="st">&quot;covR&quot;</span>,</span>
<span id="cb724-20"><a href="#cb724-20"></a>                      <span class="dt">names_pattern =</span> <span class="st">&quot;fit_(.*)&quot;</span>,</span>
<span id="cb724-21"><a href="#cb724-21"></a>                      <span class="dt">names_ptype =</span> <span class="kw">list</span>(<span class="dt">covR =</span> <span class="st">&quot;factor()&quot;</span>),</span>
<span id="cb724-22"><a href="#cb724-22"></a>                      <span class="dt">values_to =</span> <span class="st">&quot;fit&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb724-23"><a href="#cb724-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">covR =</span> <span class="kw">factor</span>(covR, </span>
<span id="cb724-24"><a href="#cb724-24"></a>                              <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;un&quot;</span>, <span class="st">&quot;ar&quot;</span>, <span class="st">&quot;ex&quot;</span>, <span class="st">&quot;in&quot;</span>),</span>
<span id="cb724-25"><a href="#cb724-25"></a>                              <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Unstructured&quot;</span>,</span>
<span id="cb724-26"><a href="#cb724-26"></a>                                         <span class="st">&quot;Auto-Regressive&quot;</span>,</span>
<span id="cb724-27"><a href="#cb724-27"></a>                                         <span class="st">&quot;Compound Symetry&quot;</span>,</span>
<span id="cb724-28"><a href="#cb724-28"></a>                                         <span class="st">&quot;Independence&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb724-29"><a href="#cb724-29"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb724-30"><a href="#cb724-30"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb724-31"><a href="#cb724-31"></a>             <span class="dt">color =</span> covR,</span>
<span id="cb724-32"><a href="#cb724-32"></a>             <span class="dt">linetype =</span> treatment)) <span class="op">+</span></span>
<span id="cb724-33"><a href="#cb724-33"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></span>
<span id="cb724-34"><a href="#cb724-34"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb724-35"><a href="#cb724-35"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;BtheB - Predictions from four GEE models (geeglm)&quot;</span>,</span>
<span id="cb724-36"><a href="#cb724-36"></a>       <span class="dt">x =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb724-37"><a href="#cb724-37"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted BDI&quot;</span>,</span>
<span id="cb724-38"><a href="#cb724-38"></a>       <span class="dt">color =</span> <span class="st">&quot;Covariance Pattern:&quot;</span>,</span>
<span id="cb724-39"><a href="#cb724-39"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Treatment:&quot;</span>) <span class="op">+</span></span>
<span id="cb724-40"><a href="#cb724-40"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>)) <span class="op">+</span></span>
<span id="cb724-41"><a href="#cb724-41"></a><span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">values     =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb724-42"><a href="#cb724-42"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values    =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb724-43"><a href="#cb724-43"></a>                                   <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb724-44"><a href="#cb724-44"></a>                                   <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb724-45"><a href="#cb724-45"></a>                                   <span class="st">&quot;darkgreen&quot;</span>)) <span class="op">+</span></span>
<span id="cb724-46"><a href="#cb724-46"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-565-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="investigate-interactions-not-with-time-month" class="section level3" number="14.4.8">
<h3 number="14.4.8"><span class="header-section-number">14.4.8</span> Investigate interactions NOT with time (<code>month</code>)</h3>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="#cb725-1"></a>btb_geeglm_ex_<span class="dv">1</span> &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre<span class="op">*</span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb725-2"><a href="#cb725-2"></a>                                   <span class="dt">data =</span> btb_long, </span>
<span id="cb725-3"><a href="#cb725-3"></a>                                   <span class="dt">id =</span> id, </span>
<span id="cb725-4"><a href="#cb725-4"></a>                                   <span class="dt">wave =</span> month,</span>
<span id="cb725-5"><a href="#cb725-5"></a>                                   <span class="dt">family =</span> gaussian, </span>
<span id="cb725-6"><a href="#cb725-6"></a>                                   <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span>
<span id="cb725-7"><a href="#cb725-7"></a></span>
<span id="cb725-8"><a href="#cb725-8"></a>btb_geeglm_ex_<span class="dv">2</span> &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre<span class="op">*</span>drug <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb725-9"><a href="#cb725-9"></a>                                   <span class="dt">data =</span> btb_long, </span>
<span id="cb725-10"><a href="#cb725-10"></a>                                   <span class="dt">id =</span> id, </span>
<span id="cb725-11"><a href="#cb725-11"></a>                                   <span class="dt">wave =</span> month,</span>
<span id="cb725-12"><a href="#cb725-12"></a>                                   <span class="dt">family =</span> gaussian, </span>
<span id="cb725-13"><a href="#cb725-13"></a>                                   <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span>
<span id="cb725-14"><a href="#cb725-14"></a></span>
<span id="cb725-15"><a href="#cb725-15"></a>btb_geeglm_ex_<span class="dv">3</span> &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st">  </span>bdi.pre<span class="op">*</span>treatment <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>month, </span>
<span id="cb725-16"><a href="#cb725-16"></a>                                   <span class="dt">data =</span> btb_long, </span>
<span id="cb725-17"><a href="#cb725-17"></a>                                   <span class="dt">id =</span> id, </span>
<span id="cb725-18"><a href="#cb725-18"></a>                                   <span class="dt">wave =</span> month,</span>
<span id="cb725-19"><a href="#cb725-19"></a>                                   <span class="dt">family =</span> gaussian, </span>
<span id="cb725-20"><a href="#cb725-20"></a>                                   <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="#cb726-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(btb_geeglm_ex, </span>
<span id="cb726-2"><a href="#cb726-2"></a>                    btb_geeglm_ex_<span class="dv">1</span>, </span>
<span id="cb726-3"><a href="#cb726-3"></a>                    btb_geeglm_ex_<span class="dv">2</span>,</span>
<span id="cb726-4"><a href="#cb726-4"></a>                    btb_geeglm_ex_<span class="dv">3</span>),</span>
<span id="cb726-5"><a href="#cb726-5"></a>               <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;None&quot;</span>,</span>
<span id="cb726-6"><a href="#cb726-6"></a>                                      <span class="st">&quot;Length&quot;</span>,</span>
<span id="cb726-7"><a href="#cb726-7"></a>                                      <span class="st">&quot;Antidpressant&quot;</span>,</span>
<span id="cb726-8"><a href="#cb726-8"></a>                                      <span class="st">&quot;Treatment&quot;</span>),</span>
<span id="cb726-9"><a href="#cb726-9"></a>               <span class="dt">label =</span> <span class="st">&quot;GEE_inter1&quot;</span>,</span>
<span id="cb726-10"><a href="#cb726-10"></a>               <span class="dt">caption =</span> <span class="st">&quot;GEE (exchangable): Interactions, not with Time&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
GEE (exchangable): Interactions, not with Time
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
None
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Length
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Antidpressant
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Treatment
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.88<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.24
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.37
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.62
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.99)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.68)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.78)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.76<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.75<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.74<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.12)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.12)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
length&gt;6m
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.20
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.66
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.47
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.22
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.48)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.27)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.46)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.48)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.77
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.47
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.76
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.65)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.62)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.20)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.64)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentBtheB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.42
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.19
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.24
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.66)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.63)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.67)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(3.38)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.71<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.70<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.71<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.71<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre:length&gt;6m
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.23
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.16)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre:drugYes
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.19
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.17)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre:treatmentBtheB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.17)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Scale parameter: gamma
</td>
<td style="padding-left: 5px;padding-right: 5px;">
75.50
</td>
<td style="padding-left: 5px;padding-right: 5px;">
74.56
</td>
<td style="padding-left: 5px;padding-right: 5px;">
73.92
</td>
<td style="padding-left: 5px;padding-right: 5px;">
74.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Scale parameter: SE
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.68
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.71
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.15
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.72
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Correlation parameter: alpha
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.69
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.69
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.68
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.68
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Correlation parameter: SE
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.12
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.10
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. clust.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="investigate-interactions-with-time-month" class="section level3" number="14.4.9">
<h3 number="14.4.9"><span class="header-section-number">14.4.9</span> Investigate interactions with time (<code>month</code>)</h3>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="#cb727-1"></a>btb_geeglm_ex_<span class="dv">11</span> &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment<span class="op">*</span>month, </span>
<span id="cb727-2"><a href="#cb727-2"></a>                                   <span class="dt">data =</span> btb_long, </span>
<span id="cb727-3"><a href="#cb727-3"></a>                                   <span class="dt">id =</span> id, </span>
<span id="cb727-4"><a href="#cb727-4"></a>                                   <span class="dt">wave =</span> month,</span>
<span id="cb727-5"><a href="#cb727-5"></a>                                   <span class="dt">family =</span> gaussian, </span>
<span id="cb727-6"><a href="#cb727-6"></a>                                   <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span>
<span id="cb727-7"><a href="#cb727-7"></a></span>
<span id="cb727-8"><a href="#cb727-8"></a>btb_geeglm_ex_<span class="dv">12</span> &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>drug<span class="op">*</span>month, </span>
<span id="cb727-9"><a href="#cb727-9"></a>                                   <span class="dt">data =</span> btb_long, </span>
<span id="cb727-10"><a href="#cb727-10"></a>                                   <span class="dt">id =</span> id, </span>
<span id="cb727-11"><a href="#cb727-11"></a>                                   <span class="dt">wave =</span> month,</span>
<span id="cb727-12"><a href="#cb727-12"></a>                                   <span class="dt">family =</span> gaussian, </span>
<span id="cb727-13"><a href="#cb727-13"></a>                                   <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span>
<span id="cb727-14"><a href="#cb727-14"></a></span>
<span id="cb727-15"><a href="#cb727-15"></a>btb_geeglm_ex_<span class="dv">13</span> &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>bdi.pre <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st">  </span>length<span class="op">*</span>month, </span>
<span id="cb727-16"><a href="#cb727-16"></a>                                   <span class="dt">data =</span> btb_long, </span>
<span id="cb727-17"><a href="#cb727-17"></a>                                   <span class="dt">id =</span> id, </span>
<span id="cb727-18"><a href="#cb727-18"></a>                                   <span class="dt">wave =</span> month,</span>
<span id="cb727-19"><a href="#cb727-19"></a>                                   <span class="dt">family =</span> gaussian, </span>
<span id="cb727-20"><a href="#cb727-20"></a>                                   <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span>
<span id="cb727-21"><a href="#cb727-21"></a></span>
<span id="cb727-22"><a href="#cb727-22"></a>btb_geeglm_ex_<span class="dv">14</span> &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(bdi <span class="op">~</span><span class="st"> </span>length <span class="op">+</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>bdi.pre<span class="op">*</span>month, </span>
<span id="cb727-23"><a href="#cb727-23"></a>                                   <span class="dt">data =</span> btb_long, </span>
<span id="cb727-24"><a href="#cb727-24"></a>                                   <span class="dt">id =</span> id, </span>
<span id="cb727-25"><a href="#cb727-25"></a>                                   <span class="dt">wave =</span> month,</span>
<span id="cb727-26"><a href="#cb727-26"></a>                                   <span class="dt">family =</span> gaussian, </span>
<span id="cb727-27"><a href="#cb727-27"></a>                                   <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="#cb728-1"></a>texreg<span class="op">::</span><span class="kw">knitreg</span>(<span class="kw">list</span>(btb_geeglm_ex, </span>
<span id="cb728-2"><a href="#cb728-2"></a>                       btb_geeglm_ex_<span class="dv">11</span>, </span>
<span id="cb728-3"><a href="#cb728-3"></a>                       btb_geeglm_ex_<span class="dv">12</span>,</span>
<span id="cb728-4"><a href="#cb728-4"></a>                       btb_geeglm_ex_<span class="dv">13</span>,</span>
<span id="cb728-5"><a href="#cb728-5"></a>                       btb_geeglm_ex_<span class="dv">14</span>),</span>
<span id="cb728-6"><a href="#cb728-6"></a>               <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;None&quot;</span>,</span>
<span id="cb728-7"><a href="#cb728-7"></a>                                      <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb728-8"><a href="#cb728-8"></a>                                      <span class="st">&quot;Antidepressant&quot;</span>,</span>
<span id="cb728-9"><a href="#cb728-9"></a>                                      <span class="st">&quot;Length&quot;</span>,</span>
<span id="cb728-10"><a href="#cb728-10"></a>                                      <span class="st">&quot;BL BDI&quot;</span>),</span>
<span id="cb728-11"><a href="#cb728-11"></a>               <span class="dt">label=</span><span class="st">&quot;GEEinter2&quot;</span>,</span>
<span id="cb728-12"><a href="#cb728-12"></a>               <span class="dt">caption =</span> <span class="st">&quot;GEE (exchangable): Interactions with Time&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
GEE (exchangable): Interactions with Time
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
None
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Treatment
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Antidepressant
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Length
</th>
<th style="padding-left: 5px;padding-right: 5px;">
BL BDI
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.88<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.83<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.63<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.28<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.09<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.22)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.21)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.34)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.64<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.67<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.09)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
length&gt;6m
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.20
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.44
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.27
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.48)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.49)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.49)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.83)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.48)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.77
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.74
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-4.31<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.79
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.72
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.65)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.66)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.01)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.64)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.66)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentBtheB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-4.23<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.32
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.31
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.36
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.66)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(2.00)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.67)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.66)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(1.66)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.71<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.95<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.88<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.80<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.50
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.15)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.26)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.21)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.16)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.35)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentBtheB:month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.47
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.30)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugYes:month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.38
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.30)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
length&gt;6m:month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.16
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.29)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
bdi.pre:month
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.01
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.01)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Scale parameter: gamma
</td>
<td style="padding-left: 5px;padding-right: 5px;">
75.50
</td>
<td style="padding-left: 5px;padding-right: 5px;">
76.03
</td>
<td style="padding-left: 5px;padding-right: 5px;">
76.13
</td>
<td style="padding-left: 5px;padding-right: 5px;">
75.21
</td>
<td style="padding-left: 5px;padding-right: 5px;">
75.17
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Scale parameter: SE
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.68
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.83
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.81
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.63
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.79
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Correlation parameter: alpha
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.69
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.70
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.70
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.69
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.69
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Correlation parameter: SE
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.11
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
<td style="padding-left: 5px;padding-right: 5px;">
280
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. clust.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
<td style="padding-left: 5px;padding-right: 5px;">
97
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="6">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Now only plot the significant variables for the ‘best’ model.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="#cb729-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> btb_geeglm_ex,</span>
<span id="cb729-2"><a href="#cb729-2"></a>                            <span class="dt">pred =</span> <span class="st">&quot;month&quot;</span>,</span>
<span id="cb729-3"><a href="#cb729-3"></a>                            <span class="dt">modx =</span> <span class="st">&quot;bdi.pre&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-570-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="#cb730-1"></a>interactions<span class="op">::</span><span class="kw">interact_plot</span>(<span class="dt">model =</span> btb_geeglm_ex,</span>
<span id="cb730-2"><a href="#cb730-2"></a>                            <span class="dt">pred =</span> <span class="st">&quot;month&quot;</span>,</span>
<span id="cb730-3"><a href="#cb730-3"></a>                            <span class="dt">modx =</span> <span class="st">&quot;bdi.pre&quot;</span>,</span>
<span id="cb730-4"><a href="#cb730-4"></a>                            <span class="dt">modx.values =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>),</span>
<span id="cb730-5"><a href="#cb730-5"></a>                            <span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">length =</span> <span class="st">&quot;&lt;6m&quot;</span>,</span>
<span id="cb730-6"><a href="#cb730-6"></a>                                      <span class="dt">drug =</span> <span class="st">&quot;No&quot;</span>,</span>
<span id="cb730-7"><a href="#cb730-7"></a>                                      <span class="dt">treatment =</span> <span class="st">&quot;TAU&quot;</span>),</span>
<span id="cb730-8"><a href="#cb730-8"></a>                            <span class="dt">colors =</span> <span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb730-9"><a href="#cb730-9"></a>                            <span class="dt">x.label =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb730-10"><a href="#cb730-10"></a>                            <span class="dt">y.label =</span> <span class="st">&quot;Predicted BDI&quot;</span>,</span>
<span id="cb730-11"><a href="#cb730-11"></a>                            <span class="dt">legend.main    =</span> <span class="st">&quot;Baseline BDI:&quot;</span>) <span class="op">+</span></span>
<span id="cb730-12"><a href="#cb730-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb730-13"><a href="#cb730-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb730-14"><a href="#cb730-14"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb730-15"><a href="#cb730-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;BtheB - Predictions from the GEE model (exchangable)&quot;</span>,</span>
<span id="cb730-16"><a href="#cb730-16"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Trajectory for a person with BL depression &lt; 6 months and randomized to TAU&quot;</span>) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-571-1.png" width="576" style="display: block; margin: auto;" /></p>
<!--chapter:end:30_example_gee_BtheB.Rmd-->
</div>
</div>
</div>
<div id="gee-binary-outcome-respiratory-illness" class="section level1" number="15">
<h1 number="15"><span class="header-section-number">15</span> GEE, Binary Outcome: Respiratory Illness</h1>
<div id="packages" class="section level2" number="15.1">
<h2 number="15.1"><span class="header-section-number">15.1</span> Packages</h2>
<div id="cran" class="section level3" number="15.1.1">
<h3 number="15.1.1"><span class="header-section-number">15.1.1</span> CRAN</h3>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="#cb731-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb731-2"><a href="#cb731-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb731-3"><a href="#cb731-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb731-4"><a href="#cb731-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb731-5"><a href="#cb731-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb731-6"><a href="#cb731-6"></a></span>
<span id="cb731-7"><a href="#cb731-7"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb731-8"><a href="#cb731-8"></a></span>
<span id="cb731-9"><a href="#cb731-9"></a><span class="kw">library</span>(corrplot)     <span class="co"># Vizualize correlation matrix</span></span>
<span id="cb731-10"><a href="#cb731-10"></a><span class="kw">library</span>(gee)          <span class="co"># Genderalized Estimation Equation Solver</span></span>
<span id="cb731-11"><a href="#cb731-11"></a><span class="kw">library</span>(geepack)      <span class="co"># Genderalized Estimation Equation Package </span></span>
<span id="cb731-12"><a href="#cb731-12"></a><span class="kw">library</span>(MuMIn)        <span class="co"># Multi-Model Inference (caluclate QIC)</span></span>
<span id="cb731-13"><a href="#cb731-13"></a></span>
<span id="cb731-14"><a href="#cb731-14"></a><span class="kw">library</span>(HSAUR)        <span class="co"># package with the dataset</span></span></code></pre></div>
</div>
<div id="github" class="section level3" number="15.1.2">
<h3 number="15.1.2"><span class="header-section-number">15.1.2</span> GitHub</h3>
<p>Helper <code>extract</code> functions for exponentiating parameters form generalized regression models within a <code>texreg</code> table of model parameters.</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="#cb732-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb732-2"><a href="#cb732-2"></a><span class="co"># library(devtools)</span></span>
<span id="cb732-3"><a href="#cb732-3"></a><span class="co"># install_github(&quot;SarBearSchwartz/texreghelpr&quot;)</span></span>
<span id="cb732-4"><a href="#cb732-4"></a></span>
<span id="cb732-5"><a href="#cb732-5"></a><span class="kw">library</span>(texreghelpr)</span></code></pre></div>
</div>
</div>
<div id="prepare-and-get-to-know-the-dataset-1" class="section level2" number="15.2">
<h2 number="15.2"><span class="header-section-number">15.2</span> Prepare and get to know the dataset</h2>
<div id="read-in-the-data-1" class="section level3" number="15.2.1">
<h3 number="15.2.1"><span class="header-section-number">15.2.1</span> Read in the data</h3>
<blockquote>
<p>This data set is in the <strong>HSAUR</strong> package.</p>
</blockquote>
<p>In each of two centres, eligible patients were randomly assigned to active treatment or placebo. During the treatment, the respiratory status (categorised poor or good) was determined at each of four, monthly visits. The trial recruited 111 participants (54 in the active group, 57 in the placebo group) and there were no missing data for either the responses or the covariates. The question of interest is to assess whether the treatment is effective and to estimate its effect.</p>
<p>Note that the data (555 observations on the following 7 variables) are in long form, i.e, repeated measurments are stored as additional rows in the data frame.</p>
<ul>
<li><p>Indicators</p>
<ul>
<li><code>subject</code> the patient ID, a factor with levels 1 to 111</li>
<li><code>centre</code> the study center, a factor with levels 1 and 2<br />
</li>
<li><code>month</code> the month, each patient was examined at months 0, 1, 2, 3 and 4</li>
</ul></li>
<li><p>Outcome or dependent variable</p>
<ul>
<li><code>status</code> the respiratory status (response variable), a factor with levels poor and good</li>
</ul></li>
<li><p>Main predictor or independent variable of interest</p>
<ul>
<li><code>treatment</code> the treatment arm, a factor with levels placebo and treatment</li>
</ul></li>
<li><p>Time-invariant Covariates</p>
<ul>
<li><code>sex</code> a factor with levels female and male<br />
</li>
<li><code>age</code> the age of the patient</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="#cb733-1"></a><span class="kw">data</span>(<span class="st">&quot;respiratory&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;HSAUR&quot;</span>)</span>
<span id="cb733-2"><a href="#cb733-2"></a></span>
<span id="cb733-3"><a href="#cb733-3"></a><span class="kw">str</span>(respiratory)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   555 obs. of  7 variables:
 $ centre   : Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ treatment: Factor w/ 2 levels &quot;placebo&quot;,&quot;treatment&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ sex      : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ age      : num  46 46 46 46 46 28 28 28 28 28 ...
 $ status   : Factor w/ 2 levels &quot;poor&quot;,&quot;good&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ month    : Ord.factor w/ 5 levels &quot;0&quot;&lt;&quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;..: 1 2 3 4 5 1 2 3 4 5 ...
 $ subject  : Factor w/ 111 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 2 2 2 2 2 ...</code></pre>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="#cb735-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(respiratory)</span></code></pre></div>
<pre><code>    centre treatment    sex age status month subject
1        1   placebo female  46   poor     0       1
112      1   placebo female  46   poor     1       1
223      1   placebo female  46   poor     2       1
334      1   placebo female  46   poor     3       1
...   &lt;NA&gt;      &lt;NA&gt;   &lt;NA&gt; ...   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
222      2 treatment female  31   good     1     111
333      2 treatment female  31   good     2     111
444      2 treatment female  31   good     3     111
555      2 treatment female  31   good     4     111</code></pre>
</div>
<div id="wide-format-2" class="section level3" number="15.2.2">
<h3 number="15.2.2"><span class="header-section-number">15.2.2</span> Wide Format</h3>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="#cb737-1"></a>data_wide &lt;-<span class="st"> </span>respiratory <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb737-2"><a href="#cb737-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(<span class="dt">key =</span> month,</span>
<span id="cb737-3"><a href="#cb737-3"></a>                <span class="dt">value =</span> status,</span>
<span id="cb737-4"><a href="#cb737-4"></a>                <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb737-5"><a href="#cb737-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="st">&quot;BL_status&quot;</span> =<span class="st"> &quot;month_0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb737-6"><a href="#cb737-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(subject) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb737-7"><a href="#cb737-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(subject, centre, sex, age, treatment, BL_status, <span class="kw">starts_with</span>(<span class="st">&quot;month&quot;</span>))  </span>
<span id="cb737-8"><a href="#cb737-8"></a></span>
<span id="cb737-9"><a href="#cb737-9"></a><span class="kw">str</span>(data_wide)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   111 obs. of  10 variables:
 $ subject  : Factor w/ 111 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
 $ centre   : Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ sex      : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 1 1 1 2 1 1 1 1 1 ...
 $ age      : num  46 28 23 44 13 34 43 28 31 37 ...
 $ treatment: Factor w/ 2 levels &quot;placebo&quot;,&quot;treatment&quot;: 1 1 2 1 1 2 1 2 2 1 ...
 $ BL_status: Factor w/ 2 levels &quot;poor&quot;,&quot;good&quot;: 1 1 2 2 2 1 1 1 2 2 ...
 $ month_1  : Factor w/ 2 levels &quot;poor&quot;,&quot;good&quot;: 1 1 2 2 2 1 2 1 2 1 ...
 $ month_2  : Factor w/ 2 levels &quot;poor&quot;,&quot;good&quot;: 1 1 2 2 2 1 1 1 2 2 ...
 $ month_3  : Factor w/ 2 levels &quot;poor&quot;,&quot;good&quot;: 1 1 2 2 2 1 2 1 2 2 ...
 $ month_4  : Factor w/ 2 levels &quot;poor&quot;,&quot;good&quot;: 1 1 2 1 2 1 2 1 2 1 ...</code></pre>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="#cb739-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_wide)</span></code></pre></div>
<pre><code>    subject centre    sex age treatment BL_status month_1 month_2 month_3
1         1      1 female  46   placebo      poor    poor    poor    poor
2         2      1 female  28   placebo      poor    poor    poor    poor
3         3      1 female  23 treatment      good    good    good    good
4         4      1 female  44   placebo      good    good    good    good
...    &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt; ...      &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;
108     108      2   male  39 treatment      poor    good    good    good
109     109      2 female  68 treatment      poor    good    good    good
110     110      2   male  63 treatment      good    good    good    good
111     111      2 female  31 treatment      good    good    good    good
    month_4
1      poor
2      poor
3      good
4      poor
...    &lt;NA&gt;
108    good
109    good
110    good
111    good</code></pre>
</div>
<div id="long-format-2" class="section level3" number="15.2.3">
<h3 number="15.2.3"><span class="header-section-number">15.2.3</span> Long Format</h3>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="#cb741-1"></a>data_long &lt;-<span class="st"> </span>data_wide<span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb741-2"><a href="#cb741-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> month,</span>
<span id="cb741-3"><a href="#cb741-3"></a>                <span class="dt">value =</span> status,</span>
<span id="cb741-4"><a href="#cb741-4"></a>                <span class="kw">starts_with</span>(<span class="st">&quot;month&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb741-5"><a href="#cb741-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">month =</span> <span class="kw">str_sub</span>(month, <span class="dt">start =</span> <span class="dv">-1</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.numeric) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb741-6"><a href="#cb741-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">status =</span> <span class="kw">case_when</span>(status <span class="op">==</span><span class="st"> &quot;poor&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb741-7"><a href="#cb741-7"></a>                                   status <span class="op">==</span><span class="st"> &quot;good&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb741-8"><a href="#cb741-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(subject, month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb741-9"><a href="#cb741-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(subject, centre, sex, age, treatment, BL_status, month, status) </span>
<span id="cb741-10"><a href="#cb741-10"></a></span>
<span id="cb741-11"><a href="#cb741-11"></a></span>
<span id="cb741-12"><a href="#cb741-12"></a><span class="kw">str</span>(data_long)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   444 obs. of  8 variables:
 $ subject  : Factor w/ 111 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 2 2 2 2 3 3 ...
 $ centre   : Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ sex      : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ age      : num  46 46 46 46 28 28 28 28 23 23 ...
 $ treatment: Factor w/ 2 levels &quot;placebo&quot;,&quot;treatment&quot;: 1 1 1 1 1 1 1 1 2 2 ...
 $ BL_status: Factor w/ 2 levels &quot;poor&quot;,&quot;good&quot;: 1 1 1 1 1 1 1 1 2 2 ...
 $ month    : num  1 2 3 4 1 2 3 4 1 2 ...
 $ status   : num  0 0 0 0 0 0 0 0 1 1 ...</code></pre>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="#cb743-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_long)</span></code></pre></div>
<pre><code>    subject centre    sex age treatment BL_status month status
1         1      1 female  46   placebo      poor     1      0
2         1      1 female  46   placebo      poor     2      0
3         1      1 female  46   placebo      poor     3      0
4         1      1 female  46   placebo      poor     4      0
...    &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt; ...      &lt;NA&gt;      &lt;NA&gt;   ...    ...
441     111      2 female  31 treatment      good     1      1
442     111      2 female  31 treatment      good     2      1
443     111      2 female  31 treatment      good     3      1
444     111      2 female  31 treatment      good     4      1</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-6" class="section level2" number="15.3">
<h2 number="15.3"><span class="header-section-number">15.3</span> Exploratory Data Analysis</h2>
<div id="summary-statistics" class="section level3" number="15.3.1">
<h3 number="15.3.1"><span class="header-section-number">15.3.1</span> Summary Statistics</h3>
<div id="demographics-and-baseline-measure" class="section level4" number="15.3.1.1">
<h4 number="15.3.1.1"><span class="header-section-number">15.3.1.1</span> Demographics and Baseline Measure</h4>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="#cb745-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb745-2"><a href="#cb745-2"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(centre, sex, age, BL_status, </span>
<span id="cb745-3"><a href="#cb745-3"></a>                    <span class="dt">splitby =</span> <span class="op">~</span><span class="st"> </span>treatment,</span>
<span id="cb745-4"><a href="#cb745-4"></a>                    <span class="dt">output =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
placebo
</th>
<th>
treatment
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 57
</td>
<td>
n = 54
</td>
</tr>
<tr>
<td>
centre
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
1
</td>
<td>
29 (50.9%)
</td>
<td>
27 (50%)
</td>
</tr>
<tr>
<td>
2
</td>
<td>
28 (49.1%)
</td>
<td>
27 (50%)
</td>
</tr>
<tr>
<td>
sex
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
female
</td>
<td>
40 (70.2%)
</td>
<td>
48 (88.9%)
</td>
</tr>
<tr>
<td>
male
</td>
<td>
17 (29.8%)
</td>
<td>
6 (11.1%)
</td>
</tr>
<tr>
<td>
age
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
33.6 (13.4)
</td>
<td>
32.9 (14.0)
</td>
</tr>
<tr>
<td>
BL_status
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
poor
</td>
<td>
31 (54.4%)
</td>
<td>
30 (55.6%)
</td>
</tr>
<tr>
<td>
good
</td>
<td>
26 (45.6%)
</td>
<td>
24 (44.4%)
</td>
</tr>
</tbody>
</table>
</div>
<div id="status-over-time" class="section level4" number="15.3.1.2">
<h4 number="15.3.1.2"><span class="header-section-number">15.3.1.2</span> Status Over Time</h4>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="#cb746-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb746-2"><a href="#cb746-2"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(month_<span class="dv">1</span>, month_<span class="dv">2</span>, month_<span class="dv">3</span>, month_<span class="dv">4</span>, </span>
<span id="cb746-3"><a href="#cb746-3"></a>                    <span class="dt">splitby =</span> <span class="op">~</span><span class="st"> </span>treatment,</span>
<span id="cb746-4"><a href="#cb746-4"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>placebo</th>
<th>treatment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 57</td>
<td>n = 54</td>
</tr>
<tr class="even">
<td>month_1</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>poor</td>
<td>29 (50.9%)</td>
<td>17 (31.5%)</td>
</tr>
<tr class="even">
<td>good</td>
<td>28 (49.1%)</td>
<td>37 (68.5%)</td>
</tr>
<tr class="odd">
<td>month_2</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>poor</td>
<td>35 (61.4%)</td>
<td>16 (29.6%)</td>
</tr>
<tr class="odd">
<td>good</td>
<td>22 (38.6%)</td>
<td>38 (70.4%)</td>
</tr>
<tr class="even">
<td>month_3</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>poor</td>
<td>31 (54.4%)</td>
<td>15 (27.8%)</td>
</tr>
<tr class="even">
<td>good</td>
<td>26 (45.6%)</td>
<td>39 (72.2%)</td>
</tr>
<tr class="odd">
<td>month_4</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>poor</td>
<td>32 (56.1%)</td>
<td>20 (37%)</td>
</tr>
<tr class="odd">
<td>good</td>
<td>25 (43.9%)</td>
<td>34 (63%)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="#cb747-1"></a>data_month_trt_prop &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb747-2"><a href="#cb747-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(treatment, month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb747-3"><a href="#cb747-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),</span>
<span id="cb747-4"><a href="#cb747-4"></a>                   <span class="dt">prop_good =</span> <span class="kw">mean</span>(status),</span>
<span id="cb747-5"><a href="#cb747-5"></a>                   <span class="dt">prop_sd =</span> <span class="kw">sd</span>(status),</span>
<span id="cb747-6"><a href="#cb747-6"></a>                   <span class="dt">prop_se =</span> prop_sd<span class="op">/</span>n)</span>
<span id="cb747-7"><a href="#cb747-7"></a></span>
<span id="cb747-8"><a href="#cb747-8"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_month_trt_prop)</span></code></pre></div>
<pre><code>  treatment month   n prop_good prop_sd prop_se
1   placebo     1  57      0.49     0.5    0.01
2   placebo     2  57      0.39    0.49    0.01
3   placebo     3  57      0.46     0.5    0.01
4   placebo     4  57      0.44     0.5    0.01
5      &lt;NA&gt;   ... ...       ...     ...     ...
6 treatment     1  54      0.69    0.47    0.01
7 treatment     2  54       0.7    0.46    0.01
8 treatment     3  54      0.72    0.45    0.01
9 treatment     4  54      0.63    0.49    0.01</code></pre>
</div>
</div>
<div id="visualization-1" class="section level3" number="15.3.2">
<h3 number="15.3.2"><span class="header-section-number">15.3.2</span> Visualization</h3>
<div id="status-over-time-1" class="section level4" number="15.3.2.1">
<h4 number="15.3.2.1"><span class="header-section-number">15.3.2.1</span> Status Over Time</h4>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="#cb749-1"></a>data_month_trt_prop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb749-2"><a href="#cb749-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,</span>
<span id="cb749-3"><a href="#cb749-3"></a>             <span class="dt">y =</span> prop_good,</span>
<span id="cb749-4"><a href="#cb749-4"></a>             <span class="dt">group =</span> treatment,</span>
<span id="cb749-5"><a href="#cb749-5"></a>             <span class="dt">color =</span> treatment)) <span class="op">+</span></span>
<span id="cb749-6"><a href="#cb749-6"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> prop_good <span class="op">-</span><span class="st"> </span>prop_se,</span>
<span id="cb749-7"><a href="#cb749-7"></a>                    <span class="dt">ymax =</span> prop_good <span class="op">+</span><span class="st"> </span>prop_se),</span>
<span id="cb749-8"><a href="#cb749-8"></a>                <span class="dt">width =</span> <span class="fl">.25</span>) <span class="op">+</span></span>
<span id="cb749-9"><a href="#cb749-9"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb749-10"><a href="#cb749-10"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb749-11"><a href="#cb749-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-581-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="logisitc-regression-glm" class="section level2" number="15.4">
<h2 number="15.4"><span class="header-section-number">15.4</span> Logisitc Regression (GLM)</h2>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="#cb750-1"></a>resp_glm &lt;-<span class="st"> </span><span class="kw">glm</span>(status <span class="op">~</span><span class="st"> </span>centre <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>BL_status <span class="op">+</span><span class="st"> </span></span>
<span id="cb750-2"><a href="#cb750-2"></a><span class="st">                   </span><span class="kw">I</span>(age<span class="dv">-33</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-33</span>)<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb750-3"><a href="#cb750-3"></a>                <span class="dt">data =</span> data_long,</span>
<span id="cb750-4"><a href="#cb750-4"></a>                <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb750-5"><a href="#cb750-5"></a></span>
<span id="cb750-6"><a href="#cb750-6"></a><span class="kw">summary</span>(resp_glm)</span></code></pre></div>
<pre><code>
Call:
glm(formula = status ~ centre + treatment + sex + BL_status + 
    I(age - 33) + I((age - 33)^2), family = binomial(link = &quot;logit&quot;), 
    data = data_long)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.5965  -0.9178   0.3985   0.8388   2.0988  

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -1.9685725  0.2733549  -7.202 5.95e-13 ***
centre2             0.5347938  0.2464412   2.170 0.030002 *  
treatmenttreatment  1.3561814  0.2447533   5.541 3.01e-08 ***
sexmale             0.4263433  0.3175081   1.343 0.179343    
BL_statusgood       1.9193401  0.2500033   7.677 1.63e-14 ***
I(age - 33)        -0.0368535  0.0106382  -3.464 0.000532 ***
I((age - 33)^2)     0.0025169  0.0006352   3.963 7.41e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 608.93  on 443  degrees of freedom
Residual deviance: 465.25  on 437  degrees of freedom
AIC: 479.25

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="#cb752-1"></a>sjPlot<span class="op">::</span><span class="kw">tab_model</span>(resp_glm)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
status
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.08 – 0.23
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
centre [2]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.05 – 2.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.030</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
treatment [treatment]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.88
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.42 – 6.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
sex [male]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.53
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.83 – 2.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.179
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
BL_status [good]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
6.82
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
4.22 – 11.27
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
age - 33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.96
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.94 – 0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(age - 33)^2
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00 – 1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
444
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup> Tjur
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.293
</td>
</tr>
</table>
</div>
<div id="generalized-estimating-equations-gee" class="section level2" number="15.5">
<h2 number="15.5"><span class="header-section-number">15.5</span> Generalized Estimating Equations (GEE)</h2>
<div id="indepdendence" class="section level3" number="15.5.1">
<h3 number="15.5.1"><span class="header-section-number">15.5.1</span> Indepdendence</h3>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="#cb753-1"></a>resp_gee_in &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(status <span class="op">~</span><span class="st"> </span>centre <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>BL_status <span class="op">+</span><span class="st"> </span></span>
<span id="cb753-2"><a href="#cb753-2"></a><span class="st">                          </span><span class="kw">I</span>(age<span class="dv">-33</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-33</span>)<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb753-3"><a href="#cb753-3"></a>                        <span class="dt">data =</span> data_long,</span>
<span id="cb753-4"><a href="#cb753-4"></a>                        <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb753-5"><a href="#cb753-5"></a>                        <span class="dt">id =</span> subject,</span>
<span id="cb753-6"><a href="#cb753-6"></a>                        <span class="dt">corstr =</span> <span class="st">&quot;independence&quot;</span>,</span>
<span id="cb753-7"><a href="#cb753-7"></a>                        <span class="dt">scale.fix =</span> <span class="ot">TRUE</span>,</span>
<span id="cb753-8"><a href="#cb753-8"></a>                        <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>       (Intercept)            centre2 treatmenttreatment            sexmale 
      -1.968572485        0.534793799        1.356181372        0.426343291 
     BL_statusgood        I(age - 33)    I((age - 33)^2) 
       1.919340141       -0.036853528        0.002516859 </code></pre>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="#cb755-1"></a><span class="kw">summary</span>(resp_gee_in)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee::gee(formula = status ~ centre + treatment + sex + BL_status + 
    I(age - 33) + I((age - 33)^2), id = subject, data = data_long, 
    family = binomial(link = &quot;logit&quot;), corstr = &quot;independence&quot;, 
    scale.fix = TRUE, scale.value = 1)

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-0.96563962 -0.34372730  0.07631922  0.29658264  0.88947816 


Coefficients:
                       Estimate   Naive S.E.   Naive z  Robust S.E.   Robust z
(Intercept)        -1.968572493 0.2733635751 -7.201298 0.4457014141 -4.4167966
centre2             0.534793799 0.2464443046  2.170039 0.3795759846  1.4089242
treatmenttreatment  1.356181377 0.2447584751  5.540896 0.3777998909  3.5896818
sexmale             0.426343293 0.3175134753  1.342757 0.4832336627  0.8822715
BL_statusgood       1.919340146 0.2500092510  7.677077 0.3772812271  5.0872930
I(age - 33)        -0.036853528 0.0106384086 -3.464196 0.0150120266 -2.4549336
I((age - 33)^2)     0.002516859 0.0006351834  3.962414 0.0007592432  3.3149582

Estimated Scale Parameter:  1
Number of Iterations:  1

Working Correlation
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1</code></pre>
<p>The results for GEE fit with the independence correlation structure produces results that are nearly identical to the GLM model.</p>
<p>The robust (sandwhich) standard errors are however much larger than the naive stadard errors</p>
</div>
<div id="exchangeable" class="section level3" number="15.5.2">
<h3 number="15.5.2"><span class="header-section-number">15.5.2</span> Exchangeable</h3>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="#cb757-1"></a>resp_gee_ex &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(status <span class="op">~</span><span class="st"> </span>centre <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>BL_status <span class="op">+</span><span class="st"> </span></span>
<span id="cb757-2"><a href="#cb757-2"></a><span class="st">                          </span><span class="kw">I</span>(age<span class="dv">-33</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-33</span>)<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb757-3"><a href="#cb757-3"></a>                        <span class="dt">data =</span> data_long,</span>
<span id="cb757-4"><a href="#cb757-4"></a>                        <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb757-5"><a href="#cb757-5"></a>                        <span class="dt">id =</span> subject,</span>
<span id="cb757-6"><a href="#cb757-6"></a>                        <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>,</span>
<span id="cb757-7"><a href="#cb757-7"></a>                        <span class="dt">scale.fix =</span> <span class="ot">TRUE</span>,</span>
<span id="cb757-8"><a href="#cb757-8"></a>                        <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>       (Intercept)            centre2 treatmenttreatment            sexmale 
      -1.968572485        0.534793799        1.356181372        0.426343291 
     BL_statusgood        I(age - 33)    I((age - 33)^2) 
       1.919340141       -0.036853528        0.002516859 </code></pre>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="#cb759-1"></a><span class="kw">summary</span>(resp_gee_ex)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Exchangeable 

Call:
gee::gee(formula = status ~ centre + treatment + sex + BL_status + 
    I(age - 33) + I((age - 33)^2), id = subject, data = data_long, 
    family = binomial(link = &quot;logit&quot;), corstr = &quot;exchangeable&quot;, 
    scale.fix = TRUE, scale.value = 1)

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-0.96563962 -0.34372730  0.07631922  0.29658264  0.88947816 


Coefficients:
                       Estimate  Naive S.E.    Naive z  Robust S.E.   Robust z
(Intercept)        -1.968572493 0.379830796 -5.1827617 0.4457014141 -4.4167966
centre2             0.534793799 0.342427246  1.5617735 0.3795759846  1.4089242
treatmenttreatment  1.356181377 0.340084835  3.9877737 0.3777998909  3.5896818
sexmale             0.426343293 0.441175807  0.9663796 0.4832336627  0.8822715
BL_statusgood       1.919340146 0.347380636  5.5251789 0.3772812271  5.0872930
I(age - 33)        -0.036853528 0.014781762 -2.4931757 0.0150120266 -2.4549336
I((age - 33)^2)     0.002516859 0.000882569  2.8517424 0.0007592432  3.3149582

Estimated Scale Parameter:  1
Number of Iterations:  1

Working Correlation
        [,1]    [,2]    [,3]    [,4]
[1,] 1.00000 0.31021 0.31021 0.31021
[2,] 0.31021 1.00000 0.31021 0.31021
[3,] 0.31021 0.31021 1.00000 0.31021
[4,] 0.31021 0.31021 0.31021 1.00000</code></pre>
<p>Notice that the naive stadard errors are more similar to the robust (sandwhich) standard errors, supporting that this is a better fitting model</p>
</div>
<div id="paramgeter-estimates-table" class="section level3" number="15.5.3">
<h3 number="15.5.3"><span class="header-section-number">15.5.3</span> Paramgeter Estimates Table</h3>
<p>The GEE models display the robus (sandwhich) standard errors.</p>
<div id="raw-estimates-logit-scale" class="section level4" number="15.5.3.1">
<h4 number="15.5.3.1"><span class="header-section-number">15.5.3.1</span> Raw Estimates (Logit Scale)</h4>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="#cb761-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb761-2"><a href="#cb761-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb761-3"><a href="#cb761-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb761-4"><a href="#cb761-4"></a></span>
<span id="cb761-5"><a href="#cb761-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(resp_glm, </span>
<span id="cb761-6"><a href="#cb761-6"></a>                     resp_gee_in, </span>
<span id="cb761-7"><a href="#cb761-7"></a>                     resp_gee_ex),</span>
<span id="cb761-8"><a href="#cb761-8"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;GLM&quot;</span>, </span>
<span id="cb761-9"><a href="#cb761-9"></a>                                       <span class="st">&quot;GEE-INDEP&quot;</span>, </span>
<span id="cb761-10"><a href="#cb761-10"></a>                                       <span class="st">&quot;GEE-EXCH&quot;</span>),</span>
<span id="cb761-11"><a href="#cb761-11"></a>                <span class="dt">caption =</span> <span class="st">&quot;Estimates on Logit Scale&quot;</span>,</span>
<span id="cb761-12"><a href="#cb761-12"></a>                <span class="dt">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Estimates on Logit Scale
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GLM
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-INDEP
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-EXCH
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.9686<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.9686<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.9686<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2734)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.4457)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.4457)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
centre2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.5348<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.5348
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.5348
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2464)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.3796)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.3796)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmenttreatment
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.3562<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.3562<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.3562<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2448)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.3778)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.3778)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexmale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.4263
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.4263
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.4263
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.3175)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.4832)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.4832)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BL_statusgood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.9193<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.9193<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.9193<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2500)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.3773)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.3773)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0369<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0369<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0369<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0106)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0150)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0150)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
(age - 33)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0025<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0025<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0025<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0006)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0008)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0008)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
479.2530
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
507.9238
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-232.6265
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Deviance
</td>
<td style="padding-left: 5px;padding-right: 5px;">
465.2530
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
444
</td>
<td style="padding-left: 5px;padding-right: 5px;">
444
</td>
<td style="padding-left: 5px;padding-right: 5px;">
444
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Scale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.0000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.0000
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Comparing the two GEE models: parameters are identical and so are the robust (sandwhich) standard errors.</p>
</div>
<div id="exponentiate-the-estimates-odds-ratio-scale" class="section level4" number="15.5.3.2">
<h4 number="15.5.3.2"><span class="header-section-number">15.5.3.2</span> Exponentiate the Estimates (odds ratio scale)</h4>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="#cb762-1"></a>texreg<span class="op">::</span><span class="kw">texreg</span>(<span class="kw">list</span>(<span class="kw">extract_glm_exp</span>(resp_glm), </span>
<span id="cb762-2"><a href="#cb762-2"></a>                    <span class="kw">extract_gee_exp</span>(resp_gee_in), </span>
<span id="cb762-3"><a href="#cb762-3"></a>                    <span class="kw">extract_gee_exp</span>(resp_gee_ex)),</span>
<span id="cb762-4"><a href="#cb762-4"></a>               <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;GLM&quot;</span>, </span>
<span id="cb762-5"><a href="#cb762-5"></a>                                      <span class="st">&quot;GEE-INDEP&quot;</span>, </span>
<span id="cb762-6"><a href="#cb762-6"></a>                                      <span class="st">&quot;GEE-EXCH&quot;</span>),</span>
<span id="cb762-7"><a href="#cb762-7"></a>               <span class="dt">caption =</span> <span class="st">&quot;Estimates on Odds-Ratio Scale&quot;</span>,</span>
<span id="cb762-8"><a href="#cb762-8"></a>               <span class="dt">ci.test =</span> <span class="dv">1</span>,</span>
<span id="cb762-9"><a href="#cb762-9"></a>               <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Estimates on Odds-Ratio Scale
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GLM
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-INDEP
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-EXCH
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.140<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.140<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.140<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.080; 0.234]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.058; 0.335]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.058; 0.335]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
centre2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.707<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.707
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.707
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.054; 2.775]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.811; 3.592]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.811; 3.592]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmenttreatment
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.881<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.881<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.881<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[2.422; 6.334]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.851; 8.139]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.851; 8.139]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sexmale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.532
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.532
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.532
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.826; 2.875]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.594; 3.949]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.594; 3.949]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BL_statusgood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.816<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.816<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.816<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[4.221; 11.271]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[3.254; 14.279]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[3.254; 14.279]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age - 33
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.964<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.964<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.964<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.943; 0.984]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.936; 0.993]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.936; 0.993]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
(age - 33)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.003<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.003<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.003<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.001; 1.004]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.001; 1.004]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.001; 1.004]
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
479.253
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
507.924
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-232.626
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Deviance
</td>
<td style="padding-left: 5px;padding-right: 5px;">
465.253
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
444
</td>
<td style="padding-left: 5px;padding-right: 5px;">
444
</td>
<td style="padding-left: 5px;padding-right: 5px;">
444
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Dispersion
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.000
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup>*</sup> Null hypothesis value outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="manual-extraction" class="section level4" number="15.5.3.3">
<h4 number="15.5.3.3"><span class="header-section-number">15.5.3.3</span> Manual Extraction</h4>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="#cb763-1"></a>resp_gee_ex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</span></code></pre></div>
<pre><code>       (Intercept)            centre2 treatmenttreatment            sexmale 
         0.1396561          1.7070962          3.8813436          1.5316465 
     BL_statusgood        I(age - 33)    I((age - 33)^2) 
         6.8164591          0.9638173          1.0025200 </code></pre>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="#cb765-1"></a>trt_EST &lt;-<span class="st"> </span><span class="kw">summary</span>(resp_gee_ex)<span class="op">$</span>coeff[<span class="st">&quot;treatmenttreatment&quot;</span>, <span class="st">&quot;Estimate&quot;</span>] </span>
<span id="cb765-2"><a href="#cb765-2"></a>trt_EST</span></code></pre></div>
<pre><code>[1] 1.356181</code></pre>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="#cb767-1"></a><span class="kw">exp</span>(trt_EST)</span></code></pre></div>
<pre><code>[1] 3.881344</code></pre>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="#cb769-1"></a>Trt_SE &lt;-<span class="st"> </span><span class="kw">summary</span>(resp_gee_ex)<span class="op">$</span>coeff[<span class="st">&quot;treatmenttreatment&quot;</span>, <span class="st">&quot;Robust S.E.&quot;</span>] </span>
<span id="cb769-2"><a href="#cb769-2"></a>Trt_SE</span></code></pre></div>
<pre><code>[1] 0.3777999</code></pre>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="#cb771-1"></a>trt_95ci &lt;-<span class="st"> </span>trt_EST <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="fl">1.96</span><span class="op">*</span>Trt_SE</span>
<span id="cb771-2"><a href="#cb771-2"></a>trt_95ci</span></code></pre></div>
<pre><code>[1] 0.6156936 2.0966692</code></pre>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="#cb773-1"></a><span class="kw">exp</span>(trt_95ci)</span></code></pre></div>
<pre><code>[1] 1.850940 8.139015</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="#cb775-1"></a>texreg<span class="op">::</span><span class="kw">texreg</span>(<span class="kw">list</span>(resp_gee_ex, </span>
<span id="cb775-2"><a href="#cb775-2"></a>                    <span class="kw">extract_gee_exp</span>(resp_gee_ex,</span>
<span id="cb775-3"><a href="#cb775-3"></a>                                    <span class="dt">include.dispersion =</span> <span class="ot">FALSE</span>,</span>
<span id="cb775-4"><a href="#cb775-4"></a>                                    <span class="dt">include.nobs =</span> <span class="ot">FALSE</span>)),</span>
<span id="cb775-5"><a href="#cb775-5"></a>               <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;b (SE)&quot;</span>, </span>
<span id="cb775-6"><a href="#cb775-6"></a>                                      <span class="st">&quot;OR [95% CI]&quot;</span>),</span>
<span id="cb775-7"><a href="#cb775-7"></a>               <span class="dt">custom.coef.map =</span> <span class="kw">list</span>(<span class="dt">centre2 =</span> <span class="st">&quot;Center 2&quot;</span>,</span>
<span id="cb775-8"><a href="#cb775-8"></a>                                      <span class="dt">sexmale =</span> <span class="st">&quot;Male&quot;</span>,</span>
<span id="cb775-9"><a href="#cb775-9"></a>                                      <span class="dt">BL_statusgood =</span> <span class="st">&quot;Good at BL&quot;</span>,</span>
<span id="cb775-10"><a href="#cb775-10"></a>                                      <span class="st">&quot;I(age - 33)&quot;</span> =<span class="st"> &quot;Age (Yrs post 33)&quot;</span>,</span>
<span id="cb775-11"><a href="#cb775-11"></a>                                      <span class="st">&quot;I((age - 33)^2)&quot;</span> =<span class="st"> &quot;Age-Squared&quot;</span>,</span>
<span id="cb775-12"><a href="#cb775-12"></a>                                      <span class="dt">treatmenttreatment =</span> <span class="st">&quot;Treatment&quot;</span>), </span>
<span id="cb775-13"><a href="#cb775-13"></a>               <span class="dt">caption =</span> <span class="st">&quot;GEE: Final Model (exchangable)&quot;</span>,</span>
<span id="cb775-14"><a href="#cb775-14"></a>               <span class="dt">ci.test =</span> <span class="dv">1</span>,</span>
<span id="cb775-15"><a href="#cb775-15"></a>               <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb775-16"><a href="#cb775-16"></a>               <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
GEE: Final Model (exchangable)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
b (SE)
</th>
<th style="padding-left: 5px;padding-right: 5px;">
OR [95% CI]
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Center 2 vs. 1
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.535 (0.380)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.707 [0.811; 3.592]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Male vs. Female
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.426 (0.483)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.532 [0.594; 3.949]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BL Good vs. Poor
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.919 (0.377)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
6.816 [3.254; 14.279]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Age (Yrs post 33)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.037 (0.015)<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.964 [0.936; 0.993]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Age-Squared
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.003 (0.001)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.003 [1.001; 1.004]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Treatment
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.356 (0.378)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.881 [1.851; 8.139]<sup>*</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Scale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
444
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05 (or Null hypothesis value outside the confidence interval).
</td>
</tr>
</tfoot>
</table>
<ul>
<li><p><code>centre</code>: Controlling for baseline status, sex, age, and treatetment, thoes in center 2 had 71% higher odds of having a good respiratory status.</p></li>
<li><p><code>sex</code>: Controlling for baseline status, center, age, and treatetment, males had 53% higher odds of having a good respiratory status.</p></li>
<li><p><code>BL_status</code>: Controlling for sex, center, age, and treatetment, thoes with bood baseline staus had nearly 7 times higher odds of having a good respiratory status.</p></li>
<li><p><code>age</code>: Controlling for baseline status, sex, center, and treatment, the role of age was non-linear, such that the odds of a good respiratory statust was lowerst for patients age 40 and better for patiers that were either yonger or older.</p></li>
<li><p><code>treatment</code>: Controlling for baseline status, sex, age, and center, thoes on the treatetment had 3.88 time higher odds of having a good respiratory status.</p></li>
</ul>
</div>
</div>
<div id="refit-with-the-geepack-package" class="section level3" number="15.5.4">
<h3 number="15.5.4"><span class="header-section-number">15.5.4</span> Refit with the <code>geepack</code> package</h3>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="#cb776-1"></a>resp_geeglm_ex &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(status <span class="op">~</span><span class="st"> </span>centre <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>BL_status <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-33</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-33</span>)<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb776-2"><a href="#cb776-2"></a>                        <span class="dt">data =</span> data_long,</span>
<span id="cb776-3"><a href="#cb776-3"></a>                        <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb776-4"><a href="#cb776-4"></a>                        <span class="dt">id =</span> subject,</span>
<span id="cb776-5"><a href="#cb776-5"></a>                        <span class="dt">waves =</span> month,</span>
<span id="cb776-6"><a href="#cb776-6"></a>                        <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="#cb777-1"></a><span class="kw">summary</span>(resp_geeglm_ex)</span></code></pre></div>
<pre><code>
Call:
geepack::geeglm(formula = status ~ centre + treatment + sex + 
    BL_status + I(age - 33) + I((age - 33)^2), family = binomial(link = &quot;logit&quot;), 
    data = data_long, id = subject, waves = month, corstr = &quot;exchangeable&quot;)

 Coefficients:
                     Estimate    Std.err   Wald Pr(&gt;|W|)    
(Intercept)        -1.9685725  0.4457014 19.508 1.00e-05 ***
centre2             0.5347938  0.3795760  1.985 0.158858    
treatmenttreatment  1.3561814  0.3777999 12.886 0.000331 ***
sexmale             0.4263433  0.4832337  0.778 0.377630    
BL_statusgood       1.9193401  0.3772812 25.881 3.63e-07 ***
I(age - 33)        -0.0368535  0.0150120  6.027 0.014091 *  
I((age - 33)^2)     0.0025169  0.0007592 10.989 0.000917 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    1.033  0.4694
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.3119  0.1515
Number of clusters:   111  Maximum cluster size: 4 </code></pre>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="#cb779-1"></a>resp_geeglm_ex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</span></code></pre></div>
<pre><code>       (Intercept)            centre2 treatmenttreatment            sexmale 
            0.1397             1.7071             3.8813             1.5316 
     BL_statusgood        I(age - 33)    I((age - 33)^2) 
            6.8165             0.9638             1.0025 </code></pre>
</div>
<div id="visualize-the-model-4" class="section level3" number="15.5.5">
<h3 number="15.5.5"><span class="header-section-number">15.5.5</span> Visualize the Model</h3>
<div id="range-of-data-values" class="section level4" number="15.5.5.1">
<h4 number="15.5.5.1"><span class="header-section-number">15.5.5.1</span> Range of Data Values</h4>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="#cb781-1"></a><span class="kw">summary</span>(data_long)</span></code></pre></div>
<pre><code>    subject    centre      sex           age           treatment   BL_status 
 1      :  4   1:224   female:352   Min.   :11.0   placebo  :228   poor:244  
 2      :  4   2:220   male  : 92   1st Qu.:23.0   treatment:216   good:200  
 3      :  4                        Median :31.0                             
 4      :  4                        Mean   :33.3                             
 5      :  4                        3rd Qu.:43.0                             
 6      :  4                        Max.   :68.0                             
 (Other):420                                                                 
     month          status     
 Min.   :1.00   Min.   :0.000  
 1st Qu.:1.75   1st Qu.:0.000  
 Median :2.50   Median :1.000  
 Mean   :2.50   Mean   :0.561  
 3rd Qu.:3.25   3rd Qu.:1.000  
 Max.   :4.00   Max.   :1.000  
                               </code></pre>
</div>
<div id="females-in-center-1" class="section level4" number="15.5.5.2">
<h4 number="15.5.5.2"><span class="header-section-number">15.5.5.2</span> Females in Center 1</h4>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="#cb783-1"></a><span class="kw">expand.grid</span>(<span class="dt">centre =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>centre),</span>
<span id="cb783-2"><a href="#cb783-2"></a>            <span class="dt">treatment =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>treatment),</span>
<span id="cb783-3"><a href="#cb783-3"></a>            <span class="dt">sex =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>sex),</span>
<span id="cb783-4"><a href="#cb783-4"></a>            <span class="dt">age =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">11</span>, <span class="dt">to =</span> <span class="dv">68</span>, <span class="dt">by =</span> <span class="dv">1</span>),</span>
<span id="cb783-5"><a href="#cb783-5"></a>            <span class="dt">BL_status =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>BL_status)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb783-6"><a href="#cb783-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(resp_geeglm_ex,</span>
<span id="cb783-7"><a href="#cb783-7"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb783-8"><a href="#cb783-8"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb783-9"><a href="#cb783-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb783-10"><a href="#cb783-10"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb783-11"><a href="#cb783-11"></a>             <span class="dt">color =</span> <span class="kw">fct_rev</span>(sex),</span>
<span id="cb783-12"><a href="#cb783-12"></a>             <span class="dt">linetype =</span> <span class="kw">fct_rev</span>(treatment))) <span class="op">+</span></span>
<span id="cb783-13"><a href="#cb783-13"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb783-14"><a href="#cb783-14"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb783-15"><a href="#cb783-15"></a><span class="st">  </span><span class="kw">facet_grid</span>(centre <span class="op">~</span><span class="st"> </span>BL_status, <span class="dt">labeller =</span> label_both) <span class="op">+</span></span>
<span id="cb783-16"><a href="#cb783-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age, years&quot;</span>,</span>
<span id="cb783-17"><a href="#cb783-17"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability of GOOD Respiratory Status&quot;</span>,</span>
<span id="cb783-18"><a href="#cb783-18"></a>       <span class="dt">color =</span> <span class="st">&quot;Sex:&quot;</span>,</span>
<span id="cb783-19"><a href="#cb783-19"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Assignment:&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-602-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="females-in-center-1-1" class="section level4" number="15.5.5.3">
<h4 number="15.5.5.3"><span class="header-section-number">15.5.5.3</span> Females in Center 1</h4>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="#cb784-1"></a><span class="kw">expand.grid</span>(<span class="dt">centre =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb784-2"><a href="#cb784-2"></a>            <span class="dt">treatment =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>treatment),</span>
<span id="cb784-3"><a href="#cb784-3"></a>            <span class="dt">sex =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb784-4"><a href="#cb784-4"></a>            <span class="dt">age =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">11</span>, <span class="dt">to =</span> <span class="dv">68</span>, <span class="dt">by =</span> <span class="dv">1</span>),</span>
<span id="cb784-5"><a href="#cb784-5"></a>            <span class="dt">BL_status =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>BL_status)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb784-6"><a href="#cb784-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(resp_geeglm_ex,</span>
<span id="cb784-7"><a href="#cb784-7"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb784-8"><a href="#cb784-8"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb784-9"><a href="#cb784-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb784-10"><a href="#cb784-10"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb784-11"><a href="#cb784-11"></a>             <span class="dt">linetype =</span> treatment)) <span class="op">+</span></span>
<span id="cb784-12"><a href="#cb784-12"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb784-13"><a href="#cb784-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb784-14"><a href="#cb784-14"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>BL_status) <span class="op">+</span></span>
<span id="cb784-15"><a href="#cb784-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age, years&quot;</span>,</span>
<span id="cb784-16"><a href="#cb784-16"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability of GOOD Respiratory Status&quot;</span>,</span>
<span id="cb784-17"><a href="#cb784-17"></a>       <span class="dt">title =</span> <span class="st">&quot;For Females at Center 1, by Baseline Status&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-603-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="males-in-center-2" class="section level4" number="15.5.5.4">
<h4 number="15.5.5.4"><span class="header-section-number">15.5.5.4</span> Males in Center 2</h4>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="#cb785-1"></a><span class="kw">expand.grid</span>(<span class="dt">centre =</span> <span class="st">&quot;2&quot;</span>,</span>
<span id="cb785-2"><a href="#cb785-2"></a>            <span class="dt">treatment =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>treatment),</span>
<span id="cb785-3"><a href="#cb785-3"></a>            <span class="dt">sex =</span> <span class="st">&quot;male&quot;</span>,</span>
<span id="cb785-4"><a href="#cb785-4"></a>            <span class="dt">age =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">11</span>, <span class="dt">to =</span> <span class="dv">68</span>, <span class="dt">by =</span> <span class="dv">1</span>),</span>
<span id="cb785-5"><a href="#cb785-5"></a>            <span class="dt">BL_status =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>BL_status)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb785-6"><a href="#cb785-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(resp_geeglm_ex,</span>
<span id="cb785-7"><a href="#cb785-7"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb785-8"><a href="#cb785-8"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb785-9"><a href="#cb785-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,</span>
<span id="cb785-10"><a href="#cb785-10"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb785-11"><a href="#cb785-11"></a>             <span class="dt">linetype =</span> treatment)) <span class="op">+</span></span>
<span id="cb785-12"><a href="#cb785-12"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb785-13"><a href="#cb785-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb785-14"><a href="#cb785-14"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>BL_status) <span class="op">+</span></span>
<span id="cb785-15"><a href="#cb785-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age, years&quot;</span>,</span>
<span id="cb785-16"><a href="#cb785-16"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability of GOOD Respiratory Status&quot;</span>,</span>
<span id="cb785-17"><a href="#cb785-17"></a>       <span class="dt">title =</span> <span class="st">&quot;For Males at Center 2, by Baseline Status&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-604-1.png" width="576" style="display: block; margin: auto;" /></p>
<!--chapter:end:40_example_gee_Respiratory.Rmd-->
</div>
</div>
</div>
</div>
<div id="gee-count-outcome-epilepsy" class="section level1" number="16">
<h1 number="16"><span class="header-section-number">16</span> GEE, Count Outcome: Epilepsy</h1>
<div id="packages-1" class="section level2" number="16.1">
<h2 number="16.1"><span class="header-section-number">16.1</span> Packages</h2>
<div id="cran-1" class="section level3" number="16.1.1">
<h3 number="16.1.1"><span class="header-section-number">16.1.1</span> CRAN</h3>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="#cb786-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb786-2"><a href="#cb786-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb786-3"><a href="#cb786-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb786-4"><a href="#cb786-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb786-5"><a href="#cb786-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb786-6"><a href="#cb786-6"></a></span>
<span id="cb786-7"><a href="#cb786-7"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb786-8"><a href="#cb786-8"></a></span>
<span id="cb786-9"><a href="#cb786-9"></a><span class="kw">library</span>(corrplot)     <span class="co"># Vizualize correlation matrix</span></span>
<span id="cb786-10"><a href="#cb786-10"></a><span class="kw">library</span>(gee)          <span class="co"># Genderalized Estimation Equation Solver</span></span>
<span id="cb786-11"><a href="#cb786-11"></a><span class="kw">library</span>(geepack)      <span class="co"># Genderalized Estimation Equation Package </span></span>
<span id="cb786-12"><a href="#cb786-12"></a><span class="kw">library</span>(MuMIn)        <span class="co"># Multi-Model Inference (caluclate QIC)</span></span>
<span id="cb786-13"><a href="#cb786-13"></a></span>
<span id="cb786-14"><a href="#cb786-14"></a><span class="kw">library</span>(HSAUR)        <span class="co"># package with the dataset</span></span></code></pre></div>
</div>
<div id="github-1" class="section level3" number="16.1.2">
<h3 number="16.1.2"><span class="header-section-number">16.1.2</span> GitHub</h3>
<p>Helper <code>extract</code> functions for exponentiating parameters form generalized regression models within a <code>texreg</code> table of model parameters.</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="#cb787-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb787-2"><a href="#cb787-2"></a><span class="co"># library(devtools)</span></span>
<span id="cb787-3"><a href="#cb787-3"></a><span class="co"># install_github(&quot;SarBearSchwartz/texreghelpr&quot;)</span></span>
<span id="cb787-4"><a href="#cb787-4"></a></span>
<span id="cb787-5"><a href="#cb787-5"></a><span class="kw">library</span>(texreghelpr)</span></code></pre></div>
</div>
</div>
<div id="prepare-and-get-to-know-the-dataset-2" class="section level2" number="16.2">
<h2 number="16.2"><span class="header-section-number">16.2</span> Prepare and get to know the dataset</h2>
<blockquote>
<p>This data set is in the <strong>HSAUR</strong> package.</p>
</blockquote>
<p>In this clinical trial, 59 patients suffering from epilepsy were randomized to groups receiving either the anti-epileptic drug “Progabide”" or a placebo in addition to standard chemotherapy. The numbers of seizures suffered in each of four, two-week periods were recorded for each patient along with a baseline seizure count for the 8 weeks prior to being randomized to treatment and age. The main question of interest is whether taking progabide reduced the number of epileptic seizures compared with placebo.</p>
<ul>
<li><p>Indicators</p>
<ul>
<li><code>subject</code> the patient ID, a factor with levels 1 to 59<br />
</li>
<li><code>period</code> treatment period, an ordered factor with levels 1 to 4</li>
</ul></li>
<li><p>Outcome or dependent variable</p>
<p>+<code>seizure.rate</code> the number of seizures (2-weeks)</p></li>
<li><p>Main predictor or independent variable of interest</p>
<ul>
<li><code>treatment</code> the treatment group, a factor with levels placebo and Progabide</li>
</ul></li>
<li><p>Time-invariant Covariates</p>
<ul>
<li><code>age</code> the age of the patient<br />
</li>
<li><code>base</code> the number of seizures before the trial (8 weeks)</li>
</ul></li>
</ul>
<div id="read-in-the-data-2" class="section level3" number="16.2.1">
<h3 number="16.2.1"><span class="header-section-number">16.2.1</span> Read in the data</h3>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="#cb788-1"></a><span class="kw">data</span>(<span class="st">&quot;epilepsy&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;HSAUR&quot;</span>)</span></code></pre></div>
<p>Problem: The outcome (<code>seizure.rate</code>) were counts over a TWO-week period and we would like to interpret the results in terms of effects on the WEEKLY rate.</p>
<ul>
<li>If we divide the values by TWO to get weekly rates, the outcome might be a decimal number</li>
<li>The Poisson distribution may only be used for whole numbers (not deciamls)</li>
</ul>
<p>Solution: We need to include an <code>offset</code> term in the model that indicates the LOG DURATION of each period.</p>
<ul>
<li>Every observation period is exactly 2 weeks in this experiment</li>
<li>Create a variable in the original dataset that is equal to the LOG DURATION (<code>per = log(2)</code>)</li>
<li>To the formula for the <code>glm()</code> or <code>gee()</code>, add: ` + offset(per)`</li>
</ul>
</div>
<div id="long-format-3" class="section level3" number="16.2.2">
<h3 number="16.2.2"><span class="header-section-number">16.2.2</span> Long Format</h3>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="#cb789-1"></a>data_long &lt;-<span class="st"> </span>epilepsy <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb789-2"><a href="#cb789-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(subject, age, treatment, base, </span>
<span id="cb789-3"><a href="#cb789-3"></a>                period, seizure.rate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb789-4"><a href="#cb789-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">per =</span> <span class="kw">log</span>(<span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st">                  </span><span class="co"># new variable to use with the offset</span></span>
<span id="cb789-5"><a href="#cb789-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">base_wk =</span> base<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb789-6"><a href="#cb789-6"></a>  </span>
<span id="cb789-7"><a href="#cb789-7"></a><span class="kw">str</span>(data_long)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   236 obs. of  8 variables:
 $ subject     : Factor w/ 59 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 2 2 2 2 3 3 ...
 $ age         : int  31 31 31 31 30 30 30 30 25 25 ...
 $ treatment   : Factor w/ 2 levels &quot;placebo&quot;,&quot;Progabide&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ base        : int  11 11 11 11 11 11 11 11 6 6 ...
 $ period      : Ord.factor w/ 4 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;: 1 2 3 4 1 2 3 4 1 2 ...
 $ seizure.rate: int  5 3 3 3 3 5 3 3 2 4 ...
 $ per         : num  0.693 0.693 0.693 0.693 0.693 ...
 $ base_wk     : num  1.38 1.38 1.38 1.38 1.38 ...</code></pre>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="#cb791-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_long, <span class="dt">top =</span> <span class="dv">10</span>, <span class="dt">bottom =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>    subject age treatment base period seizure.rate  per base_wk
1         1  31   placebo   11      1            5 0.69    1.38
2         1  31   placebo   11      2            3 0.69    1.38
3         1  31   placebo   11      3            3 0.69    1.38
4         1  31   placebo   11      4            3 0.69    1.38
5         2  30   placebo   11      1            3 0.69    1.38
6         2  30   placebo   11      2            5 0.69    1.38
7         2  30   placebo   11      3            3 0.69    1.38
8         2  30   placebo   11      4            3 0.69    1.38
9         3  25   placebo    6      1            2 0.69    0.75
10        3  25   placebo    6      2            4 0.69    0.75
...    &lt;NA&gt; ...      &lt;NA&gt;  ...   &lt;NA&gt;          ...  ...     ...
231      58  36 Progabide   13      3            0 0.69    1.62
232      58  36 Progabide   13      4            0 0.69    1.62
233      59  37 Progabide   12      1            1 0.69     1.5
234      59  37 Progabide   12      2            4 0.69     1.5
235      59  37 Progabide   12      3            3 0.69     1.5
236      59  37 Progabide   12      4            2 0.69     1.5</code></pre>
</div>
<div id="wide-format-3" class="section level3" number="16.2.3">
<h3 number="16.2.3"><span class="header-section-number">16.2.3</span> Wide Format</h3>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="#cb793-1"></a>data_wide &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb793-2"><a href="#cb793-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(<span class="dt">key =</span> period,</span>
<span id="cb793-3"><a href="#cb793-3"></a>                <span class="dt">value =</span> seizure.rate,</span>
<span id="cb793-4"><a href="#cb793-4"></a>                <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb793-5"><a href="#cb793-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(subject)</span>
<span id="cb793-6"><a href="#cb793-6"></a></span>
<span id="cb793-7"><a href="#cb793-7"></a><span class="kw">str</span>(data_wide)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   59 obs. of  10 variables:
 $ subject  : Factor w/ 59 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
 $ age      : int  31 30 25 36 22 29 31 42 37 28 ...
 $ treatment: Factor w/ 2 levels &quot;placebo&quot;,&quot;Progabide&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ base     : int  11 11 6 8 66 27 12 52 23 10 ...
 $ per      : num  0.693 0.693 0.693 0.693 0.693 ...
 $ base_wk  : num  1.38 1.38 0.75 1 8.25 ...
 $ period_1 : int  5 3 2 4 7 5 6 40 5 14 ...
 $ period_2 : int  3 5 4 4 18 2 4 20 6 13 ...
 $ period_3 : int  3 3 0 1 9 8 0 23 6 6 ...
 $ period_4 : int  3 3 5 4 21 7 2 12 5 0 ...</code></pre>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="#cb795-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_wide)</span></code></pre></div>
<pre><code>    subject age treatment base  per base_wk period_1 period_2 period_3 period_4
1         1  31   placebo   11 0.69    1.38        5        3        3        3
2         2  30   placebo   11 0.69    1.38        3        5        3        3
3         3  25   placebo    6 0.69    0.75        2        4        0        5
4         4  36   placebo    8 0.69       1        4        4        1        4
...    &lt;NA&gt; ...      &lt;NA&gt;  ...  ...     ...      ...      ...      ...      ...
56       56  26 Progabide   22 0.69    2.75        1       23       19        8
57       57  21 Progabide   25 0.69    3.12        2        3        0        1
58       58  36 Progabide   13 0.69    1.62        0        0        0        0
59       59  37 Progabide   12 0.69     1.5        1        4        3        2</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-7" class="section level2" number="16.3">
<h2 number="16.3"><span class="header-section-number">16.3</span> Exploratory Data Analysis</h2>
<div id="summarize" class="section level3" number="16.3.1">
<h3 number="16.3.1"><span class="header-section-number">16.3.1</span> Summarize</h3>
<div id="demographics-and-baseline" class="section level4" number="16.3.1.1">
<h4 number="16.3.1.1"><span class="header-section-number">16.3.1.1</span> Demographics and Baseline</h4>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="#cb797-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb797-2"><a href="#cb797-2"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(age, base, base_wk,</span>
<span id="cb797-3"><a href="#cb797-3"></a>                    <span class="dt">splitby =</span> <span class="op">~</span><span class="st"> </span>treatment,</span>
<span id="cb797-4"><a href="#cb797-4"></a>                    <span class="dt">test =</span> <span class="ot">TRUE</span>,</span>
<span id="cb797-5"><a href="#cb797-5"></a>                    <span class="dt">type =</span> <span class="st">&quot;full&quot;</span>,</span>
<span id="cb797-6"><a href="#cb797-6"></a>                    <span class="dt">output =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th>placebo</th>
<th>Progabide</th>
<th>Test</th>
<th>P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>n = 28</td>
<td>n = 31</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>age</td>
<td></td>
<td></td>
<td>T-Test: 0.76</td>
<td>0.449</td>
</tr>
<tr class="odd">
<td></td>
<td>29.0 (6.0)</td>
<td>27.7 (6.6)</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>base</td>
<td></td>
<td></td>
<td>T-Test: -0.12</td>
<td>0.907</td>
</tr>
<tr class="odd">
<td></td>
<td>30.8 (26.1)</td>
<td>31.6 (28.0)</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>base_wk</td>
<td></td>
<td></td>
<td>T-Test: -0.12</td>
<td>0.907</td>
</tr>
<tr class="odd">
<td></td>
<td>3.8 (3.3)</td>
<td>4.0 (3.5)</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="outcome-across-time" class="section level4" number="16.3.1.2">
<h4 number="16.3.1.2"><span class="header-section-number">16.3.1.2</span> Outcome Across Time</h4>
<blockquote>
<p>Note: The Poisson distribution specifies that the <strong>MEAN = VARIANCE</strong></p>
</blockquote>
<p>In this dataset, the variance is much larger than the mean, at all time points for both groups. This is evidence of <strong>overdispersion</strong> and suggest the scale parameter should be <strong>greater than one</strong>.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="#cb798-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb798-2"><a href="#cb798-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(treatment, period) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb798-3"><a href="#cb798-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N =</span> <span class="kw">n</span>(),</span>
<span id="cb798-4"><a href="#cb798-4"></a>                   <span class="dt">M =</span> <span class="kw">mean</span>(seizure.rate),</span>
<span id="cb798-5"><a href="#cb798-5"></a>                   <span class="dt">VAR =</span> <span class="kw">var</span>(seizure.rate),</span>
<span id="cb798-6"><a href="#cb798-6"></a>                   <span class="dt">SD =</span> <span class="kw">sd</span>(seizure.rate)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb798-7"><a href="#cb798-7"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:62%;">
<colgroup>
<col width="16%" />
<col width="12%" />
<col width="6%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">treatment</th>
<th align="center">period</th>
<th align="center">N</th>
<th align="center">M</th>
<th align="center">VAR</th>
<th align="center">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">placebo</td>
<td align="center">1</td>
<td align="center">28</td>
<td align="center">9.4</td>
<td align="center">103</td>
<td align="center">10.1</td>
</tr>
<tr class="even">
<td align="center">placebo</td>
<td align="center">2</td>
<td align="center">28</td>
<td align="center">8.3</td>
<td align="center">67</td>
<td align="center">8.2</td>
</tr>
<tr class="odd">
<td align="center">placebo</td>
<td align="center">3</td>
<td align="center">28</td>
<td align="center">8.8</td>
<td align="center">215</td>
<td align="center">14.7</td>
</tr>
<tr class="even">
<td align="center">placebo</td>
<td align="center">4</td>
<td align="center">28</td>
<td align="center">8.0</td>
<td align="center">58</td>
<td align="center">7.6</td>
</tr>
<tr class="odd">
<td align="center">Progabide</td>
<td align="center">1</td>
<td align="center">31</td>
<td align="center">8.6</td>
<td align="center">333</td>
<td align="center">18.2</td>
</tr>
<tr class="even">
<td align="center">Progabide</td>
<td align="center">2</td>
<td align="center">31</td>
<td align="center">8.4</td>
<td align="center">141</td>
<td align="center">11.9</td>
</tr>
<tr class="odd">
<td align="center">Progabide</td>
<td align="center">3</td>
<td align="center">31</td>
<td align="center">8.1</td>
<td align="center">193</td>
<td align="center">13.9</td>
</tr>
<tr class="even">
<td align="center">Progabide</td>
<td align="center">4</td>
<td align="center">31</td>
<td align="center">6.7</td>
<td align="center">127</td>
<td align="center">11.3</td>
</tr>
</tbody>
</table>
</div>
<div id="correlation-across-time" class="section level4" number="16.3.1.3">
<h4 number="16.3.1.3"><span class="header-section-number">16.3.1.3</span> Correlation Across Time</h4>
<p>Raw Scale</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="#cb799-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb799-2"><a href="#cb799-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(subject, period, seizure.rate ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb799-3"><a href="#cb799-3"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(<span class="dt">key =</span> period,</span>
<span id="cb799-4"><a href="#cb799-4"></a>                <span class="dt">value =</span> seizure.rate ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb799-5"><a href="#cb799-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>subject) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb799-6"><a href="#cb799-6"></a><span class="st">  </span><span class="kw">cor</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb799-7"><a href="#cb799-7"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-613-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Log Scale</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="#cb800-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb800-2"><a href="#cb800-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">rate_wk =</span> <span class="kw">log</span>(seizure.rate <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb800-3"><a href="#cb800-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(subject, period, rate_wk) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb800-4"><a href="#cb800-4"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(<span class="dt">key =</span> period,</span>
<span id="cb800-5"><a href="#cb800-5"></a>                <span class="dt">value =</span> rate_wk) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb800-6"><a href="#cb800-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>subject) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb800-7"><a href="#cb800-7"></a><span class="st">  </span><span class="kw">cor</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb800-8"><a href="#cb800-8"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-614-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="visualize-1" class="section level3" number="16.3.2">
<h3 number="16.3.2"><span class="header-section-number">16.3.2</span> Visualize</h3>
<div id="oucome-on-the-raw-scale" class="section level4" number="16.3.2.1">
<h4 number="16.3.2.1"><span class="header-section-number">16.3.2.1</span> Oucome on the Raw Scale</h4>
<p>There appear to be quite a few extreme values or outliers, particularly for the Progabide group during period one.</p>
<p>Since the outcome is truely a <strong>COUNT</strong>, we will model it with a <strong>Poisson</strong> distribution combined with a <strong>LOG</strong> link.</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="#cb801-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb801-2"><a href="#cb801-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> period,</span>
<span id="cb801-3"><a href="#cb801-3"></a>             <span class="dt">y =</span> seizure.rate)) <span class="op">+</span></span>
<span id="cb801-4"><a href="#cb801-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb801-5"><a href="#cb801-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb801-6"><a href="#cb801-6"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>treatment)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-615-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>To investigate possible outliers, we should transform the outcome with the <code>log</code> function first.</p>
<blockquote>
<p>Note: Since some participants reported no seizures during a two week period and the <code>log(0)</code> is <strong>unndefinded</strong>, we must add some amount to the values before transforming. Here we have chosen to add the value of <span class="math inline">\(1\)</span>.</p>
</blockquote>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="#cb802-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb802-2"><a href="#cb802-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> period,</span>
<span id="cb802-3"><a href="#cb802-3"></a>             <span class="dt">y =</span> <span class="kw">log</span>(seizure.rate <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">+</span></span>
<span id="cb802-4"><a href="#cb802-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb802-5"><a href="#cb802-5"></a><span class="st">  </span></span>
<span id="cb802-6"><a href="#cb802-6"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb802-7"><a href="#cb802-7"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>treatment)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-616-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="#cb803-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb803-2"><a href="#cb803-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> period,</span>
<span id="cb803-3"><a href="#cb803-3"></a>             <span class="dt">y =</span> <span class="kw">log</span>(seizure.rate <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">+</span></span>
<span id="cb803-4"><a href="#cb803-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> subject)) <span class="op">+</span></span>
<span id="cb803-5"><a href="#cb803-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb803-6"><a href="#cb803-6"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>treatment)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-617-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="#cb804-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb804-2"><a href="#cb804-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> period,</span>
<span id="cb804-3"><a href="#cb804-3"></a>             <span class="dt">y =</span> <span class="kw">log</span>(seizure.rate <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">+</span></span>
<span id="cb804-4"><a href="#cb804-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> subject),</span>
<span id="cb804-5"><a href="#cb804-5"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb804-6"><a href="#cb804-6"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb804-7"><a href="#cb804-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="dv">1</span>),</span>
<span id="cb804-8"><a href="#cb804-8"></a>              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb804-9"><a href="#cb804-9"></a>              <span class="dt">size =</span> <span class="fl">1.5</span>,</span>
<span id="cb804-10"><a href="#cb804-10"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb804-11"><a href="#cb804-11"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb804-12"><a href="#cb804-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb804-13"><a href="#cb804-13"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>treatment)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-618-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="poisson-regression-glm" class="section level2" number="16.4">
<h2 number="16.4"><span class="header-section-number">16.4</span> Poisson Regression (GLM)</h2>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="#cb805-1"></a>fit_glm &lt;-<span class="st"> </span><span class="kw">glm</span>(seizure.rate <span class="op">~</span><span class="st"> </span>base <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(per),</span>
<span id="cb805-2"><a href="#cb805-2"></a>               <span class="dt">data =</span> data_long,</span>
<span id="cb805-3"><a href="#cb805-3"></a>               <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb805-4"><a href="#cb805-4"></a></span>
<span id="cb805-5"><a href="#cb805-5"></a><span class="kw">summary</span>(fit_glm)</span></code></pre></div>
<pre><code>
Call:
glm(formula = seizure.rate ~ base + age + treatment + offset(per), 
    family = poisson(link = &quot;log&quot;), data = data_long)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-4.436  -1.403  -0.503   0.484  12.322  

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -0.130616   0.135619   -0.96   0.3355    
base                0.022652   0.000509   44.48  &lt; 2e-16 ***
age                 0.022740   0.004024    5.65  1.6e-08 ***
treatmentProgabide -0.152701   0.047805   -3.19   0.0014 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2521.75  on 235  degrees of freedom
Residual deviance:  958.46  on 232  degrees of freedom
AIC: 1732

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="generalized-estimating-equations-gee-1" class="section level2" number="16.5">
<h2 number="16.5"><span class="header-section-number">16.5</span> Generalized Estimating Equations (GEE)</h2>
<div id="match-poisson-regresssion-glm" class="section level3" number="16.5.1">
<h3 number="16.5.1"><span class="header-section-number">16.5.1</span> Match Poisson Regresssion (GLM)</h3>
<ul>
<li>correlation structure: <code>independence</code></li>
<li>scale parameter = <span class="math inline">\(1\)</span></li>
</ul>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="#cb807-1"></a>fit_gee_ind_s1 &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(seizure.rate <span class="op">~</span><span class="st"> </span>base <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(per),</span>
<span id="cb807-2"><a href="#cb807-2"></a>                           <span class="dt">data =</span> data_long,</span>
<span id="cb807-3"><a href="#cb807-3"></a>                           <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb807-4"><a href="#cb807-4"></a>                           <span class="dt">id =</span> subject,</span>
<span id="cb807-5"><a href="#cb807-5"></a>                           <span class="dt">corstr =</span> <span class="st">&quot;independence&quot;</span>,</span>
<span id="cb807-6"><a href="#cb807-6"></a>                           <span class="dt">scale.fix =</span> <span class="ot">TRUE</span>,</span>
<span id="cb807-7"><a href="#cb807-7"></a>                           <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>       (Intercept)               base                age treatmentProgabide 
          -0.13062            0.02265            0.02274           -0.15270 </code></pre>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="#cb809-1"></a><span class="kw">summary</span>(fit_gee_ind_s1)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     Independent 

Call:
gee::gee(formula = seizure.rate ~ base + age + treatment + offset(per), 
    id = subject, data = data_long, family = poisson(link = &quot;log&quot;), 
    corstr = &quot;independence&quot;, scale.fix = TRUE, scale.value = 1)

Summary of Residuals:
    Min      1Q  Median      3Q     Max 
-4.9195  0.1808  1.7073  4.8851 69.9659 


Coefficients:
                   Estimate Naive S.E. Naive z Robust S.E. Robust z
(Intercept)        -0.13062  0.1356191 -0.9631    0.365148  -0.3577
base                0.02265  0.0005093 44.4761    0.001236  18.3316
age                 0.02274  0.0040240  5.6511    0.011580   1.9637
treatmentProgabide -0.15270  0.0478051 -3.1942    0.171109  -0.8924

Estimated Scale Parameter:  1
Number of Iterations:  1

Working Correlation
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1</code></pre>
<ul>
<li><p>The estimates and the naive standard errors match the GLM exactly.</p></li>
<li><p>The naive SE’s are much smaller (<em>half</em>) than the robust (sandwich) SE’s, suggesting a poor fit.</p></li>
</ul>
</div>
<div id="change-correlation-sturucture" class="section level3" number="16.5.2">
<h3 number="16.5.2"><span class="header-section-number">16.5.2</span> Change Correlation Sturucture</h3>
<ul>
<li>correlation structure: <code>exchangeable</code></li>
<li>scale parameter = <span class="math inline">\(1\)</span></li>
</ul>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="#cb811-1"></a>fit_gee_exc_s1 &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(seizure.rate <span class="op">~</span><span class="st"> </span>base <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(per),</span>
<span id="cb811-2"><a href="#cb811-2"></a>                           <span class="dt">data =</span> data_long,</span>
<span id="cb811-3"><a href="#cb811-3"></a>                           <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb811-4"><a href="#cb811-4"></a>                           <span class="dt">id =</span> subject,</span>
<span id="cb811-5"><a href="#cb811-5"></a>                           <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>,</span>
<span id="cb811-6"><a href="#cb811-6"></a>                           <span class="dt">scale.fix =</span> <span class="ot">TRUE</span>,</span>
<span id="cb811-7"><a href="#cb811-7"></a>                           <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>       (Intercept)               base                age treatmentProgabide 
          -0.13062            0.02265            0.02274           -0.15270 </code></pre>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="#cb813-1"></a><span class="kw">summary</span>(fit_gee_exc_s1)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     Exchangeable 

Call:
gee::gee(formula = seizure.rate ~ base + age + treatment + offset(per), 
    id = subject, data = data_long, family = poisson(link = &quot;log&quot;), 
    corstr = &quot;exchangeable&quot;, scale.fix = TRUE, scale.value = 1)

Summary of Residuals:
    Min      1Q  Median      3Q     Max 
-4.9195  0.1808  1.7073  4.8851 69.9659 


Coefficients:
                   Estimate Naive S.E. Naive z Robust S.E. Robust z
(Intercept)        -0.13062  0.2004417 -0.6516    0.365148  -0.3577
base                0.02265  0.0007527 30.0926    0.001236  18.3316
age                 0.02274  0.0059474  3.8236    0.011580   1.9637
treatmentProgabide -0.15270  0.0706547 -2.1612    0.171109  -0.8924

Estimated Scale Parameter:  1
Number of Iterations:  1

Working Correlation
       [,1]   [,2]   [,3]   [,4]
[1,] 1.0000 0.3948 0.3948 0.3948
[2,] 0.3948 1.0000 0.3948 0.3948
[3,] 0.3948 0.3948 1.0000 0.3948
[4,] 0.3948 0.3948 0.3948 1.0000</code></pre>
<ul>
<li>Although the estimated beta parameters are not much different, the naive SE’s are some closer to the robust SE’s.</li>
</ul>
</div>
<div id="estimate-the-additional-scale-parameter" class="section level3" number="16.5.3">
<h3 number="16.5.3"><span class="header-section-number">16.5.3</span> Estimate the Additional Scale Parameter</h3>
<ul>
<li>correlation structure: <code>exchangeable</code></li>
<li>scale parameter = <em>freely estimated</em></li>
</ul>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="#cb815-1"></a>fit_gee_exc_sf &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(seizure.rate <span class="op">~</span><span class="st"> </span>base <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(per),</span>
<span id="cb815-2"><a href="#cb815-2"></a>                           <span class="dt">data =</span> data_long,</span>
<span id="cb815-3"><a href="#cb815-3"></a>                           <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb815-4"><a href="#cb815-4"></a>                           <span class="dt">id =</span> subject,</span>
<span id="cb815-5"><a href="#cb815-5"></a>                           <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>,</span>
<span id="cb815-6"><a href="#cb815-6"></a>                           <span class="dt">scale.fix =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>       (Intercept)               base                age treatmentProgabide 
          -0.13062            0.02265            0.02274           -0.15270 </code></pre>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="#cb817-1"></a><span class="kw">summary</span>(fit_gee_exc_sf)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     Exchangeable 

Call:
gee::gee(formula = seizure.rate ~ base + age + treatment + offset(per), 
    id = subject, data = data_long, family = poisson(link = &quot;log&quot;), 
    corstr = &quot;exchangeable&quot;, scale.fix = FALSE)

Summary of Residuals:
    Min      1Q  Median      3Q     Max 
-4.9195  0.1808  1.7073  4.8851 69.9659 


Coefficients:
                   Estimate Naive S.E. Naive z Robust S.E. Robust z
(Intercept)        -0.13062   0.452200 -0.2888    0.365148  -0.3577
base                0.02265   0.001698 13.3388    0.001236  18.3316
age                 0.02274   0.013417  1.6948    0.011580   1.9637
treatmentProgabide -0.15270   0.159398 -0.9580    0.171109  -0.8924

Estimated Scale Parameter:  5.09
Number of Iterations:  1

Working Correlation
       [,1]   [,2]   [,3]   [,4]
[1,] 1.0000 0.3948 0.3948 0.3948
[2,] 0.3948 1.0000 0.3948 0.3948
[3,] 0.3948 0.3948 1.0000 0.3948
[4,] 0.3948 0.3948 0.3948 1.0000</code></pre>
<ul>
<li><p>The naive SE’s are much closer inline with the robust SE’s.</p></li>
<li><p>The sclae parameter is estimated to be much larger than <span class="math inline">\(1\)</span>.</p></li>
</ul>
</div>
<div id="compare-models" class="section level3" number="16.5.4">
<h3 number="16.5.4"><span class="header-section-number">16.5.4</span> Compare Models</h3>
<div id="raw-estimates-logit-scale-1" class="section level4" number="16.5.4.1">
<h4 number="16.5.4.1"><span class="header-section-number">16.5.4.1</span> Raw Estimates (logit scale)</h4>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="#cb819-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb819-2"><a href="#cb819-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb819-3"><a href="#cb819-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb819-4"><a href="#cb819-4"></a></span>
<span id="cb819-5"><a href="#cb819-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_glm, </span>
<span id="cb819-6"><a href="#cb819-6"></a>                     fit_gee_ind_s1, </span>
<span id="cb819-7"><a href="#cb819-7"></a>                     fit_gee_exc_s1, </span>
<span id="cb819-8"><a href="#cb819-8"></a>                     fit_gee_exc_sf),</span>
<span id="cb819-9"><a href="#cb819-9"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;GLM&quot;</span>,</span>
<span id="cb819-10"><a href="#cb819-10"></a>                                       <span class="st">&quot;GEE-Indep(1)&quot;</span>,</span>
<span id="cb819-11"><a href="#cb819-11"></a>                                       <span class="st">&quot;GEE-Exchg(1)&quot;</span>,</span>
<span id="cb819-12"><a href="#cb819-12"></a>                                       <span class="st">&quot;GEE-Exchg(free)&quot;</span>),</span>
<span id="cb819-13"><a href="#cb819-13"></a>                <span class="dt">caption =</span> <span class="st">&quot;Estimates on Logit Scale&quot;</span>,</span>
<span id="cb819-14"><a href="#cb819-14"></a>                <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Estimates on Logit Scale
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GLM
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-Indep(1)
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-Exchg(1)
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-Exchg(free)
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.131
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.131
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.131
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.131
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.136)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.365)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.365)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.365)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
base
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.023<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.023<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.023<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.023<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.001)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.001)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.001)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.001)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.023<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.023<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.023<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.023<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.004)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.012)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.012)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.012)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentProgabide
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.153<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.153
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.153
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.153
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.048)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.171)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.171)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.171)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1732.459
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1746.314
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-862.229
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Deviance
</td>
<td style="padding-left: 5px;padding-right: 5px;">
958.464
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
236
</td>
<td style="padding-left: 5px;padding-right: 5px;">
236
</td>
<td style="padding-left: 5px;padding-right: 5px;">
236
</td>
<td style="padding-left: 5px;padding-right: 5px;">
236
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Scale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.090
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="exponentiate-the-estimates-odds-ratio-scale-1" class="section level4" number="16.5.4.2">
<h4 number="16.5.4.2"><span class="header-section-number">16.5.4.2</span> Exponentiate the Estimates (odds ratio scale)</h4>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="#cb820-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb820-2"><a href="#cb820-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb820-3"><a href="#cb820-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb820-4"><a href="#cb820-4"></a></span>
<span id="cb820-5"><a href="#cb820-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="kw">extract_glm_exp</span>(fit_glm), </span>
<span id="cb820-6"><a href="#cb820-6"></a>                     <span class="kw">extract_gee_exp</span>(fit_gee_ind_s1), </span>
<span id="cb820-7"><a href="#cb820-7"></a>                     <span class="kw">extract_gee_exp</span>(fit_gee_exc_s1), </span>
<span id="cb820-8"><a href="#cb820-8"></a>                     <span class="kw">extract_gee_exp</span>(fit_gee_exc_sf)),</span>
<span id="cb820-9"><a href="#cb820-9"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;GLM&quot;</span>,</span>
<span id="cb820-10"><a href="#cb820-10"></a>                                       <span class="st">&quot;GEE-Indep(1)&quot;</span>,</span>
<span id="cb820-11"><a href="#cb820-11"></a>                                       <span class="st">&quot;GEE-Exchg(1)&quot;</span>,</span>
<span id="cb820-12"><a href="#cb820-12"></a>                                       <span class="st">&quot;GEE-Exchg(free)&quot;</span>),</span>
<span id="cb820-13"><a href="#cb820-13"></a>                <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb820-14"><a href="#cb820-14"></a>                <span class="dt">caption =</span> <span class="st">&quot;Estimates on Odds-Ratio Scale&quot;</span>,</span>
<span id="cb820-15"><a href="#cb820-15"></a>                <span class="dt">caption.above =</span> <span class="ot">TRUE</span>,</span>
<span id="cb820-16"><a href="#cb820-16"></a>                <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 2px solid #000000;">
<caption>
Estimates on Odds-Ratio Scale
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GLM
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-Indep(1)
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-Exchg(1)
</th>
<th style="padding-left: 5px;padding-right: 5px;">
GEE-Exchg(free)
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.878
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.878
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.878
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.878
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.672; 1.144]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.429; 1.795]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.429; 1.795]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.429; 1.795]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
base
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.023<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.023<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.023<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.023<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.022; 1.024]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.020; 1.025]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.020; 1.025]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.020; 1.025]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.023<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.023<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.023<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.023<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.015; 1.031]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.000; 1.046]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.000; 1.046]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[1.000; 1.046]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
treatmentProgabide
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.858<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.858
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.858
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.858
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.782; 0.943]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.614; 1.200]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.614; 1.200]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
[0.614; 1.200]
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1732.459
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1746.314
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-862.229
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Deviance
</td>
<td style="padding-left: 5px;padding-right: 5px;">
958.464
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
236
</td>
<td style="padding-left: 5px;padding-right: 5px;">
236
</td>
<td style="padding-left: 5px;padding-right: 5px;">
236
</td>
<td style="padding-left: 5px;padding-right: 5px;">
236
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Dispersion
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.000
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.090
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup>*</sup> Null hypothesis value outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
<blockquote>
<p>CONCLUSION:</p>
<p>There is no evidence that Progabide effects the weekly rate of epileptic seizures differently than placebo.</p>
</blockquote>
<!--chapter:end:50_example_gee_Epilepsy.Rmd-->
</div>
</div>
</div>
</div>
<div id="gee-count-outcome-antibiotics-for-leprosy" class="section level1" number="17">
<h1 number="17"><span class="header-section-number">17</span> GEE, Count Outcome: Antibiotics for Leprosy</h1>
<div id="packages-2" class="section level2" number="17.1">
<h2 number="17.1"><span class="header-section-number">17.1</span> Packages</h2>
<div id="cran-2" class="section level3" number="17.1.1">
<h3 number="17.1.1"><span class="header-section-number">17.1.1</span> CRAN</h3>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="#cb821-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb821-2"><a href="#cb821-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb821-3"><a href="#cb821-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb821-4"><a href="#cb821-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb821-5"><a href="#cb821-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb821-6"><a href="#cb821-6"></a></span>
<span id="cb821-7"><a href="#cb821-7"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb821-8"><a href="#cb821-8"></a></span>
<span id="cb821-9"><a href="#cb821-9"></a><span class="kw">library</span>(corrplot)     <span class="co"># Vizualize correlation matrix</span></span>
<span id="cb821-10"><a href="#cb821-10"></a><span class="kw">library</span>(gee)          <span class="co"># Genderalized Estimation Equation Solver</span></span>
<span id="cb821-11"><a href="#cb821-11"></a><span class="kw">library</span>(geepack)      <span class="co"># Genderalized Estimation Equation Package </span></span>
<span id="cb821-12"><a href="#cb821-12"></a><span class="kw">library</span>(MuMIn)        <span class="co"># Multi-Model Inference (caluclate QIC)</span></span></code></pre></div>
</div>
<div id="github-2" class="section level3" number="17.1.2">
<h3 number="17.1.2"><span class="header-section-number">17.1.2</span> GitHub</h3>
<p>Helper <code>extract</code> functions for exponentiating parameters form generalized regression models within a <code>texreg</code> table of model parameters.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="#cb822-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb822-2"><a href="#cb822-2"></a><span class="co"># library(devtools)</span></span>
<span id="cb822-3"><a href="#cb822-3"></a><span class="co"># install_github(&quot;SarBearSchwartz/texreghelpr&quot;)</span></span>
<span id="cb822-4"><a href="#cb822-4"></a></span>
<span id="cb822-5"><a href="#cb822-5"></a><span class="kw">library</span>(texreghelpr)</span></code></pre></div>
</div>
</div>
<div id="data" class="section level2" number="17.2">
<h2 number="17.2"><span class="header-section-number">17.2</span> Data</h2>
<div id="import" class="section level3" number="17.2.1">
<h3 number="17.2.1"><span class="header-section-number">17.2.1</span> Import</h3>
<div class="rmdlink">
<p>
The following example is presented in the textbook: “Applied Longitudinal Analysis” by Garrett Fitzmaurice, Nan Laird &amp; James Ware
</p>
<p>
The dataset maybe downloaded from: <a href="https://content.sph.harvard.edu/fitzmaur/ala/" class="uri">https://content.sph.harvard.edu/fitzmaur/ala/</a>
</p>
</div>
<blockquote>
<p>Data on count of leprosy bacilli pre- and post-treatment from a clinical trial of antibiotics for leprosy.</p>
</blockquote>
<p>Source: Table 14.2.1 (page 422) in Snedecor, G.W. and Cochran, W.G. (1967). Statistical Methods, (6th edn). Ames, Iowa: Iowa State University Press</p>
<p>With permission of Iowa State University Press.</p>
<p>Reference: Snedecor, G.W. and Cochran, W.G. (1967). Statistical Methods, (6th edn).
Ames, Iowa: Iowa State University Press</p>
<p><strong>Description:</strong></p>
<p>The dataset consists of count data from a placebo-controlled clinical trial of 30 patients with leprosy at the Eversley Childs Sanitorium in the Philippines. Participants in the study were randomized to either of two antibiotics (denoted treatment drug A and B) or to a placebo (denoted treatment drug C). Prior to receiving treatment, baseline data on the number of leprosy bacilli at six sites of the body where the bacilli tend to congregate were recorded for each patient. After several months of treatment, the number of leprosy bacilli at six sites of the body were recorded a second time. The outcome variable is the total count of the number of leprosy bacilli at the six sites.</p>
<p>In this study, the question of main scientific interest is whether treatment with antibiotics (drugs A and B) reduces the abundance of leprosy bacilli at the six sites of the body when compared to placebo (drug C).</p>
<p><strong>Variables:</strong></p>
<ul>
<li><p>Outcome or dependent variable(s)</p>
<ul>
<li><code>count.pre</code> Pre-Treatment Bacilli Count</li>
<li><code>count.post</code> Post-Treatment Bacilli Count</li>
</ul></li>
<li><p>Main predictor or independent variable of interest</p>
<ul>
<li><code>drug</code> the treatment group: antibiotics (drugs A and B) or placebo (drug C)</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="#cb823-1"></a>data_raw &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tribble</span>(</span>
<span id="cb823-2"><a href="#cb823-2"></a>  <span class="op">~</span>drug, <span class="op">~</span>count_pre, <span class="op">~</span>count_post,</span>
<span id="cb823-3"><a href="#cb823-3"></a>  <span class="st">&quot;A&quot;</span>,      <span class="dv">11</span>,     <span class="dv">6</span>,    <span class="st">&quot;B&quot;</span>,       <span class="dv">6</span>,     <span class="dv">0</span>,    <span class="st">&quot;C&quot;</span>,      <span class="dv">16</span>,    <span class="dv">13</span>,</span>
<span id="cb823-4"><a href="#cb823-4"></a>  <span class="st">&quot;A&quot;</span>,       <span class="dv">8</span>,     <span class="dv">0</span>,    <span class="st">&quot;B&quot;</span>,       <span class="dv">6</span>,     <span class="dv">2</span>,    <span class="st">&quot;C&quot;</span>,      <span class="dv">13</span>,    <span class="dv">10</span>,</span>
<span id="cb823-5"><a href="#cb823-5"></a>  <span class="st">&quot;A&quot;</span>,       <span class="dv">5</span>,     <span class="dv">2</span>,    <span class="st">&quot;B&quot;</span>,       <span class="dv">7</span>,     <span class="dv">3</span>,    <span class="st">&quot;C&quot;</span>,      <span class="dv">11</span>,    <span class="dv">18</span>,</span>
<span id="cb823-6"><a href="#cb823-6"></a>  <span class="st">&quot;A&quot;</span>,      <span class="dv">14</span>,     <span class="dv">8</span>,    <span class="st">&quot;B&quot;</span>,       <span class="dv">8</span>,     <span class="dv">1</span>,    <span class="st">&quot;C&quot;</span>,       <span class="dv">9</span>,     <span class="dv">5</span>,</span>
<span id="cb823-7"><a href="#cb823-7"></a>  <span class="st">&quot;A&quot;</span>,      <span class="dv">19</span>,    <span class="dv">11</span>,    <span class="st">&quot;B&quot;</span>,      <span class="dv">18</span>,    <span class="dv">18</span>,    <span class="st">&quot;C&quot;</span>,      <span class="dv">21</span>,    <span class="dv">23</span>,</span>
<span id="cb823-8"><a href="#cb823-8"></a>  <span class="st">&quot;A&quot;</span>,       <span class="dv">6</span>,     <span class="dv">4</span>,    <span class="st">&quot;B&quot;</span>,       <span class="dv">8</span>,     <span class="dv">4</span>,    <span class="st">&quot;C&quot;</span>,      <span class="dv">16</span>,    <span class="dv">12</span>,</span>
<span id="cb823-9"><a href="#cb823-9"></a>  <span class="st">&quot;A&quot;</span>,      <span class="dv">10</span>,    <span class="dv">13</span>,    <span class="st">&quot;B&quot;</span>,      <span class="dv">19</span>,    <span class="dv">14</span>,    <span class="st">&quot;C&quot;</span>,      <span class="dv">12</span>,     <span class="dv">5</span>,</span>
<span id="cb823-10"><a href="#cb823-10"></a>  <span class="st">&quot;A&quot;</span>,       <span class="dv">6</span>,     <span class="dv">1</span>,    <span class="st">&quot;B&quot;</span>,       <span class="dv">8</span>,     <span class="dv">9</span>,    <span class="st">&quot;C&quot;</span>,      <span class="dv">12</span>,    <span class="dv">16</span>,</span>
<span id="cb823-11"><a href="#cb823-11"></a>  <span class="st">&quot;A&quot;</span>,      <span class="dv">11</span>,     <span class="dv">8</span>,    <span class="st">&quot;B&quot;</span>,       <span class="dv">5</span>,     <span class="dv">1</span>,    <span class="st">&quot;C&quot;</span>,       <span class="dv">7</span>,     <span class="dv">1</span>,</span>
<span id="cb823-12"><a href="#cb823-12"></a>  <span class="st">&quot;A&quot;</span>,       <span class="dv">3</span>,     <span class="dv">0</span>,    <span class="st">&quot;B&quot;</span>,      <span class="dv">15</span>,     <span class="dv">9</span>,    <span class="st">&quot;C&quot;</span>,      <span class="dv">12</span>,    <span class="dv">20</span>)</span></code></pre></div>
</div>
<div id="wide-format-4" class="section level3" number="17.2.2">
<h3 number="17.2.2"><span class="header-section-number">17.2.2</span> Wide Format</h3>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="#cb824-1"></a>data_wide &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb824-2"><a href="#cb824-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">drug =</span> <span class="kw">factor</span>(drug)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb824-3"><a href="#cb824-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb824-4"><a href="#cb824-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, drug, count_pre, count_post)</span>
<span id="cb824-5"><a href="#cb824-5"></a></span>
<span id="cb824-6"><a href="#cb824-6"></a><span class="kw">str</span>(data_wide)</span></code></pre></div>
<pre><code>tibble [30 x 4] (S3: tbl_df/tbl/data.frame)
 $ id        : int [1:30] 1 2 3 4 5 6 7 8 9 10 ...
 $ drug      : Factor w/ 3 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;: 1 2 3 1 2 3 1 2 3 1 ...
 $ count_pre : num [1:30] 11 6 16 8 6 13 5 7 11 14 ...
 $ count_post: num [1:30] 6 0 13 0 2 10 2 3 18 8 ...</code></pre>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="#cb826-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_wide)</span></code></pre></div>
<pre><code>   id drug count_pre count_post
1   1    A        11          6
2   2    B         6          0
3   3    C        16         13
4   4    A         8          0
5 ... &lt;NA&gt;       ...        ...
6  27    C         7          1
7  28    A         3          0
8  29    B        15          9
9  30    C        12         20</code></pre>
</div>
<div id="long-format-4" class="section level3" number="17.2.3">
<h3 number="17.2.3"><span class="header-section-number">17.2.3</span> Long Format</h3>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="#cb828-1"></a>data_long &lt;-<span class="st"> </span>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb828-2"><a href="#cb828-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> obs,</span>
<span id="cb828-3"><a href="#cb828-3"></a>                <span class="dt">value =</span> count,</span>
<span id="cb828-4"><a href="#cb828-4"></a>                <span class="kw">starts_with</span>(<span class="st">&quot;count&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb828-5"><a href="#cb828-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="kw">case_when</span>(obs <span class="op">==</span><span class="st"> &quot;count_pre&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb828-6"><a href="#cb828-6"></a>                                 obs <span class="op">==</span><span class="st"> &quot;count_post&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb828-7"><a href="#cb828-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, drug, time, count) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb828-8"><a href="#cb828-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(id, time)</span>
<span id="cb828-9"><a href="#cb828-9"></a></span>
<span id="cb828-10"><a href="#cb828-10"></a><span class="kw">str</span>(data_long)</span></code></pre></div>
<pre><code>tibble [60 x 4] (S3: tbl_df/tbl/data.frame)
 $ id   : int [1:60] 1 1 2 2 3 3 4 4 5 5 ...
 $ drug : Factor w/ 3 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;: 1 1 2 2 3 3 1 1 2 2 ...
 $ time : num [1:60] 0 1 0 1 0 1 0 1 0 1 ...
 $ count: num [1:60] 11 6 6 0 16 13 8 0 6 2 ...</code></pre>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="#cb830-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_long)</span></code></pre></div>
<pre><code>   id drug time count
1   1    A    0    11
2   1    A    1     6
3   2    B    0     6
4   2    B    1     0
5 ... &lt;NA&gt;  ...   ...
6  29    B    0    15
7  29    B    1     9
8  30    C    0    12
9  30    C    1    20</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-8" class="section level2" number="17.3">
<h2 number="17.3"><span class="header-section-number">17.3</span> Exploratory Data Analysis</h2>
<div id="summary-statistics-1" class="section level3" number="17.3.1">
<h3 number="17.3.1"><span class="header-section-number">17.3.1</span> Summary Statistics</h3>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="#cb832-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb832-2"><a href="#cb832-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(drug, time) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb832-3"><a href="#cb832-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N =</span> <span class="kw">n</span>(),</span>
<span id="cb832-4"><a href="#cb832-4"></a>                   <span class="dt">M =</span> <span class="kw">mean</span>(count),</span>
<span id="cb832-5"><a href="#cb832-5"></a>                   <span class="dt">VAR =</span> <span class="kw">var</span>(count),</span>
<span id="cb832-6"><a href="#cb832-6"></a>                   <span class="dt">SD =</span> <span class="kw">sd</span>(count)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb832-7"><a href="#cb832-7"></a><span class="st">  </span>pander<span class="op">::</span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:53%;">
<colgroup>
<col width="9%" />
<col width="9%" />
<col width="6%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">drug</th>
<th align="center">time</th>
<th align="center">N</th>
<th align="center">M</th>
<th align="center">VAR</th>
<th align="center">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">A</td>
<td align="center">0</td>
<td align="center">10</td>
<td align="center">9.3</td>
<td align="center">23</td>
<td align="center">4.8</td>
</tr>
<tr class="even">
<td align="center">A</td>
<td align="center">1</td>
<td align="center">10</td>
<td align="center">5.3</td>
<td align="center">22</td>
<td align="center">4.6</td>
</tr>
<tr class="odd">
<td align="center">B</td>
<td align="center">0</td>
<td align="center">10</td>
<td align="center">10.0</td>
<td align="center">28</td>
<td align="center">5.2</td>
</tr>
<tr class="even">
<td align="center">B</td>
<td align="center">1</td>
<td align="center">10</td>
<td align="center">6.1</td>
<td align="center">38</td>
<td align="center">6.2</td>
</tr>
<tr class="odd">
<td align="center">C</td>
<td align="center">0</td>
<td align="center">10</td>
<td align="center">12.9</td>
<td align="center">16</td>
<td align="center">4.0</td>
</tr>
<tr class="even">
<td align="center">C</td>
<td align="center">1</td>
<td align="center">10</td>
<td align="center">12.3</td>
<td align="center">51</td>
<td align="center">7.2</td>
</tr>
</tbody>
</table>
</div>
<div id="visualize-2" class="section level3" number="17.3.2">
<h3 number="17.3.2"><span class="header-section-number">17.3.2</span> Visualize</h3>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="#cb833-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb833-2"><a href="#cb833-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time_name =</span> <span class="kw">case_when</span>(time <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Pre&quot;</span>,</span>
<span id="cb833-3"><a href="#cb833-3"></a>                                      time <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Post&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb833-4"><a href="#cb833-4"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Pre&quot;</span>, <span class="st">&quot;Post&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb833-5"><a href="#cb833-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">drug_name =</span> <span class="kw">fct_recode</span>(drug,</span>
<span id="cb833-6"><a href="#cb833-6"></a>                                       <span class="st">&quot;Antibiotic A&quot;</span> =<span class="st"> &quot;A&quot;</span>,</span>
<span id="cb833-7"><a href="#cb833-7"></a>                                       <span class="st">&quot;Antibiotic B&quot;</span> =<span class="st"> &quot;B&quot;</span>,</span>
<span id="cb833-8"><a href="#cb833-8"></a>                                       <span class="st">&quot;Placebo&quot;</span> =<span class="st"> &quot;C&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb833-9"><a href="#cb833-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time_name,</span>
<span id="cb833-10"><a href="#cb833-10"></a>             <span class="dt">y =</span> count)) <span class="op">+</span></span>
<span id="cb833-11"><a href="#cb833-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb833-12"><a href="#cb833-12"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>drug_name) <span class="op">+</span></span>
<span id="cb833-13"><a href="#cb833-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb833-14"><a href="#cb833-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb833-15"><a href="#cb833-15"></a>       <span class="dt">y =</span> <span class="st">&quot;Number of Leprosy Bacilli at Six Sites of the Body&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-636-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="#cb834-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb834-2"><a href="#cb834-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time_name =</span> <span class="kw">case_when</span>(time <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Pre&quot;</span>,</span>
<span id="cb834-3"><a href="#cb834-3"></a>                                      time <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Post&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb834-4"><a href="#cb834-4"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Pre&quot;</span>, <span class="st">&quot;Post&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb834-5"><a href="#cb834-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">drug_name =</span> <span class="kw">fct_recode</span>(drug,</span>
<span id="cb834-6"><a href="#cb834-6"></a>                                       <span class="st">&quot;Antibiotic A&quot;</span> =<span class="st"> &quot;A&quot;</span>,</span>
<span id="cb834-7"><a href="#cb834-7"></a>                                       <span class="st">&quot;Antibiotic B&quot;</span> =<span class="st"> &quot;B&quot;</span>,</span>
<span id="cb834-8"><a href="#cb834-8"></a>                                       <span class="st">&quot;Placebo&quot;</span> =<span class="st"> &quot;C&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb834-9"><a href="#cb834-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time,</span>
<span id="cb834-10"><a href="#cb834-10"></a>             <span class="dt">y =</span> count)) <span class="op">+</span></span>
<span id="cb834-11"><a href="#cb834-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id),</span>
<span id="cb834-12"><a href="#cb834-12"></a>            <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></span>
<span id="cb834-13"><a href="#cb834-13"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> drug),</span>
<span id="cb834-14"><a href="#cb834-14"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb834-15"><a href="#cb834-15"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>drug_name) <span class="op">+</span></span>
<span id="cb834-16"><a href="#cb834-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb834-17"><a href="#cb834-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb834-18"><a href="#cb834-18"></a>       <span class="dt">y =</span> <span class="st">&quot;Number of Leprosy Bacilli at Six Sites of the Body&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-637-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="#cb835-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb835-2"><a href="#cb835-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time_name =</span> <span class="kw">case_when</span>(time <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Pre&quot;</span>,</span>
<span id="cb835-3"><a href="#cb835-3"></a>                                      time <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Post&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb835-4"><a href="#cb835-4"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Pre&quot;</span>, <span class="st">&quot;Post&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb835-5"><a href="#cb835-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">drug_name =</span> <span class="kw">fct_recode</span>(drug,</span>
<span id="cb835-6"><a href="#cb835-6"></a>                                       <span class="st">&quot;Antibiotic A&quot;</span> =<span class="st"> &quot;A&quot;</span>,</span>
<span id="cb835-7"><a href="#cb835-7"></a>                                       <span class="st">&quot;Antibiotic B&quot;</span> =<span class="st"> &quot;B&quot;</span>,</span>
<span id="cb835-8"><a href="#cb835-8"></a>                                       <span class="st">&quot;Placebo&quot;</span> =<span class="st"> &quot;C&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb835-9"><a href="#cb835-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time,</span>
<span id="cb835-10"><a href="#cb835-10"></a>             <span class="dt">y =</span> count)) <span class="op">+</span></span>
<span id="cb835-11"><a href="#cb835-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> drug,</span>
<span id="cb835-12"><a href="#cb835-12"></a>                  <span class="dt">color =</span> drug_name,</span>
<span id="cb835-13"><a href="#cb835-13"></a>                  <span class="dt">fill =</span> drug_name),</span>
<span id="cb835-14"><a href="#cb835-14"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb835-15"><a href="#cb835-15"></a>              <span class="dt">alpha =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb835-16"><a href="#cb835-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb835-17"><a href="#cb835-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb835-18"><a href="#cb835-18"></a>       <span class="dt">y =</span> <span class="st">&quot;Number of Leprosy Bacilli at Six Sites of the Body&quot;</span>,</span>
<span id="cb835-19"><a href="#cb835-19"></a>       <span class="dt">color =</span> <span class="ot">NULL</span>,</span>
<span id="cb835-20"><a href="#cb835-20"></a>       <span class="dt">fill =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb835-21"><a href="#cb835-21"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</span>
<span id="cb835-22"><a href="#cb835-22"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pre-Treatment&quot;</span>, <span class="st">&quot;Post-Treatment&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-638-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="generalized-estimating-equations-gee-2" class="section level2" number="17.4">
<h2 number="17.4"><span class="header-section-number">17.4</span> Generalized Estimating Equations (GEE)</h2>
<div id="the-gee-function-in-the-gee-package" class="section level4" number="17.4.0.1">
<h4 number="17.4.0.1"><span class="header-section-number">17.4.0.1</span> The <code>gee()</code> function in the <code>gee</code> package</h4>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="#cb836-1"></a>mod_gee_ind &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(count <span class="op">~</span><span class="st"> </span>drug<span class="op">*</span>time,</span>
<span id="cb836-2"><a href="#cb836-2"></a>                        <span class="dt">data =</span> data_long,</span>
<span id="cb836-3"><a href="#cb836-3"></a>                        <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb836-4"><a href="#cb836-4"></a>                        <span class="dt">id =</span> id,</span>
<span id="cb836-5"><a href="#cb836-5"></a>                        <span class="dt">corstr =</span> <span class="st">&quot;independence&quot;</span>)</span></code></pre></div>
<pre><code>(Intercept)       drugB       drugC        time  drugB:time  drugC:time 
    2.23001     0.07257     0.32721    -0.56231     0.06801     0.51468 </code></pre>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="#cb838-1"></a>mod_gee_exc &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(count <span class="op">~</span><span class="st"> </span>drug<span class="op">*</span>time,</span>
<span id="cb838-2"><a href="#cb838-2"></a>                        <span class="dt">data =</span> data_long,</span>
<span id="cb838-3"><a href="#cb838-3"></a>                        <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb838-4"><a href="#cb838-4"></a>                        <span class="dt">id =</span> id,</span>
<span id="cb838-5"><a href="#cb838-5"></a>                        <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>)</span></code></pre></div>
<pre><code>(Intercept)       drugB       drugC        time  drugB:time  drugC:time 
    2.23001     0.07257     0.32721    -0.56231     0.06801     0.51468 </code></pre>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="#cb840-1"></a>mod_gee_uns &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(count <span class="op">~</span><span class="st"> </span>drug<span class="op">*</span>time,</span>
<span id="cb840-2"><a href="#cb840-2"></a>                        <span class="dt">data =</span> data_long,</span>
<span id="cb840-3"><a href="#cb840-3"></a>                        <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb840-4"><a href="#cb840-4"></a>                        <span class="dt">id =</span> id,</span>
<span id="cb840-5"><a href="#cb840-5"></a>                        <span class="dt">corstr =</span> <span class="st">&quot;unstructured&quot;</span>)</span></code></pre></div>
<pre><code>(Intercept)       drugB       drugC        time  drugB:time  drugC:time 
    2.23001     0.07257     0.32721    -0.56231     0.06801     0.51468 </code></pre>
</div>
<div id="compare-models-1" class="section level3" number="17.4.1">
<h3 number="17.4.1"><span class="header-section-number">17.4.1</span> Compare Models</h3>
<div id="raw-estimates-log-rate-scale" class="section level4" number="17.4.1.1">
<h4 number="17.4.1.1"><span class="header-section-number">17.4.1.1</span> Raw Estimates (log-rate scale)</h4>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="#cb842-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb842-2"><a href="#cb842-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb842-3"><a href="#cb842-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb842-4"><a href="#cb842-4"></a></span>
<span id="cb842-5"><a href="#cb842-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(mod_gee_ind, </span>
<span id="cb842-6"><a href="#cb842-6"></a>                     mod_gee_exc, </span>
<span id="cb842-7"><a href="#cb842-7"></a>                     mod_gee_uns), </span>
<span id="cb842-8"><a href="#cb842-8"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Independence&quot;</span>,</span>
<span id="cb842-9"><a href="#cb842-9"></a>                                       <span class="st">&quot;Exchangeable&quot;</span>,</span>
<span id="cb842-10"><a href="#cb842-10"></a>                                       <span class="st">&quot;Unstructured&quot;</span>),</span>
<span id="cb842-11"><a href="#cb842-11"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb842-12"><a href="#cb842-12"></a>                <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb842-13"><a href="#cb842-13"></a>                <span class="dt">caption =</span> <span class="st">&quot;Estimates on Log Scale&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Estimates on Log Scale
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Independence
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Exchangeable
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Unstructured
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.230 (0.154)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.230 (0.154)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.230 (0.154)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.073 (0.220)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.073 (0.220)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.073 (0.220)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.327 (0.179)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.327 (0.179)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.327 (0.179)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.562 (0.176)<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.562 (0.176)<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.562 (0.176)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugB:time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.068 (0.246)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.068 (0.246)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.068 (0.246)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugC:time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.515 (0.221)<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.515 (0.221)<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.515 (0.221)<sup>*</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Scale
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.474
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.474
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.474
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
60
</td>
<td style="padding-left: 5px;padding-right: 5px;">
60
</td>
<td style="padding-left: 5px;padding-right: 5px;">
60
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="exponentiate-the-estimates-risk-scale" class="section level4" number="17.4.1.2">
<h4 number="17.4.1.2"><span class="header-section-number">17.4.1.2</span> Exponentiate the Estimates (risk scale)</h4>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="#cb843-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb843-2"><a href="#cb843-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb843-3"><a href="#cb843-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb843-4"><a href="#cb843-4"></a></span>
<span id="cb843-5"><a href="#cb843-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="kw">extract_gee_exp</span>(mod_gee_ind), </span>
<span id="cb843-6"><a href="#cb843-6"></a>                     <span class="kw">extract_gee_exp</span>(mod_gee_exc), </span>
<span id="cb843-7"><a href="#cb843-7"></a>                     <span class="kw">extract_gee_exp</span>(mod_gee_uns)),</span>
<span id="cb843-8"><a href="#cb843-8"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Independence&quot;</span>,</span>
<span id="cb843-9"><a href="#cb843-9"></a>                                       <span class="st">&quot;Exchangeable&quot;</span>,</span>
<span id="cb843-10"><a href="#cb843-10"></a>                                       <span class="st">&quot;Unstructured&quot;</span>),</span>
<span id="cb843-11"><a href="#cb843-11"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb843-12"><a href="#cb843-12"></a>                <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb843-13"><a href="#cb843-13"></a>                <span class="dt">ci.test =</span> <span class="dv">1</span>,</span>
<span id="cb843-14"><a href="#cb843-14"></a>                <span class="dt">caption =</span> <span class="st">&quot;Estimates on Count Scale&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Estimates on Count Scale
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Independence
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Exchangeable
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Unstructured
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
9.300 [6.882; 12.567]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
9.300 [6.882; 12.567]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
9.300 [6.882; 12.567]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.075 [0.699; 1.655]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.075 [0.699; 1.655]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.075 [0.699; 1.655]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.387 [0.977; 1.970]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.387 [0.977; 1.970]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.387 [0.977; 1.970]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.570 [0.404; 0.805]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.570 [0.404; 0.805]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.570 [0.404; 0.805]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugB:time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.070 [0.661; 1.734]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.070 [0.661; 1.734]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.070 [0.661; 1.734]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugC:time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.673 [1.086; 2.578]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.673 [1.086; 2.578]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.673 [1.086; 2.578]<sup>*</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Dispersion
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.474
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.474
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.474
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
60
</td>
<td style="padding-left: 5px;padding-right: 5px;">
60
</td>
<td style="padding-left: 5px;padding-right: 5px;">
60
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup>*</sup> Null hypothesis value outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="manual-extraction-1" class="section level4" number="17.4.1.3">
<h4 number="17.4.1.3"><span class="header-section-number">17.4.1.3</span> Manual Extraction</h4>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="#cb844-1"></a>mod_gee_exc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</span></code></pre></div>
<pre><code>(Intercept)       drugB       drugC        time  drugB:time  drugC:time 
     9.3000      1.0753      1.3871      0.5699      1.0704      1.6731 </code></pre>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="#cb846-1"></a><span class="fl">0.5699</span><span class="op">*</span><span class="fl">1.6731</span></span></code></pre></div>
<pre><code>[1] 0.9535</code></pre>
<blockquote>
<p>Interpretation</p>
<p>Antibiotic A Group: Starts with mean of 9.3 and drops by 45% (nearly cut in half) over the course of treatment.</p>
<p>Antibiotic B Group: Starts at about the same mean at Antibiotic A group and experiences the same decrease.</p>
<p>Control Group (C): Starts at about the same mean at Antibiotic A group BUT experiences a less than a 5% decrease over the student period while on the placebo pills.</p>
</blockquote>
</div>
</div>
<div id="visualize-the-final-model" class="section level3" number="17.4.2">
<h3 number="17.4.2"><span class="header-section-number">17.4.2</span> Visualize the Final Model</h3>
<div id="refit-with-the-geeglm-function-in-the-geepack-package" class="section level4" number="17.4.2.1">
<h4 number="17.4.2.1"><span class="header-section-number">17.4.2.1</span> Refit with the <code>geeglm()</code> function in the <code>geepack</code> package</h4>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="#cb848-1"></a>mod_geeglm_exc &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(count <span class="op">~</span><span class="st"> </span>drug<span class="op">*</span>time,</span>
<span id="cb848-2"><a href="#cb848-2"></a>                                  <span class="dt">data =</span> data_long,</span>
<span id="cb848-3"><a href="#cb848-3"></a>                                  <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb848-4"><a href="#cb848-4"></a>                                  <span class="dt">id =</span> id,</span>
<span id="cb848-5"><a href="#cb848-5"></a>                                  <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>)</span>
<span id="cb848-6"><a href="#cb848-6"></a></span>
<span id="cb848-7"><a href="#cb848-7"></a><span class="kw">summary</span>(mod_geeglm_exc)</span></code></pre></div>
<pre><code>
Call:
geepack::geeglm(formula = count ~ drug * time, family = poisson(link = &quot;log&quot;), 
    data = data_long, id = id, corstr = &quot;exchangeable&quot;)

 Coefficients:
            Estimate Std.err   Wald Pr(&gt;|W|)    
(Intercept)   2.2300  0.1536 210.74   &lt;2e-16 ***
drugB         0.0726  0.2200   0.11   0.7415    
drugC         0.3272  0.1791   3.34   0.0677 .  
time         -0.5623  0.1760  10.21   0.0014 ** 
drugB:time    0.0680  0.2460   0.08   0.7822    
drugC:time    0.5147  0.2206   5.45   0.0196 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     3.13   0.513
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.735   0.081
Number of clusters:   30  Maximum cluster size: 2 </code></pre>
</div>
<div id="predict-over-a-manual-grid-of-predictors" class="section level4" number="17.4.2.2">
<h4 number="17.4.2.2"><span class="header-section-number">17.4.2.2</span> Predict over a manual grid of predictors</h4>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="#cb850-1"></a><span class="kw">expand.grid</span>(<span class="dt">drug =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>drug),</span>
<span id="cb850-2"><a href="#cb850-2"></a>            <span class="dt">time =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb850-3"><a href="#cb850-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(mod_geeglm_exc,</span>
<span id="cb850-4"><a href="#cb850-4"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb850-5"><a href="#cb850-5"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) </span></code></pre></div>
<pre><code>  drug time  fit
1    A    0  9.3
2    B    0 10.0
3    C    0 12.9
4    A    1  5.3
5    B    1  6.1
6    C    1 12.3</code></pre>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="#cb852-1"></a><span class="kw">expand.grid</span>(<span class="dt">drug =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>drug),</span>
<span id="cb852-2"><a href="#cb852-2"></a>            <span class="dt">time =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb852-3"><a href="#cb852-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(mod_geeglm_exc,</span>
<span id="cb852-4"><a href="#cb852-4"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb852-5"><a href="#cb852-5"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb852-6"><a href="#cb852-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time_name =</span> <span class="kw">case_when</span>(time <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Pre&quot;</span>,</span>
<span id="cb852-7"><a href="#cb852-7"></a>                                      time <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Post&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb852-8"><a href="#cb852-8"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Pre&quot;</span>, <span class="st">&quot;Post&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb852-9"><a href="#cb852-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">drug_name =</span> <span class="kw">fct_recode</span>(drug,</span>
<span id="cb852-10"><a href="#cb852-10"></a>                                       <span class="st">&quot;Antibiotic A&quot;</span> =<span class="st"> &quot;A&quot;</span>,</span>
<span id="cb852-11"><a href="#cb852-11"></a>                                       <span class="st">&quot;Antibiotic B&quot;</span> =<span class="st"> &quot;B&quot;</span>,</span>
<span id="cb852-12"><a href="#cb852-12"></a>                                       <span class="st">&quot;Placebo&quot;</span> =<span class="st"> &quot;C&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb852-13"><a href="#cb852-13"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time_name,</span>
<span id="cb852-14"><a href="#cb852-14"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb852-15"><a href="#cb852-15"></a>             <span class="dt">group =</span> drug_name <span class="op">%&gt;%</span><span class="st"> </span>fct_rev,</span>
<span id="cb852-16"><a href="#cb852-16"></a>             <span class="dt">color =</span> drug_name <span class="op">%&gt;%</span><span class="st"> </span>fct_rev)) <span class="op">+</span></span>
<span id="cb852-17"><a href="#cb852-17"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb852-18"><a href="#cb852-18"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb852-19"><a href="#cb852-19"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb852-20"><a href="#cb852-20"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb852-21"><a href="#cb852-21"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Number of Leprosy Bacilli at Six Sites of the Body&quot;</span>,</span>
<span id="cb852-22"><a href="#cb852-22"></a>       <span class="dt">color =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb852-23"><a href="#cb852-23"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb852-24"><a href="#cb852-24"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">-0.1</span>),</span>
<span id="cb852-25"><a href="#cb852-25"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-648-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="follow-up-analysis" class="section level2" number="17.5">
<h2 number="17.5"><span class="header-section-number">17.5</span> Follow-up Analysis</h2>
<div id="collapse-the-predictor" class="section level3" number="17.5.1">
<h3 number="17.5.1"><span class="header-section-number">17.5.1</span> Collapse the Predictor</h3>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="#cb853-1"></a>data_remodel &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb853-2"><a href="#cb853-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">antibiotic =</span> <span class="kw">fct_collapse</span>(drug,</span>
<span id="cb853-3"><a href="#cb853-3"></a>                                          <span class="dt">yes =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb853-4"><a href="#cb853-4"></a>                                          <span class="dt">no =</span> <span class="kw">c</span>(<span class="st">&quot;C&quot;</span>)))</span></code></pre></div>
</div>
<div id="reduce-the-model---geegee" class="section level3" number="17.5.2">
<h3 number="17.5.2"><span class="header-section-number">17.5.2</span> Reduce the Model - <code>gee::gee()</code></h3>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="#cb854-1"></a>mod_gee_exc2 &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(count <span class="op">~</span><span class="st"> </span>antibiotic<span class="op">:</span>time ,</span>
<span id="cb854-2"><a href="#cb854-2"></a>                         <span class="dt">data =</span> data_remodel,</span>
<span id="cb854-3"><a href="#cb854-3"></a>                         <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb854-4"><a href="#cb854-4"></a>                         <span class="dt">id =</span> id,</span>
<span id="cb854-5"><a href="#cb854-5"></a>                         <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>)</span></code></pre></div>
<pre><code>       (Intercept) antibioticyes:time  antibioticno:time 
             2.373             -0.633              0.136 </code></pre>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="#cb856-1"></a><span class="kw">summary</span>(mod_gee_exc2)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     Exchangeable 

Call:
gee::gee(formula = count ~ antibiotic:time, id = id, data = data_remodel, 
    family = poisson(link = &quot;log&quot;), corstr = &quot;exchangeable&quot;)

Summary of Residuals:
   Min     1Q Median     3Q    Max 
-9.618 -4.733 -0.484  3.517 12.382 


Coefficients:
                   Estimate Naive S.E. Naive z Robust S.E. Robust z
(Intercept)          2.3734      0.103 23.0780      0.0801  29.6159
antibioticyes:time  -0.5249      0.102 -5.1243      0.1112  -4.7183
antibioticno:time   -0.0108      0.114 -0.0942      0.1572  -0.0684

Estimated Scale Parameter:  3.41
Number of Iterations:  5

Working Correlation
     [,1] [,2]
[1,] 1.00 0.78
[2,] 0.78 1.00</code></pre>
</div>
<div id="compare-parameters" class="section level3" number="17.5.3">
<h3 number="17.5.3"><span class="header-section-number">17.5.3</span> Compare Parameters</h3>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="#cb858-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb858-2"><a href="#cb858-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb858-3"><a href="#cb858-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb858-4"><a href="#cb858-4"></a></span>
<span id="cb858-5"><a href="#cb858-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="kw">extract_gee_exp</span>(mod_gee_exc), </span>
<span id="cb858-6"><a href="#cb858-6"></a>                     <span class="kw">extract_gee_exp</span>(mod_gee_exc2)), </span>
<span id="cb858-7"><a href="#cb858-7"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Original&quot;</span>,</span>
<span id="cb858-8"><a href="#cb858-8"></a>                                       <span class="st">&quot;Refit&quot;</span>),</span>
<span id="cb858-9"><a href="#cb858-9"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb858-10"><a href="#cb858-10"></a>                <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb858-11"><a href="#cb858-11"></a>                <span class="dt">ci.test =</span> <span class="dv">1</span>,</span>
<span id="cb858-12"><a href="#cb858-12"></a>                <span class="dt">caption =</span> <span class="st">&quot;Estimates on Count Scale (Exchangeable)&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Estimates on Count Scale (Exchangeable)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Original
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Refit
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
9.300 [6.882; 12.567]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
10.733 [9.173; 12.559]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugB
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.075 [0.699; 1.655]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.387 [0.977; 1.970]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.570 [0.404; 0.805]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugB:time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.070 [0.661; 1.734]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
drugC:time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.673 [1.086; 2.578]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
antibioticyes:time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.592 [0.476; 0.736]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
antibioticno:time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.989 [0.727; 1.346]
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Dispersion
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.474
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.406
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
60
</td>
<td style="padding-left: 5px;padding-right: 5px;">
60
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup>*</sup> Null hypothesis value outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
<blockquote>
<p>Interpretation</p>
<p>Grand mean is 10.73 at pre-treatment.</p>
<p>The mean count dropped by about 40% among thoes on antibiotics, but there was no decrease for thoes on placebo pills.</p>
</blockquote>
</div>
<div id="visualize-3" class="section level3" number="17.5.4">
<h3 number="17.5.4"><span class="header-section-number">17.5.4</span> Visualize</h3>
<div id="refit-with-geepackgeeglm" class="section level4" number="17.5.4.1">
<h4 number="17.5.4.1"><span class="header-section-number">17.5.4.1</span> Refit with <code>geepack::geeglm()</code></h4>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="#cb859-1"></a>mod_geeglm_exc2 &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(count <span class="op">~</span><span class="st"> </span>antibiotic<span class="op">:</span>time,</span>
<span id="cb859-2"><a href="#cb859-2"></a>                                   <span class="dt">data =</span> data_remodel,</span>
<span id="cb859-3"><a href="#cb859-3"></a>                                   <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb859-4"><a href="#cb859-4"></a>                                   <span class="dt">id =</span> id,</span>
<span id="cb859-5"><a href="#cb859-5"></a>                                   <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>)</span></code></pre></div>
</div>
<div id="predict-over-a-manual-grid" class="section level4" number="17.5.4.2">
<h4 number="17.5.4.2"><span class="header-section-number">17.5.4.2</span> Predict over a manual grid</h4>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="#cb860-1"></a><span class="kw">expand.grid</span>(<span class="dt">antibiotic =</span> <span class="kw">levels</span>(data_remodel<span class="op">$</span>antibiotic),</span>
<span id="cb860-2"><a href="#cb860-2"></a>            <span class="dt">time =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb860-3"><a href="#cb860-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(mod_geeglm_exc2,</span>
<span id="cb860-4"><a href="#cb860-4"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb860-5"><a href="#cb860-5"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb860-6"><a href="#cb860-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time_name =</span> <span class="kw">case_when</span>(time <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Pre&quot;</span>,</span>
<span id="cb860-7"><a href="#cb860-7"></a>                                      time <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Post&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb860-8"><a href="#cb860-8"></a><span class="st">                  </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Pre&quot;</span>, <span class="st">&quot;Post&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb860-9"><a href="#cb860-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time_name,</span>
<span id="cb860-10"><a href="#cb860-10"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb860-11"><a href="#cb860-11"></a>             <span class="dt">group =</span> antibiotic <span class="op">%&gt;%</span><span class="st"> </span>fct_rev,</span>
<span id="cb860-12"><a href="#cb860-12"></a>             <span class="dt">color =</span> antibiotic <span class="op">%&gt;%</span><span class="st"> </span>fct_rev)) <span class="op">+</span></span>
<span id="cb860-13"><a href="#cb860-13"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb860-14"><a href="#cb860-14"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb860-15"><a href="#cb860-15"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb860-16"><a href="#cb860-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb860-17"><a href="#cb860-17"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Marginal Mean</span><span class="ch">\n</span><span class="st">Number of Leprosy Bacilli at Six Sites of the Body&quot;</span>,</span>
<span id="cb860-18"><a href="#cb860-18"></a>       <span class="dt">color =</span> <span class="st">&quot;Antibiotic&quot;</span>) <span class="op">+</span></span>
<span id="cb860-19"><a href="#cb860-19"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb860-20"><a href="#cb860-20"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">-0.1</span>),</span>
<span id="cb860-21"><a href="#cb860-21"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-654-1.png" width="576" style="display: block; margin: auto;" /></p>
<!--chapter:end:51_example_gee_Leprosy.Rmd-->
</div>
</div>
</div>
</div>
<div id="glmm-binary-outcome-contraception-amenorrhea" class="section level1" number="18">
<h1 number="18"><span class="header-section-number">18</span> GLMM, Binary Outcome: Contraception &amp; Amenorrhea</h1>
<div id="packages-3" class="section level2" number="18.1">
<h2 number="18.1"><span class="header-section-number">18.1</span> Packages</h2>
<div id="cran-3" class="section level3" number="18.1.1">
<h3 number="18.1.1"><span class="header-section-number">18.1.1</span> CRAN</h3>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="#cb861-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb861-2"><a href="#cb861-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb861-3"><a href="#cb861-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb861-4"><a href="#cb861-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb861-5"><a href="#cb861-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb861-6"><a href="#cb861-6"></a></span>
<span id="cb861-7"><a href="#cb861-7"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb861-8"><a href="#cb861-8"></a><span class="kw">library</span>(effects)      <span class="co"># Plotting estimated marginal means</span></span>
<span id="cb861-9"><a href="#cb861-9"></a></span>
<span id="cb861-10"><a href="#cb861-10"></a><span class="kw">library</span>(optimx)       <span class="co"># Unify and streamline optimization capabilities in R</span></span></code></pre></div>
</div>
<div id="github-3" class="section level3" number="18.1.2">
<h3 number="18.1.2"><span class="header-section-number">18.1.2</span> GitHub</h3>
<p>Helper <code>extract</code> functions for exponentiating parameters form generalized regression models within a <code>texreg</code> table of model parameters.</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="#cb862-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb862-2"><a href="#cb862-2"></a><span class="co"># library(devtools)</span></span>
<span id="cb862-3"><a href="#cb862-3"></a><span class="co"># install_github(&quot;SarBearSchwartz/texreghelpr&quot;)</span></span>
<span id="cb862-4"><a href="#cb862-4"></a></span>
<span id="cb862-5"><a href="#cb862-5"></a><span class="kw">library</span>(texreghelpr)</span></code></pre></div>
</div>
</div>
<div id="data-prep" class="section level2" number="18.2">
<h2 number="18.2"><span class="header-section-number">18.2</span> Data Prep</h2>
<blockquote>
<p>Data on Amenorrhea from Clinical Trial of Contracepting Women.</p>
</blockquote>
<p><strong>Source:</strong></p>
<p>Table 1 (page 168) of Machin et al. (1988).
With permission of Elsevier.</p>
<p><strong>Reference:</strong></p>
<p>Machin D, Farley T, Busca B, Campbell M and d’Arcangues C. (1988). Assessing changes in vaginal bleeding patterns in contracepting women. Contraception, 38, 165-179.</p>
<p><strong>Description:</strong></p>
<p>The data are from a <em>longitudinal</em> clinical trial of contracepting women. In this trial women received an injection of either 100 mg or 150 mg of depot-medroxyprogesterone acetate (DMPA) on the day of randomization and three additional injections at 90-day intervals. There was a final follow-up visit 90 days after the fourth injection, i.e., one year after the first injection. Throughout the study each woman completed a menstrual diary that recorded any vaginal bleeding pattern disturbances. The diary data were used to determine whether a women experienced <em>amenorrhea</em>, the absence of menstrual bleeding for a specified number of days. A total of 1151 women completed the menstrual diaries and the diary data were used to generate a binary sequence for each woman according to whether or not she had experienced <strong>amenorrhea in the four successive three month intervals</strong>.</p>
<p>In clinical trials of modern hormonal contraceptives, pregnancy is exceedingly rare (and would be regarded as a failure of the contraceptive method), and is not the main outcome of interest in this study. Instead, the outcome of interest is a binary response indicating whether a woman experienced amenorrhea in the four successive three month intervals. A feature of this clinical trial is that there was <strong>substantial dropout</strong>. More than one third of the women dropped out before the completion of the trial.</p>
<p><strong>Variable List:</strong></p>
<ul>
<li><p>Indicators</p>
<ul>
<li><code>id</code> participant identification</li>
<li><code>occasion</code> denotes the four 90-day periods</li>
</ul></li>
<li><p>Outcome or dependent variable</p>
<ul>
<li><code>amenorrhea</code> Amenorrhea Status: 1=Amenorrhea, 0=No Amenorrhea</li>
</ul></li>
<li><p>Main predictor or independent variable of interest</p>
<ul>
<li><code>dose</code> 0 = Low (100 mg), 1 = High (150 mg)</li>
</ul></li>
</ul>
<div id="import-1" class="section level3" number="18.2.1">
<h3 number="18.2.1"><span class="header-section-number">18.2.1</span> Import</h3>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="#cb863-1"></a>data_raw &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/CEHS-research/data/master/MLM/RCTcontraception.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</span>
<span id="cb863-2"><a href="#cb863-2"></a></span>
<span id="cb863-3"><a href="#cb863-3"></a><span class="kw">str</span>(data_raw)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   4604 obs. of  4 variables:
 $ id        : int  1 1 1 1 2 2 2 2 3 3 ...
 $ dose      : int  0 0 0 0 0 0 0 0 0 0 ...
 $ occasion  : int  1 2 3 4 1 2 3 4 1 2 ...
 $ amenorrhea: chr  &quot;0&quot; &quot;.&quot; &quot;.&quot; &quot;.&quot; ...</code></pre>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="#cb865-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_raw, <span class="dt">top =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>       id dose occasion amenorrhea
1       1    0        1          0
2       1    0        2          .
3       1    0        3          .
4       1    0        4          .
5       2    0        1          0
6       2    0        2          .
7       2    0        3          .
8       2    0        4          .
9       3    0        1          0
10      3    0        2          .
...   ...  ...      ...       &lt;NA&gt;
4601 1151    1        1          1
4602 1151    1        2          1
4603 1151    1        3          1
4604 1151    1        4          1</code></pre>
</div>
<div id="long-format-5" class="section level3" number="18.2.2">
<h3 number="18.2.2"><span class="header-section-number">18.2.2</span> Long Format</h3>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="#cb867-1"></a>data_long &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb867-2"><a href="#cb867-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">factor</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb867-3"><a href="#cb867-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">dose =</span> <span class="kw">factor</span>(dose,</span>
<span id="cb867-4"><a href="#cb867-4"></a>                              <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>),</span>
<span id="cb867-5"><a href="#cb867-5"></a>                              <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb867-6"><a href="#cb867-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> occasion <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb867-7"><a href="#cb867-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">amenorrhea =</span> amenorrhea <span class="op">%&gt;%</span><span class="st">       </span><span class="co"># outcome needs to be numeric</span></span>
<span id="cb867-8"><a href="#cb867-8"></a><span class="st">                  </span><span class="kw">as.character</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb867-9"><a href="#cb867-9"></a><span class="st">                  </span><span class="kw">as.numeric</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb867-10"><a href="#cb867-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(amenorrhea)) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># dump missing occations</span></span>
<span id="cb867-11"><a href="#cb867-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(id, time)</span>
<span id="cb867-12"><a href="#cb867-12"></a></span>
<span id="cb867-13"><a href="#cb867-13"></a><span class="kw">str</span>(data_long)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   3616 obs. of  5 variables:
 $ id        : Factor w/ 1151 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
 $ dose      : Factor w/ 2 levels &quot;Low&quot;,&quot;High&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ occasion  : int  1 1 1 1 1 1 1 1 1 1 ...
 $ amenorrhea: num  0 0 0 0 0 0 0 0 0 0 ...
 $ time      : num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="#cb869-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_long, <span class="dt">bottom =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>       id dose occasion amenorrhea time
1       1  Low        1          0    0
2       2  Low        1          0    0
3       3  Low        1          0    0
4       4  Low        1          0    0
...  &lt;NA&gt; &lt;NA&gt;      ...        ...  ...
3607 1149 High        3          1    2
3608 1149 High        4          1    3
3609 1150 High        1          1    0
3610 1150 High        2          1    1
3611 1150 High        3          1    2
3612 1150 High        4          1    3
3613 1151 High        1          1    0
3614 1151 High        2          1    1
3615 1151 High        3          1    2
3616 1151 High        4          1    3</code></pre>
</div>
<div id="wide-format-5" class="section level3" number="18.2.3">
<h3 number="18.2.3"><span class="header-section-number">18.2.3</span> Wide Format</h3>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="#cb871-1"></a>data_wide &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb871-2"><a href="#cb871-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>time) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb871-3"><a href="#cb871-3"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">id_cols =</span> <span class="kw">c</span>(id, dose),</span>
<span id="cb871-4"><a href="#cb871-4"></a>                     <span class="dt">names_from =</span> occasion,</span>
<span id="cb871-5"><a href="#cb871-5"></a>                     <span class="dt">names_prefix =</span> <span class="st">&quot;occasion_&quot;</span>,</span>
<span id="cb871-6"><a href="#cb871-6"></a>                     <span class="dt">values_from =</span> amenorrhea)</span>
<span id="cb871-7"><a href="#cb871-7"></a></span>
<span id="cb871-8"><a href="#cb871-8"></a><span class="kw">str</span>(data_wide)</span></code></pre></div>
<pre><code>tibble [1,151 x 6] (S3: tbl_df/tbl/data.frame)
 $ id        : Factor w/ 1151 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
 $ dose      : Factor w/ 2 levels &quot;Low&quot;,&quot;High&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ occasion_1: num [1:1151] 0 0 0 0 0 0 0 0 0 0 ...
 $ occasion_2: num [1:1151] NA NA NA NA NA NA NA NA NA NA ...
 $ occasion_3: num [1:1151] NA NA NA NA NA NA NA NA NA NA ...
 $ occasion_4: num [1:1151] NA NA NA NA NA NA NA NA NA NA ...</code></pre>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="#cb873-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_wide, <span class="dt">bottom =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>     id dose occasion_1 occasion_2 occasion_3 occasion_4
1     1  Low          0       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
2     2  Low          0       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
3     3  Low          0       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
4     4  Low          0       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
5  &lt;NA&gt; &lt;NA&gt;        ...        ...        ...        ...
6  1142 High          1          1          1          1
7  1143 High          1          1          1          1
8  1144 High          1          1          1          1
9  1145 High          1          1          1          1
10 1146 High          1          1          1          1
11 1147 High          1          1          1          1
12 1148 High          1          1          1          1
13 1149 High          1          1          1          1
14 1150 High          1          1          1          1
15 1151 High          1          1          1          1</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-9" class="section level2" number="18.3">
<h2 number="18.3"><span class="header-section-number">18.3</span> Exploratory Data Analysis</h2>
<div id="summary-statistics-2" class="section level3" number="18.3.1">
<h3 number="18.3.1"><span class="header-section-number">18.3.1</span> Summary Statistics</h3>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="#cb875-1"></a>data_summary &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb875-2"><a href="#cb875-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(dose, occasion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb875-3"><a href="#cb875-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N =</span> <span class="kw">n</span>(),</span>
<span id="cb875-4"><a href="#cb875-4"></a>                   <span class="dt">M =</span> <span class="kw">mean</span>(amenorrhea),</span>
<span id="cb875-5"><a href="#cb875-5"></a>                   <span class="dt">SD =</span> <span class="kw">sd</span>(amenorrhea),</span>
<span id="cb875-6"><a href="#cb875-6"></a>                   <span class="dt">SE =</span> SD<span class="op">/</span><span class="kw">sqrt</span>(N))</span>
<span id="cb875-7"><a href="#cb875-7"></a></span>
<span id="cb875-8"><a href="#cb875-8"></a>data_summary</span></code></pre></div>
<pre><code># A tibble: 8 x 6
# Groups:   dose [2]
  dose  occasion     N     M    SD     SE
  &lt;fct&gt;    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Low          1   576 0.186 0.389 0.0162
2 Low          2   477 0.262 0.440 0.0202
3 Low          3   409 0.389 0.488 0.0241
4 Low          4   361 0.501 0.501 0.0264
5 High         1   575 0.205 0.404 0.0169
6 High         2   476 0.336 0.473 0.0217
7 High         3   389 0.494 0.501 0.0254
8 High         4   353 0.535 0.499 0.0266</code></pre>
</div>
<div id="visualize-4" class="section level3" number="18.3.2">
<h3 number="18.3.2"><span class="header-section-number">18.3.2</span> Visualize</h3>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="#cb877-1"></a>data_summary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb877-2"><a href="#cb877-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> occasion,</span>
<span id="cb877-3"><a href="#cb877-3"></a>             <span class="dt">y =</span> M,</span>
<span id="cb877-4"><a href="#cb877-4"></a>             <span class="dt">fill =</span> dose)) <span class="op">+</span></span>
<span id="cb877-5"><a href="#cb877-5"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb877-6"><a href="#cb877-6"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb877-7"><a href="#cb877-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb877-8"><a href="#cb877-8"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb877-9"><a href="#cb877-9"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb877-10"><a href="#cb877-10"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb877-11"><a href="#cb877-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;90-day windows&quot;</span>,</span>
<span id="cb877-12"><a href="#cb877-12"></a>       <span class="dt">y =</span> <span class="st">&quot;Observed Proportion of Amenorrhea&quot;</span>,</span>
<span id="cb877-13"><a href="#cb877-13"></a>       <span class="dt">fill =</span> <span class="st">&quot;Dosage&quot;</span>) <span class="op">+</span></span>
<span id="cb877-14"><a href="#cb877-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,</span>
<span id="cb877-15"><a href="#cb877-15"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;First&quot;</span>,</span>
<span id="cb877-16"><a href="#cb877-16"></a>                                <span class="st">&quot;Second&quot;</span>,</span>
<span id="cb877-17"><a href="#cb877-17"></a>                                <span class="st">&quot;Third&quot;</span>,</span>
<span id="cb877-18"><a href="#cb877-18"></a>                                <span class="st">&quot;Fourth&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-662-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="#cb878-1"></a>data_summary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb878-2"><a href="#cb878-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> occasion,</span>
<span id="cb878-3"><a href="#cb878-3"></a>             <span class="dt">y =</span> M,</span>
<span id="cb878-4"><a href="#cb878-4"></a>             <span class="dt">color =</span> dose <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fct_rev</span>())) <span class="op">+</span></span>
<span id="cb878-5"><a href="#cb878-5"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> M <span class="op">-</span><span class="st"> </span>SE,</span>
<span id="cb878-6"><a href="#cb878-6"></a>                    <span class="dt">ymax =</span> M <span class="op">+</span><span class="st"> </span>SE),</span>
<span id="cb878-7"><a href="#cb878-7"></a>                <span class="dt">width =</span> <span class="fl">.3</span>,</span>
<span id="cb878-8"><a href="#cb878-8"></a>                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.25</span>)) <span class="op">+</span></span>
<span id="cb878-9"><a href="#cb878-9"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.25</span>)) <span class="op">+</span></span>
<span id="cb878-10"><a href="#cb878-10"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.25</span>)) <span class="op">+</span></span>
<span id="cb878-11"><a href="#cb878-11"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb878-12"><a href="#cb878-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb878-13"><a href="#cb878-13"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb878-14"><a href="#cb878-14"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb878-15"><a href="#cb878-15"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb878-16"><a href="#cb878-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;90-day windows&quot;</span>,</span>
<span id="cb878-17"><a href="#cb878-17"></a>       <span class="dt">y =</span> <span class="st">&quot;Observed Proportion of Amenorrhea&quot;</span>,</span>
<span id="cb878-18"><a href="#cb878-18"></a>       <span class="dt">color =</span> <span class="st">&quot;Dosage&quot;</span>) <span class="op">+</span></span>
<span id="cb878-19"><a href="#cb878-19"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,</span>
<span id="cb878-20"><a href="#cb878-20"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;First&quot;</span>,</span>
<span id="cb878-21"><a href="#cb878-21"></a>                                <span class="st">&quot;Second&quot;</span>,</span>
<span id="cb878-22"><a href="#cb878-22"></a>                                <span class="st">&quot;Third&quot;</span>,</span>
<span id="cb878-23"><a href="#cb878-23"></a>                                <span class="st">&quot;Fourth&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-663-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="glmm---basic" class="section level2" number="18.4">
<h2 number="18.4"><span class="header-section-number">18.4</span> GLMM - Basic</h2>
<div id="fit-models" class="section level3" number="18.4.1">
<h3 number="18.4.1"><span class="header-section-number">18.4.1</span> Fit Models</h3>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="#cb879-1"></a>fit_<span class="dv">1</span> &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(amenorrhea <span class="op">~</span><span class="st"> </span>time<span class="op">*</span>dose <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb879-2"><a href="#cb879-2"></a>                     <span class="dt">data =</span> data_long,</span>
<span id="cb879-3"><a href="#cb879-3"></a>                     <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb879-4"><a href="#cb879-4"></a></span>
<span id="cb879-5"><a href="#cb879-5"></a>fit_<span class="dv">2</span> &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(amenorrhea <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>dose <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb879-6"><a href="#cb879-6"></a>                     <span class="dt">data =</span> data_long,</span>
<span id="cb879-7"><a href="#cb879-7"></a>                     <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
<div id="compare-via-lrt" class="section level4" number="18.4.1.1">
<h4 number="18.4.1.1"><span class="header-section-number">18.4.1.1</span> Compare via LRT</h4>
<p>Should the interaction be included? No.</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="#cb880-1"></a><span class="kw">anova</span>(fit_<span class="dv">1</span>, fit_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_2: amenorrhea ~ time + dose + (1 | id)
fit_1: amenorrhea ~ time * dose + (1 | id)
      npar  AIC  BIC logLik deviance Chisq Df Pr(&gt;Chisq)
fit_2    4 3931 3956  -1961     3923                    
fit_1    5 3932 3963  -1961     3922  0.69  1       0.41</code></pre>
</div>
</div>
<div id="model-parameter-tables" class="section level3" number="18.4.2">
<h3 number="18.4.2"><span class="header-section-number">18.4.2</span> Model Parameter Tables</h3>
<div id="logit-scale" class="section level4" number="18.4.2.1">
<h4 number="18.4.2.1"><span class="header-section-number">18.4.2.1</span> Logit Scale</h4>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="#cb882-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb882-2"><a href="#cb882-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb882-3"><a href="#cb882-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb882-4"><a href="#cb882-4"></a></span>
<span id="cb882-5"><a href="#cb882-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_<span class="dv">1</span>, fit_<span class="dv">2</span>),</span>
<span id="cb882-6"><a href="#cb882-6"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;with&quot;</span>, <span class="st">&quot;without&quot;</span>),</span>
<span id="cb882-7"><a href="#cb882-7"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb882-8"><a href="#cb882-8"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM Parameter Estimates: Inclusion of Interaction (SE and p-values)&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM Parameter Estimates: Inclusion of Interaction (SE and p-values)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
with
</th>
<th style="padding-left: 5px;padding-right: 5px;">
without
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.55 (0.17)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.61 (0.16)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.87 (0.07)<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.91 (0.05)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
doseHigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39 (0.21)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.50 (0.16)<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time:doseHigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.08 (0.09)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3932.14
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3930.83
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3963.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3955.61
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1961.07
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1961.42
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.26
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.24
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="#cb883-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb883-2"><a href="#cb883-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb883-3"><a href="#cb883-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb883-4"><a href="#cb883-4"></a></span>
<span id="cb883-5"><a href="#cb883-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_<span class="dv">1</span>, fit_<span class="dv">2</span>),</span>
<span id="cb883-6"><a href="#cb883-6"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;with&quot;</span>, <span class="st">&quot;without&quot;</span>),</span>
<span id="cb883-7"><a href="#cb883-7"></a>                  <span class="dt">ci.force =</span> <span class="ot">TRUE</span>,</span>
<span id="cb883-8"><a href="#cb883-8"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb883-9"><a href="#cb883-9"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM Parameter Estimates: Inclusion of Interaction (95% CI&#39;s)&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM Parameter Estimates: Inclusion of Interaction (95% CI’s)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
with
</th>
<th style="padding-left: 5px;padding-right: 5px;">
without
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.55 [-2.89; -2.22]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.61 [-2.92; -2.30]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.87 [ 0.74; 1.01]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.91 [ 0.81; 1.02]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
doseHigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.39 [-0.01; 0.79]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.50 [ 0.17; 0.82]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time:doseHigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.08 [-0.10; 0.26]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3932.14
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3930.83
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3963.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3955.61
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1961.07
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1961.42
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.26
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.24
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup>*</sup> Null hypothesis value outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="odds-ratio-scale" class="section level4" number="18.4.2.2">
<h4 number="18.4.2.2"><span class="header-section-number">18.4.2.2</span> Odds ratio scale</h4>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="#cb884-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb884-2"><a href="#cb884-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb884-3"><a href="#cb884-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb884-4"><a href="#cb884-4"></a></span>
<span id="cb884-5"><a href="#cb884-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="kw">extract_glmer_exp</span>(fit_<span class="dv">1</span>), </span>
<span id="cb884-6"><a href="#cb884-6"></a>                     <span class="kw">extract_glmer_exp</span>(fit_<span class="dv">2</span>)),</span>
<span id="cb884-7"><a href="#cb884-7"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;with&quot;</span>, <span class="st">&quot;without&quot;</span>),</span>
<span id="cb884-8"><a href="#cb884-8"></a>                <span class="dt">ci.test =</span> <span class="dv">1</span>,</span>
<span id="cb884-9"><a href="#cb884-9"></a>                <span class="dt">ci.force =</span> <span class="ot">TRUE</span>,</span>
<span id="cb884-10"><a href="#cb884-10"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb884-11"><a href="#cb884-11"></a>                <span class="dt">caption =</span> <span class="st">&quot;MLM Parameter Estimates: Inclusion of Interaction (95% CI&#39;s)&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
MLM Parameter Estimates: Inclusion of Interaction (95% CI’s)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
with
</th>
<th style="padding-left: 5px;padding-right: 5px;">
without
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.08 [0.06; 0.11]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.07 [0.05; 0.10]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.40 [2.08; 2.75]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2.49 [2.24; 2.77]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
doseHigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.48 [0.98; 2.22]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.64 [1.19; 2.27]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time:doseHigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.08 [0.90; 1.30]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3932.14
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3930.83
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3963.11
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3955.61
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1961.07
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1961.42
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.26
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.24
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup>*</sup> Null hypothesis value outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
</div>
</div>
<div id="visualize-the-model-5" class="section level3" number="18.4.3">
<h3 number="18.4.3"><span class="header-section-number">18.4.3</span> Visualize the Model</h3>
<div id="scale-probability" class="section level4" number="18.4.3.1">
<h4 number="18.4.3.1"><span class="header-section-number">18.4.3.1</span> Scale = Probability</h4>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="#cb885-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;dose&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb885-2"><a href="#cb885-2"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">time =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">.1</span>)),</span>
<span id="cb885-3"><a href="#cb885-3"></a>                <span class="dt">mod =</span> fit_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb885-4"><a href="#cb885-4"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb885-5"><a href="#cb885-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time,</span>
<span id="cb885-6"><a href="#cb885-6"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb885-7"><a href="#cb885-7"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>),         <span class="co"># reference lines</span></span>
<span id="cb885-8"><a href="#cb885-8"></a>             <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb885-9"><a href="#cb885-9"></a>             <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb885-10"><a href="#cb885-10"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> fit <span class="op">-</span><span class="st"> </span>se,</span>
<span id="cb885-11"><a href="#cb885-11"></a>                  <span class="dt">ymax =</span> fit <span class="op">+</span><span class="st"> </span>se,</span>
<span id="cb885-12"><a href="#cb885-12"></a>                  <span class="dt">fill =</span> dose),</span>
<span id="cb885-13"><a href="#cb885-13"></a>              <span class="dt">alpha =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb885-14"><a href="#cb885-14"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> dose),</span>
<span id="cb885-15"><a href="#cb885-15"></a>            <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb885-16"><a href="#cb885-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb885-17"><a href="#cb885-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Predicted Probability&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-672-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Remove the error bands:</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="#cb886-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;dose&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb886-2"><a href="#cb886-2"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">time =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">.1</span>)),</span>
<span id="cb886-3"><a href="#cb886-3"></a>                <span class="dt">mod =</span> fit_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb886-4"><a href="#cb886-4"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb886-5"><a href="#cb886-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time,</span>
<span id="cb886-6"><a href="#cb886-6"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb886-7"><a href="#cb886-7"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),       </span>
<span id="cb886-8"><a href="#cb886-8"></a>             <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb886-9"><a href="#cb886-9"></a>             <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb886-10"><a href="#cb886-10"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> dose),</span>
<span id="cb886-11"><a href="#cb886-11"></a>            <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb886-12"><a href="#cb886-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb886-13"><a href="#cb886-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb886-14"><a href="#cb886-14"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb886-15"><a href="#cb886-15"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb886-16"><a href="#cb886-16"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb886-17"><a href="#cb886-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;90-day Window&quot;</span>,</span>
<span id="cb886-18"><a href="#cb886-18"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability of Amenorrhea&quot;</span>,</span>
<span id="cb886-19"><a href="#cb886-19"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Dosage:&quot;</span>) <span class="op">+</span></span>
<span id="cb886-20"><a href="#cb886-20"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb886-21"><a href="#cb886-21"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;First&quot;</span>,</span>
<span id="cb886-22"><a href="#cb886-22"></a>                                <span class="st">&quot;Second&quot;</span>,</span>
<span id="cb886-23"><a href="#cb886-23"></a>                                <span class="st">&quot;Third&quot;</span>,</span>
<span id="cb886-24"><a href="#cb886-24"></a>                                <span class="st">&quot;Fourth&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-673-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="glmm---optimizers" class="section level2" number="18.5">
<h2 number="18.5"><span class="header-section-number">18.5</span> GLMM - Optimizers</h2>
<p>From the documentation:</p>
<p>The <code>lme4::glmer()</code> function fits a generalized linear mixed model, which incorporates both fixed-effects parameters and random effects in a linear predictor, <strong>via maximum likelihood</strong>. The linear predictor is related to the conditional mean of the response through the inverse link function defined in the GLM family.</p>
<p>The expression for the likelihood of a mixed-effects model is an integral over the random effects space. For a linear mixed-effects model (LMM), as fit by lmer, this integral can be evaluated exactly. For a GLMM the <strong>integral must be approximated</strong>. The most reliable approximation for GLMMs is adaptive <strong>Gauss-Hermite quadrature</strong>, at present implemented only for models with a single scalar random effect. The <code>nAGQ</code> argument controls the number of nodes in the quadrature formula. A model with a single, scalar random-effects term could reasonably use up to 25 quadrature points per scalar integral.</p>
<p>The <code>lme4::lmerControl()</code> function includes an argument for the <code>optimizer</code>, which is the name of a optimizing function(s). IT is a character vector or list of functions: length 1 for lmer or glmer, possibly length 2 for glmer). The built-in optimizers are <strong>Nelder_Mead</strong> and <strong>bobyqa</strong> (from the minqa package). Other minimizing functions are allows (constraints do apply).</p>
<p>Special provisions are made for <strong>bobyqa</strong>, <strong>Nelder_Mead</strong>, and optimizers wrapped in the <code>optimx</code> package; to use the optimx optimizers (including <strong>L-BFGS-B</strong> from base <code>optim</code> and <code>nlminb</code>), pass the method argument to <code>optim</code> in the <code>optCtrl</code> argument (you may also need to load the <code>optimx</code> package manually using <code>library(optimx)</code>.</p>
<div id="adaptive-gauss-hermite-quadrature-increase-the-number-of-quadrature-points" class="section level3" number="18.5.1">
<h3 number="18.5.1"><span class="header-section-number">18.5.1</span> Adaptive Gauss-Hermite Quadrature: Increase the number of quadrature points</h3>
<blockquote>
<p><code>nAGQ</code> (integer scalar) the number of points per axis for evaluating the adaptive Gauss-Hermite approximation to the log-likelihood. Defaults to 1, corresponding to the Laplace approximation. Values greater than 1 produce greater accuracy in the evaluation of the log-likelihood at the expense of speed. A value of zero uses a faster but less exact form of parameter estimation for GLMMs by optimizing the random effects and the fixed-effects coefficients in the penalized iteratively reweighted least squares step. (See Details.)</p>
</blockquote>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="#cb887-1"></a>fit_3a &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(amenorrhea <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>time<span class="op">:</span>dose <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>)<span class="op">:</span>dose <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb887-2"><a href="#cb887-2"></a>                     <span class="dt">data =</span> data_long,</span>
<span id="cb887-3"><a href="#cb887-3"></a>                     <span class="dt">nAGQ =</span> <span class="dv">50</span>,             <span class="co"># increase the number of points</span></span>
<span id="cb887-4"><a href="#cb887-4"></a>                     <span class="dt">family =</span> binomial)</span></code></pre></div>
</div>
<div id="laplace-approximation-switch-to-the-nelder_mead-optimizer" class="section level3" number="18.5.2">
<h3 number="18.5.2"><span class="header-section-number">18.5.2</span> Laplace Approximation: switch to the Nelder_Mead optimizer</h3>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="#cb888-1"></a>fit_3b &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(amenorrhea <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>time<span class="op">:</span>dose <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>)<span class="op">:</span>dose <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb888-2"><a href="#cb888-2"></a>                     <span class="dt">data =</span> data_long,</span>
<span id="cb888-3"><a href="#cb888-3"></a>                     <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>),</span>
<span id="cb888-4"><a href="#cb888-4"></a>                     <span class="dt">family =</span> binomial)</span></code></pre></div>
</div>
<div id="laplace-approximation-switch-to-the-l-bfgs-b-method" class="section level3" number="18.5.3">
<h3 number="18.5.3"><span class="header-section-number">18.5.3</span> Laplace Approximation: Switch to the <code>L-BFGS-B</code> method</h3>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="#cb889-1"></a>fit_3c &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(amenorrhea <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>time<span class="op">:</span>dose <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>)<span class="op">:</span>dose <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb889-2"><a href="#cb889-2"></a>                     <span class="dt">data =</span> data_long,</span>
<span id="cb889-3"><a href="#cb889-3"></a>                     <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">optimizer =</span><span class="st">&#39;optimx&#39;</span>, <span class="dt">optCtrl=</span><span class="kw">list</span>(<span class="dt">method=</span><span class="st">&#39;L-BFGS-B&#39;</span>)),</span>
<span id="cb889-4"><a href="#cb889-4"></a>                     <span class="dt">family =</span> binomial)</span></code></pre></div>
</div>
<div id="laplace-approximation-switch-to-the-nlminb-method" class="section level3" number="18.5.4">
<h3 number="18.5.4"><span class="header-section-number">18.5.4</span> Laplace Approximation: Switch to the <code>nlminb</code> method</h3>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="#cb890-1"></a>fit_3d &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(amenorrhea <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>time<span class="op">:</span>dose <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>)<span class="op">:</span>dose <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb890-2"><a href="#cb890-2"></a>                     <span class="dt">data =</span> data_long,</span>
<span id="cb890-3"><a href="#cb890-3"></a>                     <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">optimizer =</span><span class="st">&#39;optimx&#39;</span>, <span class="dt">optCtrl=</span><span class="kw">list</span>(<span class="dt">method=</span><span class="st">&#39;nlminb&#39;</span>)),</span>
<span id="cb890-4"><a href="#cb890-4"></a>                     <span class="dt">family =</span> binomial)</span></code></pre></div>
</div>
</div>
<div id="quadratic-time" class="section level2" number="18.6">
<h2 number="18.6"><span class="header-section-number">18.6</span> Quadratic Time?</h2>
<p>Assess need for quadratic time with the LRT</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="#cb891-1"></a><span class="kw">anova</span>(fit_<span class="dv">2</span>, fit_3d)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_2: amenorrhea ~ time + dose + (1 | id)
fit_3d: amenorrhea ~ time + I(time^2) + time:dose + I(time^2):dose + 
fit_3d:     (1 | id)
       npar  AIC  BIC logLik deviance Chisq Df Pr(&gt;Chisq)   
fit_2     4 3931 3956  -1961     3923                       
fit_3d    6 3925 3962  -1957     3913  9.72  2     0.0078 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="#cb893-1"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_3a, fit_3b, fit_3c, fit_3d),</span>
<span id="cb893-2"><a href="#cb893-2"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;nAGQ&quot;</span>, <span class="st">&quot;Nelder_Mead&quot;</span>,</span>
<span id="cb893-3"><a href="#cb893-3"></a>                                       <span class="st">&quot;L BFGS B&quot;</span>, <span class="st">&quot;nlminb&quot;</span>),</span>
<span id="cb893-4"><a href="#cb893-4"></a>                <span class="dt">caption =</span> <span class="st">&quot;GLMM: Various methods of ML approximation&quot;</span>,</span>
<span id="cb893-5"><a href="#cb893-5"></a>                <span class="dt">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
GLMM: Various methods of ML approximation
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
nAGQ
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Nelder_Mead
</th>
<th style="padding-left: 5px;padding-right: 5px;">
L BFGS B
</th>
<th style="padding-left: 5px;padding-right: 5px;">
nlminb
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.4829<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.4604<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.4601<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.4604<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1416)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1397)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1397)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1397)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.7714<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.7561<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.7558<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.7561<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2026)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1985)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1985)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1985)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0346
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0340
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0341
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0340
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0667)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0655)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0655)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0655)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time:doseHigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.8920<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.8861<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.8860<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.8861<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2574)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2513)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2513)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2513)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time^2:doseHigh
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.2599<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.2579<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.2579<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.2579<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0895)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0879)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0879)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0879)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3879.4906
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3925.1127
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3925.1128
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3925.1127
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3916.6493
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3962.2715
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3962.2715
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3962.2715
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1933.7453
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1956.5564
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1956.5564
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1956.5564
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3616
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1151
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.0794
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.3478
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.3494
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.3479
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup><em><strong></sup>p &lt; 0.001; <sup></strong></sup>p &lt; 0.01; <sup></em></sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="#cb894-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;dose&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb894-2"><a href="#cb894-2"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">time =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">.1</span>)),</span>
<span id="cb894-3"><a href="#cb894-3"></a>                <span class="dt">mod =</span> fit_3d) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb894-4"><a href="#cb894-4"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb894-5"><a href="#cb894-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time,</span>
<span id="cb894-6"><a href="#cb894-6"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb894-7"><a href="#cb894-7"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),       </span>
<span id="cb894-8"><a href="#cb894-8"></a>             <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb894-9"><a href="#cb894-9"></a>             <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb894-10"><a href="#cb894-10"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> dose),</span>
<span id="cb894-11"><a href="#cb894-11"></a>            <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb894-12"><a href="#cb894-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb894-13"><a href="#cb894-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb894-14"><a href="#cb894-14"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb894-15"><a href="#cb894-15"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb894-16"><a href="#cb894-16"></a>        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb894-17"><a href="#cb894-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;90-day Window&quot;</span>,</span>
<span id="cb894-18"><a href="#cb894-18"></a>       <span class="dt">y =</span> <span class="st">&quot;Predicted Probability of Amenorrhea&quot;</span>,</span>
<span id="cb894-19"><a href="#cb894-19"></a>       <span class="dt">linetype =</span> <span class="st">&quot;Dosage:&quot;</span>) <span class="op">+</span></span>
<span id="cb894-20"><a href="#cb894-20"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb894-21"><a href="#cb894-21"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;First&quot;</span>,</span>
<span id="cb894-22"><a href="#cb894-22"></a>                                <span class="st">&quot;Second&quot;</span>,</span>
<span id="cb894-23"><a href="#cb894-23"></a>                                <span class="st">&quot;Third&quot;</span>,</span>
<span id="cb894-24"><a href="#cb894-24"></a>                                <span class="st">&quot;Fourth&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-681-1.png" width="576" style="display: block; margin: auto;" /></p>
<!--chapter:end:70_example_glmm_contraception.Rmd-->
</div>
</div>
<div id="glmm-binary-outcome-muscatine-obesity" class="section level1" number="19">
<h1 number="19"><span class="header-section-number">19</span> GLMM, Binary Outcome: Muscatine Obesity</h1>
<div id="packages-4" class="section level2" number="19.1">
<h2 number="19.1"><span class="header-section-number">19.1</span> Packages</h2>
<div id="cran-4" class="section level3" number="19.1.1">
<h3 number="19.1.1"><span class="header-section-number">19.1.1</span> CRAN</h3>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="#cb895-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb895-2"><a href="#cb895-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb895-3"><a href="#cb895-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb895-4"><a href="#cb895-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb895-5"><a href="#cb895-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb895-6"><a href="#cb895-6"></a></span>
<span id="cb895-7"><a href="#cb895-7"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb895-8"><a href="#cb895-8"></a><span class="kw">library</span>(gee)          <span class="co"># Generalized Estimating Equations</span></span>
<span id="cb895-9"><a href="#cb895-9"></a><span class="kw">library</span>(effects)      <span class="co"># Plotting estimated marginal means</span></span>
<span id="cb895-10"><a href="#cb895-10"></a></span>
<span id="cb895-11"><a href="#cb895-11"></a><span class="kw">library</span>(gridExtra)    <span class="co"># combining graphics</span></span></code></pre></div>
</div>
<div id="github-4" class="section level3" number="19.1.2">
<h3 number="19.1.2"><span class="header-section-number">19.1.2</span> GitHub</h3>
<p>Helper <code>extract</code> functions for exponentiating parameters form generalized regression models within a <code>texreg</code> table of model parameters.</p>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="#cb896-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb896-2"><a href="#cb896-2"></a><span class="co"># library(devtools)</span></span>
<span id="cb896-3"><a href="#cb896-3"></a><span class="co"># install_github(&quot;SarBearSchwartz/texreghelpr&quot;)</span></span>
<span id="cb896-4"><a href="#cb896-4"></a></span>
<span id="cb896-5"><a href="#cb896-5"></a><span class="kw">library</span>(texreghelpr)</span></code></pre></div>
</div>
</div>
<div id="data-prep-1" class="section level2" number="19.2">
<h2 number="19.2"><span class="header-section-number">19.2</span> Data Prep</h2>
<blockquote>
<p>Data on Obesity from the Muscatine Coronary Risk Factor Study.</p>
</blockquote>
<p><strong>Source:</strong></p>
<p>Table 10 (page 96) in Woolson and Clarke (1984).
With permission of Blackwell Publishing.</p>
<p><strong>Reference:</strong></p>
<p>Woolson, R.F. and Clarke, W.R. (1984). Analysis of categorical incompletel longitudinal data. Journal of the Royal Statistical Society, Series A, 147, 87-99.</p>
<p><strong>Description:</strong></p>
<p>The <strong>Muscatine Coronary Risk Factor Study (MCRFS)</strong> was a longitudinal study of coronary risk factors in school children in Muscatine, Iowa <em>(Woolson and Clarke 1984; Ekholm and Skinner 1998)</em>. Five cohorts of children were measured for <code>height</code> and <code>weight</code> in <strong>1977</strong>, <strong>1979</strong>, and <strong>1981</strong>. <code>Relative weight</code> was calculated as the <strong>ratio</strong> of a child’s observed weight to the median weight for their age-sex-height group. Children with a relative weight greater than 110% of the median weight for their respective stratum were classified as <code>obese</code>. The analysis of this study involves binary data <em>(1 = obese, 0 = not obese)</em> collected at successive time points.</p>
<p>This data was also using in an article title <em>“Missing data methods in longitudinal studies: a review”</em> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3016756/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3016756/</a>).</p>
<p><strong>Variable List:</strong></p>
<ul>
<li><p>Indicators</p>
<ul>
<li><code>id</code> Child’s unique identification number</li>
<li><code>occas</code> Occasion number: 1, 2, 3</li>
</ul></li>
<li><p>Outcome or dependent variable</p>
<ul>
<li><code>obesity</code> Obesity Status, 0 = no, 1 = yes</li>
</ul></li>
<li><p>Main predictor or independent variable of interest</p>
<ul>
<li><code>gender</code> 0 = Male, 1 = Female</li>
<li><code>baseage</code> Baseline Age, mid-point of age-cohort</li>
<li><code>currage</code> Current Age, mid-point of age-cohort</li>
</ul></li>
</ul>
<div id="import-2" class="section level3" number="19.2.1">
<h3 number="19.2.1"><span class="header-section-number">19.2.1</span> Import</h3>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="#cb897-1"></a>data_raw &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/CEHS-research/data/master/MLM/Muscatine.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</span>
<span id="cb897-2"><a href="#cb897-2"></a></span>
<span id="cb897-3"><a href="#cb897-3"></a><span class="kw">str</span>(data_raw)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   14568 obs. of  6 variables:
 $ id     : int  1 1 1 2 2 2 3 3 3 4 ...
 $ gender : int  0 0 0 0 0 0 0 0 0 0 ...
 $ baseage: int  6 6 6 6 6 6 6 6 6 6 ...
 $ currage: int  6 8 10 6 8 10 6 8 10 6 ...
 $ occas  : int  1 2 3 1 2 3 1 2 3 1 ...
 $ obesity: chr  &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; ...</code></pre>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="#cb899-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_raw, <span class="dt">top =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>        id gender baseage currage occas obesity
1        1      0       6       6     1       1
2        1      0       6       8     2       1
3        1      0       6      10     3       1
4        2      0       6       6     1       1
5        2      0       6       8     2       1
6        2      0       6      10     3       1
7        3      0       6       6     1       1
8        3      0       6       8     2       1
9        3      0       6      10     3       1
10       4      0       6       6     1       1
...    ...    ...     ...     ...   ...    &lt;NA&gt;
14565 4855      1      14      18     3       0
14566 4856      1      14      14     1       .
14567 4856      1      14      16     2       .
14568 4856      1      14      18     3       0</code></pre>
</div>
<div id="restrict-to-350ids-of-children-with-complete-data-for-class-demonstration" class="section level3" number="19.2.2">
<h3 number="19.2.2"><span class="header-section-number">19.2.2</span> Restrict to 350ID’s of children with complete data for Class Demonstration</h3>
<p>Dealing with missing-ness and its implications are beyond the score of this class. Instead we are going to restrict our class analysis to a subset of 350 children who have complete data</p>
<blockquote>
<p>I am using the <code>set.seed()</code> function so that I can replicate the restults later.</p>
</blockquote>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="#cb901-1"></a>complete_ids &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb901-2"><a href="#cb901-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(obesity <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb901-3"><a href="#cb901-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb901-4"><a href="#cb901-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb901-5"><a href="#cb901-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(n <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb901-6"><a href="#cb901-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">pull</span>(id)</span>
<span id="cb901-7"><a href="#cb901-7"></a></span>
<span id="cb901-8"><a href="#cb901-8"></a><span class="kw">set.seed</span>(<span class="dv">8892</span>)</span>
<span id="cb901-9"><a href="#cb901-9"></a></span>
<span id="cb901-10"><a href="#cb901-10"></a>use_ids &lt;-<span class="st"> </span>complete_ids <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample</span>(<span class="dv">350</span>)</span>
<span id="cb901-11"><a href="#cb901-11"></a></span>
<span id="cb901-12"><a href="#cb901-12"></a><span class="kw">head</span>(use_ids)</span></code></pre></div>
<pre><code>[1] 3574  805 3458 3537  679  655</code></pre>
</div>
<div id="long-format-6" class="section level3" number="19.2.3">
<h3 number="19.2.3"><span class="header-section-number">19.2.3</span> Long Format</h3>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="#cb903-1"></a>data_long &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb903-2"><a href="#cb903-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(id <span class="op">%in%</span><span class="st"> </span>use_ids) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb903-3"><a href="#cb903-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id       =</span> id     <span class="op">%&gt;%</span><span class="st"> </span>factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb903-4"><a href="#cb903-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gender   =</span> gender <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, </span>
<span id="cb903-5"><a href="#cb903-5"></a>                                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb903-6"><a href="#cb903-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_base =</span> baseage <span class="op">%&gt;%</span><span class="st"> </span>factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb903-7"><a href="#cb903-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_curr =</span> currage <span class="op">%&gt;%</span><span class="st"> </span>factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb903-8"><a href="#cb903-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">occation =</span> occas   <span class="op">%&gt;%</span><span class="st"> </span>factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb903-9"><a href="#cb903-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">obesity  =</span> obesity <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, </span>
<span id="cb903-10"><a href="#cb903-10"></a>                                       <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb903-11"><a href="#cb903-11"></a><span class="st">  </span><span class="kw">select</span>(id, gender, age_base, age_curr, occation, obesity)</span>
<span id="cb903-12"><a href="#cb903-12"></a></span>
<span id="cb903-13"><a href="#cb903-13"></a><span class="kw">str</span>(data_long)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   1050 obs. of  6 variables:
 $ id      : Factor w/ 350 levels &quot;1&quot;,&quot;5&quot;,&quot;10&quot;,&quot;16&quot;,..: 1 1 1 2 2 2 3 3 3 4 ...
 $ gender  : Factor w/ 2 levels &quot;Male&quot;,&quot;Female&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ age_base: Factor w/ 5 levels &quot;6&quot;,&quot;8&quot;,&quot;10&quot;,&quot;12&quot;,..: 1 1 1 1 1 1 2 2 2 2 ...
 $ age_curr: Factor w/ 7 levels &quot;6&quot;,&quot;8&quot;,&quot;10&quot;,&quot;12&quot;,..: 1 2 3 1 2 3 2 3 4 2 ...
 $ occation: Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 1 2 3 1 2 3 1 2 3 1 ...
 $ obesity : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="#cb905-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_long, <span class="dt">top =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>       id gender age_base age_curr occation obesity
1       1   Male        6        6        1     Yes
2       1   Male        6        8        2     Yes
3       1   Male        6       10        3     Yes
4       5   Male        6        6        1     Yes
5       5   Male        6        8        2     Yes
6       5   Male        6       10        3     Yes
7      10   Male        8        8        1     Yes
8      10   Male        8       10        2     Yes
9      10   Male        8       12        3     Yes
10     16   Male        8        8        1     Yes
...  &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt;
1047 3582 Female       14       18        3      No
1048 3584 Female       14       14        1      No
1049 3584 Female       14       16        2      No
1050 3584 Female       14       18        3      No</code></pre>
</div>
<div id="wide-format-6" class="section level3" number="19.2.4">
<h3 number="19.2.4"><span class="header-section-number">19.2.4</span> Wide Format</h3>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="#cb907-1"></a>data_wide &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb907-2"><a href="#cb907-2"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> var,</span>
<span id="cb907-3"><a href="#cb907-3"></a>         <span class="dt">value =</span> val,</span>
<span id="cb907-4"><a href="#cb907-4"></a>         age_curr, obesity) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb907-5"><a href="#cb907-5"></a><span class="st">  </span><span class="kw">unite</span>(<span class="dt">col =</span> var_occ,</span>
<span id="cb907-6"><a href="#cb907-6"></a>        var, occation) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb907-7"><a href="#cb907-7"></a><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> var_occ,</span>
<span id="cb907-8"><a href="#cb907-8"></a>         <span class="dt">value =</span> val) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb907-9"><a href="#cb907-9"></a><span class="st">  </span><span class="kw">mutate_if</span>(is.character, factor)<span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb907-10"><a href="#cb907-10"></a><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb907-11"><a href="#cb907-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_miss =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(<span class="kw">c</span>(obesity_<span class="dv">1</span>, obesity_<span class="dv">2</span>, obesity_<span class="dv">3</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb907-12"><a href="#cb907-12"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb907-13"><a href="#cb907-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_miss =</span> <span class="kw">as.factor</span>(num_miss)) </span>
<span id="cb907-14"><a href="#cb907-14"></a></span>
<span id="cb907-15"><a href="#cb907-15"></a></span>
<span id="cb907-16"><a href="#cb907-16"></a><span class="kw">str</span>(data_wide)</span></code></pre></div>
<pre><code>tibble [350 x 10] (S3: tbl_df/tbl/data.frame)
 $ id        : Factor w/ 350 levels &quot;1&quot;,&quot;5&quot;,&quot;10&quot;,&quot;16&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
 $ gender    : Factor w/ 2 levels &quot;Male&quot;,&quot;Female&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ age_base  : Factor w/ 5 levels &quot;6&quot;,&quot;8&quot;,&quot;10&quot;,&quot;12&quot;,..: 1 1 2 2 2 3 3 3 4 4 ...
 $ age_curr_1: Factor w/ 5 levels &quot;10&quot;,&quot;12&quot;,&quot;14&quot;,..: 4 4 5 5 5 1 1 1 2 2 ...
 $ age_curr_2: Factor w/ 5 levels &quot;10&quot;,&quot;12&quot;,&quot;14&quot;,..: 5 5 1 1 1 2 2 2 3 3 ...
 $ age_curr_3: Factor w/ 5 levels &quot;10&quot;,&quot;12&quot;,&quot;14&quot;,..: 1 1 2 2 2 3 3 3 4 4 ...
 $ obesity_1 : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 2 2 2 2 2 2 2 2 2 ...
 $ obesity_2 : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 2 2 2 2 2 2 2 2 2 ...
 $ obesity_3 : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 2 2 2 2 2 2 2 2 2 ...
 $ num_miss  : Factor w/ 1 level &quot;0&quot;: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="#cb909-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_wide, <span class="dt">top =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>     id gender age_base age_curr_1 age_curr_2 age_curr_3 obesity_1 obesity_2
1     1   Male        6          6          8         10       Yes       Yes
2     5   Male        6          6          8         10       Yes       Yes
3    10   Male        8          8         10         12       Yes       Yes
4    16   Male        8          8         10         12       Yes       Yes
5    21   Male        8          8         10         12       Yes       Yes
6    30   Male       10         10         12         14       Yes       Yes
7    44   Male       10         10         12         14       Yes       Yes
8    50   Male       10         10         12         14       Yes       Yes
9    60   Male       12         12         14         16       Yes       Yes
10   61   Male       12         12         14         16       Yes       Yes
11 &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;
12 3580 Female       14         14         16         18        No        No
13 3581 Female       14         14         16         18        No        No
14 3582 Female       14         14         16         18        No        No
15 3584 Female       14         14         16         18        No        No
   obesity_3 num_miss
1        Yes        0
2        Yes        0
3        Yes        0
4        Yes        0
5        Yes        0
6        Yes        0
7        Yes        0
8        Yes        0
9        Yes        0
10       Yes        0
11      &lt;NA&gt;     &lt;NA&gt;
12        No        0
13        No        0
14        No        0
15        No        0</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-10" class="section level2" number="19.3">
<h2 number="19.3"><span class="header-section-number">19.3</span> Exploratory Data Analysis</h2>
<div id="summary-statistics-3" class="section level3" number="19.3.1">
<h3 number="19.3.1"><span class="header-section-number">19.3.1</span> Summary Statistics</h3>
<div id="demographics-and-baseline-1" class="section level4" number="19.3.1.1">
<h4 number="19.3.1.1"><span class="header-section-number">19.3.1.1</span> Demographics and Baseline</h4>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="#cb911-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb911-2"><a href="#cb911-2"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(age_base, obesity_<span class="dv">1</span>,</span>
<span id="cb911-3"><a href="#cb911-3"></a>                    <span class="dt">splitby =</span> <span class="op">~</span><span class="st"> </span>gender,</span>
<span id="cb911-4"><a href="#cb911-4"></a>                    <span class="dt">test    =</span> <span class="ot">TRUE</span>,</span>
<span id="cb911-5"><a href="#cb911-5"></a>                    <span class="dt">na.rm   =</span> <span class="ot">FALSE</span>,</span>
<span id="cb911-6"><a href="#cb911-6"></a>                    <span class="dt">output  =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
Male
</th>
<th>
Female
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 166
</td>
<td>
n = 184
</td>
<td>
</td>
</tr>
<tr>
<td>
age_base
</td>
<td>
</td>
<td>
</td>
<td>
0.759
</td>
</tr>
<tr>
<td>
6
</td>
<td>
17 (10.2%)
</td>
<td>
25 (13.6%)
</td>
<td>
</td>
</tr>
<tr>
<td>
8
</td>
<td>
47 (28.3%)
</td>
<td>
44 (23.9%)
</td>
<td>
</td>
</tr>
<tr>
<td>
10
</td>
<td>
41 (24.7%)
</td>
<td>
51 (27.7%)
</td>
<td>
</td>
</tr>
<tr>
<td>
12
</td>
<td>
33 (19.9%)
</td>
<td>
34 (18.5%)
</td>
<td>
</td>
</tr>
<tr>
<td>
14
</td>
<td>
28 (16.9%)
</td>
<td>
30 (16.3%)
</td>
<td>
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
0 (0%)
</td>
<td>
0 (0%)
</td>
<td>
</td>
</tr>
<tr>
<td>
obesity_1
</td>
<td>
</td>
<td>
</td>
<td>
0.608
</td>
</tr>
<tr>
<td>
No
</td>
<td>
138 (83.1%)
</td>
<td>
148 (80.4%)
</td>
<td>
</td>
</tr>
<tr>
<td>
Yes
</td>
<td>
28 (16.9%)
</td>
<td>
36 (19.6%)
</td>
<td>
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
0 (0%)
</td>
<td>
0 (0%)
</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
<div id="status-over-time-2" class="section level4" number="19.3.1.2">
<h4 number="19.3.1.2"><span class="header-section-number">19.3.1.2</span> Status over Time</h4>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="#cb912-1"></a>data_summary &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb912-2"><a href="#cb912-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(gender, age_curr) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb912-3"><a href="#cb912-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">obesityN =</span> <span class="kw">case_when</span>(obesity <span class="op">==</span><span class="st"> &quot;Yes&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb912-4"><a href="#cb912-4"></a>                                     obesity <span class="op">==</span><span class="st"> &quot;No&quot;</span>  <span class="op">~</span><span class="st"> </span><span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb912-5"><a href="#cb912-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(gender, age_curr, obesityN)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb912-6"><a href="#cb912-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),</span>
<span id="cb912-7"><a href="#cb912-7"></a>                   <span class="dt">prob_est =</span> <span class="kw">mean</span>(obesityN),</span>
<span id="cb912-8"><a href="#cb912-8"></a>                   <span class="dt">prob_SD  =</span> <span class="kw">sd</span>(obesityN),</span>
<span id="cb912-9"><a href="#cb912-9"></a>                   <span class="dt">prob_SE  =</span> prob_SD<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb912-10"><a href="#cb912-10"></a></span>
<span id="cb912-11"><a href="#cb912-11"></a>data_summary</span></code></pre></div>
<pre><code># A tibble: 14 x 6
# Groups:   gender [2]
   gender age_curr     n prob_est prob_SD prob_SE
   &lt;fct&gt;  &lt;fct&gt;    &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 Male   6           17    0.118   0.332  0.0805
 2 Male   8           64    0.172   0.380  0.0475
 3 Male   10         105    0.143   0.352  0.0343
 4 Male   12         121    0.198   0.400  0.0364
 5 Male   14         102    0.225   0.420  0.0416
 6 Male   16          61    0.213   0.413  0.0529
 7 Male   18          28    0.143   0.356  0.0673
 8 Female 6           25    0.16    0.374  0.0748
 9 Female 8           69    0.203   0.405  0.0488
10 Female 10         120    0.275   0.448  0.0409
11 Female 12         129    0.256   0.438  0.0386
12 Female 14         115    0.243   0.431  0.0402
13 Female 16          64    0.281   0.453  0.0566
14 Female 18          30    0.267   0.450  0.0821</code></pre>
</div>
</div>
<div id="visualize-5" class="section level3" number="19.3.2">
<h3 number="19.3.2"><span class="header-section-number">19.3.2</span> Visualize</h3>
<div id="by-cohort-and-gender" class="section level4" number="19.3.2.1">
<h4 number="19.3.2.1"><span class="header-section-number">19.3.2.1</span> By cohort and gender</h4>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="#cb914-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb914-2"><a href="#cb914-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(gender, age_base, age_curr) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb914-3"><a href="#cb914-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">obesityN =</span> <span class="kw">case_when</span>(obesity <span class="op">==</span><span class="st"> &quot;Yes&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb914-4"><a href="#cb914-4"></a>                                     obesity <span class="op">==</span><span class="st"> &quot;No&quot;</span>  <span class="op">~</span><span class="st"> </span><span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb914-5"><a href="#cb914-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(gender, age_curr, obesityN)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb914-6"><a href="#cb914-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),</span>
<span id="cb914-7"><a href="#cb914-7"></a>                   <span class="dt">prob_est =</span> <span class="kw">mean</span>(obesityN),</span>
<span id="cb914-8"><a href="#cb914-8"></a>                   <span class="dt">prob_SD  =</span> <span class="kw">sd</span>(obesityN),</span>
<span id="cb914-9"><a href="#cb914-9"></a>                   <span class="dt">prob_SE  =</span> prob_SD<span class="op">/</span><span class="kw">sqrt</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb914-10"><a href="#cb914-10"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age_curr,</span>
<span id="cb914-11"><a href="#cb914-11"></a>             <span class="dt">y =</span> prob_est,</span>
<span id="cb914-12"><a href="#cb914-12"></a>             <span class="dt">group =</span> age_base,</span>
<span id="cb914-13"><a href="#cb914-13"></a>             <span class="dt">color =</span> age_base)) <span class="op">+</span></span>
<span id="cb914-14"><a href="#cb914-14"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb914-15"><a href="#cb914-15"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb914-16"><a href="#cb914-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb914-17"><a href="#cb914-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Child&#39;s Age, years&quot;</span>,</span>
<span id="cb914-18"><a href="#cb914-18"></a>       <span class="dt">y =</span> <span class="st">&quot;Proportion Obese&quot;</span>) <span class="op">+</span></span>
<span id="cb914-19"><a href="#cb914-19"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>gender)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-691-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="by-only-gender" class="section level4" number="19.3.2.2">
<h4 number="19.3.2.2"><span class="header-section-number">19.3.2.2</span> BY only gender</h4>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="#cb915-1"></a>data_summary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb915-2"><a href="#cb915-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age_curr,</span>
<span id="cb915-3"><a href="#cb915-3"></a>             <span class="dt">y =</span> prob_est,</span>
<span id="cb915-4"><a href="#cb915-4"></a>             <span class="dt">group =</span> gender)) <span class="op">+</span></span>
<span id="cb915-5"><a href="#cb915-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> prob_est <span class="op">-</span><span class="st"> </span>prob_SE,</span>
<span id="cb915-6"><a href="#cb915-6"></a>                  <span class="dt">ymax =</span> prob_est <span class="op">+</span><span class="st"> </span>prob_SE,</span>
<span id="cb915-7"><a href="#cb915-7"></a>                  <span class="dt">fill =</span> gender),</span>
<span id="cb915-8"><a href="#cb915-8"></a>              <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb915-9"><a href="#cb915-9"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> gender,</span>
<span id="cb915-10"><a href="#cb915-10"></a>                 <span class="dt">shape =</span> gender)) <span class="op">+</span></span>
<span id="cb915-11"><a href="#cb915-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> gender,</span>
<span id="cb915-12"><a href="#cb915-12"></a>                <span class="dt">color =</span> gender)) <span class="op">+</span></span>
<span id="cb915-13"><a href="#cb915-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb915-14"><a href="#cb915-14"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodger blue&quot;</span>, <span class="st">&quot;hot pink&quot;</span>)) <span class="op">+</span></span>
<span id="cb915-15"><a href="#cb915-15"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodger blue&quot;</span>, <span class="st">&quot;hot pink&quot;</span>)) <span class="op">+</span></span>
<span id="cb915-16"><a href="#cb915-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Child&#39;s Age, years&quot;</span>,</span>
<span id="cb915-17"><a href="#cb915-17"></a>       <span class="dt">y =</span> <span class="st">&quot;Proportion Obese&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-692-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Smooth out the trends</p>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="#cb916-1"></a>data_summary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb916-2"><a href="#cb916-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age_curr,</span>
<span id="cb916-3"><a href="#cb916-3"></a>             <span class="dt">y =</span> prob_est,</span>
<span id="cb916-4"><a href="#cb916-4"></a>             <span class="dt">group =</span> gender,</span>
<span id="cb916-5"><a href="#cb916-5"></a>             <span class="dt">color =</span> gender)) <span class="op">+</span></span>
<span id="cb916-6"><a href="#cb916-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb916-7"><a href="#cb916-7"></a>              <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">2</span>),</span>
<span id="cb916-8"><a href="#cb916-8"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb916-9"><a href="#cb916-9"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb916-10"><a href="#cb916-10"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodger blue&quot;</span>, <span class="st">&quot;hot pink&quot;</span>)) <span class="op">+</span></span>
<span id="cb916-11"><a href="#cb916-11"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodger blue&quot;</span>, <span class="st">&quot;hot pink&quot;</span>)) <span class="op">+</span></span>
<span id="cb916-12"><a href="#cb916-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Child&#39;s Age, years&quot;</span>,</span>
<span id="cb916-13"><a href="#cb916-13"></a>       <span class="dt">y =</span> <span class="st">&quot;Proportion Obese&quot;</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-693-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="analysis-goal" class="section level2" number="19.4">
<h2 number="19.4"><span class="header-section-number">19.4</span> Analysis Goal</h2>
<blockquote>
<p>Does risk of obesity increase with age and are patterns of change similar for both sexes?</p>
</blockquote>
<p>There are 5 age cohorts that were measured each for 3 years, baseage and currage are age midpoints of those cohort groups. Which to include, current age or occasion? <strong>Assume no cohort effects.</strong> <em>If you do think this is an issue, include baseline age (<code>age_base</code>) and current age minus baseline age (<code>time</code>) in model.</em></p>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="#cb917-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb917-2"><a href="#cb917-2"></a><span class="st">  </span><span class="kw">group_by</span>(gender, age_base, occation) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb917-3"><a href="#cb917-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n       =</span> <span class="kw">n</span>(),</span>
<span id="cb917-4"><a href="#cb917-4"></a>            <span class="dt">count   =</span> <span class="kw">sum</span>(obesity <span class="op">==</span><span class="st"> &quot;Yes&quot;</span>),</span>
<span id="cb917-5"><a href="#cb917-5"></a>            <span class="dt">prop    =</span> <span class="kw">mean</span>(obesity <span class="op">==</span><span class="st"> &quot;Yes&quot;</span>),</span>
<span id="cb917-6"><a href="#cb917-6"></a>            <span class="dt">se      =</span> <span class="kw">sd</span>(obesity <span class="op">==</span><span class="st"> &quot;Yes&quot;</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)) <span class="op">%&gt;%</span></span>
<span id="cb917-7"><a href="#cb917-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">time =</span> (occation <span class="op">%&gt;%</span><span class="st"> </span>as.numeric) <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb917-8"><a href="#cb917-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time,</span>
<span id="cb917-9"><a href="#cb917-9"></a>             <span class="dt">y =</span> prop,</span>
<span id="cb917-10"><a href="#cb917-10"></a>             <span class="dt">color =</span> gender,</span>
<span id="cb917-11"><a href="#cb917-11"></a>             <span class="dt">fill =</span> gender))  <span class="op">+</span></span>
<span id="cb917-12"><a href="#cb917-12"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> prop <span class="op">-</span><span class="st"> </span>se,</span>
<span id="cb917-13"><a href="#cb917-13"></a>                  <span class="dt">ymax =</span> prop <span class="op">+</span><span class="st"> </span>se),</span>
<span id="cb917-14"><a href="#cb917-14"></a>              <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb917-15"><a href="#cb917-15"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb917-16"><a href="#cb917-16"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb917-17"><a href="#cb917-17"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb917-18"><a href="#cb917-18"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>age_base, <span class="dt">labeller =</span> label_both) <span class="op">+</span></span>
<span id="cb917-19"><a href="#cb917-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Observed Obesity Rates, by Gender within Cohort&quot;</span>,</span>
<span id="cb917-20"><a href="#cb917-20"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Subset of 350 children with complete data&quot;</span>,</span>
<span id="cb917-21"><a href="#cb917-21"></a>       <span class="dt">x        =</span> <span class="st">&quot;Time, years from 1977&quot;</span>,</span>
<span id="cb917-22"><a href="#cb917-22"></a>       <span class="dt">y        =</span> <span class="st">&quot;Proportion of Children Characterized as Obese&quot;</span>) <span class="op">+</span></span>
<span id="cb917-23"><a href="#cb917-23"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue3&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb917-24"><a href="#cb917-24"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue3&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb917-25"><a href="#cb917-25"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">4</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb917-26"><a href="#cb917-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb917-27"><a href="#cb917-27"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb917-28"><a href="#cb917-28"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-694-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="#cb918-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb918-2"><a href="#cb918-2"></a><span class="st">  </span><span class="kw">group_by</span>(gender, age_curr) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb918-3"><a href="#cb918-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n       =</span> <span class="kw">n</span>(),</span>
<span id="cb918-4"><a href="#cb918-4"></a>            <span class="dt">count   =</span> <span class="kw">sum</span>(obesity <span class="op">==</span><span class="st"> &quot;Yes&quot;</span>),</span>
<span id="cb918-5"><a href="#cb918-5"></a>            <span class="dt">prop    =</span> <span class="kw">mean</span>(obesity <span class="op">==</span><span class="st"> &quot;Yes&quot;</span>),</span>
<span id="cb918-6"><a href="#cb918-6"></a>            <span class="dt">se      =</span> <span class="kw">sd</span>(obesity <span class="op">==</span><span class="st"> &quot;Yes&quot;</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)) <span class="op">%&gt;%</span></span>
<span id="cb918-7"><a href="#cb918-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age_curr <span class="op">%&gt;%</span><span class="st"> </span>as.character <span class="op">%&gt;%</span><span class="st"> </span>as.numeric,</span>
<span id="cb918-8"><a href="#cb918-8"></a>             <span class="dt">y =</span> prop,</span>
<span id="cb918-9"><a href="#cb918-9"></a>             <span class="dt">group =</span> gender,</span>
<span id="cb918-10"><a href="#cb918-10"></a>             <span class="dt">color =</span> gender,</span>
<span id="cb918-11"><a href="#cb918-11"></a>             <span class="dt">fill =</span> gender))  <span class="op">+</span></span>
<span id="cb918-12"><a href="#cb918-12"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> prop <span class="op">-</span><span class="st"> </span>se,</span>
<span id="cb918-13"><a href="#cb918-13"></a>                  <span class="dt">ymax =</span> prop <span class="op">+</span><span class="st"> </span>se),</span>
<span id="cb918-14"><a href="#cb918-14"></a>              <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb918-15"><a href="#cb918-15"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb918-16"><a href="#cb918-16"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb918-17"><a href="#cb918-17"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb918-18"><a href="#cb918-18"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">12</span>, </span>
<span id="cb918-19"><a href="#cb918-19"></a>             <span class="dt">linetype   =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb918-20"><a href="#cb918-20"></a>             <span class="dt">size       =</span> <span class="dv">1</span>, </span>
<span id="cb918-21"><a href="#cb918-21"></a>             <span class="dt">color      =</span> <span class="st">&quot;navyblue&quot;</span>) <span class="op">+</span></span>
<span id="cb918-22"><a href="#cb918-22"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Observed Obesity Rates, by Gender (collapsing cohorts)&quot;</span>,</span>
<span id="cb918-23"><a href="#cb918-23"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Subset of 350 children with complete data&quot;</span>,</span>
<span id="cb918-24"><a href="#cb918-24"></a>       <span class="dt">x        =</span> <span class="st">&quot;Age of Child, years&quot;</span>,</span>
<span id="cb918-25"><a href="#cb918-25"></a>       <span class="dt">y        =</span> <span class="st">&quot;Proportion of Children Characterized as Obese&quot;</span>) <span class="op">+</span></span>
<span id="cb918-26"><a href="#cb918-26"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue3&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb918-27"><a href="#cb918-27"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue3&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb918-28"><a href="#cb918-28"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">6</span>, <span class="dt">to =</span> <span class="dv">18</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb918-29"><a href="#cb918-29"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb918-30"><a href="#cb918-30"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.05</span>),</span>
<span id="cb918-31"><a href="#cb918-31"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-695-1.png" width="576" style="display: block; margin: auto;" /></p>
<div id="center-time-at-twelve-years-old" class="section level3" number="19.4.1">
<h3 number="19.4.1"><span class="header-section-number">19.4.1</span> Center time at twelve years old</h3>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="#cb919-1"></a>data_long &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb919-2"><a href="#cb919-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_center =</span> age_curr <span class="op">%&gt;%</span><span class="st"> </span>as.character <span class="op">%&gt;%</span><span class="st"> </span>as.numeric <span class="dv">-12</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb919-3"><a href="#cb919-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">obesity_num =</span> obesity <span class="op">%&gt;%</span><span class="st"> </span>as.numeric <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb919-4"><a href="#cb919-4"></a></span>
<span id="cb919-5"><a href="#cb919-5"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_long)</span></code></pre></div>
<pre><code>       id gender age_base age_curr occation obesity age_center obesity_num
1       1   Male        6        6        1     Yes         -6           1
2       1   Male        6        8        2     Yes         -4           1
3       1   Male        6       10        3     Yes         -2           1
4       5   Male        6        6        1     Yes         -6           1
...  &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt;        ...         ...
1047 3582 Female       14       18        3      No          6           0
1048 3584 Female       14       14        1      No          2           0
1049 3584 Female       14       16        2      No          4           0
1050 3584 Female       14       18        3      No          6           0</code></pre>
</div>
</div>
<div id="glm-analysis" class="section level2" number="19.5">
<h2 number="19.5"><span class="header-section-number">19.5</span> GLM Analysis</h2>
<div id="standard-logistic-regression" class="section level3" number="19.5.1">
<h3 number="19.5.1"><span class="header-section-number">19.5.1</span> Standard logistic regression</h3>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="#cb921-1"></a>fit_glm_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender<span class="op">*</span>age_center <span class="op">+</span><span class="st"> </span>gender<span class="op">*</span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>), </span>
<span id="cb921-2"><a href="#cb921-2"></a>                 <span class="dt">data   =</span> data_long,</span>
<span id="cb921-3"><a href="#cb921-3"></a>                 <span class="dt">family =</span> binomial)</span>
<span id="cb921-4"><a href="#cb921-4"></a></span>
<span id="cb921-5"><a href="#cb921-5"></a>fit_glm_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age_center <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>), </span>
<span id="cb921-6"><a href="#cb921-6"></a>                 <span class="dt">data   =</span> data_long,</span>
<span id="cb921-7"><a href="#cb921-7"></a>                 <span class="dt">family =</span> binomial)</span></code></pre></div>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="#cb922-1"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(<span class="kw">extract_glm_exp</span>(fit_glm_<span class="dv">1</span>), </span>
<span id="cb922-2"><a href="#cb922-2"></a>                       <span class="kw">extract_glm_exp</span>(fit_glm_<span class="dv">2</span>)),</span>
<span id="cb922-3"><a href="#cb922-3"></a>                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Interaction&quot;</span>,</span>
<span id="cb922-4"><a href="#cb922-4"></a>                                         <span class="st">&quot;Main Effects&quot;</span>),</span>
<span id="cb922-5"><a href="#cb922-5"></a>                  <span class="dt">caption =</span> <span class="st">&quot;GLM: Parameter EStimates&quot;</span>,</span>
<span id="cb922-6"><a href="#cb922-6"></a>                  <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb922-7"><a href="#cb922-7"></a>                  <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>
=========================================================================
                           Interaction             Main Effects          
-------------------------------------------------------------------------
(Intercept)                   0.25 [0.18; 0.33] *     0.24 [0.19; 0.31] *
genderFemale                  1.43 [0.97; 2.12]       1.48 [1.10; 2.00] *
age_center                    1.05 [0.97; 1.14]       1.04 [0.99; 1.10]  
age_center^2                  0.99 [0.96; 1.01]       0.99 [0.98; 1.01]  
genderFemale:age_center       0.99 [0.89; 1.09]                          
genderFemale:age_center^2     1.00 [0.97; 1.04]                          
-------------------------------------------------------------------------
AIC                        1105.85                 1101.98               
BIC                        1135.59                 1121.80               
Log Likelihood             -546.93                 -546.99               
Deviance                   1093.85                 1093.98               
Num. obs.                  1050                    1050                  
=========================================================================
* Null hypothesis value outside the confidence interval.</code></pre>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="#cb924-1"></a>plot_pred_glm &lt;-<span class="st"> </span><span class="kw">Effect</span>(<span class="kw">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;age_center&quot;</span>), </span>
<span id="cb924-2"><a href="#cb924-2"></a>       fit_glm_<span class="dv">2</span>,</span>
<span id="cb924-3"><a href="#cb924-3"></a>       <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age_center =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-6</span>, <span class="dt">to =</span> <span class="dv">6</span>, <span class="dt">by =</span> <span class="fl">0.25</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb924-4"><a href="#cb924-4"></a><span class="st">   </span>data.frame <span class="op">%&gt;%</span></span>
<span id="cb924-5"><a href="#cb924-5"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">age =</span> age_center <span class="op">+</span><span class="st"> </span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb924-6"><a href="#cb924-6"></a><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x        =</span> age,</span>
<span id="cb924-7"><a href="#cb924-7"></a>              <span class="dt">y        =</span> fit,</span>
<span id="cb924-8"><a href="#cb924-8"></a>              <span class="dt">group    =</span> gender,</span>
<span id="cb924-9"><a href="#cb924-9"></a>              <span class="dt">linetype =</span> gender,</span>
<span id="cb924-10"><a href="#cb924-10"></a>              <span class="dt">fill     =</span> gender,</span>
<span id="cb924-11"><a href="#cb924-11"></a>              <span class="dt">color    =</span> gender)) <span class="op">+</span></span>
<span id="cb924-12"><a href="#cb924-12"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> fit <span class="op">-</span><span class="st"> </span>se,</span>
<span id="cb924-13"><a href="#cb924-13"></a>                  <span class="dt">ymax =</span> fit <span class="op">+</span><span class="st"> </span>se),</span>
<span id="cb924-14"><a href="#cb924-14"></a>              <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb924-15"><a href="#cb924-15"></a><span class="st">   </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb924-16"><a href="#cb924-16"></a><span class="st">   </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb924-17"><a href="#cb924-17"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Generalized Linear Model: Model #2&quot;</span>,</span>
<span id="cb924-18"><a href="#cb924-18"></a>        <span class="dt">subtitle =</span> <span class="st">&quot;Predicted Probability of Obesity&quot;</span>,</span>
<span id="cb924-19"><a href="#cb924-19"></a>        <span class="dt">x        =</span> <span class="st">&quot;Child&#39;s Age, years&quot;</span>,</span>
<span id="cb924-20"><a href="#cb924-20"></a>        <span class="dt">y        =</span> <span class="st">&quot;Probability&quot;</span>,</span>
<span id="cb924-21"><a href="#cb924-21"></a>        <span class="dt">linetype =</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb924-22"><a href="#cb924-22"></a>        <span class="dt">fill     =</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb924-23"><a href="#cb924-23"></a>        <span class="dt">color    =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span></span>
<span id="cb924-24"><a href="#cb924-24"></a><span class="st">   </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb924-25"><a href="#cb924-25"></a>         <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.05</span>),</span>
<span id="cb924-26"><a href="#cb924-26"></a>         <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb924-27"><a href="#cb924-27"></a>         <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb924-28"><a href="#cb924-28"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">6</span>, <span class="dt">to =</span> <span class="dv">18</span>, <span class="dt">by =</span> <span class="dv">2</span>))</span>
<span id="cb924-29"><a href="#cb924-29"></a></span>
<span id="cb924-30"><a href="#cb924-30"></a>plot_pred_glm </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-699-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="gee-analysis" class="section level2" number="19.6">
<h2 number="19.6"><span class="header-section-number">19.6</span> GEE Analysis</h2>
<blockquote>
<p>ALWAYS: fix the scale parameter to 1 with binomial data!!!</p>
</blockquote>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="#cb925-1"></a>fit_gee_1in &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender<span class="op">*</span>age_center <span class="op">+</span><span class="st"> </span>gender<span class="op">*</span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>), </span>
<span id="cb925-2"><a href="#cb925-2"></a>                        <span class="dt">id          =</span> id, </span>
<span id="cb925-3"><a href="#cb925-3"></a>                        <span class="dt">data        =</span> data_long,</span>
<span id="cb925-4"><a href="#cb925-4"></a>                        <span class="dt">family      =</span> binomial,</span>
<span id="cb925-5"><a href="#cb925-5"></a>                        <span class="dt">corstr      =</span> <span class="st">&#39;independence&#39;</span>, </span>
<span id="cb925-6"><a href="#cb925-6"></a>                        <span class="dt">scale.fix   =</span> <span class="ot">TRUE</span>,</span>
<span id="cb925-7"><a href="#cb925-7"></a>                        <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>                 (Intercept)                 genderFemale 
                    -1.39847                      0.36111 
                  age_center              I(age_center^2) 
                     0.04864                     -0.01123 
     genderFemale:age_center genderFemale:I(age_center^2) 
                    -0.01440                      0.00409 </code></pre>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="#cb927-1"></a>fit_gee_1ex &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender<span class="op">*</span>age_center <span class="op">+</span><span class="st"> </span>gender<span class="op">*</span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>), </span>
<span id="cb927-2"><a href="#cb927-2"></a>                        <span class="dt">id          =</span> id, </span>
<span id="cb927-3"><a href="#cb927-3"></a>                        <span class="dt">data        =</span> data_long,</span>
<span id="cb927-4"><a href="#cb927-4"></a>                        <span class="dt">family      =</span> binomial,</span>
<span id="cb927-5"><a href="#cb927-5"></a>                        <span class="dt">corstr      =</span> <span class="st">&#39;exchangeable&#39;</span>, </span>
<span id="cb927-6"><a href="#cb927-6"></a>                        <span class="dt">scale.fix   =</span> <span class="ot">TRUE</span>,</span>
<span id="cb927-7"><a href="#cb927-7"></a>                        <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>                 (Intercept)                 genderFemale 
                    -1.39847                      0.36111 
                  age_center              I(age_center^2) 
                     0.04864                     -0.01123 
     genderFemale:age_center genderFemale:I(age_center^2) 
                    -0.01440                      0.00409 </code></pre>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="#cb929-1"></a>fit_gee_1un &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender<span class="op">*</span>age_center <span class="op">+</span><span class="st"> </span>gender<span class="op">*</span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>), </span>
<span id="cb929-2"><a href="#cb929-2"></a>                        <span class="dt">id          =</span> id, </span>
<span id="cb929-3"><a href="#cb929-3"></a>                        <span class="dt">data        =</span> data_long,</span>
<span id="cb929-4"><a href="#cb929-4"></a>                        <span class="dt">family      =</span> binomial,</span>
<span id="cb929-5"><a href="#cb929-5"></a>                        <span class="dt">corstr      =</span> <span class="st">&#39;unstructured&#39;</span>, </span>
<span id="cb929-6"><a href="#cb929-6"></a>                        <span class="dt">scale.fix   =</span> <span class="ot">TRUE</span>,</span>
<span id="cb929-7"><a href="#cb929-7"></a>                        <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>                 (Intercept)                 genderFemale 
                    -1.39847                      0.36111 
                  age_center              I(age_center^2) 
                     0.04864                     -0.01123 
     genderFemale:age_center genderFemale:I(age_center^2) 
                    -0.01440                      0.00409 </code></pre>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="#cb931-1"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(<span class="kw">extract_gee_exp</span>(fit_gee_1in), </span>
<span id="cb931-2"><a href="#cb931-2"></a>                       <span class="kw">extract_gee_exp</span>(fit_gee_1ex),</span>
<span id="cb931-3"><a href="#cb931-3"></a>                       <span class="kw">extract_gee_exp</span>(fit_gee_1un)),</span>
<span id="cb931-4"><a href="#cb931-4"></a>                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Independent&quot;</span>,</span>
<span id="cb931-5"><a href="#cb931-5"></a>                                         <span class="st">&quot;Exchangable&quot;</span>,</span>
<span id="cb931-6"><a href="#cb931-6"></a>                                         <span class="st">&quot;Unstructured&quot;</span>),</span>
<span id="cb931-7"><a href="#cb931-7"></a>                  <span class="dt">caption =</span> <span class="st">&quot;Gee Model Parameters: With Interactions&quot;</span>,</span>
<span id="cb931-8"><a href="#cb931-8"></a>                  <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb931-9"><a href="#cb931-9"></a>                  <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>
=================================================================================================
                           Independent             Exchangable             Unstructured          
-------------------------------------------------------------------------------------------------
(Intercept)                   0.25 [0.17; 0.35] *     0.24 [0.17; 0.35] *     0.25 [0.17; 0.35] *
genderFemale                  1.43 [0.87; 2.35]       1.40 [0.87; 2.24]       1.39 [0.86; 2.23]  
age_center                    1.05 [0.94; 1.17]       1.07 [0.97; 1.17]       1.06 [0.97; 1.16]  
age_center^2                  0.99 [0.96; 1.01]       0.99 [0.97; 1.01]       0.99 [0.97; 1.01]  
genderFemale:age_center       0.99 [0.86; 1.13]       1.02 [0.91; 1.14]       1.02 [0.91; 1.14]  
genderFemale:age_center^2     1.00 [0.97; 1.04]       1.01 [0.98; 1.03]       1.01 [0.98; 1.03]  
-------------------------------------------------------------------------------------------------
Dispersion                    1.00                    1.00                    1.00               
Num. obs.                  1050                    1050                    1050                  
=================================================================================================
* Null hypothesis value outside the confidence interval.</code></pre>
<div id="drop-the-interaction-with-gender." class="section level3" number="19.6.1">
<h3 number="19.6.1"><span class="header-section-number">19.6.1</span> Drop the interaction with <code>gender</code>.</h3>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="#cb933-1"></a>fit_gee_2in &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age_center <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>), </span>
<span id="cb933-2"><a href="#cb933-2"></a>                        <span class="dt">id          =</span> id, </span>
<span id="cb933-3"><a href="#cb933-3"></a>                        <span class="dt">data        =</span> data_long,</span>
<span id="cb933-4"><a href="#cb933-4"></a>                        <span class="dt">family      =</span> binomial,</span>
<span id="cb933-5"><a href="#cb933-5"></a>                        <span class="dt">corstr      =</span> <span class="st">&#39;independence&#39;</span>, </span>
<span id="cb933-6"><a href="#cb933-6"></a>                        <span class="dt">scale.fix   =</span> <span class="ot">TRUE</span>,</span>
<span id="cb933-7"><a href="#cb933-7"></a>                        <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>    (Intercept)    genderFemale      age_center I(age_center^2) 
       -1.41700         0.39218         0.03973        -0.00868 </code></pre>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="#cb935-1"></a>fit_gee_2ex &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age_center <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>), </span>
<span id="cb935-2"><a href="#cb935-2"></a>                        <span class="dt">id          =</span> id, </span>
<span id="cb935-3"><a href="#cb935-3"></a>                        <span class="dt">data        =</span> data_long,</span>
<span id="cb935-4"><a href="#cb935-4"></a>                        <span class="dt">family      =</span> binomial,</span>
<span id="cb935-5"><a href="#cb935-5"></a>                        <span class="dt">corstr      =</span> <span class="st">&#39;exchangeable&#39;</span>, </span>
<span id="cb935-6"><a href="#cb935-6"></a>                        <span class="dt">scale.fix   =</span> <span class="ot">TRUE</span>,</span>
<span id="cb935-7"><a href="#cb935-7"></a>                        <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>    (Intercept)    genderFemale      age_center I(age_center^2) 
       -1.41700         0.39218         0.03973        -0.00868 </code></pre>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="#cb937-1"></a>fit_gee_2un &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age_center <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>),  </span>
<span id="cb937-2"><a href="#cb937-2"></a>                        <span class="dt">id          =</span> id, </span>
<span id="cb937-3"><a href="#cb937-3"></a>                        <span class="dt">data        =</span> data_long,</span>
<span id="cb937-4"><a href="#cb937-4"></a>                        <span class="dt">family      =</span> binomial,</span>
<span id="cb937-5"><a href="#cb937-5"></a>                        <span class="dt">corstr      =</span> <span class="st">&#39;unstructured&#39;</span>, </span>
<span id="cb937-6"><a href="#cb937-6"></a>                        <span class="dt">scale.fix   =</span> <span class="ot">TRUE</span>,</span>
<span id="cb937-7"><a href="#cb937-7"></a>                        <span class="dt">scale.value =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>    (Intercept)    genderFemale      age_center I(age_center^2) 
       -1.41700         0.39218         0.03973        -0.00868 </code></pre>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="#cb939-1"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(<span class="kw">extract_gee_exp</span>(fit_gee_2in), </span>
<span id="cb939-2"><a href="#cb939-2"></a>                       <span class="kw">extract_gee_exp</span>(fit_gee_2ex),</span>
<span id="cb939-3"><a href="#cb939-3"></a>                       <span class="kw">extract_gee_exp</span>(fit_gee_2un)),</span>
<span id="cb939-4"><a href="#cb939-4"></a>                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Independent&quot;</span>,</span>
<span id="cb939-5"><a href="#cb939-5"></a>                                         <span class="st">&quot;Exchangable&quot;</span>,</span>
<span id="cb939-6"><a href="#cb939-6"></a>                                         <span class="st">&quot;Unstructured&quot;</span>),</span>
<span id="cb939-7"><a href="#cb939-7"></a>                  <span class="dt">caption =</span> <span class="st">&quot;Gee Model Parameters: Main Effects Only&quot;</span>,</span>
<span id="cb939-8"><a href="#cb939-8"></a>                  <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb939-9"><a href="#cb939-9"></a>                  <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>
====================================================================================
              Independent             Exchangable             Unstructured          
------------------------------------------------------------------------------------
(Intercept)      0.24 [0.17; 0.34] *     0.23 [0.17; 0.33] *     0.24 [0.17; 0.33] *
genderFemale     1.48 [0.97; 2.27]       1.49 [0.97; 2.29]       1.48 [0.96; 2.27]  
age_center       1.04 [0.98; 1.11]       1.07 [1.02; 1.13] *     1.07 [1.02; 1.13] *
age_center^2     0.99 [0.98; 1.01]       0.99 [0.98; 1.01]       0.99 [0.98; 1.01]  
------------------------------------------------------------------------------------
Dispersion       1.00                    1.00                    1.00               
Num. obs.     1050                    1050                    1050                  
====================================================================================
* Null hypothesis value outside the confidence interval.</code></pre>
</div>
<div id="select-the-final-model." class="section level3" number="19.6.2">
<h3 number="19.6.2"><span class="header-section-number">19.6.2</span> Select the <strong>“final”</strong> model.</h3>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="#cb941-1"></a>fit_geeglm_2un &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age_center <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>),  </span>
<span id="cb941-2"><a href="#cb941-2"></a>                                  <span class="dt">id          =</span> id, </span>
<span id="cb941-3"><a href="#cb941-3"></a>                                  <span class="dt">data        =</span> data_long,</span>
<span id="cb941-4"><a href="#cb941-4"></a>                                  <span class="dt">family      =</span> binomial,</span>
<span id="cb941-5"><a href="#cb941-5"></a>                                  <span class="dt">corstr      =</span> <span class="st">&#39;unstructured&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="#cb942-1"></a>plot_pred_gee &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">gender =</span> data_long<span class="op">$</span>gender <span class="op">%&gt;%</span><span class="st"> </span>levels,</span>
<span id="cb942-2"><a href="#cb942-2"></a>                             <span class="dt">age_center =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-6</span>, <span class="dt">to =</span> <span class="dv">6</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb942-3"><a href="#cb942-3"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(fit_geeglm_2un,</span>
<span id="cb942-4"><a href="#cb942-4"></a>                        <span class="dt">newdata =</span> .,</span>
<span id="cb942-5"><a href="#cb942-5"></a>                        <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb942-6"><a href="#cb942-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">fct_rev</span>(gender)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb942-7"><a href="#cb942-7"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">age =</span> age_center <span class="op">+</span><span class="st"> </span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb942-8"><a href="#cb942-8"></a><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x        =</span> age,</span>
<span id="cb942-9"><a href="#cb942-9"></a>              <span class="dt">y        =</span> fit,</span>
<span id="cb942-10"><a href="#cb942-10"></a>              <span class="dt">group    =</span> gender,</span>
<span id="cb942-11"><a href="#cb942-11"></a>              <span class="dt">linetype =</span> gender,</span>
<span id="cb942-12"><a href="#cb942-12"></a>              <span class="dt">color    =</span> gender)) <span class="op">+</span></span>
<span id="cb942-13"><a href="#cb942-13"></a><span class="st">   </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb942-14"><a href="#cb942-14"></a><span class="st">   </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb942-15"><a href="#cb942-15"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Generalized Estimating Equation: Model #2, unstructured&quot;</span>,</span>
<span id="cb942-16"><a href="#cb942-16"></a>        <span class="dt">subtitle =</span> <span class="st">&quot;Predicted Probability of Obesity&quot;</span>,</span>
<span id="cb942-17"><a href="#cb942-17"></a>        <span class="dt">x     =</span> <span class="st">&quot;Child&#39;s Age, years&quot;</span>,</span>
<span id="cb942-18"><a href="#cb942-18"></a>        <span class="dt">y     =</span> <span class="st">&quot;Probability&quot;</span>,</span>
<span id="cb942-19"><a href="#cb942-19"></a>        <span class="dt">linetype =</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb942-20"><a href="#cb942-20"></a>        <span class="dt">color =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span></span>
<span id="cb942-21"><a href="#cb942-21"></a><span class="st">   </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb942-22"><a href="#cb942-22"></a>         <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.05</span>),</span>
<span id="cb942-23"><a href="#cb942-23"></a>         <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb942-24"><a href="#cb942-24"></a>         <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb942-25"><a href="#cb942-25"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">6</span>, <span class="dt">to =</span> <span class="dv">18</span>, <span class="dt">by =</span> <span class="dv">3</span>))</span>
<span id="cb942-26"><a href="#cb942-26"></a>  </span>
<span id="cb942-27"><a href="#cb942-27"></a>  </span>
<span id="cb942-28"><a href="#cb942-28"></a>plot_pred_gee</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-705-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="glmm-analysis" class="section level2" number="19.7">
<h2 number="19.7"><span class="header-section-number">19.7</span> GLMM Analysis</h2>
<blockquote>
<p>IT IS GENERALLY NOT RECOMMENDED THAT RANDOM-SLOPES BE ESTIMATED FOR BINOMIAL GLMMS</p>
</blockquote>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="#cb943-1"></a>fit_glmm_<span class="dv">1</span> &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(obesity_num <span class="op">~</span><span class="st"> </span>age_center<span class="op">*</span>gender <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>gender <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id), </span>
<span id="cb943-2"><a href="#cb943-2"></a>                          <span class="dt">data =</span> data_long,</span>
<span id="cb943-3"><a href="#cb943-3"></a>                          <span class="dt">family =</span> binomial) </span>
<span id="cb943-4"><a href="#cb943-4"></a></span>
<span id="cb943-5"><a href="#cb943-5"></a>fit_glmm_<span class="dv">2</span> &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(obesity_num <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age_center <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(age_center<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id), </span>
<span id="cb943-6"><a href="#cb943-6"></a>                          <span class="dt">data =</span> data_long,</span>
<span id="cb943-7"><a href="#cb943-7"></a>                          <span class="dt">family =</span> binomial) </span></code></pre></div>
<p>Indicates smaller model is better, no interaction at higher level necessary</p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="#cb944-1"></a><span class="kw">anova</span>(fit_glmm_<span class="dv">1</span>, fit_glmm_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>Data: data_long
Models:
fit_glmm_2: obesity_num ~ gender + age_center + I(age_center^2) + (1 | id)
fit_glmm_1: obesity_num ~ age_center * gender + I(age_center^2) * gender + 
fit_glmm_1:     (1 | id)
           npar AIC BIC logLik deviance Chisq Df Pr(&gt;Chisq)
fit_glmm_2    5 883 908   -436      873                    
fit_glmm_1    7 885 920   -436      871  1.54  2       0.46</code></pre>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="#cb946-1"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(<span class="kw">extract_glmer_exp</span>(fit_glmm_<span class="dv">1</span>), </span>
<span id="cb946-2"><a href="#cb946-2"></a>                       <span class="kw">extract_glmer_exp</span>(fit_glmm_<span class="dv">2</span>)),</span>
<span id="cb946-3"><a href="#cb946-3"></a>                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Interaction&quot;</span>,</span>
<span id="cb946-4"><a href="#cb946-4"></a>                                         <span class="st">&quot;Main Effects&quot;</span>),</span>
<span id="cb946-5"><a href="#cb946-5"></a>                  <span class="dt">caption =</span> <span class="st">&quot;GLMM: Parameter EStimates&quot;</span>,</span>
<span id="cb946-6"><a href="#cb946-6"></a>                  <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb946-7"><a href="#cb946-7"></a>                  <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>
=========================================================================
                           Interaction             Main Effects          
-------------------------------------------------------------------------
(Intercept)                   0.00 [0.00; 0.01] *     0.00 [0.00; 0.01] *
age_center                    1.21 [0.97; 1.50]       1.25 [1.09; 1.44] *
genderFemale                  1.54 [0.41; 5.74]       2.05 [0.61; 6.91]  
age_center^2                  0.97 [0.92; 1.02]       0.98 [0.95; 1.01]  
age_center:genderFemale       1.08 [0.81; 1.43]                          
genderFemale:age_center^2     1.03 [0.97; 1.10]                          
-------------------------------------------------------------------------
AIC                         885.28                  882.82               
BIC                         919.97                  907.60               
Log Likelihood             -435.64                 -436.41               
Num. obs.                  1050                    1050                  
Num. groups: id             350                     350                  
Var: id (Intercept)          50.01                   49.13               
=========================================================================
* Null hypothesis value outside the confidence interval.</code></pre>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="#cb948-1"></a><span class="kw">Effect</span>(<span class="kw">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;age_center&quot;</span>),fit_glmm_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb948-2"><a href="#cb948-2"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb948-3"><a href="#cb948-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit_exp =</span> <span class="kw">exp</span>(fit))</span></code></pre></div>
<pre><code>   gender age_center      fit       se    lower   upper fit_exp
1    Male         -6 0.000213 0.000243 2.27e-05 0.00199    1.00
2  Female         -6 0.000437 0.000515 4.32e-05 0.00439    1.00
3    Male         -3 0.000643 0.000566 1.15e-04 0.00360    1.00
4  Female         -3 0.001318 0.001225 2.13e-04 0.00811    1.00
5    Male          0 0.001451 0.001154 3.05e-04 0.00688    1.00
6  Female          0 0.002973 0.002530 5.59e-04 0.01564    1.00
7    Male          3 0.002449 0.001876 5.45e-04 0.01094    1.00
8  Female          3 0.005011 0.004140 9.88e-04 0.02500    1.01
9    Male          6 0.003091 0.002749 5.39e-04 0.01750    1.00
10 Female          6 0.006321 0.005970 9.86e-04 0.03937    1.01</code></pre>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="#cb950-1"></a>plot_pred_glmm &lt;-<span class="st"> </span><span class="kw">Effect</span>(<span class="kw">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;age_center&quot;</span>), </span>
<span id="cb950-2"><a href="#cb950-2"></a>       fit_glmm_<span class="dv">2</span>,</span>
<span id="cb950-3"><a href="#cb950-3"></a>       <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age_center =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-6</span>, <span class="dt">to =</span> <span class="dv">6</span>, <span class="dt">by =</span> <span class="fl">0.25</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb950-4"><a href="#cb950-4"></a><span class="st">   </span>data.frame <span class="op">%&gt;%</span></span>
<span id="cb950-5"><a href="#cb950-5"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">age =</span> age_center <span class="op">+</span><span class="st"> </span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb950-6"><a href="#cb950-6"></a><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x        =</span> age,</span>
<span id="cb950-7"><a href="#cb950-7"></a>              <span class="dt">y        =</span> fit,</span>
<span id="cb950-8"><a href="#cb950-8"></a>              <span class="dt">group    =</span> gender,</span>
<span id="cb950-9"><a href="#cb950-9"></a>              <span class="dt">linetype =</span> gender,</span>
<span id="cb950-10"><a href="#cb950-10"></a>              <span class="dt">color    =</span> gender)) <span class="op">+</span></span>
<span id="cb950-11"><a href="#cb950-11"></a><span class="st">   </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb950-12"><a href="#cb950-12"></a><span class="st">   </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb950-13"><a href="#cb950-13"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Generalized Linear Mixed Models: Model #2&quot;</span>,</span>
<span id="cb950-14"><a href="#cb950-14"></a>        <span class="dt">subtitle =</span> <span class="st">&quot;Predicted Probability of Obesity&quot;</span>,</span>
<span id="cb950-15"><a href="#cb950-15"></a>        <span class="dt">x        =</span> <span class="st">&quot;Child&#39;s Age, years&quot;</span>,</span>
<span id="cb950-16"><a href="#cb950-16"></a>        <span class="dt">y        =</span> <span class="st">&quot;Probability&quot;</span>,</span>
<span id="cb950-17"><a href="#cb950-17"></a>        <span class="dt">linetype =</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb950-18"><a href="#cb950-18"></a>        <span class="dt">color    =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span></span>
<span id="cb950-19"><a href="#cb950-19"></a><span class="st">   </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb950-20"><a href="#cb950-20"></a>         <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.05</span>),</span>
<span id="cb950-21"><a href="#cb950-21"></a>         <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb950-22"><a href="#cb950-22"></a>         <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb950-23"><a href="#cb950-23"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">6</span>, <span class="dt">to =</span> <span class="dv">18</span>, <span class="dt">by =</span> <span class="dv">3</span>))</span>
<span id="cb950-24"><a href="#cb950-24"></a></span>
<span id="cb950-25"><a href="#cb950-25"></a>plot_pred_glmm </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-710-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="compare-methods" class="section level2" number="19.8">
<h2 number="19.8"><span class="header-section-number">19.8</span> Compare Methods</h2>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="#cb951-1"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(<span class="kw">extract_glm_exp</span>(fit_glm_<span class="dv">2</span>),</span>
<span id="cb951-2"><a href="#cb951-2"></a>                       <span class="kw">extract_gee_exp</span>(fit_gee_2un),</span>
<span id="cb951-3"><a href="#cb951-3"></a>                       <span class="kw">extract_glmer_exp</span>(fit_glmm_<span class="dv">2</span>)),</span>
<span id="cb951-4"><a href="#cb951-4"></a>                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;GLM&quot;</span>,</span>
<span id="cb951-5"><a href="#cb951-5"></a>                                         <span class="st">&quot;GEE&quot;</span>,</span>
<span id="cb951-6"><a href="#cb951-6"></a>                                         <span class="st">&quot;GLMM&quot;</span>),</span>
<span id="cb951-7"><a href="#cb951-7"></a>                  <span class="dt">caption =</span> <span class="st">&quot;Compare Methods: Parameter EStimates&quot;</span>,</span>
<span id="cb951-8"><a href="#cb951-8"></a>                  <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb951-9"><a href="#cb951-9"></a>                  <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>
===========================================================================================
                     GLM                     GEE                     GLMM                  
-------------------------------------------------------------------------------------------
(Intercept)             0.24 [0.19; 0.31] *     0.24 [0.17; 0.33] *     0.00 [0.00; 0.01] *
genderFemale            1.48 [1.10; 2.00] *     1.48 [0.96; 2.27]       2.05 [0.61; 6.91]  
age_center              1.04 [0.99; 1.10]       1.07 [1.02; 1.13] *     1.25 [1.09; 1.44] *
age_center^2            0.99 [0.98; 1.01]       0.99 [0.98; 1.01]       0.98 [0.95; 1.01]  
-------------------------------------------------------------------------------------------
AIC                  1101.98                                          882.82               
BIC                  1121.80                                          907.60               
Log Likelihood       -546.99                                         -436.41               
Deviance             1093.98                                                               
Num. obs.            1050                    1050                    1050                  
Dispersion                                      1.00                                       
Num. groups: id                                                       350                  
Var: id (Intercept)                                                    49.13               
===========================================================================================
* Null hypothesis value outside the confidence interval.</code></pre>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="#cb953-1"></a>gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(plot_pred_glm, </span>
<span id="cb953-2"><a href="#cb953-2"></a>                        plot_pred_gee, </span>
<span id="cb953-3"><a href="#cb953-3"></a>                        plot_pred_glmm)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-712-1.png" width="720" style="display: block; margin: auto;" /></p>
<!--chapter:end:71_example_glmm_muscatine.Rmd-->
</div>
</div>
<div id="glmm-count-outcome-bolous" class="section level1" number="20">
<h1 number="20"><span class="header-section-number">20</span> GLMM, Count Outcome: Bolous</h1>
<div class="rmdlink">
<p>
GLMM FAQ by: Ben Bolker and others
</p>
<p>
<a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html" class="uri">https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html</a>
</p>
</div>
<div id="packages-5" class="section level2" number="20.1">
<h2 number="20.1"><span class="header-section-number">20.1</span> Packages</h2>
<div id="cran-5" class="section level3" number="20.1.1">
<h3 number="20.1.1"><span class="header-section-number">20.1.1</span> CRAN</h3>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="#cb954-1"></a><span class="kw">library</span>(tidyverse)    <span class="co"># all things tidy</span></span>
<span id="cb954-2"><a href="#cb954-2"></a><span class="kw">library</span>(pander)       <span class="co"># nice looking genderal tabulations</span></span>
<span id="cb954-3"><a href="#cb954-3"></a><span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span></span>
<span id="cb954-4"><a href="#cb954-4"></a><span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span></span>
<span id="cb954-5"><a href="#cb954-5"></a><span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span></span>
<span id="cb954-6"><a href="#cb954-6"></a></span>
<span id="cb954-7"><a href="#cb954-7"></a><span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span></span>
<span id="cb954-8"><a href="#cb954-8"></a><span class="kw">library</span>(gee)          <span class="co"># Generalized Estimating Equations</span></span>
<span id="cb954-9"><a href="#cb954-9"></a><span class="kw">library</span>(optimx)       <span class="co"># Optimizers for use in lme4::glmer</span></span>
<span id="cb954-10"><a href="#cb954-10"></a><span class="kw">library</span>(MuMIn)        <span class="co"># Multi-Model Inference (caluclate QIC)</span></span>
<span id="cb954-11"><a href="#cb954-11"></a><span class="kw">library</span>(effects)      <span class="co"># Plotting estimated marginal means</span></span>
<span id="cb954-12"><a href="#cb954-12"></a></span>
<span id="cb954-13"><a href="#cb954-13"></a><span class="kw">library</span>(gridExtra)    <span class="co"># combining graphics</span></span></code></pre></div>
</div>
<div id="github-5" class="section level3" number="20.1.2">
<h3 number="20.1.2"><span class="header-section-number">20.1.2</span> GitHub</h3>
<p>Helper <code>extract</code> functions for exponentiating parameters form generalized regression models within a <code>texreg</code> table of model parameters.</p>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="#cb955-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb955-2"><a href="#cb955-2"></a><span class="co"># library(devtools)</span></span>
<span id="cb955-3"><a href="#cb955-3"></a><span class="co"># install_github(&quot;SarBearSchwartz/texreghelpr&quot;)</span></span>
<span id="cb955-4"><a href="#cb955-4"></a></span>
<span id="cb955-5"><a href="#cb955-5"></a><span class="kw">library</span>(texreghelpr)</span></code></pre></div>
</div>
</div>
<div id="data-prep-2" class="section level2" number="20.2">
<h2 number="20.2"><span class="header-section-number">20.2</span> Data Prep</h2>
<blockquote>
<p>Bolus data from Weiss 2005</p>
</blockquote>
<p>Patient controlled analgesia (PCA) comparing 2 dosing regimes to self-control pain</p>
<p>The dataset has the number of requests per interval in 12 successive four-hourly intervals following abdominal surgery for 65 patients in a clinical trial to compare two groups (bolus/lock-out combinations).</p>
<p>Bolus= Large dose of medication given (usually intravenously by direct infusion injection or gravity drip) to raise blood-level concentrations to a therapeutic level</p>
<p>A ‘lock-out’ period followed each dose, where subject may not administer more medication.</p>
<ul>
<li>Lock-out time is twice as long in 2mg/dose group</li>
<li>Allows for max of 30 dosages in 2mg/dose and 60 in 1mg/dose group in any 4-hour period</li>
<li>No responses neared these upper limits</li>
</ul>
<p><strong>Variable List:</strong></p>
<ul>
<li><p>Indicators</p>
<ul>
<li><code>id</code> unique subject indicator</li>
<li><code>time</code> 11 consecutive 4-hour periods: 0, 1, 2, …, 10</li>
</ul></li>
<li><p>Outcome or dependent variable</p>
<ul>
<li><code>count</code> # doses recorded for in that 4-hour period</li>
</ul></li>
<li><p>Main predictor or independent variable of interest</p>
<ul>
<li><code>group</code>1mg/dose group, 2mg/dose group</li>
</ul></li>
</ul>
<div id="import-3" class="section level3" number="20.2.1">
<h3 number="20.2.1"><span class="header-section-number">20.2.1</span> Import</h3>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="#cb956-1"></a>data_raw &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/CEHS-research/data/master/MLM/bolus.txt&quot;</span>,</span>
<span id="cb956-2"><a href="#cb956-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span></span>
<span id="cb956-3"><a href="#cb956-3"></a>)</span>
<span id="cb956-4"><a href="#cb956-4"></a></span>
<span id="cb956-5"><a href="#cb956-5"></a><span class="kw">str</span>(data_raw) <span class="co"># see the structure</span></span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   715 obs. of  4 variables:
 $ id   : int  1 1 1 1 1 1 1 1 1 1 ...
 $ group: chr  &quot;1mg&quot; &quot;1mg&quot; &quot;1mg&quot; &quot;1mg&quot; ...
 $ time : int  0 1 2 3 4 5 6 7 8 9 ...
 $ count: int  2 2 5 2 4 0 2 4 4 4 ...</code></pre>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="#cb958-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_raw)</span></code></pre></div>
<pre><code>     id group time count
1     1   1mg    0     2
2     1   1mg    1     2
3     1   1mg    2     5
4     1   1mg    3     2
... ...  &lt;NA&gt;  ...   ...
712  65   2mg    7     6
713  65   2mg    8     1
714  65   2mg    9     2
715  65   2mg   10     0</code></pre>
</div>
<div id="long-format-7" class="section level3" number="20.2.2">
<h3 number="20.2.2"><span class="header-section-number">20.2.2</span> Long Format</h3>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="#cb960-1"></a>data_long &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb960-2"><a href="#cb960-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">factor</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb960-3"><a href="#cb960-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">timeF =</span> <span class="kw">factor</span>(time)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb960-4"><a href="#cb960-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">factor</span>(group))</span>
<span id="cb960-5"><a href="#cb960-5"></a></span>
<span id="cb960-6"><a href="#cb960-6"></a><span class="kw">str</span>(data_long) <span class="co"># see the structure</span></span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   715 obs. of  5 variables:
 $ id   : Factor w/ 65 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
 $ group: Factor w/ 2 levels &quot;1mg&quot;,&quot;2mg&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ time : int  0 1 2 3 4 5 6 7 8 9 ...
 $ count: int  2 2 5 2 4 0 2 4 4 4 ...
 $ timeF: Factor w/ 11 levels &quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...</code></pre>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="#cb962-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_long)</span></code></pre></div>
<pre><code>      id group time count timeF
1      1   1mg    0     2     0
2      1   1mg    1     2     1
3      1   1mg    2     5     2
4      1   1mg    3     2     3
... &lt;NA&gt;  &lt;NA&gt;  ...   ...  &lt;NA&gt;
712   65   2mg    7     6     7
713   65   2mg    8     1     8
714   65   2mg    9     2     9
715   65   2mg   10     0    10</code></pre>
</div>
<div id="wide-format-7" class="section level3" number="20.2.3">
<h3 number="20.2.3"><span class="header-section-number">20.2.3</span> Wide Format</h3>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="#cb964-1"></a>data_wide &lt;-<span class="st"> </span>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb964-2"><a href="#cb964-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>timeF) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb964-3"><a href="#cb964-3"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(<span class="dt">key =</span> time,</span>
<span id="cb964-4"><a href="#cb964-4"></a>                <span class="dt">value =</span> count,</span>
<span id="cb964-5"><a href="#cb964-5"></a>                <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb964-6"><a href="#cb964-6"></a></span>
<span id="cb964-7"><a href="#cb964-7"></a><span class="kw">str</span>(data_wide) <span class="co"># see the structure</span></span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   65 obs. of  13 variables:
 $ id     : Factor w/ 65 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
 $ group  : Factor w/ 2 levels &quot;1mg&quot;,&quot;2mg&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ time_0 : int  2 3 4 1 7 6 4 2 10 0 ...
 $ time_1 : int  2 5 8 4 7 5 7 10 9 7 ...
 $ time_2 : int  5 4 4 3 6 4 4 8 8 1 ...
 $ time_3 : int  2 4 3 3 8 8 8 17 9 9 ...
 $ time_4 : int  4 5 12 3 6 7 4 4 4 8 ...
 $ time_5 : int  0 0 1 1 5 4 4 2 2 0 ...
 $ time_6 : int  2 6 0 7 4 6 3 6 6 1 ...
 $ time_7 : int  4 3 6 5 7 5 1 8 1 5 ...
 $ time_8 : int  4 2 5 0 2 2 3 9 8 4 ...
 $ time_9 : int  4 7 3 1 5 4 4 1 5 1 ...
 $ time_10: int  2 4 5 1 0 4 6 4 5 0 ...</code></pre>
<div class="sourceCode" id="cb966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb966-1"><a href="#cb966-1"></a>psych<span class="op">::</span><span class="kw">headTail</span>(data_wide)</span></code></pre></div>
<pre><code>      id group time_0 time_1 time_2 time_3 time_4 time_5 time_6 time_7 time_8
1      1   1mg      2      2      5      2      4      0      2      4      4
2      2   1mg      3      5      4      4      5      0      6      3      2
3      3   1mg      4      8      4      3     12      1      0      6      5
4      4   1mg      1      4      3      3      3      1      7      5      0
... &lt;NA&gt;  &lt;NA&gt;    ...    ...    ...    ...    ...    ...    ...    ...    ...
62    62   2mg      0     13      7      9     19      4      5     11     10
63    63   2mg     11      7      6      9      3      4      6      6      6
64    64   2mg      8      4     22     11     16      4      5      9     12
65    65   2mg      2      2      2      4      4      3      7      6      1
    time_9 time_10
1        4       2
2        7       4
3        3       5
4        1       1
...    ...     ...
62       6       9
63       6       0
64      12       7
65       2       0</code></pre>
</div>
</div>
<div id="exploratory-data-analysis-11" class="section level2" number="20.3">
<h2 number="20.3"><span class="header-section-number">20.3</span> Exploratory Data Analysis</h2>
<div id="summary-statistics-4" class="section level3" number="20.3.1">
<h3 number="20.3.1"><span class="header-section-number">20.3.1</span> Summary Statistics</h3>
<div id="demographics-and-baseline-2" class="section level4" number="20.3.1.1">
<h4 number="20.3.1.1"><span class="header-section-number">20.3.1.1</span> Demographics and Baseline</h4>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb968-1"><a href="#cb968-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb968-2"><a href="#cb968-2"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(time_<span class="dv">0</span>,</span>
<span id="cb968-3"><a href="#cb968-3"></a>                    <span class="dt">splitby =</span> <span class="op">~</span><span class="st"> </span>group,</span>
<span id="cb968-4"><a href="#cb968-4"></a>                    <span class="dt">test    =</span> <span class="ot">TRUE</span>,</span>
<span id="cb968-5"><a href="#cb968-5"></a>                    <span class="dt">na.rm   =</span> <span class="ot">FALSE</span>,</span>
<span id="cb968-6"><a href="#cb968-6"></a>                    <span class="dt">output  =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
1mg
</th>
<th>
2mg
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 30
</td>
<td>
n = 35
</td>
<td>
</td>
</tr>
<tr>
<td>
time_0
</td>
<td>
</td>
<td>
</td>
<td>
0.448
</td>
</tr>
<tr>
<td>
</td>
<td>
5.5 (4.7)
</td>
<td>
6.5 (5.6)
</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
<div id="status-over-time-3" class="section level4" number="20.3.1.2">
<h4 number="20.3.1.2"><span class="header-section-number">20.3.1.2</span> Status over Time</h4>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="#cb969-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb969-2"><a href="#cb969-2"></a><span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(time_<span class="dv">0</span>, </span>
<span id="cb969-3"><a href="#cb969-3"></a>                    time_<span class="dv">1</span>, time_<span class="dv">2</span>, time_<span class="dv">3</span>, time_<span class="dv">4</span>, time_<span class="dv">5</span>, </span>
<span id="cb969-4"><a href="#cb969-4"></a>                    time_<span class="dv">6</span>, time_<span class="dv">7</span>, time_<span class="dv">8</span>, time_<span class="dv">9</span>, time_<span class="dv">10</span>,</span>
<span id="cb969-5"><a href="#cb969-5"></a>                    <span class="dt">splitby =</span> <span class="op">~</span><span class="st"> </span>group,</span>
<span id="cb969-6"><a href="#cb969-6"></a>                    <span class="dt">test    =</span> <span class="ot">TRUE</span>,</span>
<span id="cb969-7"><a href="#cb969-7"></a>                    <span class="dt">na.rm   =</span> <span class="ot">FALSE</span>,</span>
<span id="cb969-8"><a href="#cb969-8"></a>                    <span class="dt">output  =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
1mg
</th>
<th>
2mg
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 30
</td>
<td>
n = 35
</td>
<td>
</td>
</tr>
<tr>
<td>
time_0
</td>
<td>
</td>
<td>
</td>
<td>
0.448
</td>
</tr>
<tr>
<td>
</td>
<td>
5.5 (4.7)
</td>
<td>
6.5 (5.6)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_1
</td>
<td>
</td>
<td>
</td>
<td>
0.127
</td>
</tr>
<tr>
<td>
</td>
<td>
5.4 (4.0)
</td>
<td>
7.9 (7.7)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_2
</td>
<td>
</td>
<td>
</td>
<td>
0.005
</td>
</tr>
<tr>
<td>
</td>
<td>
5.1 (4.1)
</td>
<td>
9.3 (7.1)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_3
</td>
<td>
</td>
<td>
</td>
<td>
0.165
</td>
</tr>
<tr>
<td>
</td>
<td>
7.6 (5.0)
</td>
<td>
9.6 (6.6)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_4
</td>
<td>
</td>
<td>
</td>
<td>
0.084
</td>
</tr>
<tr>
<td>
</td>
<td>
5.3 (3.4)
</td>
<td>
7.4 (5.5)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_5
</td>
<td>
</td>
<td>
</td>
<td>
0.024
</td>
</tr>
<tr>
<td>
</td>
<td>
3.9 (4.2)
</td>
<td>
6.6 (5.0)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_6
</td>
<td>
</td>
<td>
</td>
<td>
0.052
</td>
</tr>
<tr>
<td>
</td>
<td>
3.7 (3.0)
</td>
<td>
5.7 (4.8)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_7
</td>
<td>
</td>
<td>
</td>
<td>
0.73
</td>
</tr>
<tr>
<td>
</td>
<td>
4.6 (3.2)
</td>
<td>
4.9 (4.0)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_8
</td>
<td>
</td>
<td>
</td>
<td>
0.236
</td>
</tr>
<tr>
<td>
</td>
<td>
4.9 (3.6)
</td>
<td>
6.3 (5.5)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_9
</td>
<td>
</td>
<td>
</td>
<td>
0.008
</td>
</tr>
<tr>
<td>
</td>
<td>
3.5 (2.1)
</td>
<td>
6.3 (5.5)
</td>
<td>
</td>
</tr>
<tr>
<td>
time_10
</td>
<td>
</td>
<td>
</td>
<td>
0.034
</td>
</tr>
<tr>
<td>
</td>
<td>
3.5 (2.8)
</td>
<td>
5.9 (5.8)
</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
<div id="correlation-over-time" class="section level4" number="20.3.1.3">
<h4 number="20.3.1.3"><span class="header-section-number">20.3.1.3</span> Correlation over Time</h4>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb970-1"><a href="#cb970-1"></a>data_wide <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-2"><a href="#cb970-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;time_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-3"><a href="#cb970-3"></a><span class="st">  </span><span class="kw">cor</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-4"><a href="#cb970-4"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-722-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="visualize-6" class="section level3" number="20.3.2">
<h3 number="20.3.2"><span class="header-section-number">20.3.2</span> Visualize</h3>
<div id="person-profile-plots-by-group" class="section level4" number="20.3.2.1">
<h4 number="20.3.2.1"><span class="header-section-number">20.3.2.1</span> Person Profile Plots, by Group</h4>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="#cb971-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb971-2"><a href="#cb971-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, </span>
<span id="cb971-3"><a href="#cb971-3"></a>             <span class="dt">y =</span> count)) <span class="op">+</span></span>
<span id="cb971-4"><a href="#cb971-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id),</span>
<span id="cb971-5"><a href="#cb971-5"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></span>
<span id="cb971-6"><a href="#cb971-6"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>group) <span class="op">+</span><span class="st"> </span></span>
<span id="cb971-7"><a href="#cb971-7"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-723-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb972-1"><a href="#cb972-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb972-2"><a href="#cb972-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, </span>
<span id="cb972-3"><a href="#cb972-3"></a>             <span class="dt">y =</span> count)) <span class="op">+</span></span>
<span id="cb972-4"><a href="#cb972-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id),</span>
<span id="cb972-5"><a href="#cb972-5"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb972-6"><a href="#cb972-6"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb972-7"><a href="#cb972-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb972-8"><a href="#cb972-8"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>group) <span class="op">+</span><span class="st"> </span></span>
<span id="cb972-9"><a href="#cb972-9"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-724-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="#cb973-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb973-2"><a href="#cb973-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, </span>
<span id="cb973-3"><a href="#cb973-3"></a>             <span class="dt">y =</span> count)) <span class="op">+</span></span>
<span id="cb973-4"><a href="#cb973-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id),</span>
<span id="cb973-5"><a href="#cb973-5"></a>              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb973-6"><a href="#cb973-6"></a>              <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">2</span>),</span>
<span id="cb973-7"><a href="#cb973-7"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb973-8"><a href="#cb973-8"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb973-9"><a href="#cb973-9"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>group) <span class="op">+</span><span class="st"> </span></span>
<span id="cb973-10"><a href="#cb973-10"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-725-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="#cb974-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb974-2"><a href="#cb974-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, </span>
<span id="cb974-3"><a href="#cb974-3"></a>             <span class="dt">y =</span> count)) <span class="op">+</span></span>
<span id="cb974-4"><a href="#cb974-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb974-5"><a href="#cb974-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb974-6"><a href="#cb974-6"></a>              <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb974-7"><a href="#cb974-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb974-8"><a href="#cb974-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb974-9"><a href="#cb974-9"></a>              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb974-10"><a href="#cb974-10"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb974-11"><a href="#cb974-11"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>group) <span class="op">+</span><span class="st"> </span></span>
<span id="cb974-12"><a href="#cb974-12"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-726-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="#cb975-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb975-2"><a href="#cb975-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, </span>
<span id="cb975-3"><a href="#cb975-3"></a>             <span class="dt">y =</span> <span class="kw">log</span>(count <span class="op">+</span><span class="st"> </span><span class="fl">.1</span>))) <span class="op">+</span></span>
<span id="cb975-4"><a href="#cb975-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb975-5"><a href="#cb975-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb975-6"><a href="#cb975-6"></a>              <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb975-7"><a href="#cb975-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb975-8"><a href="#cb975-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb975-9"><a href="#cb975-9"></a>              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb975-10"><a href="#cb975-10"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb975-11"><a href="#cb975-11"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>group) <span class="op">+</span><span class="st"> </span></span>
<span id="cb975-12"><a href="#cb975-12"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-727-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="#cb976-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb976-2"><a href="#cb976-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, </span>
<span id="cb976-3"><a href="#cb976-3"></a>             <span class="dt">y =</span> count)) <span class="op">+</span></span>
<span id="cb976-4"><a href="#cb976-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb976-5"><a href="#cb976-5"></a>              <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb976-6"><a href="#cb976-6"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb976-7"><a href="#cb976-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb976-8"><a href="#cb976-8"></a>              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb976-9"><a href="#cb976-9"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb976-10"><a href="#cb976-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb976-11"><a href="#cb976-11"></a>              <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">2</span>),</span>
<span id="cb976-12"><a href="#cb976-12"></a>              <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb976-13"><a href="#cb976-13"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb976-14"><a href="#cb976-14"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb976-15"><a href="#cb976-15"></a>              <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">3</span>),</span>
<span id="cb976-16"><a href="#cb976-16"></a>              <span class="dt">color =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb976-17"><a href="#cb976-17"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb976-18"><a href="#cb976-18"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>group) <span class="op">+</span><span class="st"> </span></span>
<span id="cb976-19"><a href="#cb976-19"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-728-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="means-over-time-by-group" class="section level4" number="20.3.2.2">
<h4 number="20.3.2.2"><span class="header-section-number">20.3.2.2</span> Means over Time, BY Group</h4>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb977-1"><a href="#cb977-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb977-2"><a href="#cb977-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(group, timeF) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb977-3"><a href="#cb977-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">M =</span> <span class="kw">mean</span>(count)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb977-4"><a href="#cb977-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> timeF,</span>
<span id="cb977-5"><a href="#cb977-5"></a>             <span class="dt">y =</span> M,</span>
<span id="cb977-6"><a href="#cb977-6"></a>             <span class="dt">group =</span> group,</span>
<span id="cb977-7"><a href="#cb977-7"></a>             <span class="dt">color =</span> group)) <span class="op">+</span></span>
<span id="cb977-8"><a href="#cb977-8"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb977-9"><a href="#cb977-9"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb977-10"><a href="#cb977-10"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb977-11"><a href="#cb977-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Four-week Intervals&quot;</span>,</span>
<span id="cb977-12"><a href="#cb977-12"></a>       <span class="dt">y =</span> <span class="st">&quot;Sample Mean Count&quot;</span>,</span>
<span id="cb977-13"><a href="#cb977-13"></a>       <span class="dt">color =</span> <span class="st">&quot;Dose&quot;</span>) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-729-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="#cb978-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb978-2"><a href="#cb978-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(group, timeF) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb978-3"><a href="#cb978-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">M =</span> <span class="kw">mean</span>(<span class="kw">log</span>(count <span class="op">+</span><span class="st"> </span><span class="fl">.1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb978-4"><a href="#cb978-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> timeF,</span>
<span id="cb978-5"><a href="#cb978-5"></a>             <span class="dt">y =</span> M,</span>
<span id="cb978-6"><a href="#cb978-6"></a>             <span class="dt">group =</span> group,</span>
<span id="cb978-7"><a href="#cb978-7"></a>             <span class="dt">color =</span> group)) <span class="op">+</span></span>
<span id="cb978-8"><a href="#cb978-8"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb978-9"><a href="#cb978-9"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb978-10"><a href="#cb978-10"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb978-11"><a href="#cb978-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Four-week Intervals&quot;</span>,</span>
<span id="cb978-12"><a href="#cb978-12"></a>       <span class="dt">y =</span> <span class="st">&quot;Sample Mean Count&quot;</span>,</span>
<span id="cb978-13"><a href="#cb978-13"></a>       <span class="dt">color =</span> <span class="st">&quot;Dose&quot;</span>) </span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-730-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="gee-analysis-1" class="section level2" number="20.4">
<h2 number="20.4"><span class="header-section-number">20.4</span> GEE Analysis</h2>
<div id="fit-various-correlation-structures" class="section level3" number="20.4.1">
<h3 number="20.4.1"><span class="header-section-number">20.4.1</span> Fit Various Correlation Structures</h3>
<div id="exchangable" class="section level4" number="20.4.1.1">
<h4 number="20.4.1.1"><span class="header-section-number">20.4.1.1</span> Exchangable</h4>
<div class="sourceCode" id="cb979"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb979-1"><a href="#cb979-1"></a>mod_gee_ex &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(count <span class="op">~</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb979-2"><a href="#cb979-2"></a>                       <span class="dt">id =</span> id,</span>
<span id="cb979-3"><a href="#cb979-3"></a>                       <span class="dt">data =</span> data_long,</span>
<span id="cb979-4"><a href="#cb979-4"></a>                       <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb979-5"><a href="#cb979-5"></a>                       <span class="dt">corstr =</span> <span class="st">&#39;exchangeable&#39;</span>)</span></code></pre></div>
<pre><code>(Intercept)    group2mg        time   I(time^2) 
    1.72189     0.36280    -0.00222    -0.00417 </code></pre>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb981-1"><a href="#cb981-1"></a><span class="kw">summary</span>(mod_gee_ex)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     Exchangeable 

Call:
gee::gee(formula = count ~ group + time + I(time^2), id = id, 
    data = data_long, family = poisson(link = &quot;log&quot;), corstr = &quot;exchangeable&quot;)

Summary of Residuals:
   Min     1Q Median     3Q    Max 
-7.976 -3.561 -0.925  2.191 27.075 


Coefficients:
            Estimate Naive S.E. Naive z Robust S.E. Robust z
(Intercept)  1.73383    0.12029 14.4136     0.11764  14.7379
group2mg     0.34258    0.14083  2.4326     0.14009   2.4454
time        -0.00222    0.02699 -0.0824     0.03099  -0.0718
I(time^2)   -0.00417    0.00269 -1.5502     0.00273  -1.5249

Estimated Scale Parameter:  3.99
Number of Iterations:  2

Working Correlation
       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
 [1,] 1.000 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418
 [2,] 0.418 1.000 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418
 [3,] 0.418 0.418 1.000 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418
 [4,] 0.418 0.418 0.418 1.000 0.418 0.418 0.418 0.418 0.418 0.418 0.418
 [5,] 0.418 0.418 0.418 0.418 1.000 0.418 0.418 0.418 0.418 0.418 0.418
 [6,] 0.418 0.418 0.418 0.418 0.418 1.000 0.418 0.418 0.418 0.418 0.418
 [7,] 0.418 0.418 0.418 0.418 0.418 0.418 1.000 0.418 0.418 0.418 0.418
 [8,] 0.418 0.418 0.418 0.418 0.418 0.418 0.418 1.000 0.418 0.418 0.418
 [9,] 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 1.000 0.418 0.418
[10,] 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 1.000 0.418
[11,] 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 0.418 1.000</code></pre>
</div>
<div id="auto-regressive-correlation-decay-over-time" class="section level4" number="20.4.1.2">
<h4 number="20.4.1.2"><span class="header-section-number">20.4.1.2</span> Auto-regressive (correlation decay over time)</h4>
<div class="sourceCode" id="cb983"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb983-1"><a href="#cb983-1"></a>mod_gee_ar &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(count <span class="op">~</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb983-2"><a href="#cb983-2"></a>                       <span class="dt">id =</span> id,</span>
<span id="cb983-3"><a href="#cb983-3"></a>                       <span class="dt">data =</span> data_long,</span>
<span id="cb983-4"><a href="#cb983-4"></a>                       <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb983-5"><a href="#cb983-5"></a>                       <span class="dt">corstr =</span> <span class="st">&quot;AR-M&quot;</span>,</span>
<span id="cb983-6"><a href="#cb983-6"></a>                       <span class="dt">Mv =</span> <span class="dv">1</span>)  </span></code></pre></div>
<pre><code>(Intercept)    group2mg        time   I(time^2) 
    1.72189     0.36280    -0.00222    -0.00417 </code></pre>
<div class="sourceCode" id="cb985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb985-1"><a href="#cb985-1"></a><span class="kw">summary</span>(mod_gee_ar)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     AR-M , M = 1 

Call:
gee::gee(formula = count ~ group + time + I(time^2), id = id, 
    data = data_long, family = poisson(link = &quot;log&quot;), corstr = &quot;AR-M&quot;, 
    Mv = 1)

Summary of Residuals:
   Min     1Q Median     3Q    Max 
-7.678 -3.556 -0.963  2.322 27.360 


Coefficients:
            Estimate Naive S.E. Naive z Robust S.E. Robust z
(Intercept)  1.66118    0.11438  14.523     0.12214   13.601
group2mg     0.35559    0.10527   3.378     0.13694    2.597
time         0.02250    0.04204   0.535     0.03265    0.689
I(time^2)   -0.00586    0.00412  -1.424     0.00294   -1.996

Estimated Scale Parameter:  4.01
Number of Iterations:  2

Working Correlation
         [,1]    [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8]    [,9]
 [1,] 1.00000 0.53366 0.28479 0.1520 0.0811 0.0433 0.0231 0.0123 0.00658
 [2,] 0.53366 1.00000 0.53366 0.2848 0.1520 0.0811 0.0433 0.0231 0.01233
 [3,] 0.28479 0.53366 1.00000 0.5337 0.2848 0.1520 0.0811 0.0433 0.02310
 [4,] 0.15198 0.28479 0.53366 1.0000 0.5337 0.2848 0.1520 0.0811 0.04328
 [5,] 0.08110 0.15198 0.28479 0.5337 1.0000 0.5337 0.2848 0.1520 0.08110
 [6,] 0.04328 0.08110 0.15198 0.2848 0.5337 1.0000 0.5337 0.2848 0.15198
 [7,] 0.02310 0.04328 0.08110 0.1520 0.2848 0.5337 1.0000 0.5337 0.28479
 [8,] 0.01233 0.02310 0.04328 0.0811 0.1520 0.2848 0.5337 1.0000 0.53366
 [9,] 0.00658 0.01233 0.02310 0.0433 0.0811 0.1520 0.2848 0.5337 1.00000
[10,] 0.00351 0.00658 0.01233 0.0231 0.0433 0.0811 0.1520 0.2848 0.53366
[11,] 0.00187 0.00351 0.00658 0.0123 0.0231 0.0433 0.0811 0.1520 0.28479
        [,10]   [,11]
 [1,] 0.00351 0.00187
 [2,] 0.00658 0.00351
 [3,] 0.01233 0.00658
 [4,] 0.02310 0.01233
 [5,] 0.04328 0.02310
 [6,] 0.08110 0.04328
 [7,] 0.15198 0.08110
 [8,] 0.28479 0.15198
 [9,] 0.53366 0.28479
[10,] 1.00000 0.53366
[11,] 0.53366 1.00000</code></pre>
</div>
<div id="unstructured" class="section level4" number="20.4.1.3">
<h4 number="20.4.1.3"><span class="header-section-number">20.4.1.3</span> Unstructured</h4>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb987-1"><a href="#cb987-1"></a>mod_gee_un &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(count <span class="op">~</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb987-2"><a href="#cb987-2"></a>                       <span class="dt">id =</span> id,</span>
<span id="cb987-3"><a href="#cb987-3"></a>                       <span class="dt">data =</span> data_long,</span>
<span id="cb987-4"><a href="#cb987-4"></a>                       <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb987-5"><a href="#cb987-5"></a>                       <span class="dt">corstr =</span> <span class="st">&quot;unstructured&quot;</span>) </span></code></pre></div>
<pre><code>(Intercept)    group2mg        time   I(time^2) 
    1.72189     0.36280    -0.00222    -0.00417 </code></pre>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb989-1"><a href="#cb989-1"></a><span class="kw">summary</span>(mod_gee_un)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     Unstructured 

Call:
gee::gee(formula = count ~ group + time + I(time^2), id = id, 
    data = data_long, family = poisson(link = &quot;log&quot;), corstr = &quot;unstructured&quot;)

Summary of Residuals:
   Min     1Q Median     3Q    Max 
-6.666 -2.698 -0.241  2.998 28.438 


Coefficients:
            Estimate Naive S.E. Naive z Robust S.E. Robust z
(Intercept)  1.56265    0.13682   11.42     0.13584    11.50
group2mg     0.28409    0.15148    1.88     0.14155     2.01
time         0.04398    0.03162    1.39     0.04002     1.10
I(time^2)   -0.00942    0.00254   -3.70     0.00371    -2.54

Estimated Scale Parameter:  4.88
Number of Iterations:  11

Working Correlation
        [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]   [,8]  [,9] [,10] [,11]
 [1,] 1.0000 0.536 0.505 0.445 0.196 0.250 0.241 0.0156 0.252 0.241 0.219
 [2,] 0.5364 1.000 0.849 0.619 0.469 0.330 0.309 0.2289 0.612 0.527 0.445
 [3,] 0.5054 0.849 1.000 0.695 0.513 0.463 0.319 0.2979 0.788 0.555 0.593
 [4,] 0.4452 0.619 0.695 1.000 0.606 0.431 0.407 0.3154 0.611 0.645 0.737
 [5,] 0.1958 0.469 0.513 0.606 1.000 0.379 0.278 0.3515 0.537 0.441 0.436
 [6,] 0.2503 0.330 0.463 0.431 0.379 1.000 0.413 0.3718 0.479 0.442 0.633
 [7,] 0.2412 0.309 0.319 0.407 0.278 0.413 1.000 0.2820 0.261 0.291 0.404
 [8,] 0.0156 0.229 0.298 0.315 0.351 0.372 0.282 1.0000 0.494 0.233 0.323
 [9,] 0.2516 0.612 0.788 0.611 0.537 0.479 0.261 0.4936 1.000 0.456 0.493
[10,] 0.2408 0.527 0.555 0.645 0.441 0.442 0.291 0.2334 0.456 1.000 0.738
[11,] 0.2186 0.445 0.593 0.737 0.436 0.633 0.404 0.3229 0.493 0.738 1.000</code></pre>
</div>
</div>
<div id="compare-corelation-structures" class="section level3" number="20.4.2">
<h3 number="20.4.2"><span class="header-section-number">20.4.2</span> Compare Corelation Structures</h3>
<div id="qic-model-fit" class="section level4" number="20.4.2.1">
<h4 number="20.4.2.1"><span class="header-section-number">20.4.2.1</span> QIC: Model Fit</h4>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="#cb991-1"></a>MuMIn<span class="op">::</span><span class="kw">model.sel</span>(mod_gee_ex, </span>
<span id="cb991-2"><a href="#cb991-2"></a>                 mod_gee_ar, </span>
<span id="cb991-3"><a href="#cb991-3"></a>                 mod_gee_un, </span>
<span id="cb991-4"><a href="#cb991-4"></a>                 <span class="dt">rank =</span> <span class="st">&quot;QIC&quot;</span>)    <span class="co">#sorts the best to the TOP, uses QIC(I) to choose corelation structure</span></span></code></pre></div>
<pre><code>Model selection table 
           (Intrc) group     time   time^2       family       corstr Mv qLik
mod_gee_ex    1.73     + -0.00222 -0.00417 poisson(log) exchangeable    3464
mod_gee_ar    1.66     +  0.02250 -0.00587 poisson(log)         AR-M  1 3462
mod_gee_un    1.56     +  0.04398 -0.00942 poisson(log) unstructured    3407
             QIC delta weight
mod_gee_ex -6904  0.00  0.432
mod_gee_ar -6904  0.18  0.395
mod_gee_un -6902  1.83  0.173
Models ranked by QIC(x) </code></pre>
</div>
<div id="model-parameter-table" class="section level4" number="20.4.2.2">
<h4 number="20.4.2.2"><span class="header-section-number">20.4.2.2</span> Model Parameter Table</h4>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb993-1"><a href="#cb993-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb993-2"><a href="#cb993-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb993-3"><a href="#cb993-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb993-4"><a href="#cb993-4"></a></span>
<span id="cb993-5"><a href="#cb993-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="kw">extract_gee_exp</span>(mod_gee_ex),</span>
<span id="cb993-6"><a href="#cb993-6"></a>                     <span class="kw">extract_gee_exp</span>(mod_gee_ar),</span>
<span id="cb993-7"><a href="#cb993-7"></a>                     <span class="kw">extract_gee_exp</span>(mod_gee_un)),</span>
<span id="cb993-8"><a href="#cb993-8"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Exchangable&quot;</span>,</span>
<span id="cb993-9"><a href="#cb993-9"></a>                                       <span class="st">&quot;AutoRegressive&quot;</span>,</span>
<span id="cb993-10"><a href="#cb993-10"></a>                                       <span class="st">&quot;Unstructured&quot;</span>),</span>
<span id="cb993-11"><a href="#cb993-11"></a>                <span class="dt">caption =</span> <span class="st">&quot;GEE: Main Effects Only, with Quadratic Time&quot;</span>,</span>
<span id="cb993-12"><a href="#cb993-12"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb993-13"><a href="#cb993-13"></a>                <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
GEE: Main Effects Only, with Quadratic Time
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Exchangable
</th>
<th style="padding-left: 5px;padding-right: 5px;">
AutoRegressive
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Unstructured
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.66 [4.50; 7.13]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.27 [4.14; 6.69]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.77 [3.66; 6.23]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
group2mg
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.41 [1.07; 1.85]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.43 [1.09; 1.87]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.33 [1.01; 1.75]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.00 [0.94; 1.06]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.02 [0.96; 1.09]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.04 [0.97; 1.13]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.00 [0.99; 1.00]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.99 [0.99; 1.00]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.99 [0.98; 1.00]<sup>*</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Dispersion
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3.99
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.01
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.88
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
715
</td>
<td style="padding-left: 5px;padding-right: 5px;">
715
</td>
<td style="padding-left: 5px;padding-right: 5px;">
715
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="4">
<sup>*</sup> Null hypothesis value outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
</div>
</div>
<div id="add-interaction-terms" class="section level3" number="20.4.3">
<h3 number="20.4.3"><span class="header-section-number">20.4.3</span> Add Interaction Terms</h3>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="#cb994-1"></a>mod_gee_ar2 &lt;-<span class="st"> </span>gee<span class="op">::</span><span class="kw">gee</span>(count <span class="op">~</span><span class="st"> </span>group<span class="op">*</span>time <span class="op">+</span><span class="st"> </span>group<span class="op">*</span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb994-2"><a href="#cb994-2"></a>                        <span class="dt">id =</span> id,</span>
<span id="cb994-3"><a href="#cb994-3"></a>                        <span class="dt">data =</span> data_long,</span>
<span id="cb994-4"><a href="#cb994-4"></a>                        <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb994-5"><a href="#cb994-5"></a>                        <span class="dt">corstr =</span> <span class="st">&quot;AR-M&quot;</span>,</span>
<span id="cb994-6"><a href="#cb994-6"></a>                        <span class="dt">Mv =</span> <span class="dv">1</span>) </span></code></pre></div>
<pre><code>       (Intercept)           group2mg               time          I(time^2) 
          1.740051           0.333462           0.000475          -0.005176 
     group2mg:time group2mg:I(time^2) 
         -0.004097           0.001582 </code></pre>
<div class="sourceCode" id="cb996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb996-1"><a href="#cb996-1"></a><span class="kw">summary</span>(mod_gee_ar2)</span></code></pre></div>
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     AR-M , M = 1 

Call:
gee::gee(formula = count ~ group * time + group * I(time^2), 
    id = id, data = data_long, family = poisson(link = &quot;log&quot;), 
    corstr = &quot;AR-M&quot;, Mv = 1)

Summary of Residuals:
   Min     1Q Median     3Q    Max 
-7.527 -3.466 -0.779  2.266 27.576 


Coefficients:
                    Estimate Naive S.E. Naive z Robust S.E. Robust z
(Intercept)         1.722048    0.14876 11.5764     0.14094  12.2179
group2mg            0.256828    0.19147  1.3414     0.19142   1.3417
time                0.007745    0.06809  0.1137     0.05263   0.1472
I(time^2)          -0.005709    0.00675 -0.8456     0.00489  -1.1674
group2mg:time       0.024064    0.08661  0.2779     0.06720   0.3581
group2mg:I(time^2) -0.000299    0.00852 -0.0351     0.00612  -0.0489

Estimated Scale Parameter:  4.01
Number of Iterations:  3

Working Correlation
         [,1]    [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8]    [,9]
 [1,] 1.00000 0.53456 0.28575 0.1528 0.0817 0.0436 0.0233 0.0125 0.00667
 [2,] 0.53456 1.00000 0.53456 0.2858 0.1528 0.0817 0.0436 0.0233 0.01247
 [3,] 0.28575 0.53456 1.00000 0.5346 0.2858 0.1528 0.0817 0.0436 0.02333
 [4,] 0.15275 0.28575 0.53456 1.0000 0.5346 0.2858 0.1528 0.0817 0.04365
 [5,] 0.08166 0.15275 0.28575 0.5346 1.0000 0.5346 0.2858 0.1528 0.08166
 [6,] 0.04365 0.08166 0.15275 0.2858 0.5346 1.0000 0.5346 0.2858 0.15275
 [7,] 0.02333 0.04365 0.08166 0.1528 0.2858 0.5346 1.0000 0.5346 0.28575
 [8,] 0.01247 0.02333 0.04365 0.0817 0.1528 0.2858 0.5346 1.0000 0.53456
 [9,] 0.00667 0.01247 0.02333 0.0436 0.0817 0.1528 0.2858 0.5346 1.00000
[10,] 0.00356 0.00667 0.01247 0.0233 0.0436 0.0817 0.1528 0.2858 0.53456
[11,] 0.00191 0.00356 0.00667 0.0125 0.0233 0.0436 0.0817 0.1528 0.28575
        [,10]   [,11]
 [1,] 0.00356 0.00191
 [2,] 0.00667 0.00356
 [3,] 0.01247 0.00667
 [4,] 0.02333 0.01247
 [5,] 0.04365 0.02333
 [6,] 0.08166 0.04365
 [7,] 0.15275 0.08166
 [8,] 0.28575 0.15275
 [9,] 0.53456 0.28575
[10,] 1.00000 0.53456
[11,] 0.53456 1.00000</code></pre>
<div class="sourceCode" id="cb998"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb998-1"><a href="#cb998-1"></a>MuMIn<span class="op">::</span><span class="kw">QIC</span>(mod_gee_ar, </span>
<span id="cb998-2"><a href="#cb998-2"></a>           mod_gee_ar2, </span>
<span id="cb998-3"><a href="#cb998-3"></a>           <span class="dt">typeR =</span> <span class="ot">TRUE</span>)    <span class="co"># NOT the default</span></span></code></pre></div>
<pre><code>              QIC
mod_gee_ar  -6900
mod_gee_ar2 -6897</code></pre>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1000-1"><a href="#cb1000-1"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(<span class="kw">extract_gee_exp</span>(mod_gee_ar),</span>
<span id="cb1000-2"><a href="#cb1000-2"></a>                       <span class="kw">extract_gee_exp</span>(mod_gee_ar2)),</span>
<span id="cb1000-3"><a href="#cb1000-3"></a>                  <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1000-4"><a href="#cb1000-4"></a>                  <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>
=============================================================
                 Model 1                Model 2              
-------------------------------------------------------------
(Intercept)        5.27 [4.14; 6.69] *    5.60 [4.25; 7.38] *
group2mg           1.43 [1.09; 1.87] *    1.29 [0.89; 1.88]  
time               1.02 [0.96; 1.09]      1.01 [0.91; 1.12]  
time^2             0.99 [0.99; 1.00] *    0.99 [0.98; 1.00]  
group2mg:time                             1.02 [0.90; 1.17]  
group2mg:time^2                           1.00 [0.99; 1.01]  
-------------------------------------------------------------
Dispersion         4.01                   4.01               
Num. obs.        715                    715                  
=============================================================
* Null hypothesis value outside the confidence interval.</code></pre>
</div>
<div id="visualize-best-model" class="section level3" number="20.4.4">
<h3 number="20.4.4"><span class="header-section-number">20.4.4</span> Visualize Best Model</h3>
<div id="model-parameter-table-1" class="section level4" number="20.4.4.1">
<h4 number="20.4.4.1"><span class="header-section-number">20.4.4.1</span> Model Parameter Table</h4>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1002-1"><a href="#cb1002-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb1002-2"><a href="#cb1002-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb1002-3"><a href="#cb1002-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb1002-4"><a href="#cb1002-4"></a></span>
<span id="cb1002-5"><a href="#cb1002-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">extract_gee_exp</span>(mod_gee_ar),</span>
<span id="cb1002-6"><a href="#cb1002-6"></a>                <span class="dt">caption =</span> <span class="st">&quot;GEE: Final Model (auto regressive)&quot;</span>,</span>
<span id="cb1002-7"><a href="#cb1002-7"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1002-8"><a href="#cb1002-8"></a>                <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
GEE: Final Model (auto regressive)
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.27 [4.14; 6.69]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
group2mg
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.43 [1.09; 1.87]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.02 [0.96; 1.09]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.99 [0.99; 1.00]<sup>*</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Dispersion
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.01
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
715
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup>*</sup> 1 outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="refit-via-geepackgeeglm" class="section level4" number="20.4.4.2">
<h4 number="20.4.4.2"><span class="header-section-number">20.4.4.2</span> Refit via <code>geepack::geeglm()</code></h4>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1003-1"><a href="#cb1003-1"></a>mod_geeglm_ar &lt;-<span class="st"> </span>geepack<span class="op">::</span><span class="kw">geeglm</span>(count <span class="op">~</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb1003-2"><a href="#cb1003-2"></a>                       <span class="dt">id =</span> id,</span>
<span id="cb1003-3"><a href="#cb1003-3"></a>                       <span class="dt">data =</span> data_long,</span>
<span id="cb1003-4"><a href="#cb1003-4"></a>                       <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb1003-5"><a href="#cb1003-5"></a>                       <span class="dt">corstr =</span> <span class="st">&quot;ar1&quot;</span>)  </span>
<span id="cb1003-6"><a href="#cb1003-6"></a></span>
<span id="cb1003-7"><a href="#cb1003-7"></a><span class="kw">summary</span>(mod_geeglm_ar)</span></code></pre></div>
<pre><code>
Call:
geepack::geeglm(formula = count ~ group + time + I(time^2), family = poisson(link = &quot;log&quot;), 
    data = data_long, id = id, corstr = &quot;ar1&quot;)

 Coefficients:
            Estimate  Std.err   Wald Pr(&gt;|W|)    
(Intercept)  1.63046  0.12861 160.71   &lt;2e-16 ***
group2mg     0.34575  0.13880   6.21    0.013 *  
time         0.03588  0.03558   1.02    0.313    
I(time^2)   -0.00665  0.00321   4.31    0.038 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation structure = ar1 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)        4   0.435
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.775  0.0333
Number of clusters:   65  Maximum cluster size: 11 </code></pre>
</div>
<div id="predict-over-a-grid" class="section level4" number="20.4.4.3">
<h4 number="20.4.4.3"><span class="header-section-number">20.4.4.3</span> Predict over a Grid</h4>
<p>Estimated Marginal Mean Counts</p>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1005-1"><a href="#cb1005-1"></a><span class="kw">expand.grid</span>(<span class="dt">time =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,</span>
<span id="cb1005-2"><a href="#cb1005-2"></a>            <span class="dt">group =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>group)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1005-3"><a href="#cb1005-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(mod_geeglm_ar,</span>
<span id="cb1005-4"><a href="#cb1005-4"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb1005-5"><a href="#cb1005-5"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1005-6"><a href="#cb1005-6"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(<span class="dt">key =</span> group,</span>
<span id="cb1005-7"><a href="#cb1005-7"></a>                <span class="dt">value =</span> fit)</span></code></pre></div>
<pre><code>   time  1mg  2mg
1     0 5.11 7.22
2     1 5.26 7.43
3     2 5.34 7.55
4     3 5.36 7.57
5     4 5.30 7.49
6     5 5.17 7.31
7     6 4.98 7.04
8     7 4.74 6.69
9     8 4.44 6.28
10    9 4.11 5.81
11   10 3.76 5.31</code></pre>
</div>
<div id="plot-estimated-marginal-means" class="section level4" number="20.4.4.4">
<h4 number="20.4.4.4"><span class="header-section-number">20.4.4.4</span> Plot Estimated Marginal Means</h4>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="#cb1007-1"></a><span class="kw">expand.grid</span>(<span class="dt">time =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,</span>
<span id="cb1007-2"><a href="#cb1007-2"></a>            <span class="dt">group =</span> <span class="kw">levels</span>(data_long<span class="op">$</span>group)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1007-3"><a href="#cb1007-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(mod_geeglm_ar,</span>
<span id="cb1007-4"><a href="#cb1007-4"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb1007-5"><a href="#cb1007-5"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1007-6"><a href="#cb1007-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time,</span>
<span id="cb1007-7"><a href="#cb1007-7"></a>             <span class="dt">y =</span> fit,</span>
<span id="cb1007-8"><a href="#cb1007-8"></a>             <span class="dt">color =</span> <span class="kw">fct_rev</span>(group))) <span class="op">+</span></span>
<span id="cb1007-9"><a href="#cb1007-9"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb1007-10"><a href="#cb1007-10"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb1007-11"><a href="#cb1007-11"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb1007-12"><a href="#cb1007-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Four-week Intervals&quot;</span>,</span>
<span id="cb1007-13"><a href="#cb1007-13"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Populaton Mean Count&quot;</span>,</span>
<span id="cb1007-14"><a href="#cb1007-14"></a>       <span class="dt">color =</span> <span class="st">&quot;Dose&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1007-15"><a href="#cb1007-15"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-744-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="glmm-analysis-1" class="section level2" number="20.5">
<h2 number="20.5"><span class="header-section-number">20.5</span> GLMM Analysis</h2>
<div id="ri-random-intercepts-only" class="section level3" number="20.5.1">
<h3 number="20.5.1"><span class="header-section-number">20.5.1</span> RI: Random Intercepts Only</h3>
<div class="sourceCode" id="cb1008"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1008-1"><a href="#cb1008-1"></a>mod_glmer_ri &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(count <span class="op">~</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((time<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id),</span>
<span id="cb1008-2"><a href="#cb1008-2"></a>                            <span class="dt">data =</span> data_long,</span>
<span id="cb1008-3"><a href="#cb1008-3"></a>                            <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb1008-4"><a href="#cb1008-4"></a></span>
<span id="cb1008-5"><a href="#cb1008-5"></a><span class="kw">summary</span>(mod_glmer_ri)</span></code></pre></div>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: poisson  ( log )
Formula: count ~ group + I(time/4) + I((time/4)^2) + (1 | id)
   Data: data_long

     AIC      BIC   logLik deviance df.resid 
    4061     4083    -2025     4051      710 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.109 -1.092 -0.150  0.814  5.628 

Random effects:
 Groups Name        Variance Std.Dev.
 id     (Intercept) 0.283    0.532   
Number of obs: 715, groups:  id, 65

Fixed effects:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     1.6099     0.1062   15.15   &lt;2e-16 ***
group2mg        0.3110     0.1371    2.27    0.023 *  
I(time/4)      -0.0089     0.0706   -0.13    0.900    
I((time/4)^2)  -0.0667     0.0281   -2.37    0.018 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) grp2mg I(t/4)
group2mg    -0.700              
I(time/4)   -0.276  0.000       
I((tm/4)^2)  0.226  0.000 -0.960</code></pre>
</div>
<div id="rias-random-intercepts-and-slopes-1" class="section level3" number="20.5.2">
<h3 number="20.5.2"><span class="header-section-number">20.5.2</span> RIAS: Random Intercepts and Slopes</h3>
<div class="sourceCode" id="cb1010"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1010-1"><a href="#cb1010-1"></a>mod_glmer_rias &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(count <span class="op">~</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>((time<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="kw">I</span>(time<span class="op">/</span><span class="dv">4</span>)<span class="op">|</span>id),</span>
<span id="cb1010-2"><a href="#cb1010-2"></a>                              <span class="dt">data =</span> data_long,</span>
<span id="cb1010-3"><a href="#cb1010-3"></a>                              <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb1010-4"><a href="#cb1010-4"></a></span>
<span id="cb1010-5"><a href="#cb1010-5"></a><span class="kw">summary</span>(mod_glmer_rias)</span></code></pre></div>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: poisson  ( log )
Formula: count ~ group + I(time/4) + I((time/4)^2) + (I(time/4) | id)
   Data: data_long

     AIC      BIC   logLik deviance df.resid 
    3964     3996    -1975     3950      708 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.045 -0.927 -0.142  0.682  4.886 

Random effects:
 Groups Name        Variance Std.Dev. Corr 
 id     (Intercept) 0.3147   0.561         
        I(time/4)   0.0825   0.287    -0.36
Number of obs: 715, groups:  id, 65

Fixed effects:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     1.5993     0.1093   14.63   &lt;2e-16 ***
group2mg        0.3002     0.1360    2.21   0.0274 *  
I(time/4)       0.0452     0.0807    0.56   0.5751    
I((time/4)^2)  -0.1035     0.0286   -3.62   0.0003 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) grp2mg I(t/4)
group2mg    -0.679              
I(time/4)   -0.363  0.005       
I((tm/4)^2)  0.224  0.001 -0.848</code></pre>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1012-1"><a href="#cb1012-1"></a><span class="kw">anova</span>(mod_glmer_ri, mod_glmer_rias)</span></code></pre></div>
<pre><code>Data: data_long
Models:
mod_glmer_ri: count ~ group + I(time/4) + I((time/4)^2) + (1 | id)
mod_glmer_rias: count ~ group + I(time/4) + I((time/4)^2) + (I(time/4) | id)
               npar  AIC  BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
mod_glmer_ri      5 4061 4083  -2025     4051                        
mod_glmer_rias    7 3964 3996  -1975     3950   100  2     &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1014-1"><a href="#cb1014-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb1014-2"><a href="#cb1014-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb1014-3"><a href="#cb1014-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb1014-4"><a href="#cb1014-4"></a></span>
<span id="cb1014-5"><a href="#cb1014-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="kw">extract_glmer_exp</span>(mod_glmer_ri),</span>
<span id="cb1014-6"><a href="#cb1014-6"></a>                     <span class="kw">extract_glmer_exp</span>(mod_glmer_rias)),</span>
<span id="cb1014-7"><a href="#cb1014-7"></a>                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Intecepts&quot;</span>, <span class="st">&quot;Intercepts and Slopes&quot;</span>),</span>
<span id="cb1014-8"><a href="#cb1014-8"></a>                <span class="dt">caption =</span> <span class="st">&quot;GLMM: Compare Random Effects&quot;</span>,</span>
<span id="cb1014-9"><a href="#cb1014-9"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1014-10"><a href="#cb1014-10"></a>                <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
GLMM: Compare Random Effects
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Intecepts
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Intercepts and Slopes
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
5.00 [4.05; 6.17]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.95 [3.99; 6.15]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
group2mg
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.36 [1.04; 1.79]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.35 [1.03; 1.77]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time/4
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.99 [0.86; 1.14]
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.05 [0.89; 1.23]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
(time/4)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.94 [0.88; 0.99]<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90 [0.85; 0.95]<sup>*</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4060.58
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3964.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4083.44
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3996.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2025.29
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1975.07
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
715
</td>
<td style="padding-left: 5px;padding-right: 5px;">
715
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
65
</td>
<td style="padding-left: 5px;padding-right: 5px;">
65
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.28
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.31
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id I(time/4)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.08
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id (Intercept) I(time/4)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="3">
<sup>*</sup> Null hypothesis value outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="rais-add-interaction" class="section level3" number="20.5.3">
<h3 number="20.5.3"><span class="header-section-number">20.5.3</span> RAIS: Add Interaction</h3>
<p>See the <a href="https://cehs-research.github.io/eBook_multilevel/glmm-binary-outcome-antibiotics-for-leprosy.html#glmm---optimizers">GLMM - Optimizers page</a> for more information on convergence problems.</p>
<div class="sourceCode" id="cb1015"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1015-1"><a href="#cb1015-1"></a>mod_glmer_rias2 &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(count <span class="op">~</span><span class="st"> </span>group<span class="op">*</span><span class="kw">I</span>(time<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span><span class="st"> </span>group<span class="op">*</span><span class="kw">I</span>((time<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>( <span class="kw">I</span>(time<span class="op">/</span><span class="dv">4</span>)<span class="op">|</span>id ),</span>
<span id="cb1015-2"><a href="#cb1015-2"></a>                              <span class="dt">data =</span> data_long,</span>
<span id="cb1015-3"><a href="#cb1015-3"></a>                              <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">optimizer =</span><span class="st">&quot;Nelder_Mead&quot;</span>),  <span class="co"># convergence issues resolved</span></span>
<span id="cb1015-4"><a href="#cb1015-4"></a>                              <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>))   </span></code></pre></div>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="#cb1016-1"></a><span class="kw">anova</span>(mod_glmer_rias, mod_glmer_rias2)</span></code></pre></div>
<pre><code>Data: data_long
Models:
mod_glmer_rias: count ~ group + I(time/4) + I((time/4)^2) + (I(time/4) | id)
mod_glmer_rias2: count ~ group * I(time/4) + group * I((time/4)^2) + (I(time/4) | 
mod_glmer_rias2:     id)
                npar  AIC  BIC logLik deviance Chisq Df Pr(&gt;Chisq)
mod_glmer_rias     7 3964 3996  -1975     3950                    
mod_glmer_rias2    9 3968 4009  -1975     3950  0.14  2       0.93</code></pre>
</div>
<div id="visualize-best-model-1" class="section level3" number="20.5.4">
<h3 number="20.5.4"><span class="header-section-number">20.5.4</span> Visualize Best Model</h3>
<div id="model-parameter-table-2" class="section level4" number="20.5.4.1">
<h4 number="20.5.4.1"><span class="header-section-number">20.5.4.1</span> Model Parameter Table</h4>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="#cb1018-1"></a><span class="co"># Knit to Website: texreg::htmlreg()</span></span>
<span id="cb1018-2"><a href="#cb1018-2"></a><span class="co"># Knit to PDF:     texreg::texreg()</span></span>
<span id="cb1018-3"><a href="#cb1018-3"></a><span class="co"># View on Screen:  texreg::screenreg()</span></span>
<span id="cb1018-4"><a href="#cb1018-4"></a></span>
<span id="cb1018-5"><a href="#cb1018-5"></a>texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="kw">extract_glmer_exp</span>(mod_glmer_rias)),</span>
<span id="cb1018-6"><a href="#cb1018-6"></a>                <span class="dt">caption =</span> <span class="st">&quot;GLMM: Final Model&quot;</span>,</span>
<span id="cb1018-7"><a href="#cb1018-7"></a>                <span class="dt">single.row =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1018-8"><a href="#cb1018-8"></a>                <span class="dt">ci.test =</span> <span class="dv">1</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
GLMM: Final Model
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4.95 [3.99; 6.15]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
group2mg
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.35 [1.03; 1.77]<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
time/4
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.05 [0.89; 1.23]
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
(time/4)^2
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.90 [0.85; 0.95]<sup>*</sup>
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3964.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
3996.15
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1975.07
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
715
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. groups: id
</td>
<td style="padding-left: 5px;padding-right: 5px;">
65
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id (Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.31
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Var: id I(time/4)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.08
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Cov: id (Intercept) I(time/4)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup>*</sup> 1 outside the confidence interval.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="estimated-marginal-means" class="section level4" number="20.5.4.2">
<h4 number="20.5.4.2"><span class="header-section-number">20.5.4.2</span> Estimated Marginal Means</h4>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1019-1"><a href="#cb1019-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb1019-2"><a href="#cb1019-2"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">time =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>),</span>
<span id="cb1019-3"><a href="#cb1019-3"></a>                <span class="dt">mod =</span> mod_glmer_rias) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1019-4"><a href="#cb1019-4"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1019-5"><a href="#cb1019-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(group, time, fit) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1019-6"><a href="#cb1019-6"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(<span class="dt">key =</span> group,</span>
<span id="cb1019-7"><a href="#cb1019-7"></a>                <span class="dt">value =</span> fit,</span>
<span id="cb1019-8"><a href="#cb1019-8"></a>                <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<pre><code>   time group_1mg group_2mg
1     0      4.95      6.68
2     1      4.97      6.71
3     2      4.93      6.66
4     3      4.83      6.52
5     4      4.67      6.30
6     5      4.46      6.02
7     6      4.20      5.67
8     7      3.90      5.27
9     8      3.58      4.84
10    9      3.25      4.38
11   10      2.90      3.92</code></pre>
</div>
<div id="plot-estimated-marginal-means-1" class="section level4" number="20.5.4.3">
<h4 number="20.5.4.3"><span class="header-section-number">20.5.4.3</span> Plot Estimated Marginal Means</h4>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1021-1"><a href="#cb1021-1"></a>effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb1021-2"><a href="#cb1021-2"></a>                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">time =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">.25</span>)),</span>
<span id="cb1021-3"><a href="#cb1021-3"></a>                <span class="dt">mod =</span> mod_glmer_rias) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1021-4"><a href="#cb1021-4"></a><span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1021-5"><a href="#cb1021-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time,</span>
<span id="cb1021-6"><a href="#cb1021-6"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb1021-7"><a href="#cb1021-7"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> fit <span class="op">-</span><span class="st"> </span>se,</span>
<span id="cb1021-8"><a href="#cb1021-8"></a>                  <span class="dt">ymax =</span> fit <span class="op">+</span><span class="st"> </span>se,</span>
<span id="cb1021-9"><a href="#cb1021-9"></a>                  <span class="dt">fill =</span> group),</span>
<span id="cb1021-10"><a href="#cb1021-10"></a>              <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb1021-11"><a href="#cb1021-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> group)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1021-12"><a href="#cb1021-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb1021-13"><a href="#cb1021-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Four-week Intervals&quot;</span>,</span>
<span id="cb1021-14"><a href="#cb1021-14"></a>       <span class="dt">y =</span> <span class="st">&quot;Estimated Populaton Mean Count&quot;</span>,</span>
<span id="cb1021-15"><a href="#cb1021-15"></a>       <span class="dt">color =</span> <span class="st">&quot;Dose&quot;</span>,</span>
<span id="cb1021-16"><a href="#cb1021-16"></a>       <span class="dt">fill =</span> <span class="st">&quot;Dose&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1021-17"><a href="#cb1021-17"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-755-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1022-1"><a href="#cb1022-1"></a>data_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1022-2"><a href="#cb1022-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">predict</span>(mod_glmer_rias,</span>
<span id="cb1022-3"><a href="#cb1022-3"></a>                              <span class="dt">newdata =</span> .,</span>
<span id="cb1022-4"><a href="#cb1022-4"></a>                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1022-5"><a href="#cb1022-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, </span>
<span id="cb1022-6"><a href="#cb1022-6"></a>             <span class="dt">y =</span> fit)) <span class="op">+</span></span>
<span id="cb1022-7"><a href="#cb1022-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb1022-8"><a href="#cb1022-8"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>group) <span class="op">+</span></span>
<span id="cb1022-9"><a href="#cb1022-9"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="eBook_multilevel_files/figure-html/unnamed-chunk-756-1.png" width="576" style="display: block; margin: auto;" /></p>
<!--chapter:end:80_example_glmm_colus.Rmd-->
</div>
</div>
</div>
</div>
<div id="sample-size-and-power" class="section level1" number="21">
<h1 number="21"><span class="header-section-number">21</span> Sample Size and Power</h1>
<div id="key-publications" class="section level2" number="21.1">
<h2 number="21.1"><span class="header-section-number">21.1</span> Key Publications</h2>
<p>Start here, its short:</p>
<ul>
<li>Snijders TAB (2005). <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/0470013192.bsa492">Power and Sample Size in Multilevel Linear Models.</a> In: Everitt BS, Howell DC (Hrsg.). <em>Encyclopedia of Statistics in Behavioral Science.</em> Chichester, UK: John Wiley and Sons, Ltd. doi: 10.1002/0470013192.bsa492</li>
</ul>
<p>This paper includes some nice power curves for reference:</p>
<ul>
<li>Scherbaum, C. A., &amp; Ferreter, J. M. (2009). <a href="https://journals.sagepub.com/doi/pdf/10.1177/1094428107308906">Estimating statistical power and required sample sizes for organizational research using multilevel modeling.</a> <em>Organizational Research Methods</em>, 12(2), 347-367.</li>
</ul>
<p>This paper tabulated the effect of number of clusters, size of cluser, and ICC:</p>
<ul>
<li>Maas, C. J., &amp; Hox, J. J. (2005). <a href="http://www.joophox.net/publist/methodology05.pdf">Sufficient Sample Sizes for Multilevel Modeling.</a> Methodology, 1(3), 86-92.</li>
</ul>
<p>This paper focuses on binary outcomes in hierarchical or clustered strkucture:</p>
<ul>
<li>Moineddin R, Matheson FI, Glazier RH. (2007). <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1955447/">A simulation study of sample size for multilevel logistic regression models.</a> <em>BMC medical research methodology</em>, 7, 34. <a href="doi:10.1186/1471-2288-7-34" class="uri">doi:10.1186/1471-2288-7-34</a></li>
</ul>
<p>This paper presents a data simulation method for estimating power for commonly used relationships research designs (via MPlus) and includes two worked examples from relationships research.</p>
<ul>
<li>Lane, S. P., &amp; Hennes, E. P. (2018). <a href="https://journals.sagepub.com/doi/full/10.1177/0265407517710342">Power struggles: Estimating sample size for multilevel relationships research.</a> <em>Journal of Social and Personal Relationships</em>, 35(1), 7-31.</li>
</ul>
<p>This paper is very clean and organized with clear notation, tables, and figures. It investigates the performance of random effect binary outcome multilevel models under varying methods of estimation, level-1 and level-2 sample size, outcome prevalence, variance component sizes, and number of predictors using SAS software</p>
<ul>
<li>Schoeneberger, J. A. (2016). <a href="https://www.tandfonline.com/doi/full/10.1080/00220973.2015.1027805">The impact of sample size and other factors when estimating multilevel logistic models.</a> <em>The Journal of Experimental Education</em>, 84(2), 373-397.</li>
</ul>
<p>This paper’s focus is three level models:</p>
<ul>
<li>Kerkhoff, D., &amp; Nussbeck, F. W. (2019). <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6536630/">The influence of sample size on parameter estimates in three-level random-effects models.</a> <em>Frontiers in psychology</em>, 10.</li>
</ul>
</div>
<div id="r-packages" class="section level2" number="21.2">
<h2 number="21.2"><span class="header-section-number">21.2</span> R packages</h2>
<div id="powerlmm" class="section level3" number="21.2.1">
<h3 number="21.2.1"><span class="header-section-number">21.2.1</span> powerlmm</h3>
<p><a href="https://github.com/rpsychologist/powerlmm"><strong><code>powerlmm</code></strong> package</a> described in:</p>
<ul>
<li>Raudenbush, S. W., and L. Xiao-Feng (2001). <a href="https://cpb-us-w2.wpmucdn.com/voices.uchicago.edu/dist/6/1063/files/2018/11/EffectsStudyDuration2001-R-1oqnhmw.pdf">“Effects of Study Duration, Frequency of Observation, and Sample Size on Power in Studies of Group Differences in Polynomial Change.”</a> <em>Psychological Methods</em> 6 (4): 387–401.</li>
</ul>
<p>Kristoffer Magnusson has posted an examle walk-through called <a href="https://cran.r-project.org/web/packages/powerlmm/vignettes/two-level.html">Power Analysis for Two-level Longitudinal Models with Missing Data</a></p>
<p>You can also access an interactive <code>shiny</code> interfaces with the following code (once you install the package in R):</p>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1023-1"><a href="#cb1023-1"></a><span class="kw">library</span>(powerlmm)</span>
<span id="cb1023-2"><a href="#cb1023-2"></a><span class="kw">shiny_powerlmm</span>()</span></code></pre></div>
</div>
<div id="simr" class="section level3" number="21.2.2">
<h3 number="21.2.2"><span class="header-section-number">21.2.2</span> simr</h3>
<p><a href="https://github.com/pitakakariki/simr"><strong><code>simr</code></strong> package</a> computed power analysis for generalised linear mixed models (GLMMs) by Monte Carlo simulation and is designed to work with models fit using the ‘lme4’ package.</p>
<p>It includes tools for:</p>
<ul>
<li>running a power analysis for a given model and design; and<br />
</li>
<li>calculating power curves to assess trade‐offs between power and sample size</li>
</ul>
<p>The paper below presents a tutorial using a simple example of count data with mixed effects (with structure representative of environmental monitoring data) to guide the user along a gentle learning curve, adding only a few commands or options at a time.</p>
<ul>
<li>Green, P., &amp; MacLeod, C. J. (2016). <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12504">SIMR: an R package for power analysis of generalized linear mixed models by simulation.</a> <em>Methods in Ecology and Evolution,</em> 7(4), 493-498.</li>
</ul>
</div>
<div id="sjstatssmpsize_lmm" class="section level3" number="21.2.3">
<h3 number="21.2.3"><span class="header-section-number">21.2.3</span> sjstats::smpsize_lmm()</h3>
<blockquote>
<p>Note: this is for ‘standard designs’ and is very simple</p>
</blockquote>
<p><a href=""><strong><code>sjstats::smpsize_lmm()</code></strong></a> compute an approximated sample size for linear mixed models (two-level-designs), based on power-calculation for standard design and adjusted for design effect for 2-level-designs.</p>
<ul>
<li><p>Cohen J. (1988). Statistical power analysis for the behavioral sciences (2nd ed.). Hillsdale,NJ: Lawrence Erlbaum.</p></li>
<li><p>Hsieh FY, Lavori PW, Cohen HJ, Feussner JR (2003). <a href="https://journals.sagepub.com/doi/10.1177/0163278703255230">An Overview of Variance Inflation Factors for Sample-Size Calculation.</a> <em>Evaluation and the Health Professions</em> 26: 239-257.</p></li>
<li><p>Snijders TAB (2005). <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/0470013192.bsa492">Power and Sample Size in Multilevel Linear Models.</a> In: Everitt BS, Howell DC (Hrsg.). <em>Encyclopedia of Statistics in Behavioral Science.</em> Chichester, UK: John Wiley and Sons, Ltd. doi: 10.1002/0470013192.bsa492</p></li>
</ul>
</div>
<div id="mlpowsim" class="section level3" number="21.2.4">
<h3 number="21.2.4"><span class="header-section-number">21.2.4</span> MLPowSim</h3>
<p><a href="http://www.bristol.ac.uk/cmm/software/mlpowsim/"><strong>MLPowSim</strong></a> is a free-download that guides you through questions and then writes R Syntax for you based on your responses.</p>
</div>
</div>
<div id="online-interactive-interfaces" class="section level2" number="21.3">
<h2 number="21.3"><span class="header-section-number">21.3</span> Online Interactive Interfaces</h2>
<p>No, G*Power won’t help you with this.</p>
<div id="glimmpse" class="section level3" number="21.3.1">
<h3 number="21.3.1"><span class="header-section-number">21.3.1</span> GLIMMPSE</h3>
<p><a href="https://glimmpse.samplesizeshop.org/#/"><strong>GLIMMPSE 2.0</strong></a> from the University of Colorado Denver, School of Public Health (NIH)</p>
<ul>
<li><p><a href="https://samplesizeshop.org/files/2012/08/Easy-Power-and-Sample-Size-for-Most-of-the-Mixed-Models-You-Will-Ever-See.pdf">Sample Size Shop Website</a></p></li>
<li><p><a href="https://samplesizeshop.org/files/2013/09/MixedModelPowerAnalysisByExampleTalk.pdf">Slides</a> two examples start on slide 62</p></li>
</ul>
</div>
<div id="webpower" class="section level3" number="21.3.2">
<h3 number="21.3.2"><span class="header-section-number">21.3.2</span> WebPower</h3>
<p><a href="https://webpower.psychstat.org/wiki/"><strong><code>WebPower</code></strong> Statistical Power Analysis Online</a> or <a href="http://psychstat.org/crt2arm" class="uri">http://psychstat.org/crt2arm</a></p>
<ul>
<li><a href="https://webpower.psychstat.org/wiki/_media/manual/multilevel_power_by_yang.pdf">Miao (“Michelle”) Yang, Mar 2015</a></li>
</ul>
</div>
</div>
<div id="stand-alone-computer-programs" class="section level2" number="21.4">
<h2 number="21.4"><span class="header-section-number">21.4</span> Stand-alone Computer Programs</h2>
<div id="optimal-design" class="section level3" number="21.4.1">
<h3 number="21.4.1"><span class="header-section-number">21.4.1</span> Optimal Design</h3>
<blockquote>
<p>Note: Works on Windows but not Mac OS.</p>
</blockquote>
<p><a href="http://www.ssicentral.com/other/hlmod.htm%20."><strong>Optimal Design</strong></a> was created by Steve Raudenbush and colleagues.</p>
<p>THis program estimates power using the intraclass correlation, effect size, a level, and sample sizes for cluster-randomized, multisite, and repeated measures designs.</p>
<p>The user can manipulate one factor at a time to examine the impact on power.</p>
<p>All results are presented graphically as power curves, which is helpful for understanding how power could be affected by particular changes in sample sizes, effect sizes, and intraclass correlations.</p>
<p>The program is user friendly and comes with extensive documentation.</p>
<ul>
<li><p>Raudenbush, S.W. (1997). <a href="https://pdfs.semanticscholar.org/a52e/386ad46433111e2c5c9258fc1a7acd171396.pdf">Statistical analysis and optimal design for cluster randomized trials.</a> <em>Psychological Methods</em>, 2: 173–185.</p></li>
<li><p>Raudenbush, S.W., &amp; Liu, X.-F. (2000). <a href="https://pdfs.semanticscholar.org/8d07/69bfee93488fa48da450e418959e841ef396.pdf">Statistical power and optimal design for multisite randomized trials.</a> <em>Psychological Methods</em>, 5: 199–213.</p></li>
<li><p>Raudenbush, S.W., &amp; Liu, Xiao-Feng. (2001). <a href="https://cpb-us-w2.wpmucdn.com/voices.uchicago.edu/dist/6/1063/files/2018/11/EffectsStudyDuration2001-R-1oqnhmw.pdf">Effects of study duration, frequency of observation, and sample size on power in studies of group differences in polynomial change.</a> <em>Psychological Methods</em>, 6: 387–401.</p></li>
</ul>
</div>
<div id="pint" class="section level3" number="21.4.2">
<h3 number="21.4.2"><span class="header-section-number">21.4.2</span> PinT</h3>
<p><a href="http://stat.gamma.rug.nl/snijders/multilevel.htm%20."><strong>PinT</strong>: <em>Power in Two-levels</em></a> was created by Tom Snijders, Roel Bosker, and Henk Guldemond.</p>
<p>This is the oldest program, but it can be used to estimate the standard errors of simple fixed effects and cross-level interactions. It can provide standard error estimates for a variety of complex models.</p>
<ul>
<li><p>The <strong>major difficulty</strong> in using this program is that it requires the user to input the means, variances, and covariances for all explanatory variables and the variance and covariance for the random effects.</p></li>
<li><p>The <strong>major advantage</strong> is that an extensive user manual is available and the formulas used by the program are presented in Snijders and Bosker (1993). This program is recommended for models that include several Level 1 or Level 2 variables.</p></li>
<li><p>Snijders, T.A.B. &amp; Bosker, R.J. (1993). <a href="https://journals.sagepub.com/doi/pdf/10.3102/10769986018003237">Standard errors and sample sizes for two-level research.</a> <em>Journal of Educational Statistics</em>, 18: 237–259.</p></li>
</ul>
</div>
<div id="rmass2" class="section level3" number="21.4.3">
<h3 number="21.4.3"><span class="header-section-number">21.4.3</span> RMASS2</h3>
<p><a href="http://tigger.uic.edu/%20hedeker/works.html"><strong>RMASS2</strong></a> calculates the sample size for a two-group repeated measures design, allowing for attrition, according to:</p>
<ul>
<li>Hedeker, D., Gibbons, R.D., &amp; Waternaux, C. (1999). <a href="https://journals.sagepub.com/doi/pdf/10.3102/10769986024001070">Sample size estimation for longitudinal designs with attrition: comparing time-related contrasts between two groups.</a> <em>Journal of Educational and Behavioral Statistics</em>, 24:70–93.</li>
</ul>
</div>
<div id="acluster" class="section level3" number="21.4.4">
<h3 number="21.4.4"><span class="header-section-number">21.4.4</span> ACluster</h3>
<p><a href="www.update-software.com/Acluster"><strong>ACluster</strong></a> calculates required sample sizes for various types of cluster randomized designs, not only for continuous but also for binary and time-to-event outcomes, as described in:</p>
<ul>
<li>Donner, A., &amp; Klar, N. (2000). <a href="https://www.researchgate.net/profile/Michel_Lavoie/publication/11942928_The_storage_of_household_long_guns_The_situation_in_Quebec/links/54cabb8e0cf2517b756002eb.pdf#page=32">Design and Analysis of Cluster Randomization Trials in Health Research.</a> London: Arnold.</li>
</ul>
<!--chapter:end:90_power.Rmd-->
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered" number="">
<h1 class="unnumbered" number="">References</h1>
<!--chapter:end:99-refs.Rmd-->
<div id="refs" class="references hanging-indent">
<div id="ref-anderson2007">
<p>Anderson, Deborah K, Catherine Lord, Susan Risi, Pamela S DiLavore, Cory Shulman, Audrey Thurm, Kathleen Welch, and Andrew Pickles. 2007. “Patterns of Growth in Verbal Abilities Among Children with Autism Spectrum Disorder.” <em>Journal of Consulting and Clinical Psychology</em> 75 (4): 594.</p>
</div>
<div id="ref-anderson2009">
<p>Anderson, Deborah K, Rosalind S Oti, Catherine Lord, and Kathleen Welch. 2009. “Patterns of Growth in Adaptive Social Abilities Among Children with Autism Spectrum Disorders.” <em>Journal of Abnormal Child Psychology</em> 37 (7): 1019–34.</p>
</div>
<div id="ref-finch2016">
<p>Finch, W Holmes, Jocelyn E Bolin, and Ken Kelley. 2016. <em>Multilevel Modeling Using R</em>. Crc Press.</p>
</div>
<div id="ref-gelman2008">
<p>Gelman, Andrew. 2008. “Scaling Regression Inputs by Dividing by Two Standard Deviations.” <em>Statistics in Medicine</em> 27 (15): 2865–73.</p>
</div>
<div id="ref-hedeker2006">
<p>Hedeker, Donald, and Robert D Gibbons. 2006. <em>Longitudinal Data Analysis</em>. Vol. 451. John Wiley &amp; Sons.</p>
</div>
<div id="ref-R-stargazer">
<p>Hlavac, Marek. 2018. <em>Stargazer: Well-Formatted Regression and Summary Statistics Tables</em>. <a href="https://CRAN.R-project.org/package=stargazer">https://CRAN.R-project.org/package=stargazer</a>.</p>
</div>
<div id="ref-hox2017">
<p>Hox, Joop J, Mirjam Moerbeek, and Rens Van de Schoot. 2017. <em>Multilevel Analysis: Techniques and Applications</em>. 3rd ed. Routledge.</p>
</div>
<div id="ref-nakagawa2013">
<p>Nakagawa, Shinichi, and Holger Schielzeth. 2013. “A General and Simple Method for Obtaining R2 from Generalized Linear Mixed-Effects Models.” <em>Methods in Ecology and Evolution</em> 4 (2): 133–42.</p>
</div>
<div id="ref-reisby1977">
<p>Reisby, Niels, Lars F Gram, Per Bech, Adam Nagy, Gorm Odden Petersen, Jørgen Ortmann, Ilse Ibsen, et al. 1977. “Imipramine: Clinical Effects and Pharmacokinetic Variability.” <em>Psychopharmacology</em> 54 (3): 263–72.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2020. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
