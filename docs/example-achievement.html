<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models</title>
  <meta name="description" content="RM Regression: ICCs, MLM/HLM, and GEEs.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="EQM_v1_cover.png" />
  <meta property="og:description" content="RM Regression: ICCs, MLM/HLM, and GEEs." />
  <meta name="github-repo" content="cehs-research/eBook_wrangle" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models" />
  
  <meta name="twitter:description" content="RM Regression: ICCs, MLM/HLM, and GEEs." />
  <meta name="twitter:image" content="EQM_v1_cover.png" />

<meta name="author" content="Sarah Schwartz &amp; Tyson Barrett">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="example-nurses-stress-intervention.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Vol. 5: Multilevel Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#blocked-notes"><i class="fa fa-check"></i>Blocked Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#code-and-output"><i class="fa fa-check"></i>Code and Output</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The Authors</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-choose-r"><i class="fa fa-check"></i>Why choose R ?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#fyi"><i class="fa fa-check"></i>FYI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i><b>1</b> Notation</a><ul>
<li class="chapter" data-level="1.1" data-path="notation.html"><a href="notation.html#data"><i class="fa fa-check"></i><b>1.1</b> Data</a></li>
<li class="chapter" data-level="1.2" data-path="notation.html"><a href="notation.html#single-level-regression-analysis"><i class="fa fa-check"></i><b>1.2</b> Single-level Regression Analysis</a><ul>
<li class="chapter" data-level="1.2.1" data-path="notation.html"><a href="notation.html#the-only-equation"><i class="fa fa-check"></i><b>1.2.1</b> The Only Equation</a></li>
<li class="chapter" data-level="1.2.2" data-path="notation.html"><a href="notation.html#parameters"><i class="fa fa-check"></i><b>1.2.2</b> Parameters</a></li>
<li class="chapter" data-level="1.2.3" data-path="notation.html"><a href="notation.html#assumptions-to-check"><i class="fa fa-check"></i><b>1.2.3</b> Assumptions to Check</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="notation.html"><a href="notation.html#multi-level-regression-analysis"><i class="fa fa-check"></i><b>1.3</b> Multi-level Regression Analysis</a><ul>
<li class="chapter" data-level="1.3.1" data-path="notation.html"><a href="notation.html#level-1-regression-equation"><i class="fa fa-check"></i><b>1.3.1</b> Level 1 Regression Equation*</a></li>
<li class="chapter" data-level="1.3.2" data-path="notation.html"><a href="notation.html#level-2-regression-equations"><i class="fa fa-check"></i><b>1.3.2</b> Level 2 Regression Equations</a></li>
<li class="chapter" data-level="1.3.3" data-path="notation.html"><a href="notation.html#combinded-multilevel-regression-equation"><i class="fa fa-check"></i><b>1.3.3</b> Combinded, Multilevel Regression Equation</a></li>
<li class="chapter" data-level="1.3.4" data-path="notation.html"><a href="notation.html#parameters-1"><i class="fa fa-check"></i><b>1.3.4</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="notation.html"><a href="notation.html#intraclass-correlation-icc"><i class="fa fa-check"></i><b>1.4</b> Intraclass Correlation (ICC)</a></li>
<li class="chapter" data-level="1.5" data-path="notation.html"><a href="notation.html#proporion-of-variance-explianed"><i class="fa fa-check"></i><b>1.5</b> Proporion of Variance Explianed</a><ul>
<li class="chapter" data-level="1.5.1" data-path="notation.html"><a href="notation.html#level-1-variance-explained"><i class="fa fa-check"></i><b>1.5.1</b> Level 1 Variance Explained</a></li>
<li class="chapter" data-level="1.5.2" data-path="notation.html"><a href="notation.html#level-2-variance-explined"><i class="fa fa-check"></i><b>1.5.2</b> Level 2 Variance Explined</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="notation.html"><a href="notation.html#using-latex-for-equation-typesetting"><i class="fa fa-check"></i><b>1.6</b> Using <span class="math inline">\(\LaTeX\)</span> for Equation Typesetting</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html"><i class="fa fa-check"></i><b>2</b> Example - Pupil Popularity</a><ul>
<li class="chapter" data-level="2.1" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a><ul>
<li class="chapter" data-level="2.1.1" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#unique-identifiers"><i class="fa fa-check"></i><b>2.1.1</b> Unique Identifiers</a></li>
<li class="chapter" data-level="2.1.2" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#structure-and-variables"><i class="fa fa-check"></i><b>2.1.2</b> Structure and variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>2.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#summarize-descriptive-statistics"><i class="fa fa-check"></i><b>2.2.1</b> Summarize Descriptive Statistics</a></li>
<li class="chapter" data-level="2.2.2" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#visualizations-of-raw-data"><i class="fa fa-check"></i><b>2.2.2</b> Visualizations of Raw Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#consider-clustering"><i class="fa fa-check"></i><b>2.2.3</b> Consider Clustering</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#single-level-regression-analysis-1"><i class="fa fa-check"></i><b>2.3</b> Single-level Regression Analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#null-model"><i class="fa fa-check"></i><b>2.3.1</b> Null Model</a></li>
<li class="chapter" data-level="2.3.2" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#add-predictors-to-the-model"><i class="fa fa-check"></i><b>2.3.2</b> Add Predictors to the Model</a></li>
<li class="chapter" data-level="2.3.3" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#compare-fixed-effects"><i class="fa fa-check"></i><b>2.3.3</b> Compare Fixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#multi-level-regression-analysis-1"><i class="fa fa-check"></i><b>2.4</b> Multi-level Regression Analysis</a><ul>
<li class="chapter" data-level="2.4.1" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#intercept-only-or-null-model"><i class="fa fa-check"></i><b>2.4.1</b> Intercept-only or Null Model</a></li>
<li class="chapter" data-level="2.4.2" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#intraclass-correlation-icc-1"><i class="fa fa-check"></i><b>2.4.2</b> Intraclass Correlation (ICC)</a></li>
<li class="chapter" data-level="2.4.3" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#add-predictors-to-the-model-1"><i class="fa fa-check"></i><b>2.4.3</b> Add Predictors to the Model</a></li>
<li class="chapter" data-level="2.4.4" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#testing-random-components"><i class="fa fa-check"></i><b>2.4.4</b> Testing Random Components</a></li>
<li class="chapter" data-level="2.4.5" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#testing-cross-level-interactions"><i class="fa fa-check"></i><b>2.4.5</b> Testing Cross-Level Interactions</a></li>
<li class="chapter" data-level="2.4.6" data-path="example-pupil-popularity.html"><a href="example-pupil-popularity.html#final-model"><i class="fa fa-check"></i><b>2.4.6</b> Final Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html"><i class="fa fa-check"></i><b>3</b> Example - Nurse’s Stress Intervention</a><ul>
<li class="chapter" data-level="3.1" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#background-1"><i class="fa fa-check"></i><b>3.1</b> Background</a><ul>
<li class="chapter" data-level="3.1.1" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#unique-identifiers-1"><i class="fa fa-check"></i><b>3.1.1</b> Unique Identifiers</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#exploratory-data-analysis-1"><i class="fa fa-check"></i><b>3.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="3.2.1" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#summarize-descriptive-statistics-1"><i class="fa fa-check"></i><b>3.2.1</b> Summarize Descriptive Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#mlm-intercept-only-or-null-model"><i class="fa fa-check"></i><b>3.3</b> MLM: Intercept-only or Null Model</a></li>
<li class="chapter" data-level="3.4" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#estimate-the-icc"><i class="fa fa-check"></i><b>3.4</b> Estimate the ICC</a></li>
<li class="chapter" data-level="3.5" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#mlm-add-fixed-effects"><i class="fa fa-check"></i><b>3.5</b> MLM: Add Fixed Effects</a><ul>
<li class="chapter" data-level="3.5.1" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#fit-the-model-5"><i class="fa fa-check"></i><b>3.5.1</b> Fit the Model</a></li>
<li class="chapter" data-level="3.5.2" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#assess-significance"><i class="fa fa-check"></i><b>3.5.2</b> Assess Significance</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#mlm-add-random-slope"><i class="fa fa-check"></i><b>3.6</b> MLM: Add Random Slope</a><ul>
<li class="chapter" data-level="3.6.1" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#fit-the-model-6"><i class="fa fa-check"></i><b>3.6.1</b> Fit the Model</a></li>
<li class="chapter" data-level="3.6.2" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#assess-significance-1"><i class="fa fa-check"></i><b>3.6.2</b> Assess Significance</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#mlm-add-cross-level-interaction"><i class="fa fa-check"></i><b>3.7</b> MLM: Add Cross-Level Interaction</a><ul>
<li class="chapter" data-level="3.7.1" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#fit-the-model-7"><i class="fa fa-check"></i><b>3.7.1</b> Fit the Model</a></li>
<li class="chapter" data-level="3.7.2" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#assess-significance-2"><i class="fa fa-check"></i><b>3.7.2</b> Assess Significance</a></li>
<li class="chapter" data-level="3.7.3" data-path="example-nurses-stress-intervention.html"><a href="example-nurses-stress-intervention.html#final-model-1"><i class="fa fa-check"></i><b>3.7.3</b> Final Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="example-achievement.html"><a href="example-achievement.html"><i class="fa fa-check"></i><b>4</b> Example - Achievement</a><ul>
<li class="chapter" data-level="4.1" data-path="example-achievement.html"><a href="example-achievement.html#background-2"><i class="fa fa-check"></i><b>4.1</b> Background</a><ul>
<li class="chapter" data-level="4.1.1" data-path="example-achievement.html"><a href="example-achievement.html#sample-structure"><i class="fa fa-check"></i><b>4.1.1</b> Sample Structure</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="example-achievement.html"><a href="example-achievement.html#exploratory-data-analysis-2"><i class="fa fa-check"></i><b>4.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="4.2.1" data-path="example-achievement.html"><a href="example-achievement.html#summarize-descriptive-statistics-2"><i class="fa fa-check"></i><b>4.2.1</b> Summarize Descriptive Statistics</a></li>
<li class="chapter" data-level="4.2.2" data-path="example-achievement.html"><a href="example-achievement.html#visualization-of-raw-data"><i class="fa fa-check"></i><b>4.2.2</b> Visualization of Raw Data</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="example-achievement.html"><a href="example-achievement.html#single-level-regression"><i class="fa fa-check"></i><b>4.3</b> Single-Level Regression</a><ul>
<li class="chapter" data-level="4.3.1" data-path="example-achievement.html"><a href="example-achievement.html#fit-nested-models-2"><i class="fa fa-check"></i><b>4.3.1</b> Fit Nested Models</a></li>
<li class="chapter" data-level="4.3.2" data-path="example-achievement.html"><a href="example-achievement.html#visualize-the-interaction"><i class="fa fa-check"></i><b>4.3.2</b> Visualize the Interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="example-achievement.html"><a href="example-achievement.html#mlm---step-1-null-model-only-fixed-and-random-intercepts"><i class="fa fa-check"></i><b>4.4</b> MLM - Step 1: Null Model, only fixed and random intercepts</a><ul>
<li class="chapter" data-level="4.4.1" data-path="example-achievement.html"><a href="example-achievement.html#fit-the-model-8"><i class="fa fa-check"></i><b>4.4.1</b> Fit the Model</a></li>
<li class="chapter" data-level="4.4.2" data-path="example-achievement.html"><a href="example-achievement.html#estimate-the-icc-1"><i class="fa fa-check"></i><b>4.4.2</b> Estimate the ICC</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="example-achievement.html"><a href="example-achievement.html#mlm---step-2-add-lower-level-explanatory-variables-fixed-ml"><i class="fa fa-check"></i><b>4.5</b> MLM - Step 2: Add Lower-level explanatory variables, fixed, ML</a><ul>
<li class="chapter" data-level="4.5.1" data-path="example-achievement.html"><a href="example-achievement.html#add-pupils-vocab-score-as-a-fixed-effects-predictor"><i class="fa fa-check"></i><b>4.5.1</b> Add pupil’s vocab score as a fixed effects predictor</a></li>
<li class="chapter" data-level="4.5.2" data-path="example-achievement.html"><a href="example-achievement.html#investigate-more-level-1-predictors"><i class="fa fa-check"></i><b>4.5.2</b> Investigate More Level 1 Predictors</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="example-achievement.html"><a href="example-achievement.html#mlm---step-3-higher-level-explanatory-variables-fixed-ml"><i class="fa fa-check"></i><b>4.6</b> MLM - Step 3: Higher-level explanatory variables, fixed, ML</a><ul>
<li class="chapter" data-level="4.6.1" data-path="example-achievement.html"><a href="example-achievement.html#assess-significance-of-effects-2"><i class="fa fa-check"></i><b>4.6.1</b> Assess Significance of Effects</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="example-achievement.html"><a href="example-achievement.html#mlm---step-4-explanatory-variables-predict-slopes-random-reml"><i class="fa fa-check"></i><b>4.7</b> MLM - Step 4: Explanatory variables predict Slopes, random, REML</a></li>
<li class="chapter" data-level="4.8" data-path="example-achievement.html"><a href="example-achievement.html#mlm---step-5-cross-level-interactions-between-explanatory-variables---fixed-ml"><i class="fa fa-check"></i><b>4.8</b> MLM - Step 5: Cross-Level interactions between explanatory variables - fixed, ML</a></li>
<li class="chapter" data-level="4.9" data-path="example-achievement.html"><a href="example-achievement.html#centering-predictors-change-center"><i class="fa fa-check"></i><b>4.9</b> Centering Predictors: Change Center</a><ul>
<li class="chapter" data-level="4.9.1" data-path="example-achievement.html"><a href="example-achievement.html#compute-the-grand-means"><i class="fa fa-check"></i><b>4.9.1</b> Compute the Grand Means</a></li>
<li class="chapter" data-level="4.9.2" data-path="example-achievement.html"><a href="example-achievement.html#use-centered-variables"><i class="fa fa-check"></i><b>4.9.2</b> Use Centered Variables</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="example-achievement.html"><a href="example-achievement.html#rescaling-predictors-change-units-or-standardize"><i class="fa fa-check"></i><b>4.10</b> Rescaling Predictors: Change Units or Standardize</a><ul>
<li class="chapter" data-level="4.10.1" data-path="example-achievement.html"><a href="example-achievement.html#scale-varaibles"><i class="fa fa-check"></i><b>4.10.1</b> Scale Varaibles</a></li>
<li class="chapter" data-level="4.10.2" data-path="example-achievement.html"><a href="example-achievement.html#use-scaled-variables"><i class="fa fa-check"></i><b>4.10.2</b> Use Scaled Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Encyclopedia of Quantitative Methods in R, vol. 5: Multilevel Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example---achievement" class="section level1">
<h1><span class="header-section-number">4</span> Example - Achievement</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(haven)        <span class="co"># read in SPSS dataset</span>
<span class="kw">library</span>(furniture)    <span class="co"># nice table1() descriptives</span>
<span class="kw">library</span>(stargazer)    <span class="co"># display nice tables: summary &amp; regression</span>
<span class="kw">library</span>(texreg)       <span class="co"># Convert Regression Output to LaTeX or HTML Tables</span>
<span class="kw">library</span>(RColorBrewer) <span class="co"># nice color palettes for plots</span>
<span class="kw">library</span>(gridExtra)    <span class="co"># place ggplots together as one plot</span>
<span class="kw">library</span>(psych)        <span class="co"># contains some useful functions, like headTail</span>
<span class="kw">library</span>(car)          <span class="co"># Companion to Applied Regression</span>
<span class="kw">library</span>(nlme)         <span class="co"># non-linear mixed-effects models</span>
<span class="kw">library</span>(lme4)         <span class="co"># Linear, generalized linear, &amp; nonlinear mixed models</span>
<span class="kw">library</span>(lmerTest)     <span class="co"># Tests on lmer objects</span>
<span class="kw">library</span>(HLMdiag)      <span class="co"># Diagnostic Tools for for nlme &amp; lmer4</span>
<span class="kw">library</span>(sjstats)      <span class="co"># ICC calculations</span>
<span class="kw">library</span>(optimx)       <span class="co"># Different optimizers to solve mlm&#39;s</span>
<span class="kw">library</span>(effsize)      <span class="co"># effect size computations</span>
<span class="kw">library</span>(lsr)          <span class="co"># companion to learning stats with R</span></code></pre></div>
<!-- ========================================================= -->
<div id="background-2" class="section level2">
<h2><span class="header-section-number">4.1</span> Background</h2>
<!-- ========================================================= -->
<p>Finch textbook…</p>
<p>The datasets for this textbook may be downloaded from the website: <a href="http://www.mlminr.com/data-sets/" class="uri">http://www.mlminr.com/data-sets/</a>. I was unable to find any documentation on this dataset in the book or online, so I contacted the authors. There were unable to provide much either, but based on visual inspection designated the class of <em>factor</em> to thoes vairables that seem to represent categorical quantities. The labels for gender and class size are relative to the frequencies in the journal article the authors did point me to <em>(although the samples sizes do not match up)</em>.</p>
<p>Read the SPSS data in with the <code>haven</code> package .</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_raw &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_sav</span>(<span class="st">&quot;http://www.mlminr.com/data-sets/Achieve.sav?attredirects=0&quot;</span>)</code></pre></div>
<p>Declare all categorical variables to be factors and apply labels where meaningful.</p>
<p>Student-specific<br />
* <code>gender</code> = Male or Female * <code>age</code> = Age, in months * <code>gevocab</code> = Vocabulary Score * <code>geread</code> = Reading Score</p>
<p>Class-specific * <code>classsize</code> = category of class’s size</p>
<p>School-specific * <code>senroll</code> = school enrollment * <code>ses</code> = school’s SES level</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve &lt;-<span class="st"> </span>data_raw <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(id, region, corp, school, class), factor) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">gender =</span> gender <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">classize =</span> classize <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;12-17&quot;</span>, <span class="st">&quot;18-21&quot;</span>, 
                                    <span class="st">&quot;22-26&quot;</span>, <span class="st">&quot;&gt;26&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, region, corp, school, class,           <span class="co"># Identifiers</span>
                gender, age, geread, gevocab,              <span class="co"># Pupil-level vars</span>
                classize,                                  <span class="co"># Class-Level vars</span>
                senroll, ses)                              <span class="co"># School-level vars</span></code></pre></div>
<div id="sample-structure" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Sample Structure</h3>
<p>It is obvious that the sample is hiarchical in nature. The nesting starts with <code>students</code> (level 1) nested within <code>class</code> (level 2), which are further nested within <code>school</code> (level 3), <code>corp</code> (level 4), and finally <code>region</code> (level 5).</p>
<p>For this chapter we will only focus on two levels: <strong>students</strong> are the units on which the outcome is measured and <strong>schools</strong> are the units in which they are nested.</p>
<p>The number of <strong><em>regions</em></strong> = 9:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num_regions &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(region) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">nrow</span>()

num_regions</code></pre></div>
<pre><code>[1] 9</code></pre>
<p>The number of <strong>corps</strong> = 60:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num_corps &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(region, corp) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">nrow</span>()

num_corps </code></pre></div>
<pre><code>[1] 60</code></pre>
<p>The number of <strong>schools</strong> = 160</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num_schools &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(region, corp, school) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">nrow</span>()

num_schools</code></pre></div>
<pre><code>[1] 160</code></pre>
<p>The number of <strong>classes</strong> = 568</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num_classes &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(region, corp, school, class) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tally</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">nrow</span>()

num_classes</code></pre></div>
<pre><code>[1] 568</code></pre>
<p>The number of <strong>students</strong> = 10320</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num_subjects &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span>nrow

num_subjects</code></pre></div>
<pre><code>[1] 10320</code></pre>
<!-- ========================================================= -->
</div>
</div>
<div id="exploratory-data-analysis-2" class="section level2">
<h2><span class="header-section-number">4.2</span> Exploratory Data Analysis</h2>
<!-- ========================================================= -->
<div id="summarize-descriptive-statistics-2" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Summarize Descriptive Statistics</h3>
<div id="the-stargazer-package-2" class="section level4">
<h4><span class="header-section-number">4.2.1.1</span> The <code>stargazer</code> package</h4>
<p>Most posters, journal articles, and reports start with a table of descriptive statistics. Since it tends to come first, this type of table is often refered to as Table 1. The <code>stargazer()</code> function can be used to create such a table, but only for the entire dataset. I haven’t been able to find a way to get it to summarize subsamples and compare them in the standard format. Also, it only summarises continuous, not categorical variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(classize, gender, geread, gevocab, age) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="dt">header =</span> <span class="ot">FALSE</span>,
                      <span class="dt">title =</span> <span class="st">&quot;Summary of the numeric variables with `stargazer`&quot;</span>,
                       <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<table style="text-align:center">
<caption>
<strong>Summary of the numeric variables with <code>stargazer</code></strong>
</caption>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
geread
</td>
<td>
10,320
</td>
<td>
4.341
</td>
<td>
2.332
</td>
<td>
0.000
</td>
<td>
2.800
</td>
<td>
4.900
</td>
<td>
12.000
</td>
</tr>
<tr>
<td style="text-align:left">
gevocab
</td>
<td>
10,320
</td>
<td>
4.494
</td>
<td>
2.368
</td>
<td>
0.000
</td>
<td>
2.900
</td>
<td>
5.200
</td>
<td>
11.200
</td>
</tr>
<tr>
<td style="text-align:left">
age
</td>
<td>
10,320
</td>
<td>
107.529
</td>
<td>
5.060
</td>
<td>
82
</td>
<td>
104
</td>
<td>
111
</td>
<td>
135
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
<div id="the-furniture-package-2" class="section level4">
<h4><span class="header-section-number">4.2.1.2</span> The <code>furniture</code> package</h4>
<p>Tyson Barrett’s <strong>furniture</strong> package includes the extremely useful function <code>table1()</code> which simplifies the common task of creating a stratified, comparative table of descriptive statistics. Full documentation can be accessed by executing <code>?furniture::table1</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># note: the label for the table must be entered above, right after the &quot;r&quot;</span>
<span class="kw">table1</span>(data_achieve,
       geread, gevocab, age, 
       <span class="dt">var_names =</span> <span class="kw">c</span>(<span class="st">&quot;Reading Score&quot;</span>,  
                     <span class="st">&quot;Vocabulary Score&quot;</span>,
                     <span class="st">&quot;Age (in months)&quot;</span>),    <span class="co"># override names</span>
       <span class="dt">splitby   =</span> <span class="op">~</span><span class="st"> </span>gender,                <span class="co"># var to divide sample by</span>
       <span class="dt">test      =</span> <span class="ot">TRUE</span>,                    <span class="co"># test groups different?</span>
       <span class="dt">caption   =</span> <span class="st">&quot;Summary of the numeric variables with `table1`&quot;</span>, 
       <span class="dt">output    =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<table>
<caption>
<span id="tab:sumtable1">Table 4.1: </span>Summary of the numeric variables with <code>table1</code>
</caption>
<thead>
<tr>
<th>
</th>
<th>
Female
</th>
<th>
Male
</th>
<th>
P-Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 5143
</td>
<td>
n = 5177
</td>
<td>
</td>
</tr>
<tr>
<td>
Reading Score
</td>
<td>
</td>
<td>
</td>
<td>
0.218
</td>
</tr>
<tr>
<td>
</td>
<td>
4.4 (2.3)
</td>
<td>
4.3 (2.3)
</td>
<td>
</td>
</tr>
<tr>
<td>
Vocabulary Score
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
</td>
<td>
4.6 (2.4)
</td>
<td>
4.4 (2.3)
</td>
<td>
</td>
</tr>
<tr>
<td>
Age (in months)
</td>
<td>
</td>
<td>
</td>
<td>
&lt;.001
</td>
</tr>
<tr>
<td>
</td>
<td>
107.1 (5.0)
</td>
<td>
107.9 (5.1)
</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="visualization-of-raw-data" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Visualization of Raw Data</h3>
<div id="level-one-plots-disaggregate-or-ignore-higher-levels" class="section level4">
<h4><span class="header-section-number">4.2.2.1</span> Level One Plots: Disaggregate or ignore higher levels</h4>
<p>For a first look, its useful to plot all the data points on a single scatterplot as displayed in the previous plot. Due to the large sample size, many points end up being plotted on top of or very near each other (<em>overplotted</em>). When this is the case, it can be useful to use <code>geom_binhex()</code> rather than <code>geom_point()</code> so the color saturation of the hexigons convey the number of points at that location, as seen in Figure .</p>
<p><em>Note: I had to manually install the package <code>hexbin</code> for the <code>geom_hex()</code> to run.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> gevocab, 
      <span class="dt">y =</span> geread) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_binhex</span>(<span class="dt">colour =</span> <span class="st">&quot;grey85&quot;</span>, <span class="dt">na.rm  =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st">     </span><span class="co"># outlines</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors   =</span> <span class="kw">c</span>(<span class="st">&quot;grey80&quot;</span>,<span class="st">&quot;navyblue&quot;</span>), <span class="co"># fill color extremes</span>
                       <span class="dt">name     =</span> <span class="st">&quot;Frequency&quot;</span>,        <span class="co"># legend title</span>
                       <span class="dt">na.value =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st">               </span><span class="co"># color for count = 0</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-123"></span>
<img src="eBook_install_files/figure-html/unnamed-chunk-123-1.png" alt="Density: Vocab vs. Reading \label{fig:hexbin}" width="576" />
<p class="caption">
Figure 4.1: Density: Vocab vs. Reading 
</p>
</div>
</div>
<div id="multilevel-plots-illustrate-two-nested-levels" class="section level4">
<h4><span class="header-section-number">4.2.2.2</span> Multilevel plots: illustrate two nested levels</h4>
<p>Up to this point, all investigation of this dataset has been only at the pupil level and any nesting or clustering within schools has been ignored. Plotting is a good was to start to get an idea of the school-to-school variability. This figure displays four handpicked school to illustrate the degreen of school-to-school variability in the <strong>association between vocab and reading</strong> scores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(school <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1321</span>, <span class="dv">6181</span>, 
                              <span class="dv">6197</span>, <span class="dv">6823</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># choose school numbers</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,
             <span class="dt">y =</span> geread))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_count</span>() <span class="op">+</span><span class="st">             </span><span class="co"># creates points, size by overplotted number</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st">     </span><span class="co"># linear model (OLS) </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>school) <span class="op">+</span><span class="st">           </span><span class="co"># panels by school</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-124-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Another way to explore the <strong>school-to-school variability</strong> is to plot the linear model fit <em>independently</em> to each of the schools. This next figure displays only the smooth lines without the standard error bands or the raw data in the form of points or hexagons.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,
             <span class="dt">y =</span> geread)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> school),
              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,
              <span class="dt">se     =</span> <span class="ot">FALSE</span>,      <span class="co"># do NOT want the SE bands</span>
              <span class="dt">size   =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st">   </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,
              <span class="dt">se     =</span> <span class="ot">FALSE</span>,
              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,       <span class="co"># do NOT want the SE bands</span>
              <span class="dt">size   =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st">        </span><span class="co"># make the lines thinner</span>
<span class="st">  </span><span class="kw">theme_bw</span>() </code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-125-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Due to the high number of schools, the figure with all the school’s independent linear regression lines resembles a hairball and is hard to deduce much about individual schools. By using the <code>facet_grid()</code> layer, we can seperate the schools out so better see school-to-school variability. It also allows investigation of higher level predictors, such as the school’s SES (median split with <code>ntile(var, 2)</code>) and class size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ses2 =</span> <span class="kw">ntile</span>(ses, <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st">                  </span><span class="co"># median split</span>
<span class="st">                  </span><span class="kw">factor</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;SES: Lower Half&quot;</span>, 
                                    <span class="st">&quot;SES: Upper Half&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x       =</span> gevocab,
             <span class="dt">y       =</span> geread,
             <span class="dt">group   =</span> school)) <span class="op">+</span><span class="st">     </span><span class="co"># sepearates students into schools</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,
              <span class="dt">se     =</span> <span class="ot">FALSE</span>,         
              <span class="dt">size   =</span> <span class="fl">0.3</span>,
              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st">         </span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(classize <span class="op">~</span><span class="st"> </span>ses2)     <span class="co"># makes seperate panels (rows ~ columns)</span></code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-126-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- ========================================================= -->
</div>
</div>
</div>
<div id="single-level-regression" class="section level2">
<h2><span class="header-section-number">4.3</span> Single-Level Regression</h2>
<!-- ========================================================= -->
<div id="fit-nested-models-2" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Fit Nested Models</h3>
<p>Ignore the fact that students are nested or clustered within school, is called dissagregating.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># linear model - ignores school (for reference only)</span>
fit_read_lm_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> geread <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,               <span class="co"># intercept only</span>
                    <span class="dt">data    =</span> data_achieve)

fit_read_lm_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> geread <span class="op">~</span><span class="st"> </span>gevocab ,        <span class="co"># one predictor</span>
                    <span class="dt">data    =</span> data_achieve)

fit_read_lm_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>age,   <span class="co"># two predictors</span>
                    <span class="dt">data    =</span> data_achieve)

fit_read_lm_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age,    <span class="co"># interation+main effects</span>
                    <span class="dt">data    =</span> data_achieve)</code></pre></div>
<p>Now compare the models:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_read_lm_<span class="dv">0</span>, fit_read_lm_<span class="dv">1</span>, 
                     fit_read_lm_<span class="dv">2</span>, fit_read_lm_<span class="dv">3</span>),
                <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 1</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 2</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 3</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 4</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
4.341<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
1.961<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
3.185<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
5.283<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.023)
</td>
<td style="padding-right: 12px; border: none;">
(0.042)
</td>
<td style="padding-right: 12px; border: none;">
(0.416)
</td>
<td style="padding-right: 12px; border: none;">
(0.870)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.530<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.528<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.009
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.008)
</td>
<td style="padding-right: 12px; border: none;">
(0.008)
</td>
<td style="padding-right: 12px; border: none;">
(0.189)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
age
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
-0.011<sup style="vertical-align: 0px;">**</sup>
</td>
<td style="padding-right: 12px; border: none;">
-0.031<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.004)
</td>
<td style="padding-right: 12px; border: none;">
(0.008)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab:age
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.005<sup style="vertical-align: 0px;">**</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.002)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
R<sup style="vertical-align: 0px;">2</sup>
</td>
<td style="border-top: 1px solid black;">
0.000
</td>
<td style="border-top: 1px solid black;">
0.289
</td>
<td style="border-top: 1px solid black;">
0.290
</td>
<td style="border-top: 1px solid black;">
0.290
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Adj. R<sup style="vertical-align: 0px;">2</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.000
</td>
<td style="padding-right: 12px; border: none;">
0.289
</td>
<td style="padding-right: 12px; border: none;">
0.290
</td>
<td style="padding-right: 12px; border: none;">
0.290
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
RMSE
</td>
<td style="border-bottom: 2px solid black;">
2.332
</td>
<td style="border-bottom: 2px solid black;">
1.966
</td>
<td style="border-bottom: 2px solid black;">
1.965
</td>
<td style="border-bottom: 2px solid black;">
1.965
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="6">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<p>Assess the significance of terms in the last ‘best’ model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit_read_lm_<span class="dv">3</span>) </code></pre></div>
<pre><code>
Call:
lm(formula = geread ~ gevocab * age, data = data_achieve)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2069 -1.1250 -0.4362  0.6041  8.6476 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.282607   0.869769   6.074  1.3e-09 ***
gevocab      0.009154   0.189113   0.048 0.961394    
age         -0.030814   0.008066  -3.820 0.000134 ***
gevocab:age  0.004830   0.001759   2.746 0.006039 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.965 on 10316 degrees of freedom
Multiple R-squared:  0.2902,    Adjusted R-squared:   0.29 
F-statistic:  1406 on 3 and 10316 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sjstats<span class="op">::</span><span class="kw">r2</span>(fit_read_lm_<span class="dv">3</span>)</code></pre></div>
<pre><code>
R-Squared for Generalized Linear Mixed Model

         R-squared: 0.290
adjusted R-squared: 0.290</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_lm_<span class="dv">3</span>)</code></pre></div>
<pre><code>Analysis of Variance Table

Response: geread
               Df Sum Sq Mean Sq   F value    Pr(&gt;F)    
gevocab         1  16224 16223.9 4202.2783 &lt; 2.2e-16 ***
age             1     34    33.7    8.7356  0.003128 ** 
gevocab:age     1     29    29.1    7.5419  0.006039 ** 
Residuals   10316  39827     3.9                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="visualize-the-interaction" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Visualize the Interaction</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>),     <span class="co"># chooses defaul values for</span>
                <span class="dt">mod =</span> fit_read_lm_<span class="dv">3</span>)                        <span class="co"># continuous vars</span></code></pre></div>
<pre><code>
 gevocab*age effect
       age
gevocab       82       95      110      120       140
     0  2.755830 2.355243 1.893028 1.584884 0.9685969
     3  3.971571 3.759370 3.514523 3.351291 3.0248284
     6  5.187313 5.163497 5.136018 5.117699 5.0810599
     8  5.997807 6.099582 6.217015 6.295304 6.4518809
     10 6.808301 7.035667 7.298012 7.472909 7.8227019</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>),     <span class="co"># chooses defaul values for</span>
                <span class="dt">mod =</span> fit_read_lm_<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st">                    </span><span class="co"># continuous vars</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age =</span> <span class="kw">factor</span>(age)) <span class="op">%&gt;%</span><span class="st">           </span><span class="co"># must make a factor to seperate lines</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> age)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() </code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-134-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is a better version of the plot.</p>
<p>Age is in months, so we want multiples of 12 for good visualization</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(data_achieve<span class="op">$</span>age)<span class="op">/</span><span class="dv">12</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  6.833   8.667   8.917   8.961   9.250  11.250 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>),
                <span class="dt">mod =</span> fit_read_lm_<span class="dv">3</span>,
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">108</span>, <span class="dv">132</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_yr =</span> <span class="kw">factor</span>(age<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x        =</span> gevocab,
             <span class="dt">y        =</span> fit,
             <span class="dt">color    =</span> age_yr,
             <span class="dt">linetype =</span> age_yr)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.25</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Best Linear Model - Disaggregated Data (OLS)&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;Vocabulary Score&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Reading Score&quot;</span>,
       <span class="dt">linetype =</span> <span class="st">&quot;Age (yrs)&quot;</span>,
       <span class="dt">color    =</span> <span class="st">&quot;Age (yrs)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.85</span>, <span class="fl">0.2</span>),
        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">11</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">11</span>, <span class="dt">by =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-136-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm---step-1-null-model-only-fixed-and-random-intercepts" class="section level2">
<h2><span class="header-section-number">4.4</span> MLM - Step 1: Null Model, only fixed and random intercepts</h2>
<!-- ========================================================= -->
<p>A so called <em>Empty Model</em> only includes random intercepts. No independent variables are involved, other the grouping or clustering variable that designates how <em>level 1</em> units are nested within <em>level 2</em> units. For a cross-sectional study design this would be the grouping variables, where as for longitudinal or repeated measures designs this would be the subject identifier. This <strong>nested structure</strong> variable should be set to have class <code>factor</code>.</p>
<div id="fit-the-model-8" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Fit the Model</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_read_0ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school), 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)                  <span class="co"># fit via ML (not the default)</span>

fit_read_0re &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school) , 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">TRUE</span>)                   <span class="co"># fit = REML (the default)</span></code></pre></div>
<p>Compare the two models to OLS:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_read_lm_<span class="dv">0</span>, fit_read_0ml, fit_read_0re),
                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;OLS&quot;</span>, <span class="st">&quot;MLM-ML&quot;</span>, <span class="st">&quot;MLM-REML&quot;</span>),
                <span class="dt">caption =</span> <span class="st">&quot;NULL Model: different estimation methods&quot;</span>,
                <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
NULL Model: different estimation methods
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>OLS</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>MLM-ML</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>MLM-REML</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
4.3408<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
4.3068<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
4.3068<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0230)
</td>
<td style="padding-right: 12px; border: none;">
(0.0548)
</td>
<td style="padding-right: 12px; border: none;">
(0.0550)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
R<sup style="vertical-align: 0px;">2</sup>
</td>
<td style="border-top: 1px solid black;">
0.0000
</td>
<td style="border-top: 1px solid black;">
</td>
<td style="border-top: 1px solid black;">
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Adj. R<sup style="vertical-align: 0px;">2</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.0000
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
RMSE
</td>
<td style="padding-right: 12px; border: none;">
2.3319
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
AIC
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
46270.3388
</td>
<td style="padding-right: 12px; border: none;">
46274.3058
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
46292.0643
</td>
<td style="padding-right: 12px; border: none;">
46296.0313
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
-23132.1694
</td>
<td style="padding-right: 12px; border: none;">
-23134.1529
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: school
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: school (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.3885
</td>
<td style="padding-right: 12px; border: none;">
0.3915
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Var: Residual
</td>
<td style="border-bottom: 2px solid black;">
</td>
<td style="border-bottom: 2px solid black;">
5.0450
</td>
<td style="border-bottom: 2px solid black;">
5.0450
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="5">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<p>Notice that the estimate for the intercept is nearly the same in the linear regression and intercept only models, but the standard errors are quite different. When there is clustering in sample, the result of ignoring it is under estimation of the standard errors and over stating the significance of associations. This table was made with the <code>screenreg()</code> function in the self named package. I tend to prefer this display over <code>stargazer()</code>.</p>
</div>
<div id="estimate-the-icc-1" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Estimate the ICC</h3>
<p>First, ask for the variance compenents:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme4<span class="op">::</span><span class="kw">VarCorr</span>(fit_read_0re) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">print</span>(<span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev&quot;</span>),
        <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code> Groups   Name        Variance Std.Dev.
 school   (Intercept) 0.3915   0.6257  
 Residual             5.0450   2.2461  </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sjstats<span class="op">::</span><span class="kw">re_var</span>(fit_read_0re)</code></pre></div>
<pre><code>      Within-group-variance:    5.045
     Between-group-variance:    0.392 (school)</code></pre>
<p><span class="math display">\[
\sigma^2_{u0} = 0.392 \\
\sigma^2_{e}  = 5.045 
\]</span></p>
<div class="genericEq">
<p>
<strong>Intraclass Correlation (ICC) Formula</strong> <span class="math display"><span class="math display">\[
\overbrace{\rho}^{\text{ICC}} = 
\frac{\overbrace{\sigma^2_{u0}}^{\text{Random Intercept}\atop\text{Variance}}}
     {\underbrace{\sigma^2_{u0}+\sigma^2_{e}}_{\text{Total}\atop\text{Variance}}}
\tag{Hox 2.9}
\]</span></span>
</p>
</div>
<p>Then you can manually caluclate the ICC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="fl">0.392</span> <span class="op">/</span><span class="st"> </span>(<span class="fl">0.392</span> <span class="op">+</span><span class="st"> </span><span class="fl">5.045</span>)</code></pre></div>
<pre><code>[1] 0.07209858</code></pre>
<p>Or you can use the <code>icc()</code> function in the <code>sjstats</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sjstats<span class="op">::</span><span class="kw">icc</span>(fit_read_0re)</code></pre></div>
<pre><code>
Linear mixed model

Family : gaussian (identity)
Formula: geread ~ 1 + (1 | school)

  ICC (school): 0.0720</code></pre>
<p><em>Note: On page 45 of the Finch textbook, the authors substituted standard deviations into the formula, rather than variances. The mistake is listed on their webpage errata (<a href="http://www.mlminr.com/errata" class="uri">http://www.mlminr.com/errata</a>).</em></p>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm---step-2-add-lower-level-explanatory-variables-fixed-ml" class="section level2">
<h2><span class="header-section-number">4.5</span> MLM - Step 2: Add Lower-level explanatory variables, fixed, ML</h2>
<!-- ========================================================= -->
<p><strong>Variance Component</strong> models (steps 2 and 3) - decompose the INTERCEPT variance into different variance compondents for each level. The regression intercepts are assumed to varry ACROSS the groups, while the slopes are assumed fixed (no random effects).</p>
<p>Fixed effects selection should come <strong>prior</strong> to random effects. You should use <em>Maximum Likelihood (ML)</em> estimation when fitting these models.</p>
<div class="rmdlightbulb">
<ul>
<li>
IF: only level 1 predictors and random intercepts are incorporated<br />
</li>
<li>
Then: MLM <span class="math inline"><span class="math inline">\(\approx\)</span></span> ANCOVA .
</li>
</ul>
</div>
<div id="add-pupils-vocab-score-as-a-fixed-effects-predictor" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Add pupil’s vocab score as a fixed effects predictor</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_read_1ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school), 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)            <span class="co"># to compare fixed var sig</span>

fit_read_1re &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school), 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">TRUE</span>)             <span class="co"># for R-sq calcs</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_read_0ml, fit_read_1ml),
                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Null&quot;</span>, <span class="st">&quot;w Pred&quot;</span>),
                <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Null</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>w Pred</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
4.307<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
2.023<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.055)
</td>
<td style="padding-right: 12px; border: none;">
(0.049)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.513<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.008)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
46270.339
</td>
<td style="border-top: 1px solid black;">
43132.432
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
46292.064
</td>
<td style="padding-right: 12px; border: none;">
43161.399
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-23132.169
</td>
<td style="padding-right: 12px; border: none;">
-21562.216
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: school
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: school (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.389
</td>
<td style="padding-right: 12px; border: none;">
0.099
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Var: Residual
</td>
<td style="border-bottom: 2px solid black;">
5.045
</td>
<td style="border-bottom: 2px solid black;">
3.766
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="4">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<div id="assess-significance-of-effects" class="section level4">
<h4><span class="header-section-number">4.5.1.1</span> Assess Significance of Effects</h4>
<p>Likelihood Ratio Test (LRT)</p>
<p>Since models 0 and 1 are nested models, only differing by the the inclusion or exclusion of the fixed effects predictor <code>gevocab</code>, AND both models were fit via Maximum Likelihood, we can compare the model fit may be compared via the <em>Likilihood-Ratio Test (LRT)</em>. The <em>Likelihood Ratio</em> value <em>(L. Ratio)</em> is found by subtracting the two model’s <code>-2 * logLik</code> or <code>deviance</code> values. Significance is judged by the Chi Squared distribution, using the difference in the number of parameters fit as the degrees of freedom.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_0ml, fit_read_1ml)</code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_0ml: geread ~ 1 + (1 | school)
fit_read_1ml: geread ~ gevocab + (1 | school)
             Df   AIC   BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
fit_read_0ml  3 46270 46292 -23132    46264                             
fit_read_1ml  4 43132 43161 -21562    43124 3139.9      1  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>What does the model look like?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>), 
                <span class="dt">mod =</span> fit_read_1ml) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,
             <span class="dt">y =</span> fit)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower,
                  <span class="dt">ymax =</span> upper),
                <span class="dt">alpha =</span> .<span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-150-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="proportion-of-variance-explained" class="section level4">
<h4><span class="header-section-number">4.5.1.2</span> Proportion of Variance Explained</h4>
<p>Extract the variance-covariance estimates:</p>
<p>M0: The Null Model (fit via REML)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sjstats<span class="op">::</span><span class="kw">re_var</span>(fit_read_0re)</code></pre></div>
<pre><code>      Within-group-variance:    5.045
     Between-group-variance:    0.392 (school)</code></pre>
<p><span class="math display">\[
\sigma^2_{u0-BL} = 0.392 \\
\sigma^2_{e-BL}  = 5.045 
\]</span></p>
<p>M1: Model with Predictor (fit via REML)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sjstats<span class="op">::</span><span class="kw">re_var</span>(fit_read_1re)</code></pre></div>
<pre><code>      Within-group-variance:    3.766
     Between-group-variance:    0.100 (school)</code></pre>
<p><span class="math display">\[
\sigma^2_{u0-MC} = 0.100 \\
\sigma^2_{e-MC}  = 3.766 
\]</span></p>
<p><strong>Level 1 <span class="math inline">\(R^2\)</span> - Snijders and Bosker</strong></p>
<p>Found on Finch (page 47), proportion of variance in the outcome explained by predictor on level one</p>
<div class="genericEq">
<p>
<strong>Snijders and Bosker Formula - Level 1 </strong> <span class="math display"><span class="math display">\[
R^2_1 = 1 - \frac{\sigma^2_{e-MC} + \sigma^2_{u0-MC}}
                 {\sigma^2_{e-BL} + \sigma^2_{u0-BL}}
\]</span></span>
</p>
</div>
<p><em>Note: This formula also apprears in the Finch errata. The subscripts in the denominator of the fraction should be for model 0, not model 1. They did substitute in the correct values.</em></p>
<p>Calculate the value by hand:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">0.100</span> <span class="op">+</span><span class="st"> </span><span class="fl">3.766</span>)<span class="op">/</span>(<span class="fl">0.392</span> <span class="op">+</span><span class="st"> </span><span class="fl">5.045</span>)</code></pre></div>
<pre><code>[1] 0.2889461</code></pre>
<p>Or use the <code>sjstats</code> package to help out:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(sjstats<span class="op">::</span><span class="kw">re_var</span>(fit_read_1re)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(sjstats<span class="op">::</span><span class="kw">re_var</span>(fit_read_0re))</code></pre></div>
<pre><code>[1] 0.288838</code></pre>
<p><strong>Level 1 <span class="math inline">\(R^2\)</span> - Raudenbush and Bryk</strong></p>
<p><span class="citation">Hox, Moerbeek, and Van de Schoot (<a href="references.html#ref-hox2017">2017</a>)</span> presents this formula on page 58 of chapter 2</p>
<blockquote>
<p>R-squared: <em>“proportion of variance explained by the first level predictor(s)”</em></p>
</blockquote>
<div class="genericEq">
<p>
<strong>Raudenbush and Bryk Approximate Formula - Level 1 </strong> <span class="math display"><span class="math display">\[
R^2_1 = \frac{\sigma^2_{e-BL} - \sigma^2_{e-MC}}
              {\sigma^2_{e-BL} }
\tag{Hox 4.8}
\]</span></span>
</p>
</div>
<p>Calculate the value by hand:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="fl">5.045</span> <span class="op">-</span><span class="st"> </span><span class="fl">3.766</span>) <span class="op">/</span><span class="st"> </span><span class="fl">5.045</span></code></pre></div>
<pre><code>[1] 0.2535183</code></pre>
<p><strong>Level 2 <span class="math inline">\(R^2\)</span> - ???</strong></p>
<p>Proportion of variance in the outcome explained by predictors</p>
<div class="genericEq">
<p>
<span class="math display"><span class="math display">\[
R^2_2 = 1 - \frac{\frac{\sigma^2_{e-MC}}{B} + \sigma^2_{u0-MC}}
                 {\frac{\sigma^2_{e-BL}}{B} + \sigma^2_{u0-BL}}
\]</span></span>
</p>
</div>
<p><span class="math inline">\(B\)</span> is the average size of the Level 2 units (schools). Technically, you should use the <em>harmonic mean</em>, but unless the clusters differ greatly in size, it doesn’t make a huge difference.</p>
<ul>
<li>Average sample cluster size</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num_subjects <span class="op">/</span><span class="st"> </span>num_schools</code></pre></div>
<pre><code>[1] 64.5</code></pre>
<ul>
<li>Calculate by hand:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>((<span class="fl">3.766</span> <span class="op">/</span><span class="st"> </span><span class="fl">64.5</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.100</span>)<span class="op">/</span>
<span class="st">    </span>((<span class="fl">5.045</span> <span class="op">/</span><span class="st"> </span><span class="fl">64.5</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.391</span>)</code></pre></div>
<pre><code>[1] 0.6624428</code></pre>
<p><strong>Level 2 <span class="math inline">\(R^2\)</span> - Raudenbush and Bryk</strong></p>
<div class="genericEq">
<p>
<strong>Raudenbush and Bryk Approximate Formula - Level 2 </strong> <span class="math display"><span class="math display">\[
R^2_1 = \frac{\sigma^2_{u0-BL} - \sigma^2_{u0-MC}}
                 {\sigma^2_{u0-BL} }
\tag{Hox 4.9}
\]</span></span>
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="fl">0.392</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.100</span>)<span class="op">/</span>(<span class="fl">0.392</span>)</code></pre></div>
<pre><code>[1] 0.744898</code></pre>
</div>
</div>
<div id="investigate-more-level-1-predictors" class="section level3">
<h3><span class="header-section-number">4.5.2</span> Investigate More Level 1 Predictors</h3>
<p>Part of investigating lower level explanatory variables, is checking for interactions between these variables. The interaction between fixed effects is also considered to be a fixed effect, so we need to employ <em>Maximum Likelihood</em> estimation to compare nested models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_read_2ml &lt;-<span class="st"> </span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), 
                     <span class="dt">data =</span> data_achieve,
                     <span class="dt">REML =</span> <span class="ot">FALSE</span>)

fit_read_3ml &lt;-<span class="st"> </span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), 
                     <span class="dt">data =</span> data_achieve,
                     <span class="dt">REML =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_read_1ml, fit_read_2ml, fit_read_3ml),
                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Only Vocab&quot;</span>, <span class="st">&quot;Both Main Effects&quot;</span>, <span class="st">&quot;Interaction&quot;</span>),
                <span class="dt">caption =</span> <span class="st">&quot;Investigate Pupil-level Predictors&quot;</span>,
                <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Investigate Pupil-level Predictors
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Only Vocab</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Both Main Effects</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Interaction</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
2.0231<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
3.0049<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
5.1874<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0492)
</td>
<td style="padding-right: 12px; border: none;">
(0.4172)
</td>
<td style="padding-right: 12px; border: none;">
(0.8666)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab
</td>
<td style="padding-right: 12px; border: none;">
0.5130<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.5121<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
-0.0279
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0084)
</td>
<td style="padding-right: 12px; border: none;">
(0.0084)
</td>
<td style="padding-right: 12px; border: none;">
(0.1881)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
age
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
-0.0091<sup style="vertical-align: 0px;">*</sup>
</td>
<td style="padding-right: 12px; border: none;">
-0.0294<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0038)
</td>
<td style="padding-right: 12px; border: none;">
(0.0080)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab:age
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.0050<sup style="vertical-align: 0px;">**</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0017)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
43132.4318
</td>
<td style="border-top: 1px solid black;">
43128.8201
</td>
<td style="border-top: 1px solid black;">
43122.5687
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
43161.3991
</td>
<td style="padding-right: 12px; border: none;">
43165.0293
</td>
<td style="padding-right: 12px; border: none;">
43166.0198
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-21562.2159
</td>
<td style="padding-right: 12px; border: none;">
-21559.4100
</td>
<td style="padding-right: 12px; border: none;">
-21555.2844
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: school
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: school (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.0987
</td>
<td style="padding-right: 12px; border: none;">
0.0973
</td>
<td style="padding-right: 12px; border: none;">
0.0977
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Var: Residual
</td>
<td style="border-bottom: 2px solid black;">
3.7661
</td>
<td style="border-bottom: 2px solid black;">
3.7646
</td>
<td style="border-bottom: 2px solid black;">
3.7614
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="5">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<div id="assess-significance-of-effects-1" class="section level4">
<h4><span class="header-section-number">4.5.2.1</span> Assess Significance of Effects</h4>
<p>Likelihood Ratio Test (LRT)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_1ml, fit_read_2ml, fit_read_3ml)</code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_1ml: geread ~ gevocab + (1 | school)
fit_read_2ml: geread ~ gevocab + age + (1 | school)
fit_read_3ml: geread ~ gevocab * age + (1 | school)
             Df   AIC   BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)   
fit_read_1ml  4 43132 43161 -21562    43124                            
fit_read_2ml  5 43129 43165 -21559    43119 5.6117      1   0.017841 * 
fit_read_3ml  6 43123 43166 -21555    43111 8.2514      1   0.004072 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="visulaize-the-interation" class="section level4">
<h4><span class="header-section-number">4.5.2.2</span> Visulaize the Interation</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>), 
                <span class="dt">mod =</span> fit_read_3ml,
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">108</span>, <span class="dv">132</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_yr =</span> <span class="kw">factor</span>(age<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> age_yr)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-167-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- ========================================================= -->
</div>
</div>
</div>
<div id="mlm---step-3-higher-level-explanatory-variables-fixed-ml" class="section level2">
<h2><span class="header-section-number">4.6</span> MLM - Step 3: Higher-level explanatory variables, fixed, ML</h2>
<!-- ========================================================= -->
<p>School enrollment (<code>senroll</code>) applies to each school as a whole. When a variable is measured at a higher level, all units in the same group have the same value. In this case, all student in the same school have the same value for <code>senroll</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_read_4ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>senroll <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_read_0ml, fit_read_3ml, fit_read_4ml),
                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Null&quot;</span>, <span class="st">&quot;Level 1 only&quot;</span>, <span class="st">&quot;Level 2 Pred&quot;</span>),
                <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Null</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Level 1 only</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Level 2 Pred</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
4.307<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
5.187<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
5.239<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.055)
</td>
<td style="padding-right: 12px; border: none;">
(0.867)
</td>
<td style="padding-right: 12px; border: none;">
(0.872)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
-0.028
</td>
<td style="padding-right: 12px; border: none;">
-0.028
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.188)
</td>
<td style="padding-right: 12px; border: none;">
(0.188)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
age
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
-0.029<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
-0.029<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.008)
</td>
<td style="padding-right: 12px; border: none;">
(0.008)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab:age
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.005<sup style="vertical-align: 0px;">**</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.005<sup style="vertical-align: 0px;">**</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.002)
</td>
<td style="padding-right: 12px; border: none;">
(0.002)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
senroll
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
-0.000
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.000)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
46270.339
</td>
<td style="border-top: 1px solid black;">
43122.569
</td>
<td style="border-top: 1px solid black;">
43124.314
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
46292.064
</td>
<td style="padding-right: 12px; border: none;">
43166.020
</td>
<td style="padding-right: 12px; border: none;">
43175.007
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-23132.169
</td>
<td style="padding-right: 12px; border: none;">
-21555.284
</td>
<td style="padding-right: 12px; border: none;">
-21555.157
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: school
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: school (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.389
</td>
<td style="padding-right: 12px; border: none;">
0.098
</td>
<td style="padding-right: 12px; border: none;">
0.097
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Var: Residual
</td>
<td style="border-bottom: 2px solid black;">
5.045
</td>
<td style="border-bottom: 2px solid black;">
3.761
</td>
<td style="border-bottom: 2px solid black;">
3.761
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="5">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<div id="assess-significance-of-effects-2" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Assess Significance of Effects</h3>
<p>Likelihood Ratio Test (LRT)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_0ml, fit_read_3ml, fit_read_4ml)</code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_0ml: geread ~ 1 + (1 | school)
fit_read_3ml: geread ~ gevocab * age + (1 | school)
fit_read_4ml: geread ~ gevocab * age + senroll + (1 | school)
             Df   AIC   BIC logLik deviance     Chisq Chi Df Pr(&gt;Chisq)
fit_read_0ml  3 46270 46292 -23132    46264                            
fit_read_3ml  6 43123 43166 -21555    43111 3153.7701      3     &lt;2e-16
fit_read_4ml  7 43124 43175 -21555    43110    0.2548      1     0.6137
                
fit_read_0ml    
fit_read_3ml ***
fit_read_4ml    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm---step-4-explanatory-variables-predict-slopes-random-reml" class="section level2">
<h2><span class="header-section-number">4.7</span> MLM - Step 4: Explanatory variables predict Slopes, random, REML</h2>
<!-- ========================================================= -->
<p><strong>Random Coefficient</strong> models - decompose the SLOPE variance BETWEEN groups.</p>
<p>The fixed effect of the predictor captures the overall association it has with the outcome (intercept), while the random effect of the predictor captures the group-to-group variation in the association (slope). <em>Note: A variable can be fit as BOTH a fixed and random effect.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_read_3re &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), 
                     <span class="dt">data =</span> data_achieve,
                     <span class="dt">REML =</span> <span class="ot">TRUE</span>)

<span class="co">#fit_read_5re &lt;- lmer(geread ~ gevocab + (gevocab | school), </span>
<span class="co">#                     data = achieve,</span>
<span class="co">#                     REML = TRUE)         # failed to converge :(</span>

fit_read_5re &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">TRUE</span>,
                           <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>, 
                                                 <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,
                                                 <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,
                                                                <span class="dt">starttests =</span> <span class="ot">FALSE</span>,
                                                                <span class="dt">kkt =</span> <span class="ot">FALSE</span>))) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_read_3re, fit_read_5re),
                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Rand Int&quot;</span>, <span class="st">&quot;Rand Int and Slopes&quot;</span>),
                <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Rand Int</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Rand Int and Slopes</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
5.1872<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
5.6133<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.8668)
</td>
<td style="padding-right: 12px; border: none;">
(0.8727)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab
</td>
<td style="padding-right: 12px; border: none;">
-0.0281
</td>
<td style="padding-right: 12px; border: none;">
-0.1378
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.1881)
</td>
<td style="padding-right: 12px; border: none;">
(0.1922)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
age
</td>
<td style="padding-right: 12px; border: none;">
-0.0294<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
-0.0335<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0080)
</td>
<td style="padding-right: 12px; border: none;">
(0.0081)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab:age
</td>
<td style="padding-right: 12px; border: none;">
0.0050<sup style="vertical-align: 0px;">**</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.0061<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0017)
</td>
<td style="padding-right: 12px; border: none;">
(0.0018)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
43155.4945
</td>
<td style="border-top: 1px solid black;">
43011.6498
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
43198.9455
</td>
<td style="padding-right: 12px; border: none;">
43069.5845
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-21571.7472
</td>
<td style="padding-right: 12px; border: none;">
-21497.8249
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: school
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: school (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.0988
</td>
<td style="padding-right: 12px; border: none;">
0.2753
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: Residual
</td>
<td style="padding-right: 12px; border: none;">
3.7625
</td>
<td style="padding-right: 12px; border: none;">
3.6611
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: school gevocab
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.0195
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Cov: school (Intercept) gevocab
</td>
<td style="border-bottom: 2px solid black;">
</td>
<td style="border-bottom: 2px solid black;">
-0.0631
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="4">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<div id="assess-significance-of-effect" class="section level4">
<h4><span class="header-section-number">4.7.0.1</span> Assess Significance of Effect</h4>
<p>Likelihood Ratio Test (LRT)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_3re, fit_read_5re, <span class="dt">refit =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_3re: geread ~ gevocab * age + (1 | school)
fit_read_5re: geread ~ gevocab * age + (gevocab | school)
             Df   AIC   BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
fit_read_3re  6 43155 43199 -21572    43143                             
fit_read_5re  8 43012 43070 -21498    42996 147.84      2  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>You can use the Chi-squared LRT test based on deviances even though we fit our modesl with REML, since the models only differe in terms of random effects, but have the same fixed effects.</p>
</div>
<div id="visualize-the-model" class="section level4">
<h4><span class="header-section-number">4.7.0.2</span> Visualize the Model</h4>
<p>What does the model look like?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab&quot;</span>, <span class="st">&quot;age&quot;</span>), 
                <span class="dt">mod =</span> fit_read_5re,
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">108</span>, <span class="dv">132</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_yr =</span> <span class="kw">factor</span>(age<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> age_yr)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-176-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- ========================================================= -->
</div>
</div>
<div id="mlm---step-5-cross-level-interactions-between-explanatory-variables---fixed-ml" class="section level2">
<h2><span class="header-section-number">4.8</span> MLM - Step 5: Cross-Level interactions between explanatory variables - fixed, ML</h2>
<!-- ========================================================= -->
<p>Remember that an interaction beween fixed effects is also fixed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_read_5ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">FALSE</span>,
                           <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>, 
                                                 <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,
                                                 <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,
                                                                <span class="dt">starttests =</span> <span class="ot">FALSE</span>,
                                                                <span class="dt">kkt =</span> <span class="ot">FALSE</span>)))

fit_read_6ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>senroll <span class="op">+</span>
<span class="st">                             </span>(gevocab <span class="op">|</span><span class="st"> </span>school), 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)

fit_read_7ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>gevocab<span class="op">*</span>senroll <span class="op">+</span>
<span class="st">                           </span>(gevocab <span class="op">|</span><span class="st"> </span>school), 
                           <span class="dt">data =</span> data_achieve,
                           <span class="dt">REML =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texreg<span class="op">::</span><span class="kw">htmlreg</span>(<span class="kw">list</span>(fit_read_3ml, fit_read_6ml, fit_read_7ml),
                <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Level 1 only&quot;</span>, <span class="st">&quot;Both Levels&quot;</span>, <span class="st">&quot;Cross-Level&quot;</span>),
                <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Level 1 only</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Both Levels</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Cross-Level</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
5.1874<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
5.6030<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
5.5167<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.8666)
</td>
<td style="padding-right: 12px; border: none;">
(0.8780)
</td>
<td style="padding-right: 12px; border: none;">
(0.8942)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab
</td>
<td style="padding-right: 12px; border: none;">
-0.0279
</td>
<td style="padding-right: 12px; border: none;">
-0.1378
</td>
<td style="padding-right: 12px; border: none;">
-0.1144
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.1881)
</td>
<td style="padding-right: 12px; border: none;">
(0.1921)
</td>
<td style="padding-right: 12px; border: none;">
(0.1975)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
age
</td>
<td style="padding-right: 12px; border: none;">
-0.0294<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
-0.0335<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
-0.0335<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0080)
</td>
<td style="padding-right: 12px; border: none;">
(0.0081)
</td>
<td style="padding-right: 12px; border: none;">
(0.0081)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab:age
</td>
<td style="padding-right: 12px; border: none;">
0.0050<sup style="vertical-align: 0px;">**</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.0061<sup style="vertical-align: 0px;">***</sup>
</td>
<td style="padding-right: 12px; border: none;">
0.0061<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0017)
</td>
<td style="padding-right: 12px; border: none;">
(0.0018)
</td>
<td style="padding-right: 12px; border: none;">
(0.0018)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
senroll
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.0000
</td>
<td style="padding-right: 12px; border: none;">
0.0002
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0002)
</td>
<td style="padding-right: 12px; border: none;">
(0.0004)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gevocab:senroll
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
-0.0000
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.0001)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
43122.5687
</td>
<td style="border-top: 1px solid black;">
42981.6977
</td>
<td style="border-top: 1px solid black;">
42983.4444
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
43166.0198
</td>
<td style="padding-right: 12px; border: none;">
43046.8743
</td>
<td style="padding-right: 12px; border: none;">
43055.8628
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-21555.2844
</td>
<td style="padding-right: 12px; border: none;">
-21481.8489
</td>
<td style="padding-right: 12px; border: none;">
-21481.7222
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
<td style="padding-right: 12px; border: none;">
10320
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: school
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
<td style="padding-right: 12px; border: none;">
160
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: school (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.0977
</td>
<td style="padding-right: 12px; border: none;">
0.2715
</td>
<td style="padding-right: 12px; border: none;">
0.2692
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: Residual
</td>
<td style="padding-right: 12px; border: none;">
3.7614
</td>
<td style="padding-right: 12px; border: none;">
3.6604
</td>
<td style="padding-right: 12px; border: none;">
3.6606
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: school gevocab
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
0.0193
</td>
<td style="padding-right: 12px; border: none;">
0.0191
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Cov: school (Intercept) gevocab
</td>
<td style="border-bottom: 2px solid black;">
</td>
<td style="border-bottom: 2px solid black;">
-0.0623
</td>
<td style="border-bottom: 2px solid black;">
-0.0617
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="5">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<div id="assess-significance-of-effects-3" class="section level4">
<h4><span class="header-section-number">4.8.0.1</span> Assess Significance of Effects</h4>
<p>Likelihood Ratio Test (LRT)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_3ml, fit_read_6ml, fit_read_7ml)</code></pre></div>
<pre><code>Data: data_achieve
Models:
fit_read_3ml: geread ~ gevocab * age + (1 | school)
fit_read_6ml: geread ~ gevocab * age + senroll + (gevocab | school)
fit_read_7ml: geread ~ gevocab * age + gevocab * senroll + (gevocab | school)
             Df   AIC   BIC logLik deviance    Chisq Chi Df Pr(&gt;Chisq)    
fit_read_3ml  6 43123 43166 -21555    43111                               
fit_read_6ml  9 42982 43047 -21482    42964 146.8710      3     &lt;2e-16 ***
fit_read_7ml 10 42983 43056 -21482    42963   0.2534      1     0.6147    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<!-- ========================================================= -->
</div>
</div>
<div id="centering-predictors-change-center" class="section level2">
<h2><span class="header-section-number">4.9</span> Centering Predictors: Change Center</h2>
<!-- ========================================================= -->
<p>Centering variables measured on the lowest level only involves subtacting the mean from every value. The spread or standard deviation is not changed.</p>
<div id="compute-the-grand-means" class="section level3">
<h3><span class="header-section-number">4.9.1</span> Compute the Grand Means</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(gevocab, age, senroll,
                    <span class="dt">output =</span> <span class="st">&quot;html&quot;</span>,
                    <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<table>
<thead>
<tr>
<th>
</th>
<th>
Mean/Count (SD/%)
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
</td>
<td>
n = 10320
</td>
</tr>
<tr>
<td>
gevocab
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
4.4938 (2.3679)
</td>
</tr>
<tr>
<td>
age
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
107.5290 (5.0596)
</td>
</tr>
<tr>
<td>
senroll
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
533.4148 (154.7968)
</td>
</tr>
</tbody>
</table>
<div id="subtract-the-grand-mean" class="section level4">
<h4><span class="header-section-number">4.9.1.1</span> Subtract the Grand Mean</h4>
<p>Subract the grand-mean from each observation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve_center &lt;-<span class="st"> </span>data_achieve <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">gevocab_c =</span> gevocab <span class="op">-</span><span class="st"> </span><span class="fl">4.4938</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_c     =</span> age     <span class="op">-</span><span class="st"> </span><span class="fl">107.5290</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">senroll_c =</span> senroll <span class="op">-</span><span class="st"> </span><span class="fl">533.4148</span>)</code></pre></div>
</div>
<div id="compare-the-centered-and-uncentered-measures" class="section level4">
<h4><span class="header-section-number">4.9.1.2</span> Compare the centered and uncentered measures</h4>
<p>View the first and last few observations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve_center <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, school, 
                gevocab, gevocab_c, 
                age,     age_c, 
                senroll, senroll_c) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">headTail</span>()</code></pre></div>
<pre><code>    id school gevocab gevocab_c age age_c senroll senroll_c
1    1    767     3.1     -1.39 104 -3.53     463    -70.41
2    2    767     2.8     -1.69 106 -1.53     463    -70.41
3    3    767     1.7     -2.79 112  4.47     463    -70.41
4    4    767     2.1     -2.39 109  1.47     463    -70.41
5 &lt;NA&gt;   &lt;NA&gt;     ...       ... ...   ...     ...       ...
6 7893   9085     4.7      0.21 108  0.47     603     69.59
7 7894   9085     3.1     -1.39 108  0.47     603     69.59
8 7895   9085     3.8     -0.69 114  6.47     603     69.59
9 7896   9085       3     -1.49 106 -1.53     603     69.59</code></pre>
<p>Compare the summary statistcs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve_center <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(gevocab, gevocab_c, 
                    age,     age_c, 
                    senroll, senroll_c,
                    <span class="dt">output =</span> <span class="st">&quot;html&quot;</span>,
                    <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th&gt;   &lt;/th&gt;
   &lt;th&gt; Mean/Count (SD/%) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; n = 10320 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; gevocab &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 4.4938 (2.3679) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; gevocab_c &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 0.0000 (2.3679) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; age &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 107.5290 (5.0596) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; age_c &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; -0.0000 (5.0596) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; senroll &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 533.4148 (154.7968) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; senroll_c &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 0.0000 (154.7968) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div id="use-centered-variables" class="section level3">
<h3><span class="header-section-number">4.9.2</span> Use Centered Variables</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_read_8ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), 
                           <span class="dt">data =</span> data_achieve_center,
                           <span class="dt">REML =</span> <span class="ot">FALSE</span>,
                             <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>, 
                                                   <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,
                                                   <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,
                                                                  <span class="dt">starttests =</span> <span class="ot">FALSE</span>,
                                                                  <span class="dt">kkt =</span> <span class="ot">FALSE</span>)))

fit_read_8ml_c &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab_c <span class="op">+</span><span class="st"> </span>age_c <span class="op">+</span><span class="st"> </span>(gevocab_c <span class="op">|</span><span class="st"> </span>school), 
                             <span class="dt">data =</span> data_achieve_center,
                             <span class="dt">REML =</span> <span class="ot">FALSE</span>,
                               <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>, 
                                                     <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,
                                                     <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,
                                                                    <span class="dt">starttests =</span> <span class="ot">FALSE</span>,
                                                                    <span class="dt">kkt =</span> <span class="ot">FALSE</span>)))

fit_read_9ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab<span class="op">*</span>age <span class="op">+</span><span class="st"> </span>(gevocab <span class="op">|</span><span class="st"> </span>school), 
                           <span class="dt">data =</span> data_achieve_center,
                           <span class="dt">REML =</span> <span class="ot">FALSE</span>,
                             <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>, 
                                                   <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,
                                                   <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,
                                                                  <span class="dt">starttests =</span> <span class="ot">FALSE</span>,
                                                                  <span class="dt">kkt =</span> <span class="ot">FALSE</span>)))

fit_read_9ml_c &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab_c<span class="op">*</span>age_c <span class="op">+</span><span class="st"> </span>(gevocab_c <span class="op">|</span><span class="st"> </span>school), 
                             <span class="dt">data =</span> data_achieve_center,
                             <span class="dt">REML =</span> <span class="ot">FALSE</span>,
                               <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;optimx&quot;</span>, 
                                                     <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,
                                                     <span class="dt">optCtrl =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;nlminb&quot;</span>,
                                                                    <span class="dt">starttests =</span> <span class="ot">FALSE</span>,
                                                                    <span class="dt">kkt =</span> <span class="ot">FALSE</span>)))</code></pre></div>
<div id="compare-the-models" class="section level4">
<h4><span class="header-section-number">4.9.2.1</span> Compare the Models</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_8ml, fit_read_9ml)</code></pre></div>
<pre><code>Data: data_achieve_center
Models:
fit_read_8ml: geread ~ gevocab + age + (gevocab | school)
fit_read_9ml: geread ~ gevocab * age + (gevocab | school)
             Df   AIC   BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
fit_read_8ml  7 42989 43040 -21488    42975                             
fit_read_9ml  8 42980 43038 -21482    42964 11.726      1  0.0006162 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_8ml_c, fit_read_9ml_c)</code></pre></div>
<pre><code>Data: data_achieve_center
Models:
fit_read_8ml_c: geread ~ gevocab_c + age_c + (gevocab_c | school)
fit_read_9ml_c: geread ~ gevocab_c * age_c + (gevocab_c | school)
               Df   AIC   BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
fit_read_8ml_c  7 42989 43040 -21488    42975                             
fit_read_9ml_c  8 42980 43038 -21482    42964 11.726      1  0.0006162 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="visualize-the-model-1" class="section level4">
<h4><span class="header-section-number">4.9.2.2</span> Visualize the Model</h4>
<p>What does the model look like?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># now plot it</span>
effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab_c&quot;</span>, <span class="st">&quot;age_c&quot;</span>),
                <span class="dt">mod =</span> fit_read_9ml_c) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_c =</span> <span class="kw">factor</span>(age_c)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab_c,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> age_c)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-190-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab_c&quot;</span>, <span class="st">&quot;age_c&quot;</span>),
                <span class="dt">mod =</span> fit_read_9ml_c,
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age_c =</span> <span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">108</span>, <span class="dv">132</span>) <span class="op">-</span><span class="st"> </span><span class="fl">107.5290</span>)) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_yrs =</span> <span class="kw">factor</span>((age_c <span class="op">+</span><span class="st"> </span><span class="fl">107.5290</span>)<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">gevocab =</span> gevocab_c <span class="op">+</span><span class="st"> </span><span class="fl">4.4938</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> age_yrs)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-191-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- ========================================================= -->
</div>
</div>
</div>
<div id="rescaling-predictors-change-units-or-standardize" class="section level2">
<h2><span class="header-section-number">4.10</span> Rescaling Predictors: Change Units or Standardize</h2>
<!-- ========================================================= -->
<p>To retain meaningful units, you can multiply or divide all the measured values of a variable by a set amount, like a multiple of 10. This retains the meaning behind the units while still bringing them into line with other variables in the model and can avoid some convergence issues.</p>
<div id="scale-varaibles" class="section level3">
<h3><span class="header-section-number">4.10.1</span> Scale Varaibles</h3>
<div id="divide-by-a-meaningful-value" class="section level4">
<h4><span class="header-section-number">4.10.1.1</span> Divide by a Meaningful Value</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve_center_scale &lt;-<span class="st"> </span>data_achieve_center <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">senroll_ch =</span> senroll_c <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># centered AND divided by one hundred</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ses_t      =</span> ses <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)               <span class="co"># JUST divide by ten</span></code></pre></div>
</div>
<div id="compare-the-scaled-and-unscaled-measures" class="section level4">
<h4><span class="header-section-number">4.10.1.2</span> Compare the scaled and unscaled measures</h4>
<p>View the first and last few observations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve_center_scale <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, school, 
                senroll, senroll_c, senroll_ch,
                ses, ses_t) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">headTail</span>()</code></pre></div>
<pre><code>    id school senroll senroll_c senroll_ch  ses ses_t
1    1    767     463    -70.41       -0.7 80.4  8.04
2    2    767     463    -70.41       -0.7 80.4  8.04
3    3    767     463    -70.41       -0.7 80.4  8.04
4    4    767     463    -70.41       -0.7 80.4  8.04
5 &lt;NA&gt;   &lt;NA&gt;     ...       ...        ...  ...   ...
6 7893   9085     603     69.59        0.7 84.4  8.44
7 7894   9085     603     69.59        0.7 84.4  8.44
8 7895   9085     603     69.59        0.7 84.4  8.44
9 7896   9085     603     69.59        0.7 84.4  8.44</code></pre>
<p>Compare the summary statistcs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve_center_scale <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>furniture<span class="op">::</span><span class="kw">table1</span>(senroll, senroll_c, senroll_ch,
                    ses, ses_t,
                    <span class="dt">output =</span> <span class="st">&quot;html&quot;</span>,
                    <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th&gt;   &lt;/th&gt;
   &lt;th&gt; Mean/Count (SD/%) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; n = 10320 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; senroll &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 533.4148 (154.7968) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; senroll_c &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 0.0000 (154.7968) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; senroll_ch &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 0.0000 (1.5480) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; ses &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 72.8490 (21.9817) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt; ses_t &lt;/td&gt;
   &lt;td&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td&gt;  &lt;/td&gt;
   &lt;td&gt; 7.2849 (2.1982) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div id="use-scaled-variables" class="section level3">
<h3><span class="header-section-number">4.10.2</span> Use Scaled Variables</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_read_10ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab_c<span class="op">*</span>age_c <span class="op">+</span><span class="st"> </span>gevocab_c<span class="op">*</span>ses_t <span class="op">+</span><span class="st">   </span><span class="co"># 2 2-way interactions</span>
<span class="st">                                      </span>(gevocab_c <span class="op">|</span><span class="st"> </span>school),  
                             <span class="dt">data   =</span> data_achieve_center_scale,
                             <span class="dt">REML   =</span> <span class="ot">FALSE</span>)

fit_read_11ml &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">lmer</span>(geread <span class="op">~</span><span class="st"> </span>gevocab_c<span class="op">*</span>age_c<span class="op">*</span>ses_t <span class="op">+</span><span class="st">              </span><span class="co"># 3-way interaction</span>
<span class="st">                                      </span>(gevocab_c <span class="op">|</span><span class="st"> </span>school),  
                             <span class="dt">data   =</span> data_achieve_center_scale,
                             <span class="dt">REML  =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screenreg</span>(<span class="kw">list</span>(fit_read_10ml, fit_read_11ml),
          <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;2-way&quot;</span>, <span class="st">&quot;3-way&quot;</span>),
          <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>
===================================================================
                                   2-way            3-way          
-------------------------------------------------------------------
(Intercept)                             3.9449 ***       3.9413 ***
                                       (0.1065)         (0.1067)   
gevocab_c                               0.6710 ***       0.6739 ***
                                       (0.0512)         (0.0513)   
age_c                                  -0.0044          -0.0082    
                                       (0.0039)         (0.0137)   
ses_t                                   0.0571 ***       0.0576 ***
                                       (0.0140)         (0.0140)   
gevocab_c:age_c                         0.0055 **        0.0001    
                                       (0.0018)         (0.0067)   
gevocab_c:ses_t                        -0.0211 **       -0.0215 ** 
                                       (0.0066)         (0.0067)   
age_c:ses_t                                              0.0004    
                                                        (0.0018)   
gevocab_c:age_c:ses_t                                    0.0007    
                                                        (0.0009)   
-------------------------------------------------------------------
AIC                                 42928.8135       42932.0461    
BIC                                 43001.2319       43018.9482    
Log Likelihood                     -21454.4067      -21454.0231    
Num. obs.                           10320            10320         
Num. groups: school                   160              160         
Var: school (Intercept)                 0.0788           0.0785    
Var: school gevocab_c                   0.0173           0.0173    
Cov: school (Intercept) gevocab_c       0.0311           0.0311    
Var: Residual                           3.6616           3.6616    
===================================================================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit_read_10ml, fit_read_11ml)</code></pre></div>
<pre><code>Data: data_achieve_center_scale
Models:
fit_read_10ml: geread ~ gevocab_c * age_c + gevocab_c * ses_t + (gevocab_c | 
fit_read_10ml:     school)
fit_read_11ml: geread ~ gevocab_c * age_c * ses_t + (gevocab_c | school)
              Df   AIC   BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
fit_read_10ml 10 42929 43001 -21454    42909                         
fit_read_11ml 12 42932 43019 -21454    42908 0.7674      2     0.6813</code></pre>
<div id="visualize-the-model-2" class="section level4">
<h4><span class="header-section-number">4.10.2.1</span> Visualize the Model</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_achieve_center_scale <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(gevocab_c, age_c, ses_t) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summary</span>()</code></pre></div>
<pre><code>   gevocab_c             age_c                ses_t       
 Min.   :-4.493800   Min.   :-25.529000   Min.   : 0.000  
 1st Qu.:-1.593800   1st Qu.: -3.529000   1st Qu.: 6.630  
 Median :-0.693800   Median : -0.529000   Median : 8.170  
 Mean   : 0.000044   Mean   : -0.000027   Mean   : 7.285  
 3rd Qu.: 0.706200   3rd Qu.:  3.471000   3rd Qu.: 8.780  
 Max.   : 6.706200   Max.   : 27.471000   Max.   :10.000  </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effects<span class="op">::</span><span class="kw">Effect</span>(<span class="dt">focal.predictors =</span> <span class="kw">c</span>(<span class="st">&quot;gevocab_c&quot;</span>, <span class="st">&quot;age_c&quot;</span>, <span class="st">&quot;ses_t&quot;</span>),
                <span class="dt">mod =</span> fit_read_11ml,
                <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age_c =</span> <span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">108</span>, <span class="dv">132</span>) <span class="op">-</span><span class="st"> </span><span class="fl">107.5290</span>,
                               <span class="dt">ses_t =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>))) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">age_yrs =</span> <span class="kw">factor</span>((age_c <span class="op">+</span><span class="st"> </span><span class="fl">107.5290</span>)<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">gevocab =</span> gevocab_c <span class="op">+</span><span class="st"> </span><span class="fl">4.4938</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ses     =</span> <span class="kw">factor</span>(ses_t <span class="op">*</span><span class="st"> </span><span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gevocab,
             <span class="dt">y =</span> fit,
             <span class="dt">color =</span> age_yrs)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>ses, <span class="dt">labeller =</span> <span class="st">&quot;label_both&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Vocabulary Score&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Reading Score</span><span class="ch">\n</span><span class="st">Estimated Marginal Mean&quot;</span>,
       <span class="dt">color =</span> <span class="st">&quot;Student Age&quot;</span>)</code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-199-1.png" width="576" style="display: block; margin: auto;" /></p>
<hr />
<p>Helpful links:</p>
<p><a href="http://maths-people.anu.edu.au/~johnm/r-book/xtras/mlm-ohp.pdf" class="uri">http://maths-people.anu.edu.au/~johnm/r-book/xtras/mlm-ohp.pdf</a></p>
<p><a href="http://ase.tufts.edu/gsc/gradresources/guidetomixedmodelsinr/mixed%20model%20guide.html">http://ase.tufts.edu/gsc/gradresources/guidetomixedmodelsinr/mixed%20model%20guide.html</a></p>
<p><a href="http://web.stanford.edu/class/psych252/section_2015/Section_week9.html" class="uri">http://web.stanford.edu/class/psych252/section_2015/Section_week9.html</a></p>
<p><a href="https://www.r-bloggers.com/visualizing-generalized-linear-mixed-effects-models-with-ggplot-rstats-lme4/" class="uri">https://www.r-bloggers.com/visualizing-generalized-linear-mixed-effects-models-with-ggplot-rstats-lme4/</a></p>
<p><a href="https://www.r-bloggers.com/visualizing-generalized-linear-mixed-effects-models-part-2-rstats-lme4/" class="uri">https://www.r-bloggers.com/visualizing-generalized-linear-mixed-effects-models-part-2-rstats-lme4/</a></p>
<p><a href="http://www.strengejacke.de/sjPlot/sjp.lmer/" class="uri">http://www.strengejacke.de/sjPlot/sjp.lmer/</a></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="example-nurses-stress-intervention.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"toc_depth": 3
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
